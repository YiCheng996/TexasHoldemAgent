2025-02-25 14:53:57,333 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:53:57,336 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-maxxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:53:57,336 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-02-25 14:53:57,337 - src.engine.game - INFO - Added player ai_4 to game 716991f8-99f2-4fd0-af05-a11a8746f53c
2025-02-25 14:53:57,337 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-maxxxxx
2025-02-25 14:53:57,337 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:53:57,338 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:53:57,338 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♦', 'Q♥')
2025-02-25 14:53:57,339 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♣', 'A♠')
2025-02-25 14:53:57,339 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♥', '9♥')
2025-02-25 14:53:57,339 - src.engine.game - INFO - 玩家 ai_3 手牌: ('J♥', 'A♦')
2025-02-25 14:53:57,339 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♣', '6♦')
2025-02-25 14:53:57,340 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-02-25 14:53:57,340 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-02-25 14:53:57,340 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-02-25 14:53:57,341 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-02-25 14:53:57,341 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-02-25 14:53:57,341 - src.engine.game - INFO - 当前玩家: ai_3
2025-02-25 14:53:57,341 - src.engine.game - INFO - 游戏 716991f8-99f2-4fd0-af05-a11a8746f53c 开始，进入翻牌前阶段
2025-02-25 14:53:57,341 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-02-25 14:53:57,342 - server - INFO - 游戏 716991f8-99f2-4fd0-af05-a11a8746f53c 已开始
2025-02-25 14:53:57,342 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-02-25 14:53:57,832 - server - INFO - WebSocket连接已建立: 716991f8-99f2-4fd0-af05-a11a8746f53c
2025-02-25 14:53:57,833 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♣', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '9♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♥', 'A♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:53:57,835 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:53:57,835 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:53:57,836 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:53:57,836 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:53:57,836 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:53:57,836 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:53:59,982 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:53:59,982 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:53:59,982 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:00,983 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:00,983 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-02-25 14:54:00,983 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-02-25 14:54:00,984 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-02-25 14:54:00,984 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-02-25 14:54:00,984 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-02-25 14:54:00,984 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:54:00,984 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:54:00,984 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:00,985 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:54:00,985 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:54:00,985 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:54:00,985 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:00,985 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-02-25 14:54:00,985 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:00,986 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:00,986 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:54:00,986 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:00,986 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:00,986 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♣', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '9♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:54:00,987 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:00,987 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-02-25 14:54:00,987 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:00,988 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:00,988 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:54:00,988 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:00,989 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:06,007 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:06,008 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:54:06,008 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:54:06,009 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:54:06,009 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:54:06,009 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:54:06,010 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:54:06,077 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '17b037b9-5973-9a71-bd74-987c40e6b120'}
2025-02-25 14:54:06,079 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:54:06,079 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '17b037b9-5973-9a71-bd74-987c40e6b120'}
2025-02-25 14:54:07,086 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '17b037b9-5973-9a71-bd74-987c40e6b120'}
2025-02-25 14:54:07,086 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-02-25 14:54:07,086 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-02-25 14:54:07,087 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-02-25 14:54:07,087 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-02-25 14:54:07,087 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-02-25 14:54:07,087 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:54:07,087 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:54:07,088 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:07,088 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:54:07,088 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:54:07,088 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:54:07,089 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:07,089 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-02-25 14:54:07,089 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:07,089 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:07,089 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:54:07,089 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:07,090 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:07,090 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♣', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '9♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'FOLD', 'last_amount': 0}]}
2025-02-25 14:54:07,090 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:07,091 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-02-25 14:54:07,091 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:07,091 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:07,091 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:54:07,092 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:11,009 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:16,002 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:21,013 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:26,017 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:31,033 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:32,386 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-02-25 14:54:32,386 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-02-25T14:54:32.386761', 'table_talk': None}
2025-02-25 14:54:32,387 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-02-25 14:54:32,387 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-02-25 14:54:32,387 - src.engine.game - INFO - 玩家 player_0 跟注
2025-02-25 14:54:32,387 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-02-25 14:54:32,388 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:54:32,388 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:54:32,388 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:32,388 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-02-25 14:54:32,388 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-02-25 14:54:32,388 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:54:32,388 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:32,389 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-02-25 14:54:32,389 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:32,389 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:54:32,389 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:54:32,389 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:54:32,389 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:32,390 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:32,390 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♣', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '9♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:54:32,390 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:32,390 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-02-25 14:54:32,391 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:32,391 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:54:32,391 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:54:32,392 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:54:32,392 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:36,058 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:36,060 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:54:36,061 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:54:36,062 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:54:36,062 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:54:36,062 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:54:36,063 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:54:38,248 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:38,248 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:54:38,248 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:39,254 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:39,254 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-02-25 14:54:39,254 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-02-25 14:54:39,255 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-02-25 14:54:39,255 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-02-25 14:54:39,255 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-02-25 14:54:39,255 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:54:39,255 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:54:39,255 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:39,255 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:54:39,256 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:54:39,256 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:54:39,256 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:39,256 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-02-25 14:54:39,256 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:39,257 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:54:39,257 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-02-25 14:54:39,257 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-02-25 14:54:39,258 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:39,258 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:39,258 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '9♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:54:39,259 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:39,259 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-02-25 14:54:39,259 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:39,260 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:54:39,260 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-02-25 14:54:39,260 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-02-25 14:54:39,261 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:41,065 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:41,066 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:54:41,067 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:54:41,067 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:54:41,067 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:54:41,067 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:54:41,068 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:54:41,146 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'f50dce31-0055-93c7-8bf0-86ab2d09afd6'}
2025-02-25 14:54:41,147 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:54:41,147 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'f50dce31-0055-93c7-8bf0-86ab2d09afd6'}
2025-02-25 14:54:42,154 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'f50dce31-0055-93c7-8bf0-86ab2d09afd6'}
2025-02-25 14:54:42,155 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-02-25 14:54:42,155 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-02-25 14:54:42,156 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-02-25 14:54:42,156 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-02-25 14:54:42,156 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-02-25 14:54:42,157 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-02-25 14:54:42,157 - src.engine.game - INFO - 开始游戏结算
2025-02-25 14:54:42,158 - src.engine.game - INFO - 活跃玩家数量: 1
2025-02-25 14:54:42,159 - src.engine.state - INFO - 玩家 player_0 获得底池 50 筹码，当前筹码: 1030
2025-02-25 14:54:42,159 - src.engine.game - INFO - 玩家 player_0 获得底池 50 筹码
2025-02-25 14:54:42,159 - src.engine.state - INFO - 已停止所有玩家的行动
2025-02-25 14:54:42,159 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-02-25 14:54:42,160 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1030, 'current_bet': 20, 'is_active': False, 'cards': ('Q♦', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:54:42,161 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:42,161 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-02-25 14:54:42,161 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-02-25 14:54:42,162 - server - INFO - 回合结束，进入下一阶段
2025-02-25 14:54:42,162 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-02-25 14:54:42,162 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-02-25 14:54:42,163 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-02-25 14:54:42,164 - server - INFO - 游戏进入新阶段: FINISHED
2025-02-25 14:54:43,930 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 14:54:43,930 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-02-25 14:54:43,931 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-02-25 14:54:43,931 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:54:43,932 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:54:43,932 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♠', '10♣')
2025-02-25 14:54:43,932 - src.engine.game - INFO - 玩家 ai_1 手牌: ('2♥', 'J♦')
2025-02-25 14:54:43,933 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♠', '5♠')
2025-02-25 14:54:43,933 - src.engine.game - INFO - 玩家 ai_3 手牌: ('3♠', 'Q♣')
2025-02-25 14:54:43,934 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♠', '10♦')
2025-02-25 14:54:43,934 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-02-25 14:54:43,935 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-02-25 14:54:43,935 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-02-25 14:54:43,935 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-02-25 14:54:43,936 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-02-25 14:54:43,936 - src.engine.game - INFO - 当前玩家: ai_4
2025-02-25 14:54:43,937 - src.engine.game - INFO - 游戏 716991f8-99f2-4fd0-af05-a11a8746f53c 开始，进入翻牌前阶段
2025-02-25 14:54:43,937 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-02-25 14:54:46,080 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:46,081 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:54:46,082 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:54:46,082 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:54:46,083 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:54:46,083 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:54:46,084 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:54:46,120 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '1af9887f-46dc-9f2e-a4b3-96e03887108d'}
2025-02-25 14:54:46,120 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:54:46,120 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '1af9887f-46dc-9f2e-a4b3-96e03887108d'}
2025-02-25 14:54:47,128 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '1af9887f-46dc-9f2e-a4b3-96e03887108d'}
2025-02-25 14:54:47,129 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-02-25 14:54:47,130 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-02-25 14:54:47,131 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-02-25 14:54:47,131 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-02-25 14:54:47,132 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-02-25 14:54:47,132 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:54:47,133 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:54:47,134 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:47,135 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:54:47,135 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:54:47,136 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:54:47,136 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:47,137 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-02-25 14:54:47,137 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:47,138 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:47,138 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:54:47,138 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:47,139 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:47,139 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1030, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('2♥', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'FOLD', 'last_amount': 0}]}
2025-02-25 14:54:47,141 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:47,141 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-02-25 14:54:47,142 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:54:47,143 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:47,143 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:54:47,144 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:51,093 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:51,173 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 56}
2025-02-25 14:54:51,174 - server - INFO - 收到加注请求，金额: 56
2025-02-25 14:54:51,174 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 56, 'timestamp': '2025-02-25T14:54:51.174656', 'table_talk': None}
2025-02-25 14:54:51,176 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-02-25 14:54:51,177 - src.engine.state - INFO - 玩家 player_0 加注到 56 筹码，已标记为已行动
2025-02-25 14:54:51,178 - src.engine.game - INFO - 玩家 player_0 加注到 56
2025-02-25 14:54:51,178 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-02-25 14:54:51,179 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:54:51,179 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:54:51,180 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:54:51,180 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-02-25 14:54:51,180 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-02-25 14:54:51,181 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:54:51,182 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:51,182 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-02-25 14:54:51,183 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:54:51,183 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=56, is_all_in=False
2025-02-25 14:54:51,184 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:51,185 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:54:51,187 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:51,188 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:51,189 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 86, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 974, 'current_bet': 56, 'is_active': True, 'cards': ('7♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 56}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('2♥', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:54:51,190 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:51,191 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-02-25 14:54:51,191 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:54:51,192 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=56, is_all_in=False
2025-02-25 14:54:51,192 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:54:51,193 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:54:51,193 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:56,111 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:54:56,112 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:54:56,112 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:54:56,112 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:54:56,113 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:54:56,113 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:54:56,114 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:54:58,779 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:58,781 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:54:58,781 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:59,796 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:54:59,796 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-02-25 14:54:59,796 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-02-25 14:54:59,797 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-02-25 14:54:59,798 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-02-25 14:54:59,799 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-02-25 14:54:59,800 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:54:59,801 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:54:59,802 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:54:59,803 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:54:59,805 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:54:59,806 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:54:59,806 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:59,807 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_3']
2025-02-25 14:54:59,808 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:54:59,808 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=56, is_all_in=False
2025-02-25 14:54:59,809 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:54:59,810 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-02-25 14:54:59,810 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:54:59,811 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:54:59,812 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 86, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 974, 'current_bet': 56, 'is_active': True, 'cards': ('7♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:54:59,813 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:54:59,814 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_3']
2025-02-25 14:54:59,815 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:54:59,816 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=56, is_all_in=False
2025-02-25 14:54:59,817 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:54:59,817 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-02-25 14:54:59,818 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:55:01,124 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:01,125 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:55:01,125 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:55:01,126 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:55:01,126 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:55:01,127 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:55:01,128 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:55:01,238 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'afd01d65-c86a-9303-b441-056416c4ce19'}
2025-02-25 14:55:01,239 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:55:01,240 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'afd01d65-c86a-9303-b441-056416c4ce19'}
2025-02-25 14:55:02,250 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'afd01d65-c86a-9303-b441-056416c4ce19'}
2025-02-25 14:55:02,251 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-02-25 14:55:02,253 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-02-25 14:55:02,254 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-02-25 14:55:02,254 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-02-25 14:55:02,255 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-02-25 14:55:02,257 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:55:02,258 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:55:02,259 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:55:02,260 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:55:02,261 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-02-25 14:55:02,261 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:55:02,262 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:02,263 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-02-25 14:55:02,264 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:55:02,264 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=56, is_all_in=False
2025-02-25 14:55:02,265 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-02-25 14:55:02,265 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-02-25 14:55:02,266 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:55:02,266 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:55:02,267 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 86, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 974, 'current_bet': 56, 'is_active': True, 'cards': ('7♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:55:02,268 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:02,270 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-02-25 14:55:02,271 - src.engine.game - INFO - 当前最大下注额: 56
2025-02-25 14:55:02,272 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=56, is_all_in=False
2025-02-25 14:55:02,272 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-02-25 14:55:02,273 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-02-25 14:55:02,273 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:55:06,143 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:06,144 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:55:06,145 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:55:06,146 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:55:06,146 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:55:06,147 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:55:06,147 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:55:08,901 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:55:08,901 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:55:08,902 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:55:09,904 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:55:09,904 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-02-25 14:55:09,905 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-02-25 14:55:09,905 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-02-25 14:55:09,906 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-02-25 14:55:09,906 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-02-25 14:55:09,906 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-02-25 14:55:09,907 - src.engine.game - INFO - 开始游戏结算
2025-02-25 14:55:09,907 - src.engine.game - INFO - 活跃玩家数量: 1
2025-02-25 14:55:09,907 - src.engine.state - INFO - 玩家 player_0 获得底池 86 筹码，当前筹码: 1060
2025-02-25 14:55:09,908 - src.engine.game - INFO - 玩家 player_0 获得底池 86 筹码
2025-02-25 14:55:09,908 - src.engine.state - INFO - 已停止所有玩家的行动
2025-02-25 14:55:09,908 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 86, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♠', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-02-25 14:55:09,909 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 86, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♠', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1060, 'current_bet': 56, 'is_active': False, 'cards': ('7♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:55:09,910 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:09,911 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-02-25 14:55:09,911 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-02-25 14:55:09,912 - server - INFO - 回合结束，进入下一阶段
2025-02-25 14:55:09,912 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-02-25 14:55:09,912 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-02-25 14:55:09,913 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 86, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♠', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-02-25 14:55:09,914 - server - INFO - 游戏进入新阶段: FINISHED
2025-02-25 14:55:11,158 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:11,332 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 14:55:11,334 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-02-25 14:55:11,336 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-02-25 14:55:11,338 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:55:11,339 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:55:11,340 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♣', '4♠')
2025-02-25 14:55:11,341 - src.engine.game - INFO - 玩家 ai_1 手牌: ('2♥', '3♦')
2025-02-25 14:55:11,342 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♥', 'K♠')
2025-02-25 14:55:11,342 - src.engine.game - INFO - 玩家 ai_3 手牌: ('3♠', '8♦')
2025-02-25 14:55:11,343 - src.engine.game - INFO - 玩家 ai_4 手牌: ('10♣', '2♠')
2025-02-25 14:55:11,343 - src.engine.state - INFO - 玩家 ai_3 下注 10 筹码
2025-02-25 14:55:11,344 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-02-25 14:55:11,344 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-02-25 14:55:11,345 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-02-25 14:55:11,345 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-02-25 14:55:11,346 - src.engine.game - INFO - 当前玩家: player_0
2025-02-25 14:55:11,346 - src.engine.game - INFO - 游戏 716991f8-99f2-4fd0-af05-a11a8746f53c 开始，进入翻牌前阶段
2025-02-25 14:55:11,347 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-02-25 14:55:16,170 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:21,179 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:26,196 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:31,213 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:36,196 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-02-25 14:55:47,848 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-02-25 14:55:47,852 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-02-25 14:55:47,886 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-02-25 14:55:48,378 - server - INFO - 正在创建游戏: e6c26626-a48d-4eb9-92a6-88765551c08f, 玩家数量: 5
2025-02-25 14:55:48,379 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 14:55:48,379 - src.engine.state - INFO - 游戏状态已初始化
2025-02-25 14:55:48,380 - src.engine.game - INFO - 游戏 e6c26626-a48d-4eb9-92a6-88765551c08f 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-02-25 14:55:48,380 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-02-25 14:55:48,380 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-02-25 14:55:48,381 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:55:48,383 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-minixxx，性格: 擅长使用策略和心理战术
2025-02-25 14:55:48,383 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-02-25 14:55:48,384 - src.engine.game - INFO - Added player ai_1 to game e6c26626-a48d-4eb9-92a6-88765551c08f
2025-02-25 14:55:48,384 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-minixxx
2025-02-25 14:55:48,385 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:55:48,386 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3xxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:55:48,386 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-02-25 14:55:48,386 - src.engine.game - INFO - Added player ai_2 to game e6c26626-a48d-4eb9-92a6-88765551c08f
2025-02-25 14:55:48,387 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3xxxx
2025-02-25 14:55:48,387 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:55:48,388 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnetxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:55:48,388 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-02-25 14:55:48,388 - src.engine.game - INFO - Added player ai_3 to game e6c26626-a48d-4eb9-92a6-88765551c08f
2025-02-25 14:55:48,390 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:55:48,390 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:55:48,391 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-maxxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:55:48,392 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-02-25 14:55:48,392 - src.engine.game - INFO - Added player ai_4 to game e6c26626-a48d-4eb9-92a6-88765551c08f
2025-02-25 14:55:48,392 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-maxxxxx
2025-02-25 14:55:48,392 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:55:48,393 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:55:48,393 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♣', 'Q♦')
2025-02-25 14:55:48,393 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♠', 'Q♣')
2025-02-25 14:55:48,393 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♥', '5♦')
2025-02-25 14:55:48,394 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♠', '2♣')
2025-02-25 14:55:48,394 - src.engine.game - INFO - 玩家 ai_4 手牌: ('9♣', '6♦')
2025-02-25 14:55:48,394 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-02-25 14:55:48,394 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-02-25 14:55:48,394 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-02-25 14:55:48,395 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-02-25 14:55:48,395 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-02-25 14:55:48,395 - src.engine.game - INFO - 当前玩家: ai_3
2025-02-25 14:55:48,395 - src.engine.game - INFO - 游戏 e6c26626-a48d-4eb9-92a6-88765551c08f 开始，进入翻牌前阶段
2025-02-25 14:55:48,395 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-02-25 14:55:48,396 - server - INFO - 游戏 e6c26626-a48d-4eb9-92a6-88765551c08f 已开始
2025-02-25 14:55:48,396 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-02-25 14:55:49,277 - server - INFO - WebSocket连接已建立: e6c26626-a48d-4eb9-92a6-88765551c08f
2025-02-25 14:55:49,278 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:55:49,279 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:55:49,279 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:55:49,280 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:55:49,280 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:55:49,280 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:55:49,280 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:55:51,576 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:55:51,576 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:55:51,577 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:55:52,592 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:55:52,592 - server - INFO - AI玩家 ai_3 决定执行动作: CHECK, 金额: 0
2025-02-25 14:55:52,593 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CHECK
2025-02-25 14:55:52,593 - src.engine.game - INFO - 玩家 ai_3 过牌，已标记为已行动
2025-02-25 14:55:52,593 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_3
2025-02-25 14:55:52,593 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:55:52,593 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:55:52,593 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:55:52,594 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:55:52,594 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:55:52,594 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:55:52,594 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:52,594 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:55:52,594 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:55:52,595 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:55:52,595 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:55:52,595 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:55:52,595 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:55:52,595 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:55:52,596 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:52,596 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:55:52,597 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:55:52,597 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:55:52,597 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:55:52,598 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:55:57,601 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:55:57,601 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:55:57,602 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:55:57,602 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:55:57,603 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:55:57,603 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:55:58,137 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '18fcdada-517e-97d5-bd8c-4060d1e2515f'}
2025-02-25 14:55:58,137 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:55:58,138 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '18fcdada-517e-97d5-bd8c-4060d1e2515f'}
2025-02-25 14:55:59,139 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '18fcdada-517e-97d5-bd8c-4060d1e2515f'}
2025-02-25 14:55:59,142 - server - INFO - AI玩家 ai_4 决定执行动作: CHECK, 金额: 0
2025-02-25 14:55:59,144 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CHECK
2025-02-25 14:55:59,145 - src.engine.game - INFO - 玩家 ai_4 过牌，已标记为已行动
2025-02-25 14:55:59,147 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_4
2025-02-25 14:55:59,149 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:55:59,150 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:55:59,151 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:55:59,152 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:55:59,153 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:55:59,153 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:55:59,154 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:59,155 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:55:59,155 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:55:59,156 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:55:59,156 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:55:59,157 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:55:59,157 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:55:59,157 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CHECK', 'last_amount': 0}]}
2025-02-25 14:55:59,158 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:55:59,159 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:55:59,159 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:55:59,159 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:55:59,160 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:55:59,161 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:56:07,674 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-02-25 14:56:07,675 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-02-25T14:56:07.675791', 'table_talk': None}
2025-02-25 14:56:07,675 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-02-25 14:56:07,676 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-02-25 14:56:07,676 - src.engine.game - INFO - 玩家 player_0 跟注
2025-02-25 14:56:07,676 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-02-25 14:56:07,677 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:56:07,677 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:56:07,677 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:07,677 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-02-25 14:56:07,677 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-02-25 14:56:07,678 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:56:07,678 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:07,678 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:07,678 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:07,678 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:07,678 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:56:07,679 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:56:07,679 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:56:07,679 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:07,679 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:07,680 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:07,680 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:07,680 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:07,680 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:07,680 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:56:07,681 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:56:07,681 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:56:12,624 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:56:12,624 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:56:12,625 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:56:12,626 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:12,626 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:12,627 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:56:15,284 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:15,284 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:15,285 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:16,300 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:16,300 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:16,300 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-02-25 14:56:16,301 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-02-25 14:56:16,301 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-02-25 14:56:16,301 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:56:16,301 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:56:16,302 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:16,302 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:56:16,302 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:56:16,302 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:56:16,303 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:16,303 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:16,303 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:16,303 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:16,303 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:16,304 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:16,304 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:16,304 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:16,304 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:16,305 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:16,305 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:16,305 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:16,305 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:16,306 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:16,306 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:16,306 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:17,594 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:56:17,594 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:56:17,594 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:56:17,595 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:17,595 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:17,595 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:56:17,668 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '107087cb-8c0e-9212-9bbe-1db0c5ff15fc'}
2025-02-25 14:56:17,668 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:17,669 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '107087cb-8c0e-9212-9bbe-1db0c5ff15fc'}
2025-02-25 14:56:18,675 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '107087cb-8c0e-9212-9bbe-1db0c5ff15fc'}
2025-02-25 14:56:18,675 - server - INFO - AI玩家 ai_2 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:18,675 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CHECK
2025-02-25 14:56:18,676 - src.engine.game - INFO - 玩家 ai_2 过牌，已标记为已行动
2025-02-25 14:56:18,676 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_2
2025-02-25 14:56:18,676 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:56:18,676 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:56:18,676 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:18,677 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:56:18,677 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-02-25 14:56:18,677 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:56:18,677 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:18,677 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:18,678 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:18,678 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:18,678 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:18,678 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:18,678 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:18,679 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:18,679 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:18,679 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:18,679 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:18,680 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:18,680 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:18,680 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:18,680 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:18,681 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:22,619 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:56:22,620 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:56:22,620 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:56:22,620 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:22,620 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:22,620 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:56:24,805 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:24,806 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:24,806 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:25,820 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:25,822 - server - INFO - AI玩家 ai_3 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:25,823 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CHECK
2025-02-25 14:56:25,823 - src.engine.game - INFO - 玩家 ai_3 过牌，已标记为已行动
2025-02-25 14:56:25,824 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_3
2025-02-25 14:56:25,824 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:56:25,824 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:56:25,825 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:25,825 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:56:25,826 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:56:25,826 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:56:25,826 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:25,827 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:25,827 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:25,827 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:25,827 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:25,827 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:25,828 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:25,828 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:25,828 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:25,829 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:25,829 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:25,829 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:25,829 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:25,829 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:25,830 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:25,830 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:27,609 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:56:27,610 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:56:27,610 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:56:27,611 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:27,611 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:27,611 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:56:27,688 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'e14a6de9-7018-9c48-bde4-a309c11b533a'}
2025-02-25 14:56:27,688 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:27,689 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'e14a6de9-7018-9c48-bde4-a309c11b533a'}
2025-02-25 14:56:28,696 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'e14a6de9-7018-9c48-bde4-a309c11b533a'}
2025-02-25 14:56:28,697 - server - INFO - AI玩家 ai_4 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:28,698 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CHECK
2025-02-25 14:56:28,699 - src.engine.game - INFO - 玩家 ai_4 过牌，已标记为已行动
2025-02-25 14:56:28,699 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_4
2025-02-25 14:56:28,699 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:56:28,700 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:56:28,700 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:28,700 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-02-25 14:56:28,701 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_1
2025-02-25 14:56:28,701 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:56:28,702 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:28,702 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:28,702 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:28,703 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:28,703 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:28,703 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:28,703 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:28,703 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:28,704 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CHECK', 'last_amount': 0}]}
2025-02-25 14:56:28,704 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:28,705 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:28,705 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:28,705 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:28,705 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:28,706 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:28,706 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:32,636 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:56:32,637 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:56:32,637 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:56:32,638 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:32,638 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:32,638 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:56:34,874 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:34,874 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:34,874 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:35,880 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:35,882 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:35,883 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-02-25 14:56:35,885 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-02-25 14:56:35,886 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-02-25 14:56:35,888 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:56:35,890 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:56:35,892 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:35,894 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:56:35,896 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_3
2025-02-25 14:56:35,899 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:56:35,901 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:35,903 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:35,904 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:35,906 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:35,907 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:35,908 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:35,909 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:35,910 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:35,911 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:35,914 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:35,915 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:35,916 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:35,917 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:35,918 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:35,919 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:35,919 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:37,644 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:56:37,645 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:56:37,645 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:56:37,645 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:37,646 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:37,646 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:56:39,818 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:39,819 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:39,820 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:40,831 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:40,835 - server - INFO - AI玩家 ai_3 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:40,837 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CHECK
2025-02-25 14:56:40,837 - src.engine.game - INFO - 玩家 ai_3 过牌，已标记为已行动
2025-02-25 14:56:40,837 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_3
2025-02-25 14:56:40,837 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:56:40,837 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:56:40,838 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:40,838 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:56:40,839 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:56:40,839 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:56:40,840 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:40,841 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:40,841 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:40,842 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:40,842 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:40,843 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:40,843 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:40,844 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:40,844 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:40,845 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:40,845 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:40,846 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:40,846 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:40,846 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:40,846 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:40,847 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:42,646 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:56:42,647 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:56:42,647 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:56:42,647 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:42,648 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:42,648 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:56:42,728 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '74c35013-1388-9f85-b23f-0aa0dea72284'}
2025-02-25 14:56:42,728 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:42,729 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '74c35013-1388-9f85-b23f-0aa0dea72284'}
2025-02-25 14:56:43,739 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '74c35013-1388-9f85-b23f-0aa0dea72284'}
2025-02-25 14:56:43,739 - server - INFO - AI玩家 ai_4 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:43,739 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CHECK
2025-02-25 14:56:43,740 - src.engine.game - INFO - 玩家 ai_4 过牌，已标记为已行动
2025-02-25 14:56:43,740 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_4
2025-02-25 14:56:43,740 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:56:43,740 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:56:43,740 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:43,740 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-02-25 14:56:43,740 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_1
2025-02-25 14:56:43,741 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:56:43,741 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:43,741 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:43,741 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:43,741 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:43,742 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:43,742 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:43,743 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:43,743 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:43,743 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CHECK', 'last_amount': 0}]}
2025-02-25 14:56:43,744 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:43,744 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:43,744 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:43,745 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:43,745 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:43,745 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:43,746 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:47,658 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:56:47,658 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:56:47,658 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:56:47,659 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:56:47,659 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:56:47,659 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:56:49,816 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:49,816 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:56:49,816 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:50,826 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:56:50,826 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-02-25 14:56:50,827 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-02-25 14:56:50,827 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-02-25 14:56:50,827 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-02-25 14:56:50,827 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:56:50,827 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:56:50,828 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:50,828 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:56:50,828 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_3
2025-02-25 14:56:50,828 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:56:50,828 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:50,828 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:50,828 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:50,828 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:50,828 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:50,829 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:50,829 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:56:50,829 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:56:50,829 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:56:50,830 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:56:50,830 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:56:50,831 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:56:50,831 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:56:50,831 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-02-25 14:56:50,831 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(20)，回合继续
2025-02-25 14:56:50,831 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:57:07,217 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-02-25 14:57:07,221 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-02-25 14:57:14,268 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-02-25 14:57:14,271 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-02-25 14:57:18,369 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-02-25 14:57:18,697 - server - INFO - 正在创建游戏: 5d0149fe-13e1-4b8d-9871-907d32911b41, 玩家数量: 5
2025-02-25 14:57:18,698 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 14:57:18,698 - src.engine.state - INFO - 游戏状态已初始化
2025-02-25 14:57:18,699 - src.engine.game - INFO - 游戏 5d0149fe-13e1-4b8d-9871-907d32911b41 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-02-25 14:57:18,699 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-02-25 14:57:18,699 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-02-25 14:57:18,700 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:18,701 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-minixxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:18,701 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-02-25 14:57:18,702 - src.engine.game - INFO - Added player ai_1 to game 5d0149fe-13e1-4b8d-9871-907d32911b41
2025-02-25 14:57:18,702 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-minixxx
2025-02-25 14:57:18,702 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:18,703 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3xxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:18,703 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-02-25 14:57:18,704 - src.engine.game - INFO - Added player ai_2 to game 5d0149fe-13e1-4b8d-9871-907d32911b41
2025-02-25 14:57:18,704 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3xxxx
2025-02-25 14:57:18,704 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:18,706 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnetxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:18,706 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-02-25 14:57:18,706 - src.engine.game - INFO - Added player ai_3 to game 5d0149fe-13e1-4b8d-9871-907d32911b41
2025-02-25 14:57:18,706 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:57:18,707 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:18,709 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-maxxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:18,709 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-02-25 14:57:18,709 - src.engine.game - INFO - Added player ai_4 to game 5d0149fe-13e1-4b8d-9871-907d32911b41
2025-02-25 14:57:18,710 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-maxxxxx
2025-02-25 14:57:18,710 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:18,710 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:57:18,711 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♣', '6♣')
2025-02-25 14:57:18,711 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♦', '4♠')
2025-02-25 14:57:18,711 - src.engine.game - INFO - 玩家 ai_2 手牌: ('J♦', '2♣')
2025-02-25 14:57:18,712 - src.engine.game - INFO - 玩家 ai_3 手牌: ('Q♣', '9♥')
2025-02-25 14:57:18,712 - src.engine.game - INFO - 玩家 ai_4 手牌: ('7♠', '8♦')
2025-02-25 14:57:18,712 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-02-25 14:57:18,712 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-02-25 14:57:18,713 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-02-25 14:57:18,713 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-02-25 14:57:18,713 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-02-25 14:57:18,713 - src.engine.game - INFO - 当前玩家: ai_3
2025-02-25 14:57:18,714 - src.engine.game - INFO - 游戏 5d0149fe-13e1-4b8d-9871-907d32911b41 开始，进入翻牌前阶段
2025-02-25 14:57:18,714 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-02-25 14:57:18,714 - server - INFO - 游戏 5d0149fe-13e1-4b8d-9871-907d32911b41 已开始
2025-02-25 14:57:18,714 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-02-25 14:57:19,158 - server - INFO - 正在创建游戏: 2417ec71-e6ef-438b-9e72-856b03286430, 玩家数量: 5
2025-02-25 14:57:19,158 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 14:57:19,159 - src.engine.state - INFO - 游戏状态已初始化
2025-02-25 14:57:19,159 - src.engine.game - INFO - 游戏 2417ec71-e6ef-438b-9e72-856b03286430 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-02-25 14:57:19,159 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-02-25 14:57:19,159 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-02-25 14:57:19,160 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:19,162 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-minixxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:19,162 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-02-25 14:57:19,162 - src.engine.game - INFO - Added player ai_1 to game 2417ec71-e6ef-438b-9e72-856b03286430
2025-02-25 14:57:19,163 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-minixxx
2025-02-25 14:57:19,163 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:19,165 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3xxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:19,165 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-02-25 14:57:19,165 - src.engine.game - INFO - Added player ai_2 to game 2417ec71-e6ef-438b-9e72-856b03286430
2025-02-25 14:57:19,166 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3xxxx
2025-02-25 14:57:19,166 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:19,167 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnetxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:19,168 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-02-25 14:57:19,168 - src.engine.game - INFO - Added player ai_3 to game 2417ec71-e6ef-438b-9e72-856b03286430
2025-02-25 14:57:19,168 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:57:19,168 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 14:57:19,170 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-maxxxxx，性格: 擅长使用策略和心理战术
2025-02-25 14:57:19,170 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-02-25 14:57:19,170 - src.engine.game - INFO - Added player ai_4 to game 2417ec71-e6ef-438b-9e72-856b03286430
2025-02-25 14:57:19,171 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-maxxxxx
2025-02-25 14:57:19,171 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:19,171 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:57:19,171 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♣', 'Q♦')
2025-02-25 14:57:19,171 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♠', 'K♥')
2025-02-25 14:57:19,172 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♦', '7♦')
2025-02-25 14:57:19,172 - src.engine.game - INFO - 玩家 ai_3 手牌: ('10♠', '3♣')
2025-02-25 14:57:19,172 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♠', '2♥')
2025-02-25 14:57:19,172 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-02-25 14:57:19,173 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-02-25 14:57:19,173 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-02-25 14:57:19,173 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-02-25 14:57:19,173 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-02-25 14:57:19,173 - src.engine.game - INFO - 当前玩家: ai_3
2025-02-25 14:57:19,173 - src.engine.game - INFO - 游戏 2417ec71-e6ef-438b-9e72-856b03286430 开始，进入翻牌前阶段
2025-02-25 14:57:19,174 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-02-25 14:57:19,174 - server - INFO - 游戏 2417ec71-e6ef-438b-9e72-856b03286430 已开始
2025-02-25 14:57:19,174 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-02-25 14:57:19,769 - server - INFO - WebSocket连接已建立: 2417ec71-e6ef-438b-9e72-856b03286430
2025-02-25 14:57:19,770 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:19,771 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:57:19,772 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:57:19,772 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:57:19,773 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:19,773 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:19,773 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:57:21,972 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:21,973 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:21,973 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:22,983 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:22,984 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:22,985 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 14:57:22,985 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-02-25 14:57:22,985 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 14:57:22,986 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 14:57:22,986 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:57:22,986 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:57:22,986 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:22,986 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:57:22,986 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:57:22,987 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:57:22,987 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:22,987 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:22,987 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:22,988 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:22,989 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:22,990 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:22,990 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:22,990 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:22,991 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:22,991 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:22,991 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:22,992 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:22,992 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:22,992 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:28,008 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:57:28,010 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:57:28,010 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:57:28,011 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:28,011 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:28,012 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:57:28,554 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '9332b6fc-e48c-9a6b-ba2f-7c6230bc09e3'}
2025-02-25 14:57:28,554 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:28,555 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '9332b6fc-e48c-9a6b-ba2f-7c6230bc09e3'}
2025-02-25 14:57:29,567 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '9332b6fc-e48c-9a6b-ba2f-7c6230bc09e3'}
2025-02-25 14:57:29,568 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:29,568 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 14:57:29,569 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-02-25 14:57:29,569 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 14:57:29,569 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 14:57:29,570 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:57:29,570 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:57:29,570 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:29,571 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:57:29,572 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:57:29,572 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:57:29,572 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:29,572 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:29,573 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:29,573 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:29,573 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:29,573 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:29,573 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:29,573 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 14:57:29,575 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:29,575 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:29,575 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:29,575 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:29,576 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:29,576 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:31,116 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-02-25 14:57:31,117 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-02-25T14:57:31.117809', 'table_talk': None}
2025-02-25 14:57:31,117 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-02-25 14:57:31,117 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-02-25 14:57:31,118 - src.engine.game - INFO - 玩家 player_0 跟注
2025-02-25 14:57:31,119 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-02-25 14:57:31,119 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:57:31,120 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:57:31,120 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:31,121 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-02-25 14:57:31,122 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-02-25 14:57:31,122 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:57:31,123 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:31,123 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:31,124 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:31,124 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:31,125 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:57:31,125 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:57:31,125 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:31,125 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:31,126 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:31,126 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:31,126 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:31,127 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:31,127 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:31,127 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-02-25 14:57:31,127 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-02-25 14:57:31,127 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:33,010 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:57:33,011 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:57:33,011 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:57:33,011 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:33,011 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:33,012 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:57:35,157 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:35,157 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:35,158 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:36,162 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:36,162 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:36,162 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-02-25 14:57:36,163 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-02-25 14:57:36,163 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-02-25 14:57:36,163 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-02-25 14:57:36,163 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:57:36,164 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:57:36,164 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:36,164 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:57:36,164 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:57:36,164 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:57:36,165 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:36,165 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:36,165 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:36,165 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:36,165 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:36,165 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-02-25 14:57:36,165 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-02-25 14:57:36,166 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:36,166 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:36,166 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 100, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:36,166 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:36,167 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:36,167 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:36,167 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:36,167 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:36,168 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-02-25 14:57:36,168 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-02-25 14:57:36,168 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:38,025 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:57:38,025 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:57:38,026 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:57:38,026 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:38,026 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:38,026 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:57:38,120 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '70f9c968-f013-94fa-90f1-a2772681a632'}
2025-02-25 14:57:38,121 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:38,121 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '70f9c968-f013-94fa-90f1-a2772681a632'}
2025-02-25 14:57:39,132 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '70f9c968-f013-94fa-90f1-a2772681a632'}
2025-02-25 14:57:39,132 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:39,133 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-02-25 14:57:39,133 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-02-25 14:57:39,133 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-02-25 14:57:39,133 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-02-25 14:57:39,134 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:57:39,134 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:57:39,134 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:39,135 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-02-25 14:57:39,135 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-02-25 14:57:39,135 - src.engine.game - INFO - 更新当前玩家为: None
2025-02-25 14:57:39,136 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:39,136 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:39,136 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:57:39,136 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:39,136 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:39,136 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:39,137 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:39,137 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=20, is_all_in=False
2025-02-25 14:57:39,137 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-02-25 14:57:39,137 - src.engine.game - INFO - 回合是否完成: True
2025-02-25 14:57:39,137 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-02-25 14:57:39,137 - src.engine.game - INFO - 活跃玩家数量: 5, 当前游戏阶段: GameStage.PRE_FLOP
2025-02-25 14:57:39,138 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-02-25 14:57:39,138 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-02-25 14:57:39,138 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:39,138 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-02-25 14:57:39,138 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-02-25 14:57:39,139 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-02-25 14:57:39,139 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-02-25 14:57:39,139 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-02-25 14:57:39,139 - src.engine.dealer - INFO - Dealt 3 community cards: ['A♠', '7♥', '6♣']
2025-02-25 14:57:39,139 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['A♠', '7♥', '6♣']
2025-02-25 14:57:39,139 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_2', 2), ('ai_3', 3), ('ai_4', 4)]
2025-02-25 14:57:39,139 - src.engine.game - INFO - 庄家位置: 0
2025-02-25 14:57:39,140 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-02-25 14:57:39,140 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-02-25 14:57:39,140 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:39,141 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:39,141 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:39,141 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:39,142 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:39,142 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:39,143 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:43,018 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:57:43,018 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:57:43,018 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:57:43,019 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:43,019 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:43,019 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:57:45,142 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:45,142 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:45,143 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:46,153 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:46,153 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:46,154 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-02-25 14:57:46,154 - src.engine.state - INFO - 玩家 ai_1 跟注 0 筹码，已标记为已行动
2025-02-25 14:57:46,154 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-02-25 14:57:46,155 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-02-25 14:57:46,155 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:57:46,155 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:57:46,155 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:46,155 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:57:46,156 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:57:46,156 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:57:46,156 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:46,156 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:46,156 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:46,157 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:46,157 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:46,157 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:46,157 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:46,157 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:46,158 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:46,158 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:46,159 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:46,160 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:46,161 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:46,162 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:48,038 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:57:48,039 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:57:48,039 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:57:48,040 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:48,040 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:48,040 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:57:48,143 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ba2c4eed-2959-9c12-aa5e-9c0b3f6ac337'}
2025-02-25 14:57:48,143 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:48,144 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ba2c4eed-2959-9c12-aa5e-9c0b3f6ac337'}
2025-02-25 14:57:49,158 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ba2c4eed-2959-9c12-aa5e-9c0b3f6ac337'}
2025-02-25 14:57:49,159 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:49,159 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-02-25 14:57:49,160 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-02-25 14:57:49,160 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-02-25 14:57:49,160 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-02-25 14:57:49,160 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:57:49,160 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:57:49,161 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:49,161 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:57:49,161 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-02-25 14:57:49,161 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:57:49,161 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:49,161 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:49,162 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:49,162 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:49,162 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:49,162 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:49,162 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:49,163 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:49,163 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:49,164 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:49,164 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:49,165 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:49,166 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:49,166 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:53,047 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:57:53,047 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:57:53,047 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:57:53,048 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:53,048 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:53,048 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:57:55,282 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:55,282 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:55,282 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:56,289 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:57:56,290 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:56,290 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 14:57:56,291 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-02-25 14:57:56,291 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 14:57:56,291 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 14:57:56,292 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:57:56,292 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:57:56,292 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:56,292 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:57:56,293 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:57:56,293 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:57:56,293 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:56,293 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:56,293 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:56,293 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:56,294 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:56,294 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:56,294 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:56,294 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:57:56,295 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:56,295 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:56,295 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:56,295 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:56,295 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:56,296 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:58,064 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:57:58,064 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:57:58,065 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:57:58,065 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:57:58,065 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:57:58,065 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:57:58,160 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '0fae80e5-3346-9156-976f-2a1b719af7a5'}
2025-02-25 14:57:58,161 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:57:58,161 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '0fae80e5-3346-9156-976f-2a1b719af7a5'}
2025-02-25 14:57:59,170 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '0fae80e5-3346-9156-976f-2a1b719af7a5'}
2025-02-25 14:57:59,170 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 14:57:59,170 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 14:57:59,171 - src.engine.state - INFO - 玩家 ai_4 跟注 0 筹码，已标记为已行动
2025-02-25 14:57:59,171 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 14:57:59,171 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 14:57:59,171 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:57:59,171 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:57:59,172 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:59,172 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:57:59,172 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:57:59,172 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:57:59,172 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:59,172 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:59,173 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:59,173 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:59,173 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:59,173 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:57:59,173 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:57:59,173 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 14:57:59,174 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:57:59,174 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:57:59,174 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:57:59,174 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:57:59,175 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:57:59,175 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:17,612 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-02-25 14:58:17,613 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-02-25T14:58:17.613453', 'table_talk': None}
2025-02-25 14:58:17,613 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-02-25 14:58:17,613 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-02-25 14:58:17,613 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-02-25 14:58:17,614 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:58:17,614 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:58:17,614 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:17,614 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-02-25 14:58:17,614 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-02-25 14:58:17,615 - src.engine.game - INFO - 更新当前玩家为: None
2025-02-25 14:58:17,615 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:17,615 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:17,615 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:17,615 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:17,615 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:17,616 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:17,616 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:17,616 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:17,616 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-02-25 14:58:17,617 - src.engine.game - INFO - 回合是否完成: True
2025-02-25 14:58:17,617 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-02-25 14:58:17,617 - src.engine.game - INFO - 活跃玩家数量: 5, 当前游戏阶段: GameStage.FLOP
2025-02-25 14:58:17,617 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-02-25 14:58:17,617 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-02-25 14:58:17,618 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:17,618 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-02-25 14:58:17,618 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-02-25 14:58:17,618 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-02-25 14:58:17,618 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-02-25 14:58:17,619 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-02-25 14:58:17,619 - src.engine.dealer - INFO - Dealt 1 community cards: ['6♦']
2025-02-25 14:58:17,619 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['A♠', '7♥', '6♣', '6♦']
2025-02-25 14:58:17,619 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_2', 2), ('ai_3', 3), ('ai_4', 4)]
2025-02-25 14:58:17,619 - src.engine.game - INFO - 庄家位置: 0
2025-02-25 14:58:17,620 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-02-25 14:58:17,620 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-02-25 14:58:17,620 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:17,621 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:17,621 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:17,621 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:17,622 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:17,622 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:17,622 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:18,119 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:58:18,119 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:58:18,120 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:58:18,120 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:18,121 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:18,121 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:58:20,326 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:20,326 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:20,326 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:21,328 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:21,329 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:21,330 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-02-25 14:58:21,331 - src.engine.state - INFO - 玩家 ai_1 跟注 0 筹码，已标记为已行动
2025-02-25 14:58:21,331 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-02-25 14:58:21,332 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-02-25 14:58:21,332 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:58:21,333 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:58:21,333 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:21,334 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:58:21,336 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:58:21,336 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:58:21,337 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:21,337 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:21,337 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:21,338 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:21,338 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:21,338 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:21,338 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:21,338 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:21,339 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:21,339 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:21,340 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:21,340 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:21,341 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:21,342 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:23,127 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:58:23,127 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:58:23,128 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:58:23,128 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:23,128 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:23,128 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:58:23,201 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ed89cdc0-935b-9fef-b18a-5ea691cf68a0'}
2025-02-25 14:58:23,202 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:23,202 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ed89cdc0-935b-9fef-b18a-5ea691cf68a0'}
2025-02-25 14:58:24,204 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ed89cdc0-935b-9fef-b18a-5ea691cf68a0'}
2025-02-25 14:58:24,205 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:24,205 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-02-25 14:58:24,205 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-02-25 14:58:24,205 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-02-25 14:58:24,206 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-02-25 14:58:24,206 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:58:24,206 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:58:24,206 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:24,206 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:58:24,206 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-02-25 14:58:24,206 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:58:24,206 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:24,207 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:24,207 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:24,207 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:24,207 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:24,207 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:24,207 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:24,208 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:24,208 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:24,208 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:24,208 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:24,208 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:24,208 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:24,209 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:28,145 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:58:28,145 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:58:28,146 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:58:28,146 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:28,146 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:28,147 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:58:30,265 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:30,266 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:30,266 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:31,277 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:31,277 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:31,277 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 14:58:31,279 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-02-25 14:58:31,279 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 14:58:31,279 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 14:58:31,279 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:58:31,279 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:58:31,280 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:31,280 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:58:31,280 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:58:31,280 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:58:31,280 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:31,280 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:31,280 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:31,281 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:31,281 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:31,281 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:31,281 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:31,281 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:31,282 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:31,282 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:31,282 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:31,282 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:31,282 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:31,283 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:33,153 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:58:33,153 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:58:33,153 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:58:33,154 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:33,154 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:33,155 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:58:33,246 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '58371043-b733-9e26-bbf8-74e972d3c2fa'}
2025-02-25 14:58:33,247 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:33,247 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '58371043-b733-9e26-bbf8-74e972d3c2fa'}
2025-02-25 14:58:34,254 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '58371043-b733-9e26-bbf8-74e972d3c2fa'}
2025-02-25 14:58:34,254 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:34,255 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 14:58:34,255 - src.engine.state - INFO - 玩家 ai_4 跟注 0 筹码，已标记为已行动
2025-02-25 14:58:34,255 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 14:58:34,255 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 14:58:34,256 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:58:34,256 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:58:34,256 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:34,256 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:58:34,256 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:58:34,257 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:58:34,257 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:34,257 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:34,257 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:34,257 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:34,257 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:34,258 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:34,258 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:34,258 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 100, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 14:58:34,259 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:34,259 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:34,259 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:34,260 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:34,260 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:34,260 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:58:43,123 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 100}
2025-02-25 14:58:43,124 - server - INFO - 收到加注请求，金额: 100
2025-02-25 14:58:43,124 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 100, 'timestamp': '2025-02-25T14:58:43.124825', 'table_talk': None}
2025-02-25 14:58:43,125 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-02-25 14:58:43,125 - src.engine.state - INFO - 玩家 player_0 加注到 100 筹码，已标记为已行动
2025-02-25 14:58:43,126 - src.engine.game - INFO - 玩家 player_0 加注到 100
2025-02-25 14:58:43,126 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-02-25 14:58:43,126 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:58:43,126 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:58:43,127 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:43,127 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-02-25 14:58:43,127 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-02-25 14:58:43,127 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-02-25 14:58:43,127 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:43,128 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:43,128 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:43,129 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:43,129 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:43,129 - src.engine.game - INFO - 玩家 ai_1 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:43,130 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:43,130 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:43,131 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 200, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 100}, {'id': 'ai_1', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:43,131 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:43,132 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:43,132 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:43,132 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:43,132 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:43,133 - src.engine.game - INFO - 玩家 ai_1 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:43,133 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:43,170 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:58:43,171 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:58:43,171 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:58:43,171 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:43,172 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:43,172 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:58:45,430 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:45,431 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:45,431 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:46,439 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:46,440 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:46,440 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-02-25 14:58:46,441 - src.engine.state - INFO - 玩家 ai_1 跟注 100 筹码，已标记为已行动
2025-02-25 14:58:46,441 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-02-25 14:58:46,442 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-02-25 14:58:46,442 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:58:46,443 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:58:46,443 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:46,444 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:58:46,444 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:58:46,444 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:58:46,445 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:46,446 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:46,446 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:46,448 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:46,448 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:46,449 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:46,449 - src.engine.game - INFO - 玩家 ai_2 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:46,450 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:46,451 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:46,452 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 300, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:46,453 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:46,454 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:46,454 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:46,455 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:46,455 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:46,456 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:46,457 - src.engine.game - INFO - 玩家 ai_2 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:46,458 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:48,184 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:58:48,185 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:58:48,186 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:58:48,187 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:48,188 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:48,188 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:58:48,296 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '27fd9610-fe7d-980f-868c-63977f777c9a'}
2025-02-25 14:58:48,296 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:48,297 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '27fd9610-fe7d-980f-868c-63977f777c9a'}
2025-02-25 14:58:49,309 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '27fd9610-fe7d-980f-868c-63977f777c9a'}
2025-02-25 14:58:49,310 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:49,311 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-02-25 14:58:49,312 - src.engine.state - INFO - 玩家 ai_2 跟注 100 筹码，已标记为已行动
2025-02-25 14:58:49,313 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-02-25 14:58:49,314 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-02-25 14:58:49,316 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:58:49,317 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:58:49,317 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:49,317 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:58:49,318 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-02-25 14:58:49,319 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:58:49,319 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:49,320 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:49,320 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:49,321 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:49,322 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:49,322 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:49,322 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:49,323 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:49,323 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:49,324 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:49,324 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 400, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:49,325 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:49,326 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:49,328 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:49,330 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:49,335 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:49,336 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:49,336 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:49,337 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:49,337 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:53,199 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:58:53,202 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:58:53,202 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:58:53,203 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:53,204 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:53,204 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:58:55,593 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:55,594 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:55,595 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:56,609 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:58:56,612 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:56,613 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 14:58:56,614 - src.engine.state - INFO - 玩家 ai_3 跟注 100 筹码，已标记为已行动
2025-02-25 14:58:56,615 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 14:58:56,616 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 14:58:56,617 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:58:56,617 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:58:56,618 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:56,619 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:58:56,620 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:58:56,622 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:58:56,624 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:56,624 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:56,625 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:56,625 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,626 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,626 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,627 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,628 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:56,628 - src.engine.game - INFO - 玩家 ai_4 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:56,629 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:56,630 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:58:56,630 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 500, 'community_cards': ['A♠', '7♥', '6♣', '6♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 880, 'current_bet': 100, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 980, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:58:56,631 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:56,632 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:56,632 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:56,634 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,636 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,636 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,637 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:56,637 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:58:56,638 - src.engine.game - INFO - 玩家 ai_4 下注额(0)不等于最大下注额(100)，回合继续
2025-02-25 14:58:56,638 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-02-25 14:58:58,211 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:58:58,212 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:58:58,213 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:58:58,214 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:58:58,214 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:58:58,215 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:58:58,287 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '9b937bca-b2a0-91f7-8e65-cb749d6d9470'}
2025-02-25 14:58:58,288 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:58:58,288 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '9b937bca-b2a0-91f7-8e65-cb749d6d9470'}
2025-02-25 14:58:59,290 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '9b937bca-b2a0-91f7-8e65-cb749d6d9470'}
2025-02-25 14:58:59,291 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 14:58:59,292 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 14:58:59,293 - src.engine.state - INFO - 玩家 ai_4 跟注 100 筹码，已标记为已行动
2025-02-25 14:58:59,294 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 14:58:59,295 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 14:58:59,296 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:58:59,297 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:58:59,299 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:59,299 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-02-25 14:58:59,300 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-02-25 14:58:59,300 - src.engine.game - INFO - 更新当前玩家为: None
2025-02-25 14:58:59,301 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:59,301 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:59,302 - src.engine.game - INFO - 当前最大下注额: 100
2025-02-25 14:58:59,303 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:59,303 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:59,304 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:59,304 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:59,307 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=100, is_all_in=False
2025-02-25 14:58:59,308 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-02-25 14:58:59,308 - src.engine.game - INFO - 回合是否完成: True
2025-02-25 14:58:59,309 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-02-25 14:58:59,310 - src.engine.game - INFO - 活跃玩家数量: 5, 当前游戏阶段: GameStage.TURN
2025-02-25 14:58:59,310 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-02-25 14:58:59,311 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-02-25 14:58:59,312 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:59,312 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-02-25 14:58:59,313 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-02-25 14:58:59,313 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-02-25 14:58:59,314 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-02-25 14:58:59,314 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-02-25 14:58:59,316 - src.engine.dealer - INFO - Dealt 1 community cards: ['Q♥']
2025-02-25 14:58:59,316 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['A♠', '7♥', '6♣', '6♦', 'Q♥']
2025-02-25 14:58:59,317 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_2', 2), ('ai_3', 3), ('ai_4', 4)]
2025-02-25 14:58:59,317 - src.engine.game - INFO - 庄家位置: 0
2025-02-25 14:58:59,318 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-02-25 14:58:59,318 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-02-25 14:58:59,319 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 600, 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 14:58:59,321 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:58:59,322 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:58:59,323 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:58:59,324 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:58:59,325 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:58:59,325 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:03,200 - server - INFO - 当前AI玩家: ai_1
2025-02-25 14:59:03,201 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-02-25 14:59:03,201 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-02-25 14:59:03,203 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:59:03,203 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:59:03,204 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-minixxx
2025-02-25 14:59:05,615 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:59:05,616 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:59:05,616 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:59:06,622 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"openai/o3-minixxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:59:06,624 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-02-25 14:59:06,624 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-02-25 14:59:06,625 - src.engine.state - INFO - 玩家 ai_1 跟注 0 筹码，已标记为已行动
2025-02-25 14:59:06,626 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-02-25 14:59:06,627 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-02-25 14:59:06,628 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-02-25 14:59:06,629 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-02-25 14:59:06,630 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:06,631 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-02-25 14:59:06,631 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-02-25 14:59:06,632 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-02-25 14:59:06,633 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:06,634 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:06,634 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:06,635 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:06,635 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:06,636 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:06,636 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:59:06,637 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 600, 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:59:06,638 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:06,639 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:06,641 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:06,642 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:06,643 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:06,644 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:08,209 - server - INFO - 当前AI玩家: ai_2
2025-02-25 14:59:08,210 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-02-25 14:59:08,211 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-02-25 14:59:08,211 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:59:08,212 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:59:08,212 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3xxxx
2025-02-25 14:59:08,301 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ebb4d394-440a-95f5-adfa-d85b06ee037b'}
2025-02-25 14:59:08,302 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:59:08,303 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ebb4d394-440a-95f5-adfa-d85b06ee037b'}
2025-02-25 14:59:09,308 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `deepseek-v3xxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'ebb4d394-440a-95f5-adfa-d85b06ee037b'}
2025-02-25 14:59:09,313 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-02-25 14:59:09,317 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-02-25 14:59:09,321 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-02-25 14:59:09,324 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-02-25 14:59:09,325 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-02-25 14:59:09,326 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-02-25 14:59:09,327 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-02-25 14:59:09,327 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:09,328 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-02-25 14:59:09,329 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-02-25 14:59:09,329 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-02-25 14:59:09,330 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:09,330 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:09,331 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:09,331 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:09,332 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:09,332 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:09,332 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:59:09,333 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 600, 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:59:09,334 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:09,334 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:09,335 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:09,335 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:09,335 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:09,336 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:13,219 - server - INFO - 当前AI玩家: ai_3
2025-02-25 14:59:13,220 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 14:59:13,220 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 14:59:13,221 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:59:13,222 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:59:13,222 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 14:59:15,759 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:59:15,759 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:59:15,759 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:59:16,770 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 14:59:16,771 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 14:59:16,771 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 14:59:16,772 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-02-25 14:59:16,773 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 14:59:16,774 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 14:59:16,776 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 14:59:16,777 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 14:59:16,778 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:16,778 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 14:59:16,780 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 14:59:16,781 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 14:59:16,781 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:16,782 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:16,782 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:16,783 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:16,784 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:16,784 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:16,786 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:59:16,787 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 600, 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:59:16,788 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:16,789 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:16,791 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:16,792 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:16,793 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:16,794 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:18,225 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:59:18,226 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:59:18,227 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:59:18,228 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:59:18,228 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:59:18,229 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:59:18,294 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'd0311c35-1406-977a-a913-7f8f6ba803f0'}
2025-02-25 14:59:18,295 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:59:18,295 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'd0311c35-1406-977a-a913-7f8f6ba803f0'}
2025-02-25 14:59:19,301 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'd0311c35-1406-977a-a913-7f8f6ba803f0'}
2025-02-25 14:59:19,301 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 14:59:19,302 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 14:59:19,303 - src.engine.state - INFO - 玩家 ai_4 跟注 0 筹码，已标记为已行动
2025-02-25 14:59:19,303 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 14:59:19,304 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 14:59:19,304 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:59:19,305 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:59:19,305 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:19,306 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:59:19,306 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:59:19,307 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:59:19,308 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:19,308 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:19,310 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:19,310 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:19,311 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:19,311 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:19,312 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:59:19,313 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 600, 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 14:59:19,314 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:19,315 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:19,316 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:19,317 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:19,317 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:19,318 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:21,749 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-02-25 14:59:21,750 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-02-25T14:59:21.750835', 'table_talk': None}
2025-02-25 14:59:21,751 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-02-25 14:59:21,751 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-02-25 14:59:21,752 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-02-25 14:59:21,752 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-02-25 14:59:21,753 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-02-25 14:59:21,753 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:21,754 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-02-25 14:59:21,754 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-02-25 14:59:21,755 - src.engine.game - INFO - 更新当前玩家为: None
2025-02-25 14:59:21,755 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:21,757 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:21,758 - src.engine.game - INFO - 当前最大下注额: 0
2025-02-25 14:59:21,758 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:59:21,758 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:59:21,759 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:59:21,759 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:59:21,760 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=0, is_all_in=False
2025-02-25 14:59:21,760 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-02-25 14:59:21,760 - src.engine.game - INFO - 回合是否完成: True
2025-02-25 14:59:21,761 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-02-25 14:59:21,761 - src.engine.game - INFO - 活跃玩家数量: 5, 当前游戏阶段: GameStage.RIVER
2025-02-25 14:59:21,762 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-02-25 14:59:21,762 - src.engine.game - INFO - 从阶段 GameStage.RIVER 进入下一阶段
2025-02-25 14:59:21,763 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:21,763 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-02-25 14:59:21,763 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-02-25 14:59:21,764 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-02-25 14:59:21,764 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-02-25 14:59:21,765 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-02-25 14:59:21,765 - src.engine.game - INFO - 河牌阶段结束，进入摊牌阶段
2025-02-25 14:59:21,765 - src.engine.game - INFO - 游戏结束，执行结算
2025-02-25 14:59:21,766 - src.engine.game - INFO - 结算时活跃玩家数量: 5
2025-02-25 14:59:21,766 - src.engine.game - INFO - 需要比较牌面大小进行结算
2025-02-25 14:59:21,767 - src.engine.game - INFO - 玩家 player_0 赢得底池 600
2025-02-25 14:59:21,768 - src.engine.game - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 600, 'winning_hand': 'TWO_PAIR', 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♣', 'Q♦'), 'hand_rank': 'TWO_PAIR', 'is_winner': True}, {'player_id': 'ai_1', 'hole_cards': ('7♠', 'K♥'), 'hand_rank': 'TWO_PAIR', 'is_winner': False}, {'player_id': 'ai_2', 'hole_cards': ('2♦', '7♦'), 'hand_rank': 'TWO_PAIR', 'is_winner': False}, {'player_id': 'ai_3', 'hole_cards': ('10♠', '3♣'), 'hand_rank': 'PAIR', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('4♠', '2♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}
2025-02-25 14:59:21,768 - src.engine.state - INFO - 已停止所有玩家的行动
2025-02-25 14:59:21,769 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 600, 'winning_hand': 'TWO_PAIR', 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♣', 'Q♦'), 'hand_rank': 'TWO_PAIR', 'is_winner': True}, {'player_id': 'ai_1', 'hole_cards': ('7♠', 'K♥'), 'hand_rank': 'TWO_PAIR', 'is_winner': False}, {'player_id': 'ai_2', 'hole_cards': ('2♦', '7♦'), 'hand_rank': 'TWO_PAIR', 'is_winner': False}, {'player_id': 'ai_3', 'hole_cards': ('10♠', '3♣'), 'hand_rank': 'PAIR', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('4♠', '2♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}, 'players': [{'id': 'player_0', 'chips': 1480, 'current_bet': 0, 'is_active': False, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': ('7♠', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': ('2♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': ('10♠', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': ('4♠', '2♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 14:59:21,770 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:21,771 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-02-25 14:59:21,771 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-02-25 14:59:21,772 - server - INFO - 回合结束，进入下一阶段
2025-02-25 14:59:21,772 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-02-25 14:59:21,773 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-02-25 14:59:21,773 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 600, 'winning_hand': 'TWO_PAIR', 'community_cards': ['A♠', '7♥', '6♣', '6♦', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♣', 'Q♦'), 'hand_rank': 'TWO_PAIR', 'is_winner': True}, {'player_id': 'ai_1', 'hole_cards': ('7♠', 'K♥'), 'hand_rank': 'TWO_PAIR', 'is_winner': False}, {'player_id': 'ai_2', 'hole_cards': ('2♦', '7♦'), 'hand_rank': 'TWO_PAIR', 'is_winner': False}, {'player_id': 'ai_3', 'hole_cards': ('10♠', '3♣'), 'hand_rank': 'PAIR', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('4♠', '2♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}
2025-02-25 14:59:21,775 - server - INFO - 游戏进入新阶段: FINISHED
2025-02-25 14:59:25,991 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 14:59:25,992 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-02-25 14:59:25,993 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-02-25 14:59:25,994 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:25,995 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 14:59:25,995 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♣', '10♥')
2025-02-25 14:59:25,996 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♦', '2♥')
2025-02-25 14:59:25,997 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♦', '7♣')
2025-02-25 14:59:25,997 - src.engine.game - INFO - 玩家 ai_3 手牌: ('7♥', 'Q♦')
2025-02-25 14:59:25,998 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♠', 'K♣')
2025-02-25 14:59:25,998 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-02-25 14:59:25,999 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-02-25 14:59:25,999 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-02-25 14:59:26,000 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-02-25 14:59:26,000 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-02-25 14:59:26,001 - src.engine.game - INFO - 当前玩家: ai_4
2025-02-25 14:59:26,001 - src.engine.game - INFO - 游戏 2417ec71-e6ef-438b-9e72-856b03286430 开始，进入翻牌前阶段
2025-02-25 14:59:26,002 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-02-25 14:59:28,232 - server - INFO - 当前AI玩家: ai_4
2025-02-25 14:59:28,233 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 14:59:28,234 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 14:59:28,235 - src.agents.llm - INFO - 
==================================================
2025-02-25 14:59:28,235 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 14:59:28,235 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 14:59:28,326 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '86af4f18-c21d-929b-b4c3-5e707fa95675'}
2025-02-25 14:59:28,327 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 14:59:28,328 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '86af4f18-c21d-929b-b4c3-5e707fa95675'}
2025-02-25 14:59:29,334 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '86af4f18-c21d-929b-b4c3-5e707fa95675'}
2025-02-25 14:59:29,334 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 14:59:29,334 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 14:59:29,335 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-02-25 14:59:29,335 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 14:59:29,335 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 14:59:29,335 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 14:59:29,335 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 14:59:29,336 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:59:29,337 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 14:59:29,337 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 14:59:29,337 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 14:59:29,338 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:29,339 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:29,339 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:59:29,340 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:29,341 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:29,341 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 14:59:29,342 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 14:59:29,343 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1480, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '10♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('6♦', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 870, 'current_bet': 10, 'is_active': True, 'cards': ('9♦', '7♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 860, 'current_bet': 20, 'is_active': True, 'cards': ('7♥', 'Q♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 860, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', 'K♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 14:59:29,345 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 14:59:29,346 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 14:59:29,347 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 14:59:29,348 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 14:59:29,348 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 14:59:29,349 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:08:47,581 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-02-25 15:08:47,585 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-02-25 15:08:54,484 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-02-25 15:08:54,488 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-02-25 15:08:54,722 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-02-25 15:08:55,006 - server - INFO - 正在创建游戏: 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554, 玩家数量: 5
2025-02-25 15:08:55,007 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 15:08:55,007 - src.engine.state - INFO - 游戏状态已初始化
2025-02-25 15:08:55,008 - src.engine.game - INFO - 游戏 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-02-25 15:08:55,008 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-02-25 15:08:55,009 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-02-25 15:08:55,009 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:08:55,012 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-minixxx，性格: 擅长使用策略和心理战术
2025-02-25 15:08:55,012 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-02-25 15:08:55,013 - src.engine.game - INFO - Added player ai_1 to game 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554
2025-02-25 15:08:55,013 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-minixxx
2025-02-25 15:08:55,014 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:08:55,016 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3xxxx，性格: 擅长使用策略和心理战术
2025-02-25 15:08:55,016 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-02-25 15:08:55,017 - src.engine.game - INFO - Added player ai_2 to game 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554
2025-02-25 15:08:55,017 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3xxxx
2025-02-25 15:08:55,018 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:08:55,019 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnetxxxx，性格: 擅长使用策略和心理战术
2025-02-25 15:08:55,020 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-02-25 15:08:55,020 - src.engine.game - INFO - Added player ai_3 to game 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554
2025-02-25 15:08:55,020 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 15:08:55,020 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:08:55,022 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-maxxxxx，性格: 擅长使用策略和心理战术
2025-02-25 15:08:55,023 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-02-25 15:08:55,023 - src.engine.game - INFO - Added player ai_4 to game 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554
2025-02-25 15:08:55,023 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-maxxxxx
2025-02-25 15:08:55,023 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:08:55,023 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 15:08:55,023 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♥', '7♣')
2025-02-25 15:08:55,024 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♠', '4♣')
2025-02-25 15:08:55,024 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♠', '4♠')
2025-02-25 15:08:55,024 - src.engine.game - INFO - 玩家 ai_3 手牌: ('8♦', 'Q♥')
2025-02-25 15:08:55,025 - src.engine.game - INFO - 玩家 ai_4 手牌: ('A♦', '6♦')
2025-02-25 15:08:55,025 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-02-25 15:08:55,025 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-02-25 15:08:55,025 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-02-25 15:08:55,026 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-02-25 15:08:55,026 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-02-25 15:08:55,026 - src.engine.game - INFO - 当前玩家: ai_3
2025-02-25 15:08:55,027 - src.engine.game - INFO - 游戏 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554 开始，进入翻牌前阶段
2025-02-25 15:08:55,027 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-02-25 15:08:55,027 - server - INFO - 游戏 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554 已开始
2025-02-25 15:08:55,028 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-02-25 15:08:55,322 - server - INFO - WebSocket连接已建立: 0b8c4a56-a9fa-4f96-a3e7-f2ee90ff6554
2025-02-25 15:08:55,322 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '4♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'Q♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 15:08:55,324 - server - INFO - 当前AI玩家: ai_3
2025-02-25 15:08:55,324 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 15:08:55,324 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 15:08:55,325 - src.agents.llm - INFO - 
==================================================
2025-02-25 15:08:55,325 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 15:08:55,325 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 15:08:57,587 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 15:08:57,588 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 15:08:57,588 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 15:08:58,592 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 15:08:58,595 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 15:08:58,596 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 15:08:58,597 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-02-25 15:08:58,598 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 15:08:58,598 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 15:08:58,599 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 15:08:58,600 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 15:08:58,600 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:08:58,601 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 15:08:58,602 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 15:08:58,603 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 15:08:58,604 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:08:58,605 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:08:58,605 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:08:58,606 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:08:58,606 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:08:58,607 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:08:58,607 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 15:08:58,607 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '4♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', 'Q♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 15:08:58,608 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:08:58,609 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:08:58,609 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:08:58,609 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:08:58,610 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:08:58,610 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:09:03,637 - server - INFO - 当前AI玩家: ai_4
2025-02-25 15:09:03,638 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 15:09:03,638 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 15:09:03,638 - src.agents.llm - INFO - 
==================================================
2025-02-25 15:09:03,639 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 15:09:03,639 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 15:09:04,473 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'd74cdd8f-8a0b-91f5-bcb6-5fe7dd431f70'}
2025-02-25 15:09:04,473 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 15:09:04,473 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'd74cdd8f-8a0b-91f5-bcb6-5fe7dd431f70'}
2025-02-25 15:09:05,480 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': 'd74cdd8f-8a0b-91f5-bcb6-5fe7dd431f70'}
2025-02-25 15:09:05,481 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 15:09:05,481 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 15:09:05,482 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-02-25 15:09:05,482 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 15:09:05,483 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 15:09:05,483 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 15:09:05,484 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 15:09:05,484 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:09:05,485 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 15:09:05,485 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 15:09:05,486 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 15:09:05,486 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:09:05,487 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:09:05,488 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:09:05,488 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:09:05,489 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:09:05,489 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:09:05,490 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 15:09:05,491 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '4♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', 'Q♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♦', '6♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 15:09:05,492 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:09:05,493 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:09:05,494 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:09:05,494 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:09:05,495 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:09:05,495 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:11:44,775 - server - INFO - 正在创建游戏: f128072b-f547-4443-ad58-df6ff0197c74, 玩家数量: 5
2025-02-25 15:11:44,775 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-02-25 15:11:44,776 - src.engine.state - INFO - 游戏状态已初始化
2025-02-25 15:11:44,776 - src.engine.game - INFO - 游戏 f128072b-f547-4443-ad58-df6ff0197c74 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-02-25 15:11:44,776 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-02-25 15:11:44,777 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-02-25 15:11:44,777 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:11:44,778 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-minixxx，性格: 擅长使用策略和心理战术
2025-02-25 15:11:44,779 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-02-25 15:11:44,779 - src.engine.game - INFO - Added player ai_1 to game f128072b-f547-4443-ad58-df6ff0197c74
2025-02-25 15:11:44,779 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-minixxx
2025-02-25 15:11:44,780 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:11:44,781 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3xxxx，性格: 擅长使用策略和心理战术
2025-02-25 15:11:44,781 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-02-25 15:11:44,781 - src.engine.game - INFO - Added player ai_2 to game f128072b-f547-4443-ad58-df6ff0197c74
2025-02-25 15:11:44,781 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3xxxx
2025-02-25 15:11:44,782 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:11:44,783 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnetxxxx，性格: 擅长使用策略和心理战术
2025-02-25 15:11:44,783 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-02-25 15:11:44,784 - src.engine.game - INFO - Added player ai_3 to game f128072b-f547-4443-ad58-df6ff0197c74
2025-02-25 15:11:44,784 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 15:11:44,784 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-minixxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3xxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-maxxxxx', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-02-25 15:11:44,786 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-maxxxxx，性格: 擅长使用策略和心理战术
2025-02-25 15:11:44,786 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-02-25 15:11:44,786 - src.engine.game - INFO - Added player ai_4 to game f128072b-f547-4443-ad58-df6ff0197c74
2025-02-25 15:11:44,786 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-maxxxxx
2025-02-25 15:11:44,786 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:11:44,786 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-02-25 15:11:44,786 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♠', '8♠')
2025-02-25 15:11:44,787 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♥', '4♥')
2025-02-25 15:11:44,787 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', 'A♠')
2025-02-25 15:11:44,787 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♠', '2♥')
2025-02-25 15:11:44,787 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♣', 'Q♦')
2025-02-25 15:11:44,788 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-02-25 15:11:44,788 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-02-25 15:11:44,788 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-02-25 15:11:44,788 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-02-25 15:11:44,789 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-02-25 15:11:44,789 - src.engine.game - INFO - 当前玩家: ai_3
2025-02-25 15:11:44,789 - src.engine.game - INFO - 游戏 f128072b-f547-4443-ad58-df6ff0197c74 开始，进入翻牌前阶段
2025-02-25 15:11:44,789 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-02-25 15:11:44,789 - server - INFO - 游戏 f128072b-f547-4443-ad58-df6ff0197c74 已开始
2025-02-25 15:11:44,790 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-02-25 15:11:45,297 - server - INFO - WebSocket连接已建立: f128072b-f547-4443-ad58-df6ff0197c74
2025-02-25 15:11:45,297 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('10♥', '4♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'A♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', '2♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 15:11:45,298 - server - INFO - 当前AI玩家: ai_3
2025-02-25 15:11:45,299 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-02-25 15:11:45,299 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-02-25 15:11:45,299 - src.agents.llm - INFO - 
==================================================
2025-02-25 15:11:45,299 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 15:11:45,300 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnetxxxx
2025-02-25 15:11:47,666 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 15:11:47,667 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 15:11:47,667 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 15:11:48,680 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.BadRequestError: OpenrouterException - {"error":{"message":"anthropic/claude-3.7-sonnetxxxx is not a valid model ID","code":400},"user_id":"user_2tWHwu1NaFKuYJdLtx3JEzN9D0N"}
2025-02-25 15:11:48,681 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-02-25 15:11:48,682 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-02-25 15:11:48,683 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-02-25 15:11:48,683 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-02-25 15:11:48,685 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-02-25 15:11:48,685 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-02-25 15:11:48,686 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-02-25 15:11:48,687 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:11:48,688 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-02-25 15:11:48,689 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-02-25 15:11:48,690 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-02-25 15:11:48,691 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:11:48,691 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:11:48,692 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:11:48,692 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:11:48,693 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:11:48,693 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:11:48,694 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 15:11:48,694 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('10♥', '4♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'A♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♠', '2♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': None, 'last_amount': None}]}
2025-02-25 15:11:48,695 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:11:48,696 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:11:48,697 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:11:48,698 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:11:48,699 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:11:48,699 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:11:53,704 - server - INFO - 当前AI玩家: ai_4
2025-02-25 15:11:53,704 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-02-25 15:11:53,705 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-02-25 15:11:53,705 - src.agents.llm - INFO - 
==================================================
2025-02-25 15:11:53,706 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-02-25 15:11:53,706 - src.agents.llm - INFO - 使用模型: openai/qwen-maxxxxx
2025-02-25 15:11:53,787 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '2310afde-18aa-9db4-b374-2c0c22b91e5c'}
2025-02-25 15:11:53,788 - src.agents.llm - ERROR - 详细错误: 
2025-02-25 15:11:53,788 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '2310afde-18aa-9db4-b374-2c0c22b91e5c'}
2025-02-25 15:11:54,798 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.NotFoundError: OpenAIException - Error code: 404 - {'error': {'message': 'The model `qwen-maxxxxx` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}, 'request_id': '2310afde-18aa-9db4-b374-2c0c22b91e5c'}
2025-02-25 15:11:54,799 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-02-25 15:11:54,800 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-02-25 15:11:54,800 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-02-25 15:11:54,801 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-02-25 15:11:54,802 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-02-25 15:11:54,802 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-02-25 15:11:54,803 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-02-25 15:11:54,803 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:11:54,804 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-02-25 15:11:54,805 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-02-25 15:11:54,806 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-02-25 15:11:54,807 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:11:54,808 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:11:54,809 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:11:54,809 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:11:54,810 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:11:54,810 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-02-25 15:11:54,811 - src.engine.game - INFO - 回合是否完成: False
2025-02-25 15:11:54,811 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('10♥', '4♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-minixxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'A♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3xxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♠', '2♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnetxxxx', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', 'Q♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-maxxxxx', 'last_action': 'CALL', 'last_amount': 0}]}
2025-02-25 15:11:54,813 - src.engine.game - INFO - 检查回合是否完成
2025-02-25 15:11:54,813 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-02-25 15:11:54,814 - src.engine.game - INFO - 当前最大下注额: 20
2025-02-25 15:11:54,814 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-02-25 15:11:54,815 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-02-25 15:11:54,815 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:25:32,919 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:25:32,923 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:25:39,007 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:25:39,011 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:25:39,236 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:25:39,842 - server - INFO - 正在创建游戏: 28c9e950-9361-4d9a-9228-aa76d6441089, 玩家数量: 5
2025-03-10 21:25:39,842 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:25:39,843 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:25:39,843 - src.engine.game - INFO - 游戏 28c9e950-9361-4d9a-9228-aa76d6441089 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:25:39,843 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:25:39,844 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:25:39,844 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:25:39,845 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:25:39,847 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:25:39,847 - src.engine.game - INFO - Added player ai_1 to game 28c9e950-9361-4d9a-9228-aa76d6441089
2025-03-10 21:25:39,847 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:25:39,847 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:25:39,848 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:25:39,849 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:25:39,849 - src.engine.game - INFO - Added player ai_2 to game 28c9e950-9361-4d9a-9228-aa76d6441089
2025-03-10 21:25:39,849 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:25:39,849 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:25:39,851 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:25:39,851 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:25:39,852 - src.engine.game - INFO - Added player ai_3 to game 28c9e950-9361-4d9a-9228-aa76d6441089
2025-03-10 21:25:39,852 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:25:39,852 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:25:39,853 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:25:39,853 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:25:39,854 - src.engine.game - INFO - Added player ai_4 to game 28c9e950-9361-4d9a-9228-aa76d6441089
2025-03-10 21:25:39,854 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:25:39,854 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:25:39,854 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:25:39,854 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♠', '3♥')
2025-03-10 21:25:39,855 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♠', '5♦')
2025-03-10 21:25:39,855 - src.engine.game - INFO - 玩家 ai_2 手牌: ('J♥', '7♣')
2025-03-10 21:25:39,855 - src.engine.game - INFO - 玩家 ai_3 手牌: ('Q♦', '7♠')
2025-03-10 21:25:39,856 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♣', '9♣')
2025-03-10 21:25:39,856 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:25:39,856 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:25:39,856 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:25:39,856 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:25:39,857 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:25:39,857 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:25:39,857 - src.engine.game - INFO - 游戏 28c9e950-9361-4d9a-9228-aa76d6441089 开始，进入翻牌前阶段
2025-03-10 21:25:39,857 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:25:39,858 - server - INFO - 游戏 28c9e950-9361-4d9a-9228-aa76d6441089 已开始
2025-03-10 21:25:39,858 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:25:40,421 - server - INFO - WebSocket连接已建立: 28c9e950-9361-4d9a-9228-aa76d6441089
2025-03-10 21:25:40,422 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '3♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('A♠', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♥', '7♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '7♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', '9♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:25:40,425 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:25:40,425 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:25:40,426 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:25:40,426 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:25:40,427 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:25:40,427 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:25:49,044 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":20,"confidence":0.6},"reasoning":{"hand_strength":"Q♦7♠是一手中等偏弱的起手牌。Q是一张不错的高牌，但7♠没有太多价值，且两张牌不是同花也不连续。","position_analysis":"我在位置3，是中间位置，不是特别有利的位置。在这个位置上应该相对保守一些。","pot_odds":"当前底池30，需要下注20来跟注，底池赔率为1.5:1，考虑到我的手牌强度，勉强值得跟注看翻牌。","opponent_reads":["ai_2已经加注至20，显示出一定的强度，但这可能只是标准的抢盲行为","ai_1只是跟注小盲，没有展示出特别的强度","player_0和ai_4还没有行动，需要考虑他们可能的反应"]},"table_talk":{"message":"嗯，看看翻牌会怎样。","tone":"平静"}}
2025-03-10 21:25:49,044 - src.agents.llm - INFO - ==================================================

2025-03-10 21:25:49,045 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，看看翻牌会怎样。', 'tone': '平静'}
2025-03-10 21:25:49,045 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 21:25:49,045 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 21:25:49,046 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-03-10 21:25:49,046 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 21:25:49,046 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 21:25:49,046 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:25:49,046 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:25:49,046 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:25:49,047 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:25:49,047 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:25:49,048 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:25:49,048 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:25:49,048 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:25:49,048 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:25:49,048 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:25:49,048 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:25:49,048 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:25:49,048 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:25:49,048 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '3♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('A♠', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♥', '7♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '7♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', '9♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，看看翻牌会怎样。', 'tone': '平静'}}
2025-03-10 21:25:49,049 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:25:49,049 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:25:49,049 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:25:49,050 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:25:49,050 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:25:49,050 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:25:54,055 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:25:54,055 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:25:54,057 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:25:54,057 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:25:54,058 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:25:54,058 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:26:08,504 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"20","confidence":0.6},"reasoning":{"hand_strength":"手牌为4♣, 9♣，在没有公共牌的情况下属于较弱的手牌。但在前期阶段，考虑到位置优势和对手可能的试探性行为，直接放弃似乎过于保守。","position_analysis":"处于中后位，这给了观察前面玩家行动的机会，并且可以利用位置优势做出更合理的判断。","pot_odds":"当前底池赔率不是特别有利，但跟注成本相对较低，风险可控。","opponent_reads":["ai_3选择跟注，表明他/她可能持有不错的起始手牌或正在尝试控制底池大小。"]},"table_talk":{"message":"看来大家都挺谨慎的嘛，那我就跟着看看吧。","tone":"轻松友好"}}
2025-03-10 21:26:08,505 - src.agents.llm - INFO - ==================================================

2025-03-10 21:26:08,505 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来大家都挺谨慎的嘛，那我就跟着看看吧。', 'tone': '轻松友好'}
2025-03-10 21:26:08,506 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 21:26:08,506 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 21:26:08,506 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-03-10 21:26:08,506 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 21:26:08,506 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 21:26:08,507 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:26:08,507 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:26:08,507 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:26:08,507 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:26:08,507 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:26:08,507 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:26:08,508 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:26:08,508 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:26:08,508 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:26:08,508 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:26:08,508 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:26:08,508 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:26:08,508 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:26:08,509 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '3♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('A♠', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♥', '7♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '7♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', '9♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '看来大家都挺谨慎的嘛，那我就跟着看看吧。', 'tone': '轻松友好'}}
2025-03-10 21:26:08,510 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:26:08,510 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:26:08,510 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:26:08,510 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:26:08,511 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:26:08,511 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:27:53,174 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:27:53,376 - server - INFO - 正在创建游戏: db8d57d1-ae47-4c5a-87b2-e533d7690c33, 玩家数量: 5
2025-03-10 21:27:53,377 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:27:53,377 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:27:53,377 - src.engine.game - INFO - 游戏 db8d57d1-ae47-4c5a-87b2-e533d7690c33 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:27:53,377 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:27:53,378 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:27:53,378 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:27:53,380 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:27:53,380 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:27:53,380 - src.engine.game - INFO - Added player ai_1 to game db8d57d1-ae47-4c5a-87b2-e533d7690c33
2025-03-10 21:27:53,381 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:27:53,381 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:27:53,382 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:27:53,382 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:27:53,382 - src.engine.game - INFO - Added player ai_2 to game db8d57d1-ae47-4c5a-87b2-e533d7690c33
2025-03-10 21:27:53,384 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:27:53,384 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:27:53,386 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:27:53,387 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:27:53,387 - src.engine.game - INFO - Added player ai_3 to game db8d57d1-ae47-4c5a-87b2-e533d7690c33
2025-03-10 21:27:53,387 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:27:53,388 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:27:53,390 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:27:53,391 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:27:53,391 - src.engine.game - INFO - Added player ai_4 to game db8d57d1-ae47-4c5a-87b2-e533d7690c33
2025-03-10 21:27:53,391 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:27:53,391 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:27:53,391 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:27:53,391 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♠', '10♥')
2025-03-10 21:27:53,392 - src.engine.game - INFO - 玩家 ai_1 手牌: ('J♥', '6♠')
2025-03-10 21:27:53,392 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♥', '8♥')
2025-03-10 21:27:53,392 - src.engine.game - INFO - 玩家 ai_3 手牌: ('2♣', '3♥')
2025-03-10 21:27:53,393 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♠', 'K♣')
2025-03-10 21:27:53,393 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:27:53,393 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:27:53,393 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:27:53,394 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:27:53,394 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:27:53,394 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:27:53,394 - src.engine.game - INFO - 游戏 db8d57d1-ae47-4c5a-87b2-e533d7690c33 开始，进入翻牌前阶段
2025-03-10 21:27:53,394 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:27:53,395 - server - INFO - 游戏 db8d57d1-ae47-4c5a-87b2-e533d7690c33 已开始
2025-03-10 21:27:53,395 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:27:53,698 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:27:53,791 - server - INFO - WebSocket连接已建立: db8d57d1-ae47-4c5a-87b2-e533d7690c33
2025-03-10 21:27:53,791 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', '10♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('J♥', '6♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♥', '8♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♣', '3♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:27:53,794 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:27:53,795 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:27:53,795 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:27:53,795 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:27:53,795 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:27:53,796 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:28:01,431 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"2-3不同花是德州扑克中最弱的起手牌之一，几乎没有成牌潜力","position_analysis":"位置3是中前位，位置较差，需要更强的起手牌才能参与","pot_odds":"底池有30，需要下注20才能继续，赔率不佳","opponent_reads":["ai_2已经加注，说明可能有强牌","前位玩家ai_1已经跟注，表明至少有中等强度的牌"]},"table_talk":{"message":"这手牌连鱼都不如，我还是留着筹码等更好的机会吧","tone":"轻松幽默"}}
2025-03-10 21:28:01,431 - src.agents.llm - INFO - ==================================================

2025-03-10 21:28:01,432 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌连鱼都不如，我还是留着筹码等更好的机会吧', 'tone': '轻松幽默'}
2025-03-10 21:28:01,432 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:28:01,432 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:28:01,432 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:28:01,433 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:28:01,433 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:28:01,433 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:28:01,433 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:28:01,433 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:28:01,433 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:28:01,434 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:28:01,434 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:28:01,434 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:28:01,434 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:28:01,434 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:28:01,434 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:28:01,435 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:28:01,435 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:28:01,435 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:28:01,435 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', '10♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('J♥', '6♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♥', '8♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌连鱼都不如，我还是留着筹码等更好的机会吧', 'tone': '轻松幽默'}}
2025-03-10 21:28:01,435 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:28:01,436 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:28:01,436 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:28:01,436 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:28:01,436 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:28:01,437 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:28:01,437 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:06,454 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:06,455 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:28:06,456 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:28:06,456 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:28:06,457 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:28:06,457 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:28:06,457 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:28:17,553 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":80,"confidence":0.75},"reasoning":{"hand_strength":"持有K高牌，虽然不是特别强的手牌，但在前翻牌圈有一定的潜力。","position_analysis":"处于中间位置，可以采取稍微激进的策略来测试对手的反应。","pot_odds":"目前底池较小，通过加注可以控制底池大小，并可能迫使其他玩家做出更难的决策。","opponent_reads":["ai_1和ai_2都只进行了小额下注或跟注，显示出他们手牌强度可能不高。"]},"table_talk":{"message":"看来大家都挺谨慎的嘛，那我就先试试水吧。","tone":"轻松自信"}}
2025-03-10 21:28:17,555 - src.agents.llm - INFO - ==================================================

2025-03-10 21:28:17,555 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '看来大家都挺谨慎的嘛，那我就先试试水吧。', 'tone': '轻松自信'}
2025-03-10 21:28:17,555 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 80
2025-03-10 21:28:17,556 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:28:17,556 - src.engine.state - INFO - 玩家 ai_4 加注到 80 筹码，已标记为已行动
2025-03-10 21:28:17,556 - src.engine.game - INFO - 玩家 ai_4 加注到 80
2025-03-10 21:28:17,557 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:28:17,557 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:28:17,557 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:28:17,557 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 21:28:17,558 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:28:17,558 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:28:17,558 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:28:17,558 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:28:17,558 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:28:17,559 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 21:28:17,559 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:28:17,559 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:28:17,559 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:28:17,559 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:28:17,560 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', '10♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('J♥', '6♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♥', '8♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 920, 'current_bet': 80, 'is_active': True, 'cards': ('4♠', 'K♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 80}], 'table_talk': {'message': '看来大家都挺谨慎的嘛，那我就先试试水吧。', 'tone': '轻松自信'}}
2025-03-10 21:28:17,560 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:28:17,561 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:28:17,561 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 21:28:17,561 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:28:17,561 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:28:17,561 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:28:17,562 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:22,586 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:27,598 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:32,595 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:37,585 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:42,605 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:47,612 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:52,607 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:28:57,633 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:02,651 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:07,654 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:12,653 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:15,362 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:29:15,563 - server - INFO - 正在创建游戏: cd3494c1-63a6-4fe8-b9b4-0c34177e02e2, 玩家数量: 5
2025-03-10 21:29:15,563 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:29:15,563 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:29:15,564 - src.engine.game - INFO - 游戏 cd3494c1-63a6-4fe8-b9b4-0c34177e02e2 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:29:15,565 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:29:15,565 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:29:15,565 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:29:15,567 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:29:15,567 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:29:15,567 - src.engine.game - INFO - Added player ai_1 to game cd3494c1-63a6-4fe8-b9b4-0c34177e02e2
2025-03-10 21:29:15,567 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:29:15,568 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:29:15,569 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:29:15,569 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:29:15,569 - src.engine.game - INFO - Added player ai_2 to game cd3494c1-63a6-4fe8-b9b4-0c34177e02e2
2025-03-10 21:29:15,570 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:29:15,570 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:29:15,571 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:29:15,571 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:29:15,571 - src.engine.game - INFO - Added player ai_3 to game cd3494c1-63a6-4fe8-b9b4-0c34177e02e2
2025-03-10 21:29:15,571 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:29:15,571 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:29:15,572 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:29:15,572 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:29:15,572 - src.engine.game - INFO - Added player ai_4 to game cd3494c1-63a6-4fe8-b9b4-0c34177e02e2
2025-03-10 21:29:15,572 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:29:15,574 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:29:15,574 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:29:15,574 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♠', '6♠')
2025-03-10 21:29:15,574 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♦', '2♥')
2025-03-10 21:29:15,574 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', 'J♠')
2025-03-10 21:29:15,574 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♥', '9♦')
2025-03-10 21:29:15,575 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♥', '7♠')
2025-03-10 21:29:15,575 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:29:15,575 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:29:15,575 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:29:15,575 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:29:15,576 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:29:15,576 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:29:15,576 - src.engine.game - INFO - 游戏 cd3494c1-63a6-4fe8-b9b4-0c34177e02e2 开始，进入翻牌前阶段
2025-03-10 21:29:15,576 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:29:15,577 - server - INFO - 游戏 cd3494c1-63a6-4fe8-b9b4-0c34177e02e2 已开始
2025-03-10 21:29:15,577 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:29:15,965 - server - INFO - WebSocket连接已建立: cd3494c1-63a6-4fe8-b9b4-0c34177e02e2
2025-03-10 21:29:15,965 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('10♦', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '9♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', '7♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:29:15,967 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:29:15,967 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:29:15,967 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:29:15,968 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:29:15,968 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:29:15,968 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:29:24,281 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"6♥, 9♦是一手较弱的起手牌，不同花色且没有连牌潜力，在德州扑克中排名靠后","position_analysis":"我在比较早的位置(位置3)，后面还有一名玩家要行动，位置不佳","pot_odds":"当前底池30，需要下注20才能继续，底池赔率为1.5:1，不足以支持用这样的弱牌继续","opponent_reads":["ai_2已经加注到20，显示出一定的强度","前面的ai_1选择跟注而不是弃牌，可能有一定的牌力"]},"table_talk":{"message":"这手牌不太适合我的风格，留着筹码等更好的机会吧。","tone":"冷静"}}
2025-03-10 21:29:24,282 - src.agents.llm - INFO - ==================================================

2025-03-10 21:29:24,282 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太适合我的风格，留着筹码等更好的机会吧。', 'tone': '冷静'}
2025-03-10 21:29:24,283 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:29:24,283 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:29:24,283 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:29:24,283 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:29:24,283 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:29:24,283 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:29:24,284 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:29:24,284 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:29:24,284 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:29:24,285 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:29:24,285 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:29:24,285 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:29:24,285 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:29:24,285 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:29:24,286 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:29:24,286 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:29:24,286 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:29:24,286 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:29:24,287 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('10♦', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', '7♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太适合我的风格，留着筹码等更好的机会吧。', 'tone': '冷静'}}
2025-03-10 21:29:24,287 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:29:24,288 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:29:24,288 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:29:24,288 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:29:24,288 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:29:24,289 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:29:24,289 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:24,289 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:29,300 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:29,301 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:29,301 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:29:29,302 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:29:29,302 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:29:29,302 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:29:29,302 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:29:29,303 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:29:47,076 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"我的手牌8♥, 7♠在前翻牌阶段并不强，但考虑到对手可能也持有类似强度的手牌。","position_analysis":"处于中间位置，可以采取一些激进策略来测试对手的反应。","pot_odds":"当前底池为30，通过加注到60，我试图控制底池大小同时观察对手的行为。","opponent_reads":["player_0尚未行动，可能在等待更强的手牌；ai_1和ai_2已经进行了小额下注，显示出他们可能持有一些信心但不强烈。"]},"table_talk":{"message":"看来大家都挺谨慎的嘛，那我就先试试水吧。","tone":"轻松自信"}}
2025-03-10 21:29:47,077 - src.agents.llm - INFO - ==================================================

2025-03-10 21:29:47,077 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺谨慎的嘛，那我就先试试水吧。', 'tone': '轻松自信'}
2025-03-10 21:29:47,078 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 21:29:47,078 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:29:47,078 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 21:29:47,078 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 21:29:47,078 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:29:47,078 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:29:47,079 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:29:47,079 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:29:47,079 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:29:47,079 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:29:47,079 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:29:47,080 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:29:47,080 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:29:47,080 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:29:47,080 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:29:47,081 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:29:47,081 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:29:47,081 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:29:47,081 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('10♦', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♥', '7♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺谨慎的嘛，那我就先试试水吧。', 'tone': '轻松自信'}}
2025-03-10 21:29:47,081 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:29:47,082 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:29:47,082 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:29:47,082 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:29:47,082 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:29:47,082 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:29:47,083 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:47,083 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:52,092 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:52,092 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:57,106 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:29:57,106 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:02,126 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:02,126 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:07,151 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:07,151 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:12,132 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:12,132 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:17,142 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:17,143 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:22,155 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:22,155 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:27,159 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:27,160 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:29,222 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:30:29,419 - server - INFO - 正在创建游戏: f7600151-9bc7-47d3-962d-4548d6cfd36c, 玩家数量: 5
2025-03-10 21:30:29,419 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:30:29,420 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:30:29,420 - src.engine.game - INFO - 游戏 f7600151-9bc7-47d3-962d-4548d6cfd36c 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:30:29,420 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:30:29,420 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:30:29,421 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:30:29,423 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:30:29,423 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:30:29,423 - src.engine.game - INFO - Added player ai_1 to game f7600151-9bc7-47d3-962d-4548d6cfd36c
2025-03-10 21:30:29,423 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:30:29,424 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:30:29,425 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:30:29,425 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:30:29,426 - src.engine.game - INFO - Added player ai_2 to game f7600151-9bc7-47d3-962d-4548d6cfd36c
2025-03-10 21:30:29,426 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:30:29,426 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:30:29,427 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:30:29,427 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:30:29,428 - src.engine.game - INFO - Added player ai_3 to game f7600151-9bc7-47d3-962d-4548d6cfd36c
2025-03-10 21:30:29,428 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:30:29,428 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:30:29,428 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:30:29,428 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:30:29,428 - src.engine.game - INFO - Added player ai_4 to game f7600151-9bc7-47d3-962d-4548d6cfd36c
2025-03-10 21:30:29,428 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:30:29,429 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:30:29,429 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:30:29,429 - src.engine.game - INFO - 玩家 player_0 手牌: ('J♥', '6♦')
2025-03-10 21:30:29,429 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♣', 'A♣')
2025-03-10 21:30:29,430 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♦', '8♠')
2025-03-10 21:30:29,430 - src.engine.game - INFO - 玩家 ai_3 手牌: ('7♦', 'Q♠')
2025-03-10 21:30:29,430 - src.engine.game - INFO - 玩家 ai_4 手牌: ('10♣', '9♥')
2025-03-10 21:30:29,430 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:30:29,430 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:30:29,430 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:30:29,430 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:30:29,430 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:30:29,432 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:30:29,432 - src.engine.game - INFO - 游戏 f7600151-9bc7-47d3-962d-4548d6cfd36c 开始，进入翻牌前阶段
2025-03-10 21:30:29,432 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:30:29,432 - server - INFO - 游戏 f7600151-9bc7-47d3-962d-4548d6cfd36c 已开始
2025-03-10 21:30:29,432 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:30:29,593 - server - INFO - WebSocket连接已建立: f7600151-9bc7-47d3-962d-4548d6cfd36c
2025-03-10 21:30:29,593 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♥', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('7♦', 'Q♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:30:29,595 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:30:29,595 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:30:29,595 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:30:29,596 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:30:29,596 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:30:29,596 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:30:38,436 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"7♦Q♠是一手较弱的起手牌，不同花色且不连续，没有形成任何有价值的组合。在德州扑克起手牌评估中属于下游牌型。","position_analysis":"我处于早期位置(位置3)，这是一个不利的位置，因为在我之后还有一名玩家要行动。在早期位置玩弱牌风险较高。","pot_odds":"当前底池30，需要下注20才能继续，底池赔率为1.5:1，考虑到我的手牌强度，这不是一个有利的赔率。","opponent_reads":["ai_2已经加注到20，这表明他可能有一手不错的牌","前面两位玩家已经投入了筹码，说明牌局竞争可能会激烈"]},"table_talk":{"message":"这手牌不太行，留着火力下一把打。","tone":"轻松"}}
2025-03-10 21:30:38,437 - src.agents.llm - INFO - ==================================================

2025-03-10 21:30:38,437 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太行，留着火力下一把打。', 'tone': '轻松'}
2025-03-10 21:30:38,437 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:30:38,438 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:30:38,438 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:30:38,438 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:30:38,438 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:30:38,438 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:30:38,439 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:30:38,439 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:30:38,439 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:30:38,439 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:30:38,439 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:30:38,439 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:30:38,439 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:30:38,440 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:30:38,440 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:30:38,440 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:30:38,440 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:30:38,440 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:30:38,440 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♥', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太行，留着火力下一把打。', 'tone': '轻松'}}
2025-03-10 21:30:38,441 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:30:38,441 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:30:38,441 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:30:38,442 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:30:38,442 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:30:38,442 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:30:38,442 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:38,443 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:38,443 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:43,461 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:43,461 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:43,464 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:30:43,465 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:30:43,465 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:30:43,466 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:30:43,466 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:30:43,467 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:30:43,467 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:31:07,161 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "CALL",
    "amount": "20",
    "confidence": "0.6"
  },
  "reasoning": {
    "hand_strength": "我的手牌是10♣, 9♥，在没有看到公共牌的情况下属于中等偏弱的手牌。但考虑到对手们可能持有更差的牌，这组连牌有潜力形成顺子。",
    "position_analysis": "处于中间位置，可以观察后续玩家的动作来调整策略，同时也有机会控制底池大小。",
    "pot_odds": "当前跟注的成本为20，相对于现有底池30来说，跟注成本相对较低，且有机会通过后续街面改善手牌。",
    "opponent_reads": ["ai_2已经进行了加注，表明他可能持有一手中等以上的牌力；player_0尚未行动，需警惕其可能采取激进策略。"]
  },
  "table_talk": {
    "message": "我感觉今天运气不错，让我们看看接下来会发生什么吧。",
    "tone": "轻松友好"
  }
}
2025-03-10 21:31:07,162 - src.agents.llm - INFO - ==================================================

2025-03-10 21:31:07,163 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我感觉今天运气不错，让我们看看接下来会发生什么吧。', 'tone': '轻松友好'}
2025-03-10 21:31:07,163 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 21:31:07,163 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 21:31:07,163 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-03-10 21:31:07,164 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 21:31:07,164 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 21:31:07,164 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:31:07,164 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:31:07,164 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:31:07,165 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:31:07,165 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:31:07,165 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:31:07,165 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:07,165 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:07,165 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:31:07,166 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:31:07,166 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:31:07,166 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:31:07,166 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:31:07,167 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♥', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '我感觉今天运气不错，让我们看看接下来会发生什么吧。', 'tone': '轻松友好'}}
2025-03-10 21:31:07,167 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:07,167 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:07,168 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:31:07,168 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:31:07,168 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:31:07,168 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:31:07,169 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:07,169 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:07,169 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:12,163 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:12,163 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:12,164 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:17,176 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:17,177 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:17,178 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:22,192 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:22,192 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:22,193 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:27,195 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:27,195 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:27,195 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:32,210 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:32,210 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:32,211 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:36,114 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 21:31:36,114 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T21:31:36.114761', 'table_talk': None}
2025-03-10 21:31:36,115 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 21:31:36,115 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 21:31:36,115 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 21:31:36,115 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 21:31:36,115 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 21:31:36,116 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 21:31:36,116 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:31:36,116 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 21:31:36,116 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 21:31:36,116 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:31:36,116 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:36,117 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:36,117 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:31:36,117 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:31:36,118 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:31:36,118 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:31:36,118 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:31:36,118 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:31:36,119 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:36,119 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:36,119 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:31:36,119 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:31:36,119 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:31:36,121 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:31:37,227 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:37,227 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:37,228 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:37,228 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:31:37,228 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:31:37,229 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:31:37,229 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:31:37,229 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:31:37,229 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:31:50,641 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.85"}, "reasoning": {"hand_strength": "虽然手牌A♣和4♣整体实力一般，但A牌的存在提供了不错的高牌优势，加上同花潜力，具备一定进攻性。", "position_analysis": "目前处于较早位置，主动加注能够掌握先机，逼迫对手在后续游戏中做出更为艰难的选择。", "pot_odds": "底池已达到50，面对20的跟注要求，加注可以利用较好的赔率控制局面，同时稀释对手的跟注范围。", "opponent_reads": ["对手在此轮表现较为温和（CALL），可能范围较宽或试图诱导跟注，此时加注可施压迫使其弃牌或犯错。"]}, "table_talk": {"message": "各位，今天我可是掌控全局，看看我的牌和手笔！", "tone": "自信且略带挑衅"}}
2025-03-10 21:31:50,642 - src.agents.llm - INFO - ==================================================

2025-03-10 21:31:50,642 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 21:31:50,643 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '各位，今天我可是掌控全局，看看我的牌和手笔！', 'tone': '自信且略带挑衅'}
2025-03-10 21:31:50,643 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 21:31:50,643 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 21:31:50,643 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 21:31:50,643 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 21:31:50,644 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 21:31:50,644 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:31:50,644 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:31:50,644 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:31:50,644 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:31:50,644 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:31:50,645 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:31:50,645 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:50,645 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:50,645 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:31:50,645 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:31:50,645 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:31:50,646 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:31:50,646 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:31:50,646 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:31:50,646 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，今天我可是掌控全局，看看我的牌和手笔！', 'tone': '自信且略带挑衅'}}
2025-03-10 21:31:50,647 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:50,647 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:50,647 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:31:50,647 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:31:50,648 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:31:50,648 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:31:50,648 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:31:50,648 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:50,649 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:50,649 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:50,649 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:31:50,650 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:31:50,650 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:31:50,650 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:31:50,650 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:31:50,650 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:31:58,853 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":40,"confidence":0.7},"reasoning":{"hand_strength":"中等，9♦和8♠有形成顺子或同花的潜力","position_analysis":"位置2，处于中位，可以观察后续玩家的行动","pot_odds":"底池80，当前最大注40，底池赔率2:1","opponent_reads":["ai_1进行了加注，可能持有较强的手牌或试图施加压力","ai_4选择了跟注，可能持有中等强度的手牌或试图观察后续行动"]},"table_talk":{"message":"看来大家都很有信心，我跟注看看","tone":"轻松"}}
2025-03-10 21:31:58,854 - src.agents.llm - INFO - ==================================================

2025-03-10 21:31:58,855 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来大家都很有信心，我跟注看看', 'tone': '轻松'}
2025-03-10 21:31:58,855 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-03-10 21:31:58,855 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-03-10 21:31:58,855 - src.engine.state - INFO - 玩家 ai_2 跟注 20 筹码，已标记为已行动
2025-03-10 21:31:58,856 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-03-10 21:31:58,857 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-03-10 21:31:58,857 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:31:58,857 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:31:58,857 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:31:58,857 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:31:58,857 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_4
2025-03-10 21:31:58,857 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:31:58,858 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:58,858 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:58,858 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:31:58,858 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:31:58,858 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:31:58,859 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:31:58,859 - src.engine.game - INFO - 玩家 ai_4 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 21:31:58,859 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:31:58,859 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:31:58,859 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 100, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来大家都很有信心，我跟注看看', 'tone': '轻松'}}
2025-03-10 21:31:58,859 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:31:58,861 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:31:58,861 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:31:58,861 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:31:58,861 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:31:58,861 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:31:58,861 - src.engine.game - INFO - 玩家 ai_4 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 21:31:58,862 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:31:58,862 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:58,862 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:58,862 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:31:58,863 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:31:58,863 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:31:58,863 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:31:58,863 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:31:58,863 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:31:58,863 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:32:15,223 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "CALL",
    "amount": "40",
    "confidence": "0.6"
  },
  "reasoning": {
    "hand_strength": "手牌10♣, 9♥属于中等偏弱，但在前翻牌圈有一定的潜力形成顺子。",
    "position_analysis": "处于中间位置，可以观察更多玩家的动作来调整策略。",
    "pot_odds": "考虑到当前底池大小与跟注成本，跟注是合理的，因为这不会花费太多筹码同时保留了看到翻牌的机会。",
    "opponent_reads": ["ai_1选择加注可能持有较好的起始手牌，但也有试探性加注的可能性。", "ai_2跟注表明其手牌强度不确定，可能是为了控制损失而采取的保守行动。"]
  },
  "table_talk": {
    "message": "我决定看看接下来会发生什么，希望好运。",
    "tone": "轻松友好"
  }
}
2025-03-10 21:32:15,224 - src.agents.llm - INFO - ==================================================

2025-03-10 21:32:15,225 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我决定看看接下来会发生什么，希望好运。', 'tone': '轻松友好'}
2025-03-10 21:32:15,225 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 21:32:15,225 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 21:32:15,225 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-03-10 21:32:15,225 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 21:32:15,226 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 21:32:15,226 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:32:15,226 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:32:15,226 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:32:15,226 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 21:32:15,226 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:32:15,227 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:32:15,227 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:15,227 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:15,227 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:32:15,227 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:32:15,227 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:32:15,227 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:32:15,228 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 21:32:15,228 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 21:32:15,228 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 21:32:15,228 - src.engine.game - INFO - 活跃玩家数量: 3, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 21:32:15,228 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 21:32:15,228 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 21:32:15,228 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:15,229 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 21:32:15,229 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 21:32:15,229 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 21:32:15,229 - src.engine.dealer - INFO - Dealt 3 community cards: ['5♥', 'J♣', 'J♦']
2025-03-10 21:32:15,229 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['5♥', 'J♣', 'J♦']
2025-03-10 21:32:15,230 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_1', 1), ('ai_2', 2), ('ai_4', 4)]
2025-03-10 21:32:15,230 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 21:32:15,230 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 21:32:15,230 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 21:32:15,230 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 120, 'community_cards': ['5♥', 'J♣', 'J♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '我决定看看接下来会发生什么，希望好运。', 'tone': '轻松友好'}}
2025-03-10 21:32:15,231 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:15,231 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:15,231 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:15,231 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:32:15,232 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:32:15,232 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:32:15,232 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:15,232 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:15,233 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:15,233 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:32:15,233 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:32:15,233 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:32:15,233 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:32:15,234 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:32:15,234 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:32:32,670 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "40", "confidence": "0.7"}, "reasoning": {"hand_strength": "目前持有A♣,4♣在J♥,J♣,J♦的翻牌下只有A高，但具备后续抽成同花或A/4成对的潜力，算是边缘但有改善空间的手牌", "position_analysis": "位于早位，虽然有多人参与，但现阶段对局已较为混乱，采用跟注保持彩池控制较为合适", "pot_odds": "底池为120，加注额40，底池赔率约3:1，对于潜在抽牌来说具有吸引力", "opponent_reads": ["ai_1的40加注可能显示出较强牌力或试图利用位置优势偷底池", "ai_2和ai_4跟注表明他们的手牌有一定潜力或中等牌力"]}, "table_talk": {"message": "就跟一下，看看局势变化，也许下一张牌能让我大翻盘", "tone": "轻松中带点挑衅"}}
2025-03-10 21:32:32,672 - src.agents.llm - INFO - ==================================================

2025-03-10 21:32:32,672 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '就跟一下，看看局势变化，也许下一张牌能让我大翻盘', 'tone': '轻松中带点挑衅'}
2025-03-10 21:32:32,672 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 21:32:32,672 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 21:32:32,673 - src.engine.state - INFO - 玩家 ai_1 跟注 0 筹码，已标记为已行动
2025-03-10 21:32:32,673 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 21:32:32,673 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 21:32:32,673 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:32:32,673 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:32:32,674 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:32,674 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:32:32,674 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:32:32,674 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:32:32,674 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:32,674 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:32,675 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:32,675 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:32,675 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:32:32,675 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:32:32,676 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:32:32,676 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:32:32,676 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 120, 'community_cards': ['5♥', 'J♣', 'J♦'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '就跟一下，看看局势变化，也许下一张牌能让我大翻盘', 'tone': '轻松中带点挑衅'}}
2025-03-10 21:32:32,677 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:32,677 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:32,677 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:32,678 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:32,678 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:32:32,678 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:32:32,678 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:32:32,679 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:32,679 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:32,679 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:32,679 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:32:32,679 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:32:32,679 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:32:32,679 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:32:32,680 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:32:32,680 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:32:41,640 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":40,"confidence":0.7},"reasoning":{"hand_strength":"手牌9♦, 8♠在当前公共牌5♥, J♣, J♦下没有形成任何强牌，但有一定的潜力形成顺子或两对","position_analysis":"位置2处于中间位置，可以观察其他玩家的行动后再做出决策","pot_odds":"底池120，需要跟注40，底池赔率为3:1，相对合理","opponent_reads":["ai_1在FLOP阶段进行了40的加注，显示出一定的牌力，但可能是在试探其他玩家的反应","ai_4和ai_2都选择了跟注，显示出他们可能有一定的牌力或是在等待更好的机会"]},"table_talk":{"message":"看来大家都对这张J有点兴趣，我也跟一下看看","tone":"轻松试探"}}
2025-03-10 21:32:41,641 - src.agents.llm - INFO - ==================================================

2025-03-10 21:32:41,642 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来大家都对这张J有点兴趣，我也跟一下看看', 'tone': '轻松试探'}
2025-03-10 21:32:41,642 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-03-10 21:32:41,642 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-03-10 21:32:41,643 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-03-10 21:32:41,643 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-03-10 21:32:41,643 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-03-10 21:32:41,643 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:32:41,644 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:32:41,644 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:41,644 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:32:41,644 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_4
2025-03-10 21:32:41,644 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:32:41,645 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:41,645 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:41,646 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:41,646 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:41,646 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:41,646 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:32:41,646 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 21:32:41,646 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:32:41,646 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:32:41,647 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 120, 'community_cards': ['5♥', 'J♣', 'J♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来大家都对这张J有点兴趣，我也跟一下看看', 'tone': '轻松试探'}}
2025-03-10 21:32:41,647 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:41,647 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:41,648 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:32:41,648 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:41,648 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:41,648 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:32:41,648 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 21:32:41,649 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:32:41,649 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:41,649 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:41,649 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:41,650 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:32:41,650 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:32:41,650 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:32:41,650 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:32:41,651 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:32:41,651 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:32:59,969 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"100","confidence":0.75},"reasoning":{"hand_strength":"手牌为10♣, 9♥，虽然不是很强，但在翻牌圈有顺子听牌的机会。考虑到公共牌面出现了一对J，我的手牌可能隐藏得很好，不易被对手察觉其潜在价值。","position_analysis":"位于中间位置，可以尝试控制底池大小同时观察对手反应来获取更多信息。","pot_odds":"当前底池赔率支持小额加注以保持游戏参与度并增加赢利机会。","opponent_reads":["ai_1之前进行了加注，显示出一定的牌力或试图通过加注施压；ai_2选择跟注，表明他们可能持有中等强度的手牌或者也在等待更好的发展。"]},"table_talk":{"message":"看起来大家都有些犹豫不决啊，那我先来点小刺激吧！","tone":"轻松自信"}}
2025-03-10 21:32:59,970 - src.agents.llm - INFO - ==================================================

2025-03-10 21:32:59,970 - src.agents.llm - INFO - 成功将字符串金额 100 转换为数字 100.0
2025-03-10 21:32:59,971 - src.agents.llm - INFO - 生成动作: RAISE 金额: 100 table_talk: {'message': '看起来大家都有些犹豫不决啊，那我先来点小刺激吧！', 'tone': '轻松自信'}
2025-03-10 21:32:59,971 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 100
2025-03-10 21:32:59,971 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:32:59,971 - src.engine.state - INFO - 玩家 ai_4 加注到 100 筹码，已标记为已行动
2025-03-10 21:32:59,971 - src.engine.game - INFO - 玩家 ai_4 加注到 100
2025-03-10 21:32:59,971 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:32:59,972 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:32:59,972 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:32:59,972 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:32:59,972 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-10 21:32:59,972 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_1
2025-03-10 21:32:59,972 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:32:59,973 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:59,973 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:59,973 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:32:59,973 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:59,973 - src.engine.game - INFO - 玩家 ai_1 下注额(0)不等于最大下注额(100)，回合继续
2025-03-10 21:32:59,973 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:32:59,973 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:32:59,974 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 220, 'community_cards': ['5♥', 'J♣', 'J♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'A♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 860, 'current_bet': 100, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 100}], 'table_talk': {'message': '看起来大家都有些犹豫不决啊，那我先来点小刺激吧！', 'tone': '轻松自信'}}
2025-03-10 21:32:59,974 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:32:59,975 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:32:59,975 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:32:59,975 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:32:59,975 - src.engine.game - INFO - 玩家 ai_1 下注额(0)不等于最大下注额(100)，回合继续
2025-03-10 21:32:59,976 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:32:59,976 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:59,976 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:59,977 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:32:59,977 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:32:59,977 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:32:59,977 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:32:59,978 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:32:59,978 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:32:59,978 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:33:22,188 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"0","confidence":"0.95"},"reasoning":{"hand_strength":"手牌4♣, A♣在翻牌J♣, J♦, 5♥面前只形成了单A，且没有更强的改善潜力，整体牌力偏弱","position_analysis":"位于第一个行动位置，容易被后续的激进行动所压制，无法利用位置优势进行反击","pot_odds":"底池为220，但当前最大注100，跟注可能面临较高风险且投入产出比不佳","opponent_reads":["ai_4通过加注表现出强势，表明其潜在牌力较强","ai_2的跟注显示出谨慎但有一定信心，整体局面不利于我"]},"table_talk":{"message":"各位高手都在拼劲，我看今天就先守住实力，等待下次的良机。","tone":"冷静坚定"}}
2025-03-10 21:33:22,189 - src.agents.llm - INFO - ==================================================

2025-03-10 21:33:22,189 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位高手都在拼劲，我看今天就先守住实力，等待下次的良机。', 'tone': '冷静坚定'}
2025-03-10 21:33:22,189 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 21:33:22,189 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 21:33:22,190 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 21:33:22,190 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 21:33:22,190 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 21:33:22,190 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:33:22,190 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:33:22,190 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:33:22,192 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:33:22,192 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:33:22,192 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:33:22,192 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:22,192 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:33:22,193 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:33:22,193 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:33:22,193 - src.engine.game - INFO - 玩家 ai_2 下注额(0)不等于最大下注额(100)，回合继续
2025-03-10 21:33:22,193 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:33:22,194 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:33:22,194 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 220, 'community_cards': ['5♥', 'J♣', 'J♦'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 860, 'current_bet': 100, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位高手都在拼劲，我看今天就先守住实力，等待下次的良机。', 'tone': '冷静坚定'}}
2025-03-10 21:33:22,194 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:22,195 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:33:22,195 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:33:22,195 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 21:33:22,195 - src.engine.game - INFO - 玩家 ai_2 下注额(0)不等于最大下注额(100)，回合继续
2025-03-10 21:33:22,196 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:33:22,196 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:22,196 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:22,196 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:22,197 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:33:22,197 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:33:22,197 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:33:22,198 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:33:22,198 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:33:22,198 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:33:30,170 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌9♦, 8♠在当前公共牌5♥, J♣, J♦下没有形成任何强牌型，且没有明显的听牌机会。","position_analysis":"处于中间位置，后续还有多个玩家可能行动，增加了不确定性。","pot_odds":"底池220，当前最大注100，跟注需要投入100，赔率较低，不值得冒险。","opponent_reads":["对手ai_4在前一轮进行了加注，显示出一定的牌力，可能持有较强的牌。"]},"table_talk":{"message":"看来这手牌不太适合我，我选择放弃。","tone":"冷静"}}
2025-03-10 21:33:30,171 - src.agents.llm - INFO - ==================================================

2025-03-10 21:33:30,172 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择放弃。', 'tone': '冷静'}
2025-03-10 21:33:30,172 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 21:33:30,172 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 21:33:30,172 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 21:33:30,172 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 21:33:30,173 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 21:33:30,173 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 21:33:30,173 - src.engine.game - INFO - 开始游戏结算
2025-03-10 21:33:30,174 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 21:33:30,174 - src.engine.state - INFO - 玩家 ai_4 获得底池 220 筹码，当前筹码: 1080
2025-03-10 21:33:30,174 - src.engine.game - INFO - 玩家 ai_4 获得底池 220 筹码
2025-03-10 21:33:30,174 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 21:33:30,174 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 220, 'winning_hand': None, 'community_cards': ['5♥', 'J♣', 'J♦'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 21:33:30,175 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['5♥', 'J♣', 'J♦'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 220, 'winning_hand': None, 'community_cards': ['5♥', 'J♣', 'J♦'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1080, 'current_bet': 100, 'is_active': False, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择放弃。', 'tone': '冷静'}}
2025-03-10 21:33:30,175 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:30,176 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 21:33:30,176 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 21:33:30,176 - server - INFO - 回合结束，进入下一阶段
2025-03-10 21:33:30,176 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 21:33:30,177 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 21:33:30,177 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 220, 'winning_hand': None, 'community_cards': ['5♥', 'J♣', 'J♦'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 21:33:30,177 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 21:33:30,177 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:30,178 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:30,178 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:32,654 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:33:32,655 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 21:33:32,655 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 21:33:32,655 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:33:32,655 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♠', 'Q♥')
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♠', 'Q♠')
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♥', 'J♥')
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 ai_3 手牌: ('3♠', '7♣')
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 ai_4 手牌: ('K♣', '5♣')
2025-03-10 21:33:32,656 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 21:33:32,656 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-03-10 21:33:32,656 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 21:33:32,657 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 21:33:32,657 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 21:33:32,657 - src.engine.game - INFO - 游戏 f7600151-9bc7-47d3-962d-4548d6cfd36c 开始，进入翻牌前阶段
2025-03-10 21:33:32,657 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 21:33:35,194 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:35,194 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:35,195 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:35,195 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:33:35,195 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:33:35,195 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:33:35,196 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:33:35,196 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:33:35,196 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:33:52,858 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"持有一张大牌K和一张小同花牌5，虽然不是很强但有一定的潜力。考虑到对手可能持有更好的手牌，通过加注可以测试他们的反应并收集更多信息。","position_analysis":"位于中间位置，这既不是非常有利也不是很不利的位置。这意味着需要更加谨慎地评估行动的风险与回报。","pot_odds":"当前底池为30，相对于我的筹码量来说较小，即使加注至60也只占总筹码的一小部分，风险相对可控。","opponent_reads":["player_0尚未采取任何行动，可能是等待观察；ai_1、ai_2和ai_3都已下注或跟注，显示出他们对各自手牌的信心。"]},"table_talk":{"message":"看起来大家都挺有信心的嘛，那我也来凑个热闹吧！","tone":"轻松友好"}}
2025-03-10 21:33:52,858 - src.agents.llm - INFO - ==================================================

2025-03-10 21:33:52,859 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看起来大家都挺有信心的嘛，那我也来凑个热闹吧！', 'tone': '轻松友好'}
2025-03-10 21:33:52,859 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 21:33:52,859 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:33:52,859 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 21:33:52,859 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 21:33:52,860 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:33:52,860 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:33:52,860 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:33:52,860 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:33:52,860 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:33:52,861 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:33:52,861 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:33:52,861 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:52,861 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:33:52,862 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:33:52,862 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:33:52,862 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:33:52,862 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:33:52,862 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:33:52,863 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': True, 'cards': ('2♥', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', '7♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1020, 'current_bet': 60, 'is_active': True, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看起来大家都挺有信心的嘛，那我也来凑个热闹吧！', 'tone': '轻松友好'}}
2025-03-10 21:33:52,863 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:52,863 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:33:52,864 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:33:52,864 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:33:52,864 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:33:52,864 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:33:52,865 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:52,865 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:52,866 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:57,874 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:57,874 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:57,874 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:33:59,284 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 21:33:59,284 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T21:33:59.284031', 'table_talk': None}
2025-03-10 21:33:59,284 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 21:33:59,285 - src.engine.state - INFO - 玩家 player_0 跟注 60 筹码，已标记为已行动
2025-03-10 21:33:59,285 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 21:33:59,285 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 21:33:59,285 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 21:33:59,286 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 21:33:59,286 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:33:59,286 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 21:33:59,286 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 21:33:59,287 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:33:59,287 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:59,287 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:33:59,288 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:33:59,288 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:33:59,288 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:33:59,288 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:33:59,288 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:33:59,288 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:33:59,288 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 150, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('2♠', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': True, 'cards': ('2♥', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', '7♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1020, 'current_bet': 60, 'is_active': True, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:33:59,288 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:33:59,288 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:33:59,289 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:33:59,289 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:33:59,289 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:33:59,289 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:33:59,289 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:02,896 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:02,897 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:02,898 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:02,899 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:34:02,901 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:34:02,902 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:34:02,903 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:34:02,903 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:34:02,904 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:34:29,231 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "7♠, Q♠在Pre-flop时并非强牌，主要依赖顺子或同花潜力，但整体来讲偏弱。", "position_analysis": "你处在较早的位置，信息有限，且面对ai_4的激进加注和player_0的跟注，后续行动可能不利。", "pot_odds": "底池150，对应需要投入60，虽然赔率诱人，但在面对对手表现出较强牌力的情况下风险较高。", "opponent_reads": ["ai_4通过加注显示出强势或者试图偷池，player_0跟注表现谨慎，整体局势不利于投机牌型"]}, "table_talk": {"message": "抱歉各位，今天这手牌不合我的胃口。祝你们好运。", "tone": "冷静且略带不屑"}}
2025-03-10 21:34:29,232 - src.agents.llm - INFO - ==================================================

2025-03-10 21:34:29,232 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉各位，今天这手牌不合我的胃口。祝你们好运。', 'tone': '冷静且略带不屑'}
2025-03-10 21:34:29,232 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 21:34:29,232 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 21:34:29,233 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 21:34:29,233 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 21:34:29,233 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 21:34:29,233 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:34:29,233 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:34:29,233 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:29,234 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:34:29,234 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:34:29,234 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:34:29,234 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:29,234 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:34:29,234 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:29,235 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:34:29,235 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:34:29,235 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:34:29,235 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:29,235 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:34:29,235 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 150, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('2♠', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': True, 'cards': ('2♥', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', '7♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1020, 'current_bet': 60, 'is_active': True, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉各位，今天这手牌不合我的胃口。祝你们好运。', 'tone': '冷静且略带不屑'}}
2025-03-10 21:34:29,236 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:29,236 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:34:29,236 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:29,237 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:34:29,237 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:34:29,237 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:34:29,237 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:29,237 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:29,238 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:29,238 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:29,238 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:34:29,239 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:34:29,239 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:34:29,239 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:34:29,239 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:34:29,239 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:34:38,521 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"","confidence":0.8},"reasoning":{"hand_strength":"手牌2♥, J♥在PRE_FLOP阶段相对较弱，缺乏成牌潜力","position_analysis":"位置2在早期位置，不利于后续行动","pot_odds":"底池赔率不理想，不值得冒险跟注","opponent_reads":["ai_4进行了加注，player_0选择跟注，显示出对手可能有较强的手牌"]},"table_talk":{"message":"看来你们这次手气不错，我先退一步","tone":"轻松"}}
2025-03-10 21:34:38,522 - src.agents.llm - INFO - ==================================================

2025-03-10 21:34:38,522 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们这次手气不错，我先退一步', 'tone': '轻松'}
2025-03-10 21:34:38,522 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 21:34:38,523 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 21:34:38,523 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 21:34:38,523 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 21:34:38,523 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 21:34:38,524 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:34:38,524 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:34:38,524 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:38,524 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 21:34:38,524 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 21:34:38,525 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 21:34:38,525 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:38,525 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_3', 'ai_4']
2025-03-10 21:34:38,525 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:38,526 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:34:38,526 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:34:38,526 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 21:34:38,526 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:38,527 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:34:38,527 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 150, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('2♠', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♠', '7♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1020, 'current_bet': 60, 'is_active': True, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们这次手气不错，我先退一步', 'tone': '轻松'}}
2025-03-10 21:34:38,527 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:38,528 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_3', 'ai_4']
2025-03-10 21:34:38,528 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:38,528 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:34:38,528 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:34:38,528 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 21:34:38,529 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:38,529 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:38,529 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:38,529 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:38,529 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:34:38,529 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:34:38,530 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:34:38,530 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:34:38,530 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:34:38,530 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:34:46,210 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"持有3♠, 7♣是非常弱的起手牌，没有同花可能，没有顺子潜力，没有高牌价值","position_analysis":"我在相对较早的位置(位置3)，在我之后还有多名玩家要行动，增加了被人再次加注的风险","pot_odds":"底池150，需要跟注60，底池赔率约为2.5:1，但手牌太弱，不值得继续投入","opponent_reads":["ai_4已经加注，表明可能有强牌","player_0跟注，说明他也可能有不错的牌力","两名玩家已经弃牌，但仍有两名活跃玩家"]},"table_talk":{"message":"这手牌不太行，我还是省点筹码吧","tone":"轻松"}}
2025-03-10 21:34:46,211 - src.agents.llm - INFO - ==================================================

2025-03-10 21:34:46,211 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太行，我还是省点筹码吧', 'tone': '轻松'}
2025-03-10 21:34:46,212 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:34:46,212 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:34:46,212 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:34:46,212 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:34:46,213 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:34:46,213 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:34:46,213 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:34:46,213 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:46,213 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 21:34:46,214 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:34:46,214 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:34:46,214 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:46,214 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:34:46,214 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:34:46,215 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:34:46,215 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:34:46,215 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 21:34:46,215 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 21:34:46,215 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 21:34:46,215 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 21:34:46,216 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 21:34:46,216 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 21:34:46,216 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:34:46,216 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 21:34:46,216 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 21:34:46,217 - src.engine.dealer - INFO - Dealt 3 community cards: ['K♠', '6♦', '8♣']
2025-03-10 21:34:46,217 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['K♠', '6♦', '8♣']
2025-03-10 21:34:46,217 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_4', 4)]
2025-03-10 21:34:46,217 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 21:34:46,217 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 21:34:46,217 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 21:34:46,217 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 150, 'community_cards': ['K♠', '6♦', '8♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1020, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太行，我还是省点筹码吧', 'tone': '轻松'}}
2025-03-10 21:34:46,219 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:46,219 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:34:46,219 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:34:46,219 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:34:46,219 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:34:46,220 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:46,220 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:46,220 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:46,221 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:46,221 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:34:46,221 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:34:46,221 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:34:46,221 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:34:46,222 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:34:46,222 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:34:58,652 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":120,"confidence":0.85},"reasoning":{"hand_strength":"持有顶对K，有一定的强度但不是非常强。考虑到公共牌面没有明显的听牌可能，我的手牌相对安全。","position_analysis":"处于中后位置，有利于观察对手行动后再做决定，同时也能通过加注来控制底池大小和获取更多信息。","pot_odds":"当前底池为150，加注到120后总投入与潜在回报比合理，符合长期盈利策略。","opponent_reads":["player_0在之前的回合选择了跟注，显示出他可能持有一些实力或者是在尝试用较小的代价看接下来的牌局发展。"]},"table_talk":{"message":"看来我们都认为这把值得一看，那我再加点吧。","tone":"轻松自信"}}
2025-03-10 21:34:58,654 - src.agents.llm - INFO - ==================================================

2025-03-10 21:34:58,654 - src.agents.llm - INFO - 生成动作: RAISE 金额: 120 table_talk: {'message': '看来我们都认为这把值得一看，那我再加点吧。', 'tone': '轻松自信'}
2025-03-10 21:34:58,655 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 120
2025-03-10 21:34:58,655 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:34:58,655 - src.engine.state - INFO - 玩家 ai_4 加注到 120 筹码，已标记为已行动
2025-03-10 21:34:58,655 - src.engine.game - INFO - 玩家 ai_4 加注到 120
2025-03-10 21:34:58,656 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:34:58,656 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:34:58,656 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:34:58,656 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 21:34:58,656 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:34:58,656 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:34:58,657 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:34:58,657 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:58,657 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:34:58,657 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 21:34:58,657 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:34:58,657 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:34:58,657 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:58,657 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:34:58,657 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 270, 'community_cards': ['K♠', '6♦', '8♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 900, 'current_bet': 120, 'is_active': True, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 120}], 'table_talk': {'message': '看来我们都认为这把值得一看，那我再加点吧。', 'tone': '轻松自信'}}
2025-03-10 21:34:58,658 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:34:58,658 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:34:58,658 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 21:34:58,659 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:34:58,659 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:34:58,659 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:34:58,660 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:58,660 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:34:58,660 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:03,679 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:03,680 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:03,680 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:08,671 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:08,671 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:08,672 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:12,058 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 21:35:12,058 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T21:35:12.058859', 'table_talk': None}
2025-03-10 21:35:12,058 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 21:35:12,059 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 21:35:12,059 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 21:35:12,059 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 21:35:12,059 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 21:35:12,060 - src.engine.game - INFO - 开始游戏结算
2025-03-10 21:35:12,060 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 21:35:12,061 - src.engine.state - INFO - 玩家 ai_4 获得底池 270 筹码，当前筹码: 1170
2025-03-10 21:35:12,061 - src.engine.game - INFO - 玩家 ai_4 获得底池 270 筹码
2025-03-10 21:35:12,061 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 21:35:12,062 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 270, 'winning_hand': None, 'community_cards': ['K♠', '6♦', '8♣'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♣', '5♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 21:35:12,062 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['K♠', '6♦', '8♣'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 270, 'winning_hand': None, 'community_cards': ['K♠', '6♦', '8♣'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♣', '5♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1170, 'current_bet': 120, 'is_active': False, 'cards': ('K♣', '5♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:35:12,062 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:12,062 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 21:35:12,063 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 21:35:12,063 - server - INFO - 回合结束，进入下一阶段
2025-03-10 21:35:12,063 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 21:35:12,063 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 21:35:12,063 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 270, 'winning_hand': None, 'community_cards': ['K♠', '6♦', '8♣'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♣', '5♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 21:35:12,064 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 21:35:13,321 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:35:13,322 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 21:35:13,322 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 21:35:13,322 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:35:13,322 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:35:13,323 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', '9♦')
2025-03-10 21:35:13,323 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♣', 'Q♠')
2025-03-10 21:35:13,323 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♠', '5♥')
2025-03-10 21:35:13,323 - src.engine.game - INFO - 玩家 ai_3 手牌: ('J♠', '3♠')
2025-03-10 21:35:13,323 - src.engine.game - INFO - 玩家 ai_4 手牌: ('2♣', '4♥')
2025-03-10 21:35:13,324 - src.engine.state - INFO - 玩家 ai_3 下注 10 筹码
2025-03-10 21:35:13,324 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 21:35:13,324 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 21:35:13,324 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 21:35:13,325 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 21:35:13,325 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 21:35:13,325 - src.engine.game - INFO - 游戏 f7600151-9bc7-47d3-962d-4548d6cfd36c 开始，进入翻牌前阶段
2025-03-10 21:35:13,325 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 21:35:13,695 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:13,695 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:13,696 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:18,699 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:18,700 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:18,700 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:23,685 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:23,716 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:23,716 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:25,641 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 21:35:25,642 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T21:35:25.642277', 'table_talk': None}
2025-03-10 21:35:25,642 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 21:35:25,643 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 21:35:25,644 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 21:35:25,644 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 21:35:25,644 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 21:35:25,644 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 21:35:25,644 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:25,645 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 21:35:25,645 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 21:35:25,645 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:35:25,645 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:25,645 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:35:25,645 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:25,646 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:25,646 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:35:25,646 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:35:25,646 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:35:25,646 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:35:25,647 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '9♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': True, 'cards': ('A♠', '5♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('J♠', '3♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1150, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '4♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:35:25,647 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:25,648 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:35:25,648 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:25,648 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:25,648 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:35:25,648 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:35:25,649 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:35:28,704 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:28,704 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:28,705 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:28,705 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:35:28,705 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:35:28,705 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:35:28,706 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:35:28,706 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:35:28,706 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:35:52,526 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.85"}, "reasoning": {"hand_strength": "我的手牌9♣和Q♠并不是顶级起手牌，属于中等偏下水平，可以通过看翻牌来寻求改善，但硬力有限，不适合冒险大加注", "position_analysis": "位置1较早，相对于后位玩家信息较少，保持稳健策略比较合适", "pot_odds": "当前底池50，投入20跟注，底池赔率尚可，可以用较低风险换取翻牌后的潜在收益", "opponent_reads": ["player_0选择跟注显示出愿意继续投入，但可能手牌也不强", "ai_3和ai_4的下注情况显示他们在等待更好时机或持有中等手牌", "ai_2尚未下注，可能保守或等待变数"]}, "table_talk": {"message": "各位，我只是想平稳进入下一阶段，看看翻牌的实际走势。", "tone": "冷静自信"}}
2025-03-10 21:35:52,527 - src.agents.llm - INFO - ==================================================

2025-03-10 21:35:52,527 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位，我只是想平稳进入下一阶段，看看翻牌的实际走势。', 'tone': '冷静自信'}
2025-03-10 21:35:52,528 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 21:35:52,528 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 21:35:52,528 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 21:35:52,529 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 21:35:52,529 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 21:35:52,529 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:35:52,530 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:35:52,530 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:52,530 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:35:52,531 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:35:52,531 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:35:52,531 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:52,531 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:35:52,531 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:52,531 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:52,533 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:52,533 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:35:52,533 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:35:52,533 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:35:52,533 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:35:52,533 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '9♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': True, 'cards': ('A♠', '5♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('J♠', '3♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1150, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '4♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，我只是想平稳进入下一阶段，看看翻牌的实际走势。', 'tone': '冷静自信'}}
2025-03-10 21:35:52,534 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:52,534 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:35:52,535 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:52,535 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:52,535 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:52,535 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:35:52,535 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:35:52,536 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:35:52,536 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:52,536 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:52,536 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:52,538 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:35:52,538 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:35:52,538 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:35:52,538 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:35:52,538 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:35:52,539 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:35:59,700 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌A♠, 5♥在PRE_FLOP阶段强度较低，缺乏成牌潜力","position_analysis":"位置2，处于早期位置，不利于后续行动","pot_odds":"底池赔率不理想，不值得冒险跟注或加注","opponent_reads":["player_0和ai_1都选择跟注，表明他们可能持有较强的手牌或准备在后续阶段施加压力"]},"table_talk":{"message":"看来你们都有信心，我选择退出这局","tone":"冷静"}}
2025-03-10 21:35:59,701 - src.agents.llm - INFO - ==================================================

2025-03-10 21:35:59,702 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们都有信心，我选择退出这局', 'tone': '冷静'}
2025-03-10 21:35:59,702 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 21:35:59,702 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 21:35:59,702 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 21:35:59,703 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 21:35:59,703 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 21:35:59,703 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:35:59,703 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:35:59,703 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:59,704 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 21:35:59,704 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 21:35:59,704 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 21:35:59,704 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:59,705 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 21:35:59,705 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:59,705 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:59,706 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:59,706 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:35:59,706 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 21:35:59,706 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:35:59,706 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:35:59,706 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '9♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('J♠', '3♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1150, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '4♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们都有信心，我选择退出这局', 'tone': '冷静'}}
2025-03-10 21:35:59,708 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:35:59,708 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 21:35:59,708 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:35:59,708 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:59,708 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:35:59,708 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:35:59,709 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 21:35:59,709 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:35:59,709 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:59,710 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:59,710 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:35:59,710 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:35:59,711 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:35:59,711 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:35:59,711 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:35:59,711 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:35:59,711 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:36:07,855 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"J♠3♠是一副较弱的起手牌，虽然同花，但牌值差距大，连接性差，在六人桌中强度较低。","position_analysis":"我处于早期位置，后面还有两名玩家要行动，位置不佳。","pot_odds":"底池70，需要下注20才能继续，赔率约为3.5:1，但考虑到手牌强度和位置，这个赔率不足以支持继续。","opponent_reads":["所有前面的玩家都选择了跟注，没有人加注，说明他们手牌可能中等强度，但也可能有人在慢打强牌。"]},"table_talk":{"message":"这手牌不太行，还是保留实力等更好的机会吧。","tone":"平静"}}
2025-03-10 21:36:07,857 - src.agents.llm - INFO - ==================================================

2025-03-10 21:36:07,857 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太行，还是保留实力等更好的机会吧。', 'tone': '平静'}
2025-03-10 21:36:07,858 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:36:07,859 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:36:07,859 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:36:07,860 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:36:07,860 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:36:07,860 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:36:07,861 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:36:07,861 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:07,861 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:36:07,861 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:36:07,861 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:36:07,862 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:07,862 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 21:36:07,862 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:07,862 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:36:07,862 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:36:07,863 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:36:07,863 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 21:36:07,863 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:07,864 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:36:07,864 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '9♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1150, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '4♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太行，还是保留实力等更好的机会吧。', 'tone': '平静'}}
2025-03-10 21:36:07,865 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:07,865 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 21:36:07,865 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:07,865 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:36:07,866 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:36:07,866 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:36:07,866 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 21:36:07,866 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:07,867 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:07,867 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:07,867 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:07,868 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:36:07,868 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:36:07,868 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:36:07,868 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:36:07,869 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:36:07,869 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:36:18,575 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "FOLD",
    "amount": "",
    "confidence": 0.8
  },
  "reasoning": {
    "hand_strength": "我的手牌2♣, 4♥非常弱，在没有看到公共牌的情况下几乎没有任何胜算。",
    "position_analysis": "处于中间位置，既不是最有利也不是最不利的位置，但鉴于手牌质量较差，位置优势并不明显。",
    "pot_odds": "考虑到需要至少加注到60才能继续游戏，而我手中的牌力不足以支持这样的投资。当前底池为70，即使跟注也不划算。",
    "opponent_reads": ["两位对手都选择了跟注，表明他们可能持有较好的起始手牌或愿意尝试看翻牌。"]
  },
  "table_talk": {
    "message": "这次我选择放弃，希望下一手能有更好的运气。",
    "tone": "友好"
  }
}
2025-03-10 21:36:18,576 - src.agents.llm - INFO - ==================================================

2025-03-10 21:36:18,576 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我选择放弃，希望下一手能有更好的运气。', 'tone': '友好'}
2025-03-10 21:36:18,577 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 21:36:18,577 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 21:36:18,578 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 21:36:18,578 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 21:36:18,578 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 21:36:18,578 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:36:18,578 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:36:18,578 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:18,578 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 21:36:18,579 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:36:18,579 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:36:18,579 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:18,579 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 21:36:18,579 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:18,579 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:36:18,580 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:36:18,580 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 21:36:18,580 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 21:36:18,580 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 21:36:18,580 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 21:36:18,581 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 21:36:18,581 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 21:36:18,581 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 21:36:18,581 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 21:36:18,582 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 21:36:18,582 - src.engine.dealer - INFO - Dealt 3 community cards: ['Q♥', '3♥', '5♠']
2025-03-10 21:36:18,582 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['Q♥', '3♥', '5♠']
2025-03-10 21:36:18,582 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 21:36:18,582 - src.engine.game - INFO - 庄家位置: 2
2025-03-10 21:36:18,583 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 21:36:18,583 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 21:36:18,583 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 70, 'community_cards': ['Q♥', '3♥', '5♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 920, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '9♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1150, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我选择放弃，希望下一手能有更好的运气。', 'tone': '友好'}}
2025-03-10 21:36:18,583 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:18,584 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 21:36:18,584 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:36:18,584 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:36:18,584 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:36:18,585 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:18,585 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:18,585 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:18,586 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:23,598 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:23,598 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:23,599 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:25,815 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 21:36:25,815 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T21:36:25.815985', 'table_talk': None}
2025-03-10 21:36:25,815 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 21:36:25,815 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 21:36:25,817 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 21:36:25,817 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 21:36:25,818 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 21:36:25,818 - src.engine.game - INFO - 开始游戏结算
2025-03-10 21:36:25,818 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 21:36:25,818 - src.engine.state - INFO - 玩家 ai_1 获得底池 70 筹码，当前筹码: 1010
2025-03-10 21:36:25,819 - src.engine.game - INFO - 玩家 ai_1 获得底池 70 筹码
2025-03-10 21:36:25,819 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 21:36:25,819 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 70, 'winning_hand': None, 'community_cards': ['Q♥', '3♥', '5♠'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('9♣', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 21:36:25,819 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['Q♥', '3♥', '5♠'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 70, 'winning_hand': None, 'community_cards': ['Q♥', '3♥', '5♠'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('9♣', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 1010, 'current_bet': 0, 'is_active': False, 'cards': ('9♣', 'Q♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1150, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:36:25,820 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:25,820 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 21:36:25,821 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 21:36:25,821 - server - INFO - 回合结束，进入下一阶段
2025-03-10 21:36:25,821 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 21:36:25,821 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 21:36:25,821 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 70, 'winning_hand': None, 'community_cards': ['Q♥', '3♥', '5♠'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('9♣', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 21:36:25,822 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 21:36:26,650 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:36:26,651 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 21:36:26,651 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 21:36:26,652 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:36:26,652 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:36:26,653 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♦', '6♣')
2025-03-10 21:36:26,653 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♣', '9♣')
2025-03-10 21:36:26,653 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', 'A♦')
2025-03-10 21:36:26,653 - src.engine.game - INFO - 玩家 ai_3 手牌: ('5♥', 'A♠')
2025-03-10 21:36:26,654 - src.engine.game - INFO - 玩家 ai_4 手牌: ('9♠', 'J♥')
2025-03-10 21:36:26,654 - src.engine.state - INFO - 玩家 ai_4 下注 10 筹码
2025-03-10 21:36:26,655 - src.engine.game - INFO - 玩家 ai_4 下注小盲注 10
2025-03-10 21:36:26,655 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 21:36:26,655 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 21:36:26,655 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_4(10)，大盲注=player_0(20)
2025-03-10 21:36:26,657 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 21:36:26,657 - src.engine.game - INFO - 游戏 f7600151-9bc7-47d3-962d-4548d6cfd36c 开始，进入翻牌前阶段
2025-03-10 21:36:26,658 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 21:36:28,612 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:28,612 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:28,613 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:28,614 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:36:28,614 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:36:28,615 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:36:28,615 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:36:28,615 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:36:28,615 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:36:47,258 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.85"}, "reasoning": {"hand_strength": "8♣,9♣虽非顶级强牌，但具备同花和顺子的潜力，有隐蔽的进攻性", "position_analysis": "处于早位，需谨慎处理，不宜在没有足够信息时冒进", "pot_odds": "底池为30，跟注20成本合理，能够以较低成本看发牌，获取更多信息", "opponent_reads": ["player_0表现激进，可能试图控制局面", "ai_4的10筹码下注显示犹豫", "ai_2和ai_3暂无行动，暂时信息不足"]}, "table_talk": {"message": "各位，静观其变，今天让大家来尝尝我的后劲！", "tone": "自信且略带挑衅"}}
2025-03-10 21:36:47,259 - src.agents.llm - INFO - ==================================================

2025-03-10 21:36:47,259 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位，静观其变，今天让大家来尝尝我的后劲！', 'tone': '自信且略带挑衅'}
2025-03-10 21:36:47,259 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 21:36:47,259 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 21:36:47,260 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 21:36:47,260 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 21:36:47,260 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 21:36:47,260 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:36:47,260 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:36:47,260 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:47,261 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:36:47,261 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:36:47,261 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:36:47,261 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:47,261 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:36:47,261 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:47,261 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:36:47,262 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:36:47,262 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:47,262 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:36:47,262 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 950, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1140, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，静观其变，今天让大家来尝尝我的后劲！', 'tone': '自信且略带挑衅'}}
2025-03-10 21:36:47,263 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:47,263 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:36:47,264 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:36:47,264 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:36:47,264 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:36:47,264 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:47,264 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:47,264 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:47,265 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:47,265 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:36:47,265 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:36:47,265 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:36:47,265 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:36:47,265 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:36:47,265 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:36:54,567 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":40,"confidence":0.85},"reasoning":{"hand_strength":"Q♣和A♦是强牌，尤其是在PRE_FLOP阶段，A♦的高牌潜力很大","position_analysis":"位置2是早期位置，但手牌强度足以支持加注","pot_odds":"底池50，当前最大注20，加注到40是合理的，底池赔率支持加注","opponent_reads":["ai_1选择了CALL，表明他可能持有中等强度的牌，加注可以迫使他做出更艰难的决定"]},"table_talk":{"message":"看来有人想跟我玩大的，那就来吧！","tone":"挑衅"}}
2025-03-10 21:36:54,568 - src.agents.llm - INFO - ==================================================

2025-03-10 21:36:54,568 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来有人想跟我玩大的，那就来吧！', 'tone': '挑衅'}
2025-03-10 21:36:54,568 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-10 21:36:54,569 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 21:36:54,569 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-10 21:36:54,569 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-10 21:36:54,569 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 21:36:54,569 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:36:54,570 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:36:54,570 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:36:54,570 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 21:36:54,570 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 21:36:54,570 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 21:36:54,570 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:54,571 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:36:54,571 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:36:54,571 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:36:54,571 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:36:54,571 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:54,571 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:36:54,572 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1140, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想跟我玩大的，那就来吧！', 'tone': '挑衅'}}
2025-03-10 21:36:54,572 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:36:54,572 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:36:54,572 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:36:54,573 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:36:54,573 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:36:54,573 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:36:54,574 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:54,574 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:54,574 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:36:54,575 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:36:54,575 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:36:54,575 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:36:54,575 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:36:54,575 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:36:54,575 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:37:03,405 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":40,"confidence":0.7},"reasoning":{"hand_strength":"A5o是一手中等强度的起手牌。虽然有一张A，但5作为配牌较弱，且不同花色，潜力有限。","position_analysis":"我在中间位置，已经有人在我前面加注，且还有一名玩家在我之后要行动。","pot_odds":"当前底池90，我需要跟注40，获得2.25:1的底池赔率，考虑到我手上有A，值得跟注一次。","opponent_reads":["ai_2的加注表明他可能有一手不错的牌，但加注幅度不大，可能是中等强度的手牌","ai_1选择跟注而非加注，说明他手牌可能不是特别强"]},"table_talk":{"message":"让我们看看翻牌会带来什么惊喜。","tone":"平静自信"}}
2025-03-10 21:37:03,406 - src.agents.llm - INFO - ==================================================

2025-03-10 21:37:03,407 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我们看看翻牌会带来什么惊喜。', 'tone': '平静自信'}
2025-03-10 21:37:03,407 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 21:37:03,407 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 21:37:03,407 - src.engine.state - INFO - 玩家 ai_3 跟注 40 筹码，已标记为已行动
2025-03-10 21:37:03,407 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 21:37:03,408 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 21:37:03,408 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:37:03,408 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:37:03,408 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:03,408 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:37:03,409 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:37:03,409 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:37:03,409 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:03,409 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:03,409 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:03,409 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:37:03,410 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:37:03,410 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:37:03,410 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:37:03,410 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 130, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1140, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '让我们看看翻牌会带来什么惊喜。', 'tone': '平静自信'}}
2025-03-10 21:37:03,411 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:03,411 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:03,411 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:03,411 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:37:03,412 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:37:03,412 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:37:03,412 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:03,412 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:03,413 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:03,413 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:37:03,413 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:37:03,413 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:37:03,414 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:37:03,414 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:37:03,414 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:37:15,746 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"40","confidence":0.65},"reasoning":{"hand_strength":"手牌为9♠, J♥，在预翻牌阶段属于中等偏弱。但考虑到对手加注行为，可能存在潜在的强牌或诈唬可能，直接跟注可以保持较小损失同时观察后续情况。","position_analysis":"处于较晚位置，有利于根据前面玩家的动作做出更合理的判断。","pot_odds":"当前底池赔率较为合适，跟注成本相对较低，适合收集更多信息。","opponent_reads":["ai_2进行了加注，表明其对自己手牌有一定信心；其他两位玩家选择跟注，显示出他们也愿意继续游戏，可能是持有不错的起始手牌或者采取观望策略。"]},"table_talk":{"message":"看起来大家都挺有信心的嘛，我也来凑个热闹。","tone":"轻松友好"}}
2025-03-10 21:37:15,746 - src.agents.llm - INFO - ==================================================

2025-03-10 21:37:15,746 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看起来大家都挺有信心的嘛，我也来凑个热闹。', 'tone': '轻松友好'}
2025-03-10 21:37:15,746 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 21:37:15,748 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 21:37:15,748 - src.engine.state - INFO - 玩家 ai_4 跟注 30 筹码，已标记为已行动
2025-03-10 21:37:15,748 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 21:37:15,748 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 21:37:15,748 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:37:15,748 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:37:15,748 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:15,749 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:37:15,749 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:37:15,749 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:37:15,749 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:15,749 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:15,750 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:15,750 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:37:15,750 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:37:15,750 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:37:15,751 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:37:15,751 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 160, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1110, 'current_bet': 40, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '看起来大家都挺有信心的嘛，我也来凑个热闹。', 'tone': '轻松友好'}}
2025-03-10 21:37:15,751 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:15,752 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:15,752 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:15,752 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:37:15,752 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:37:15,753 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:37:15,753 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:15,753 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:15,754 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:20,776 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:20,776 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:20,777 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:21,671 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 21:37:21,671 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T21:37:21.671865', 'table_talk': None}
2025-03-10 21:37:21,672 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 21:37:21,672 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 21:37:21,672 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 21:37:21,672 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 21:37:21,672 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 21:37:21,673 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 21:37:21,673 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:21,673 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 21:37:21,673 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 21:37:21,674 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:37:21,674 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:21,674 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:21,674 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:21,674 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:21,676 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:37:21,676 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 21:37:21,676 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:37:21,676 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:37:21,676 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 180, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 40, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1110, 'current_bet': 40, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:37:21,677 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:21,677 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:21,677 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:21,677 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:21,677 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 21:37:21,677 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 21:37:21,677 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:37:25,769 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:25,769 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:25,770 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:25,771 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:37:25,771 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:37:25,772 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:37:25,772 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:37:25,772 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:37:25,773 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:37:56,929 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "40", "confidence": "0.8"}, "reasoning": {"hand_strength": "我当前持有8♣, 9♣是一手同花连牌，虽非顶级起手牌，但具备构成顺子和同花的潜力", "position_analysis": "处于较早位置，主动加注可能暴露策略，选择跟注可以保留后续行动的灵活性", "pot_odds": "投入40进入180的底池，赔率较诱人，有利于小成本发挥手牌潜力", "opponent_reads": ["对手多数选择跟注或微弱加注，显示牌路较宽松且风险不大"]}, "table_talk": {"message": "大家耐心点，让我们看看翻牌会不会给出更惊喜的答案！", "tone": "自信且略带挑衅"}}
2025-03-10 21:37:56,930 - src.agents.llm - INFO - ==================================================

2025-03-10 21:37:56,931 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '大家耐心点，让我们看看翻牌会不会给出更惊喜的答案！', 'tone': '自信且略带挑衅'}
2025-03-10 21:37:56,931 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 21:37:56,932 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 21:37:56,932 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 21:37:56,932 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 21:37:56,932 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 21:37:56,933 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:37:56,933 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:37:56,933 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:56,933 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 21:37:56,933 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:37:56,934 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:37:56,934 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:56,934 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:56,934 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 21:37:56,934 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:56,934 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:56,934 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:56,934 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:56,936 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 21:37:56,936 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 21:37:56,936 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 21:37:56,936 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 21:37:56,936 - src.engine.game - INFO - 活跃玩家数量: 5, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 21:37:56,936 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 21:37:56,936 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 21:37:56,936 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:56,937 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 21:37:56,937 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 21:37:56,937 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 21:37:56,937 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 21:37:56,937 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 21:37:56,938 - src.engine.dealer - INFO - Dealt 3 community cards: ['4♦', '8♦', 'J♦']
2025-03-10 21:37:56,938 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['4♦', '8♦', 'J♦']
2025-03-10 21:37:56,938 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_2', 2), ('ai_3', 3), ('ai_4', 4)]
2025-03-10 21:37:56,938 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 21:37:56,938 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 21:37:56,938 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 21:37:56,939 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 200, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 910, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1110, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '大家耐心点，让我们看看翻牌会不会给出更惊喜的答案！', 'tone': '自信且略带挑衅'}}
2025-03-10 21:37:56,939 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:37:56,939 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:37:56,940 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:37:56,940 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:37:56,940 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:37:56,940 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:37:56,941 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:56,941 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:56,941 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:37:56,942 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:37:56,942 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:37:56,942 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:37:56,942 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:37:56,942 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:37:56,943 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:38:13,602 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"100","confidence":0.75},"reasoning":{"hand_strength":"持有一对J，加上公共牌中的一张J，目前形成了三条。这是一个非常强的手牌组合，在当前阶段有很好的胜算。","position_analysis":"处于较晚的位置，可以观察到其他玩家的动作后再做决定，这给了我们更多策略上的灵活性。","pot_odds":"底池为200，加注至100后，即使后面有人跟注，我们的投入相对于可能赢得的回报来说是合理的。","opponent_reads":["ai_2选择了加注40，表明他可能持有较好的手牌或尝试偷取底池；其余玩家均选择跟注，显示出他们可能在寻找机会或持有不错的听牌。"]},"table_talk":{"message":"看来大家都挺有信心的嘛，那我也来凑个热闹吧！","tone":"轻松自信"}}
2025-03-10 21:38:13,603 - src.agents.llm - INFO - ==================================================

2025-03-10 21:38:13,603 - src.agents.llm - INFO - 成功将字符串金额 100 转换为数字 100.0
2025-03-10 21:38:13,603 - src.agents.llm - INFO - 生成动作: RAISE 金额: 100 table_talk: {'message': '看来大家都挺有信心的嘛，那我也来凑个热闹吧！', 'tone': '轻松自信'}
2025-03-10 21:38:13,604 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 100
2025-03-10 21:38:13,604 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:38:13,604 - src.engine.state - INFO - 玩家 ai_4 加注到 100 筹码，已标记为已行动
2025-03-10 21:38:13,604 - src.engine.game - INFO - 玩家 ai_4 加注到 100
2025-03-10 21:38:13,604 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:38:13,605 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:38:13,605 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:38:13,605 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:13,605 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:38:13,605 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:38:13,605 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:38:13,606 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:13,606 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:13,606 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:13,606 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:38:13,606 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:38:13,606 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:38:13,607 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:38:13,607 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 300, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 100, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 100}], 'table_talk': {'message': '看来大家都挺有信心的嘛，那我也来凑个热闹吧！', 'tone': '轻松自信'}}
2025-03-10 21:38:13,608 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:13,608 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:13,608 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:13,608 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:38:13,609 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:38:13,610 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:38:13,610 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:13,610 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:13,611 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:18,621 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:18,622 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:18,622 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:23,558 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 21:38:23,558 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T21:38:23.558336', 'table_talk': None}
2025-03-10 21:38:23,558 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 21:38:23,559 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 21:38:23,559 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 21:38:23,559 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 21:38:23,559 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 21:38:23,559 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 21:38:23,560 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:23,560 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 21:38:23,560 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 21:38:23,560 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:38:23,561 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:23,561 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:23,561 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:23,562 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:38:23,562 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:38:23,562 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:38:23,562 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:38:23,563 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 300, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 100, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:38:23,563 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:23,563 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:23,563 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:23,564 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:38:23,564 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:38:23,564 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:38:23,619 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:38:23,620 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:38:23,621 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:38:23,621 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:38:23,621 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:38:23,622 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:38:45,291 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "100", "confidence": "0.7"}, "reasoning": {"hand_strength": "手中有一对8，虽然不是顶对但具备一定的潜力，加上9可能带来顺子的可能

", "position_analysis": "位置靠前，不算优势，但可以通过后续牌局动态进行调整", "pot_odds": "底池300，对手下注100，投入产出比尚可", "opponent_reads": ["ai_4的再加注可能代表实力，也可能是在试图施压", "ai_2的小额加注显示出试探性行为"]}, "table_talk": {"message": "各位小心，我只是想看局势如何发展，稳扎稳打才是王道。", "tone": "冷静而略带挑衅"}}
2025-03-10 21:38:45,292 - src.agents.llm - INFO - ==================================================

2025-03-10 21:38:45,292 - src.agents.llm - ERROR - JSON解析失败: Invalid control character at: line 1 column 134 (char 133)
2025-03-10 21:38:45,292 - src.agents.llm - ERROR - 解析LLM响应时出错: Invalid control character at: line 1 column 134 (char 133)
2025-03-10 21:38:45,293 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): Invalid control character at: line 1 column 134 (char 133)
2025-03-10 21:38:46,295 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: Invalid control character at: line 1 column 134 (char 133)
2025-03-10 21:38:46,295 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 21:38:46,295 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 21:38:46,295 - src.engine.state - INFO - 玩家 ai_1 跟注 100 筹码，已标记为已行动
2025-03-10 21:38:46,296 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 21:38:46,296 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 21:38:46,296 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:38:46,296 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:38:46,296 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:46,297 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:38:46,297 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:38:46,297 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:38:46,297 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:46,297 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:46,297 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:46,297 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:38:46,298 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:38:46,298 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:38:46,298 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:38:46,298 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:38:46,298 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 400, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 910, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 100, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:38:46,299 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:46,299 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:46,299 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 21:38:46,299 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:38:46,299 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:38:46,300 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:38:46,300 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:38:46,300 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:46,301 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:46,302 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:46,303 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:38:46,304 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:38:46,304 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:38:46,304 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:38:46,304 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:38:46,305 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:38:56,062 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"240","confidence":"0.8"},"reasoning":{"hand_strength":"手牌A♦和Q♣，结合公共牌4♦, 8♦, J♦，形成了同花听牌和潜在的顺子听牌，手牌强度较高","position_analysis":"位置2，处于中位，可以观察后续玩家的行动，有一定的信息优势","pot_odds":"底池400，当前最大注100，加注到240，底池赔率合理，值得继续投资","opponent_reads":["ai_1多次跟注，可能持有中等强度的手牌","ai_4进行了加注，可能持有强牌或试图利用位置优势"]},"table_talk":{"message":"看来大家都很有信心，我也不能落后","tone":"自信"}}
2025-03-10 21:38:56,063 - src.agents.llm - INFO - ==================================================

2025-03-10 21:38:56,063 - src.agents.llm - INFO - 成功将字符串金额 240 转换为数字 240.0
2025-03-10 21:38:56,063 - src.agents.llm - INFO - 生成动作: RAISE 金额: 240 table_talk: {'message': '看来大家都很有信心，我也不能落后', 'tone': '自信'}
2025-03-10 21:38:56,063 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 240
2025-03-10 21:38:56,064 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 21:38:56,064 - src.engine.state - INFO - 玩家 ai_2 加注到 240 筹码，已标记为已行动
2025-03-10 21:38:56,064 - src.engine.game - INFO - 玩家 ai_2 加注到 240
2025-03-10 21:38:56,064 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 21:38:56,065 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:38:56,065 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:38:56,065 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:38:56,065 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 21:38:56,065 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 21:38:56,065 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 21:38:56,067 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:56,067 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:56,067 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:38:56,067 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:38:56,067 - src.engine.game - INFO - 玩家 ai_1 下注额(100)不等于最大下注额(240)，回合继续
2025-03-10 21:38:56,067 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:38:56,067 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:38:56,068 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 640, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 670, 'current_bet': 240, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 240}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 100, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来大家都很有信心，我也不能落后', 'tone': '自信'}}
2025-03-10 21:38:56,068 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:38:56,069 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:38:56,069 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:38:56,069 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:38:56,069 - src.engine.game - INFO - 玩家 ai_1 下注额(100)不等于最大下注额(240)，回合继续
2025-03-10 21:38:56,069 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:38:56,070 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:56,070 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:56,071 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:38:56,072 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:38:56,073 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:38:56,073 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:38:56,073 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:38:56,074 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:38:56,074 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:39:05,222 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"我手上只有A高牌和5，没有成型牌型。公共牌上有三张方块，我没有同花听牌，也没有顺子听牌。","position_analysis":"我在中间位置，前面已经有人加注，后面还有一个玩家要行动。","pot_odds":"当前底池640，我需要跟注240，底池赔率约为2.67:1，但我的胜率可能不到30%。","opponent_reads":["ai_2非常激进，从FLOP开始就持续加注，可能有强牌或同花听牌","ai_1一直跟注，可能有中等强度的牌或者抽牌","ai_4之前有加注行为，但面对ai_2的再加注选择了不行动"]},"table_talk":{"message":"这牌面太危险了，三张方块在公共区。我没有方块，只能放弃了。","tone":"谨慎"}}
2025-03-10 21:39:05,225 - src.agents.llm - INFO - ==================================================

2025-03-10 21:39:05,225 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌面太危险了，三张方块在公共区。我没有方块，只能放弃了。', 'tone': '谨慎'}
2025-03-10 21:39:05,225 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:39:05,226 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:39:05,226 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:39:05,226 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:39:05,226 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:39:05,226 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:39:05,227 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:39:05,227 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:05,227 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:39:05,227 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:39:05,227 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:39:05,228 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:39:05,228 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:39:05,228 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:05,228 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:39:05,228 - src.engine.game - INFO - 玩家 ai_1 下注额(100)不等于最大下注额(240)，回合继续
2025-03-10 21:39:05,229 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:39:05,229 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:39:05,229 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 640, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 670, 'current_bet': 240, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 100, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌面太危险了，三张方块在公共区。我没有方块，只能放弃了。', 'tone': '谨慎'}}
2025-03-10 21:39:05,230 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:39:05,230 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:39:05,230 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:05,231 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:39:05,231 - src.engine.game - INFO - 玩家 ai_1 下注额(100)不等于最大下注额(240)，回合继续
2025-03-10 21:39:05,231 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:39:05,231 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:05,232 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:05,232 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:05,232 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:39:05,233 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:39:05,233 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:39:05,233 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:39:05,233 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:39:05,233 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:39:27,911 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "CALL",
    "amount": "",
    "confidence": 0.7
  },
  "reasoning": {
    "hand_strength": "我有一对J，这在翻牌圈是相当不错的手牌。考虑到公共牌面有三张方片，可能存在同花听牌的风险，但我的对手们可能也在担心这一点。",
    "position_analysis": "我在较晚的位置行动，这意味着我可以基于其他玩家的动作来做出更明智的决定。鉴于ai_2刚刚进行了加注，显示出一定的强势，直接跟注可以让我以较低的成本看到转牌，同时保持我的筹码量。",
    "pot_odds": "当前底池为640，跟注需要支付额外140。即使考虑到底池赔率，这个价格对于尝试击中更好的牌来说还是合理的。",
    "opponent_reads": ["ai_1似乎对继续参与游戏持开放态度；ai_2则表现得更加激进，可能是持有强牌或试图通过加注施压。"]
  },
  "table_talk": {
    "message": "看来有人想要控制这个游戏了。好吧，让我们看看接下来会发生什么。",
    "tone": "轻松挑衅"
  }
}
2025-03-10 21:39:27,913 - src.agents.llm - INFO - ==================================================

2025-03-10 21:39:27,913 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来有人想要控制这个游戏了。好吧，让我们看看接下来会发生什么。', 'tone': '轻松挑衅'}
2025-03-10 21:39:27,913 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 21:39:27,913 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 21:39:27,913 - src.engine.state - INFO - 玩家 ai_4 跟注 140 筹码，已标记为已行动
2025-03-10 21:39:27,913 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 21:39:27,914 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 21:39:27,914 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:39:27,914 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:39:27,914 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:27,914 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-10 21:39:27,914 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_1
2025-03-10 21:39:27,915 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:39:27,915 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:39:27,915 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:39:27,915 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:27,915 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:39:27,915 - src.engine.game - INFO - 玩家 ai_1 下注额(100)不等于最大下注额(240)，回合继续
2025-03-10 21:39:27,915 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:39:27,915 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:39:27,915 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 780, 'community_cards': ['4♦', '8♦', 'J♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': True, 'cards': ('8♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 670, 'current_bet': 240, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 240, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '看来有人想要控制这个游戏了。好吧，让我们看看接下来会发生什么。', 'tone': '轻松挑衅'}}
2025-03-10 21:39:27,917 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:39:27,918 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 21:39:27,918 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:27,918 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 21:39:27,918 - src.engine.game - INFO - 玩家 ai_1 下注额(100)不等于最大下注额(240)，回合继续
2025-03-10 21:39:27,919 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:39:27,919 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:27,919 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:27,919 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:27,920 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:39:27,920 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:39:27,920 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:39:27,920 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:39:27,920 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:39:27,921 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:39:50,177 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "手牌只有一对八，加上弱九高，在这种比较激进的下注环境下显得实力不足。", "position_analysis": "处于位置1，行动处于较前位置，不利于观察对手动态。", "pot_odds": "底池较大，但投入的成本与手牌实际改善的可能性不成正比。", "opponent_reads": ["对手多次激进加注，显示出较强牌力或强烈攻击性，面对这样的牌局我的一对一般难以竞争。"]}, "table_talk": {"message": "看来今天你们都带来了好牌，我就退让一步，留点实力待下回合。", "tone": "冷静且略带讽刺"}}
2025-03-10 21:39:50,178 - src.agents.llm - INFO - ==================================================

2025-03-10 21:39:50,178 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天你们都带来了好牌，我就退让一步，留点实力待下回合。', 'tone': '冷静且略带讽刺'}
2025-03-10 21:39:50,179 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 21:39:50,179 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 21:39:50,179 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 21:39:50,179 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 21:39:50,179 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 21:39:50,179 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:39:50,179 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:39:50,180 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:50,180 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 21:39:50,180 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:39:50,180 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:39:50,180 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:39:50,181 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:39:50,181 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 21:39:50,181 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 21:39:50,181 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 21:39:50,182 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 21:39:50,182 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 21:39:50,182 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 21:39:50,182 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 21:39:50,182 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 21:39:50,182 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 21:39:50,182 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:39:50,182 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 21:39:50,184 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 21:39:50,184 - src.engine.dealer - INFO - Dealt 1 community cards: ['7♣']
2025-03-10 21:39:50,184 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['4♦', '8♦', 'J♦', '7♣']
2025-03-10 21:39:50,184 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_2', 2), ('ai_4', 4)]
2025-03-10 21:39:50,184 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 21:39:50,184 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 21:39:50,184 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 21:39:50,185 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 780, 'community_cards': ['4♦', '8♦', 'J♦', '7♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 670, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天你们都带来了好牌，我就退让一步，留点实力待下回合。', 'tone': '冷静且略带讽刺'}}
2025-03-10 21:39:50,185 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:39:50,185 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:39:50,186 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 21:39:50,186 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:39:50,186 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:39:50,186 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:39:50,186 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:50,187 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:50,187 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:39:50,188 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:39:50,188 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:39:50,188 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:39:50,189 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:39:50,189 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:39:50,189 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:40:07,331 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"500","confidence":0.8},"reasoning":{"hand_strength":"拥有顶对J，加上公共牌面有三张方块，存在同花听牌的可能性。考虑到我的手牌和潜在的赢率，这张牌还是有一定价值的。","position_analysis":"位于较后的位置，能够观察到对手的行为后再做决定，这给了我一定的信息优势。","pot_odds":"当前底池为780，加注至1280（包括我加注的500），考虑到可能存在的听牌机会以及已经形成的顶对，这个投资是合理的。","opponent_reads":["ai_2之前进行了较大的加注，显示出他们可能持有强牌或者在尝试施压。但是，基于他们的筹码量和之前的行动模式，我认为这是个好时机来测试他们的决心。"]},"table_talk":{"message":"看来大家都挺有信心啊，那我也得跟上步伐了！","tone":"轻松自信"}}
2025-03-10 21:40:07,331 - src.agents.llm - INFO - ==================================================

2025-03-10 21:40:07,331 - src.agents.llm - INFO - 成功将字符串金额 500 转换为数字 500.0
2025-03-10 21:40:07,333 - src.agents.llm - INFO - 生成动作: RAISE 金额: 500 table_talk: {'message': '看来大家都挺有信心啊，那我也得跟上步伐了！', 'tone': '轻松自信'}
2025-03-10 21:40:07,333 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 500
2025-03-10 21:40:07,333 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:40:07,333 - src.engine.state - INFO - 玩家 ai_4 加注到 500 筹码，已标记为已行动
2025-03-10 21:40:07,334 - src.engine.game - INFO - 玩家 ai_4 加注到 500
2025-03-10 21:40:07,334 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:40:07,334 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:40:07,335 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:40:07,335 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 21:40:07,335 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_2, 位置: 2
2025-03-10 21:40:07,335 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_2
2025-03-10 21:40:07,335 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:40:07,336 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:40:07,336 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:40:07,336 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 21:40:07,336 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:40:07,336 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:40:07,337 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:40:07,337 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:40:07,337 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 1280, 'community_cards': ['4♦', '8♦', 'J♦', '7♣'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 670, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 370, 'current_bet': 500, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 500}], 'table_talk': {'message': '看来大家都挺有信心啊，那我也得跟上步伐了！', 'tone': '轻松自信'}}
2025-03-10 21:40:07,338 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:40:07,338 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:40:07,338 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 21:40:07,338 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:40:07,338 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:40:07,339 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:40:07,339 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:07,339 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:07,340 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:07,340 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:40:07,341 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:40:07,341 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:40:07,341 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:40:07,341 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:40:07,342 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:40:16,717 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"ALL_IN","amount":670,"confidence":0.85},"reasoning":{"hand_strength":"手牌A♦和Q♣在当前公共牌4♦, 8♦, J♦, 7♣下，有潜力形成同花或高牌，手牌强度中等偏上。","position_analysis":"位置2处于中间位置，有利于观察其他玩家的行动，做出更有利的决策。","pot_odds":"底池1280，当前最大注500，我的筹码670，全下可以获得较大的底池回报。","opponent_reads":["对手ai_4多次加注，显示出较强的牌力，但我的全下可能会迫使其弃牌或冒险跟注。"]},"table_talk":{"message":"看来你很有信心，但我也不甘示弱，全下！","tone":"自信且挑衅"}}
2025-03-10 21:40:16,718 - src.agents.llm - INFO - ==================================================

2025-03-10 21:40:16,718 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 670 table_talk: {'message': '看来你很有信心，但我也不甘示弱，全下！', 'tone': '自信且挑衅'}
2025-03-10 21:40:16,719 - server - INFO - AI玩家 ai_2 决定执行动作: ALL_IN, 金额: 670
2025-03-10 21:40:16,719 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.ALL_IN
2025-03-10 21:40:16,719 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_2
2025-03-10 21:40:16,719 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:40:16,720 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:40:16,720 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 21:40:16,720 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 21:40:16,720 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:40:16,721 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:40:16,721 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:40:16,721 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:40:16,721 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 21:40:16,721 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:40:16,722 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:40:16,722 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:40:16,722 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:40:16,722 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 1280, 'community_cards': ['4♦', '8♦', 'J♦', '7♣'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 100, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 670, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'ALL_IN', 'last_amount': 670}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 370, 'current_bet': 500, 'is_active': True, 'cards': ('9♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你很有信心，但我也不甘示弱，全下！', 'tone': '自信且挑衅'}}
2025-03-10 21:40:16,723 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:40:16,723 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 21:40:16,723 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 21:40:16,724 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:40:16,724 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:40:16,724 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:40:16,724 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:16,725 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:16,725 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:21,721 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:21,723 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:21,725 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:26,726 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:26,728 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:26,729 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:31,724 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:31,726 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:31,728 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:36,704 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:36,706 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:36,709 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:41,716 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:41,716 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:41,717 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:46,731 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:46,732 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:46,733 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:51,748 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:51,748 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:51,748 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:56,758 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:56,758 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:40:56,759 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:01,776 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:01,777 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:01,778 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:06,784 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:06,784 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:06,785 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:11,783 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:11,787 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:11,788 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:16,799 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:16,799 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:16,799 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:21,801 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:21,803 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:21,804 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:26,811 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:26,811 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:26,812 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:31,825 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:31,827 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:31,829 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:36,848 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:36,851 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:36,854 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:41,852 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:41,852 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:41,853 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:46,870 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:46,870 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:46,871 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:51,856 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:51,856 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:51,857 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:56,875 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:56,876 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:41:56,876 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:01,892 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:01,896 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:01,898 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:06,907 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:06,908 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:06,908 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:11,930 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:11,930 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:11,930 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:16,911 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:16,911 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:16,911 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:21,922 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:21,922 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:21,922 - server - ERROR - 发送游戏状态时出错: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-03-10 21:42:30,877 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:42:30,881 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:42:42,044 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:42:42,048 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:42:56,574 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:42:56,578 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:43:53,843 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:43:54,298 - server - INFO - 正在创建游戏: bc7ac6e4-8e65-4659-854c-55cfc3419ace, 玩家数量: 5
2025-03-10 21:43:54,299 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:43:54,300 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:43:54,301 - src.engine.game - INFO - 游戏 bc7ac6e4-8e65-4659-854c-55cfc3419ace 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:43:54,301 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:43:54,302 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:43:54,303 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:43:54,305 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:43:54,306 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:43:54,306 - src.engine.game - INFO - Added player ai_1 to game bc7ac6e4-8e65-4659-854c-55cfc3419ace
2025-03-10 21:43:54,307 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:43:54,308 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:43:54,310 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:43:54,311 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:43:54,311 - src.engine.game - INFO - Added player ai_2 to game bc7ac6e4-8e65-4659-854c-55cfc3419ace
2025-03-10 21:43:54,311 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:43:54,313 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:43:54,315 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:43:54,316 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:43:54,317 - src.engine.game - INFO - Added player ai_3 to game bc7ac6e4-8e65-4659-854c-55cfc3419ace
2025-03-10 21:43:54,317 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:43:54,318 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:43:54,321 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:43:54,321 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:43:54,322 - src.engine.game - INFO - Added player ai_4 to game bc7ac6e4-8e65-4659-854c-55cfc3419ace
2025-03-10 21:43:54,322 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:43:54,322 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:43:54,323 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:43:54,323 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♠', 'J♥')
2025-03-10 21:43:54,324 - src.engine.game - INFO - 玩家 ai_1 手牌: ('J♠', 'Q♥')
2025-03-10 21:43:54,325 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♥', '10♣')
2025-03-10 21:43:54,325 - src.engine.game - INFO - 玩家 ai_3 手牌: ('A♣', '6♣')
2025-03-10 21:43:54,326 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♣', '8♥')
2025-03-10 21:43:54,326 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:43:54,327 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:43:54,327 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:43:54,328 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:43:54,329 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:43:54,329 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:43:54,329 - src.engine.game - INFO - 游戏 bc7ac6e4-8e65-4659-854c-55cfc3419ace 开始，进入翻牌前阶段
2025-03-10 21:43:54,330 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:43:54,330 - server - INFO - 游戏 bc7ac6e4-8e65-4659-854c-55cfc3419ace 已开始
2025-03-10 21:43:54,331 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:43:54,442 - server - INFO - WebSocket连接已建立: bc7ac6e4-8e65-4659-854c-55cfc3419ace
2025-03-10 21:43:54,442 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'J♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('J♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '10♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '6♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♣', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:43:54,443 - server - ERROR - 发送游戏状态到玩家 type 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:43:54,443 - server - ERROR - 发送游戏状态到玩家 asgi 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:43:54,443 - server - ERROR - 发送游戏状态到玩家 http_version 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:43:54,444 - server - ERROR - 发送游戏状态到玩家 scheme 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:43:54,444 - server - ERROR - 发送游戏状态到玩家 server 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:43:54,445 - server - ERROR - 发送游戏状态到玩家 client 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:43:54,445 - server - ERROR - 发送游戏状态到玩家 root_path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:43:54,446 - server - ERROR - 发送游戏状态到玩家 path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:43:54,446 - server - ERROR - 发送游戏状态到玩家 raw_path 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:43:54,447 - server - ERROR - 发送游戏状态到玩家 query_string 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:43:54,447 - server - ERROR - 发送游戏状态到玩家 headers 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:43:54,447 - server - ERROR - 发送游戏状态到玩家 subprotocols 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:43:54,448 - server - ERROR - 发送游戏状态到玩家 state 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:43:54,448 - server - ERROR - 发送游戏状态到玩家 extensions 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:43:54,449 - server - ERROR - 发送游戏状态到玩家 app 时出错: 'FastAPI' object has no attribute 'send_json'
2025-03-10 21:43:54,449 - server - ERROR - 发送游戏状态到玩家 starlette.exception_handlers 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:43:54,449 - server - ERROR - 发送游戏状态到玩家 router 时出错: 'APIRouter' object has no attribute 'send_json'
2025-03-10 21:43:54,450 - server - ERROR - 发送游戏状态到玩家 endpoint 时出错: 'function' object has no attribute 'send_json'
2025-03-10 21:43:54,450 - server - ERROR - 发送游戏状态到玩家 path_params 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:43:54,451 - server - ERROR - 发送游戏状态到玩家 route 时出错: 'APIWebSocketRoute' object has no attribute 'send_json'
2025-03-10 21:43:54,452 - server - ERROR - 发送游戏状态到玩家 fastapi_astack 时出错: 'AsyncExitStack' object has no attribute 'send_json'
2025-03-10 21:43:54,452 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,452 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,452 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,453 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,454 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,454 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,455 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,455 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,456 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,456 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,457 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,457 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,458 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,458 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,459 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,459 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,460 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,460 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,460 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,461 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,461 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:43:54,462 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:43:54,462 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:43:54,463 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:43:54,463 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:43:54,464 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:43:54,464 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:44:03,829 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":20,"confidence":0.7},"reasoning":{"hand_strength":"A♣6♣是一手中等强度的起手牌。A高牌有价值，同花潜力提供了一定的后续发展空间。","position_analysis":"我在位置3，属于中间位置，不是特别有利的位置。在这个位置上应该相对谨慎。","pot_odds":"当前底池30，我需要投入20筹码，底池赔率为1.5:1，考虑到我有A高牌和同花潜力，值得跟注观察翻牌。","opponent_reads":["ai_2已经加注到20，显示出一定的强度，但这在前期是标准的抬注","ai_1只是跟注小盲，没有表现出特别强的手牌","其他玩家尚未行动，需要保持警惕"]},"table_talk":{"message":"让我们看看翻牌会带来什么惊喜。","tone":"平静自信"}}
2025-03-10 21:44:03,830 - src.agents.llm - INFO - ==================================================

2025-03-10 21:44:03,832 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我们看看翻牌会带来什么惊喜。', 'tone': '平静自信'}
2025-03-10 21:44:03,832 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 21:44:03,833 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 21:44:03,833 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-03-10 21:44:03,834 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 21:44:03,834 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 21:44:03,835 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:44:03,835 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:44:03,836 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:44:03,836 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:44:03,837 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:44:03,837 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:44:03,837 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:44:03,838 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:44:03,838 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:44:03,839 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:44:03,839 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:44:03,840 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:44:03,840 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:44:03,841 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'J♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('J♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '10♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♣', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '让我们看看翻牌会带来什么惊喜。', 'tone': '平静自信'}}
2025-03-10 21:44:03,842 - server - ERROR - 发送游戏状态到玩家 type 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:03,842 - server - ERROR - 发送游戏状态到玩家 asgi 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:03,843 - server - ERROR - 发送游戏状态到玩家 http_version 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:03,843 - server - ERROR - 发送游戏状态到玩家 scheme 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:03,843 - server - ERROR - 发送游戏状态到玩家 server 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:03,844 - server - ERROR - 发送游戏状态到玩家 client 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:03,845 - server - ERROR - 发送游戏状态到玩家 root_path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:03,845 - server - ERROR - 发送游戏状态到玩家 path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:03,846 - server - ERROR - 发送游戏状态到玩家 raw_path 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:03,846 - server - ERROR - 发送游戏状态到玩家 query_string 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:03,847 - server - ERROR - 发送游戏状态到玩家 headers 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:03,847 - server - ERROR - 发送游戏状态到玩家 subprotocols 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:03,848 - server - ERROR - 发送游戏状态到玩家 state 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:03,848 - server - ERROR - 发送游戏状态到玩家 extensions 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:03,848 - server - ERROR - 发送游戏状态到玩家 app 时出错: 'FastAPI' object has no attribute 'send_json'
2025-03-10 21:44:03,849 - server - ERROR - 发送游戏状态到玩家 starlette.exception_handlers 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:03,851 - server - ERROR - 发送游戏状态到玩家 router 时出错: 'APIRouter' object has no attribute 'send_json'
2025-03-10 21:44:03,852 - server - ERROR - 发送游戏状态到玩家 endpoint 时出错: 'function' object has no attribute 'send_json'
2025-03-10 21:44:03,853 - server - ERROR - 发送游戏状态到玩家 path_params 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:03,853 - server - ERROR - 发送游戏状态到玩家 route 时出错: 'APIWebSocketRoute' object has no attribute 'send_json'
2025-03-10 21:44:03,854 - server - ERROR - 发送游戏状态到玩家 fastapi_astack 时出错: 'AsyncExitStack' object has no attribute 'send_json'
2025-03-10 21:44:03,855 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,855 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,857 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,858 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,858 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,859 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,859 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,860 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,861 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,861 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,862 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,863 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,864 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,865 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,865 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,865 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,866 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,867 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,867 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,870 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,871 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:03,871 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:44:03,872 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:44:03,873 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:44:03,873 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:44:03,873 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:44:03,874 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:44:14,766 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:44:14,770 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:44:20,864 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:44:20,939 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:44:22,687 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:44:23,046 - server - INFO - 正在创建游戏: acdc092c-9faf-4433-b255-6727d5b64add, 玩家数量: 5
2025-03-10 21:44:23,047 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:44:23,047 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:44:23,048 - src.engine.game - INFO - 游戏 acdc092c-9faf-4433-b255-6727d5b64add 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:44:23,048 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:44:23,048 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:44:23,049 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:44:23,050 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:44:23,051 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:44:23,051 - src.engine.game - INFO - Added player ai_1 to game acdc092c-9faf-4433-b255-6727d5b64add
2025-03-10 21:44:23,051 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:44:23,051 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:44:23,053 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:44:23,053 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:44:23,053 - src.engine.game - INFO - Added player ai_2 to game acdc092c-9faf-4433-b255-6727d5b64add
2025-03-10 21:44:23,053 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:44:23,054 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:44:23,055 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:44:23,056 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:44:23,056 - src.engine.game - INFO - Added player ai_3 to game acdc092c-9faf-4433-b255-6727d5b64add
2025-03-10 21:44:23,056 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:44:23,056 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:44:23,058 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:44:23,058 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:44:23,058 - src.engine.game - INFO - Added player ai_4 to game acdc092c-9faf-4433-b255-6727d5b64add
2025-03-10 21:44:23,059 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:44:23,059 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:44:23,059 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:44:23,059 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♠', 'K♠')
2025-03-10 21:44:23,059 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♦', 'J♥')
2025-03-10 21:44:23,060 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♥', '4♣')
2025-03-10 21:44:23,060 - src.engine.game - INFO - 玩家 ai_3 手牌: ('2♣', '5♥')
2025-03-10 21:44:23,060 - src.engine.game - INFO - 玩家 ai_4 手牌: ('3♣', 'A♦')
2025-03-10 21:44:23,060 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:44:23,060 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:44:23,060 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:44:23,060 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:44:23,060 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:44:23,061 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:44:23,061 - src.engine.game - INFO - 游戏 acdc092c-9faf-4433-b255-6727d5b64add 开始，进入翻牌前阶段
2025-03-10 21:44:23,061 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:44:23,061 - server - INFO - 游戏 acdc092c-9faf-4433-b255-6727d5b64add 已开始
2025-03-10 21:44:23,061 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:44:23,471 - server - INFO - WebSocket连接已建立: acdc092c-9faf-4433-b255-6727d5b64add
2025-03-10 21:44:23,472 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♠', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '4♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♣', '5♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('3♣', 'A♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:44:23,473 - server - ERROR - 发送游戏状态到玩家 type 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:23,473 - server - ERROR - 发送游戏状态到玩家 asgi 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:23,474 - server - ERROR - 发送游戏状态到玩家 http_version 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:23,474 - server - ERROR - 发送游戏状态到玩家 scheme 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:23,474 - server - ERROR - 发送游戏状态到玩家 server 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:23,474 - server - ERROR - 发送游戏状态到玩家 client 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:23,475 - server - ERROR - 发送游戏状态到玩家 root_path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:23,475 - server - ERROR - 发送游戏状态到玩家 path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:23,475 - server - ERROR - 发送游戏状态到玩家 raw_path 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:23,475 - server - ERROR - 发送游戏状态到玩家 query_string 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:23,476 - server - ERROR - 发送游戏状态到玩家 headers 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:23,476 - server - ERROR - 发送游戏状态到玩家 subprotocols 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:23,476 - server - ERROR - 发送游戏状态到玩家 state 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:23,476 - server - ERROR - 发送游戏状态到玩家 extensions 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:23,476 - server - ERROR - 发送游戏状态到玩家 app 时出错: 'FastAPI' object has no attribute 'send_json'
2025-03-10 21:44:23,477 - server - ERROR - 发送游戏状态到玩家 starlette.exception_handlers 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:23,477 - server - ERROR - 发送游戏状态到玩家 router 时出错: 'APIRouter' object has no attribute 'send_json'
2025-03-10 21:44:23,477 - server - ERROR - 发送游戏状态到玩家 endpoint 时出错: 'function' object has no attribute 'send_json'
2025-03-10 21:44:23,477 - server - ERROR - 发送游戏状态到玩家 path_params 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:23,478 - server - ERROR - 发送游戏状态到玩家 route 时出错: 'APIWebSocketRoute' object has no attribute 'send_json'
2025-03-10 21:44:23,478 - server - ERROR - 发送游戏状态到玩家 fastapi_astack 时出错: 'AsyncExitStack' object has no attribute 'send_json'
2025-03-10 21:44:23,478 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,478 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,479 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,479 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,479 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,479 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,480 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,480 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,480 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,481 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,481 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,481 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,482 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,482 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,482 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,482 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,483 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,483 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,484 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,484 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,484 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:23,484 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:44:23,485 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:44:23,485 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:44:23,485 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:44:23,486 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:44:23,486 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:44:31,370 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"2♣, 5♥是非常弱的起手牌，在德州扑克中属于最差的10%手牌。没有同花可能，没有顺子可能，没有高牌价值。","position_analysis":"我处于早期位置(位置3)，这是一个不利的位置，因为在我之后还有至少一名玩家要行动，增加了我被再次加注的风险。","pot_odds":"当前底池30，需要下注20才能继续游戏，底池赔率为1.5:1，而我的手牌获胜概率远低于这个数值。","opponent_reads":["ai_2已经加注到20，显示出一定的强势","我的手牌极弱，即使跟注也很难在后续回合有好的发展"]},"table_talk":{"message":"这手牌不值得浪费筹码，聪明的选择是知道何时该退出。","tone":"冷静"}}
2025-03-10 21:44:31,371 - src.agents.llm - INFO - ==================================================

2025-03-10 21:44:31,372 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不值得浪费筹码，聪明的选择是知道何时该退出。', 'tone': '冷静'}
2025-03-10 21:44:31,372 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:44:31,372 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:44:31,373 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:44:31,373 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:44:31,373 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:44:31,373 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:44:31,374 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:44:31,374 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:44:31,374 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:44:31,374 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:44:31,374 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:44:31,374 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:44:31,374 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:44:31,375 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:44:31,375 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:44:31,375 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:44:31,375 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:44:31,375 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:44:31,376 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♠', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '4♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('3♣', 'A♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不值得浪费筹码，聪明的选择是知道何时该退出。', 'tone': '冷静'}}
2025-03-10 21:44:31,376 - server - ERROR - 发送游戏状态到玩家 type 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:31,376 - server - ERROR - 发送游戏状态到玩家 asgi 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:31,376 - server - ERROR - 发送游戏状态到玩家 http_version 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:31,377 - server - ERROR - 发送游戏状态到玩家 scheme 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:31,377 - server - ERROR - 发送游戏状态到玩家 server 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:31,377 - server - ERROR - 发送游戏状态到玩家 client 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:31,377 - server - ERROR - 发送游戏状态到玩家 root_path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:31,377 - server - ERROR - 发送游戏状态到玩家 path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:31,377 - server - ERROR - 发送游戏状态到玩家 raw_path 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 query_string 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 headers 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 subprotocols 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 state 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 extensions 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 app 时出错: 'FastAPI' object has no attribute 'send_json'
2025-03-10 21:44:31,378 - server - ERROR - 发送游戏状态到玩家 starlette.exception_handlers 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:31,379 - server - ERROR - 发送游戏状态到玩家 router 时出错: 'APIRouter' object has no attribute 'send_json'
2025-03-10 21:44:31,379 - server - ERROR - 发送游戏状态到玩家 endpoint 时出错: 'function' object has no attribute 'send_json'
2025-03-10 21:44:31,379 - server - ERROR - 发送游戏状态到玩家 path_params 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:31,379 - server - ERROR - 发送游戏状态到玩家 route 时出错: 'APIWebSocketRoute' object has no attribute 'send_json'
2025-03-10 21:44:31,379 - server - ERROR - 发送游戏状态到玩家 fastapi_astack 时出错: 'AsyncExitStack' object has no attribute 'send_json'
2025-03-10 21:44:31,380 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,380 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,380 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,380 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,380 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,380 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,381 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,381 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,381 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,381 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,382 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,382 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,382 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,382 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,382 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,383 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,383 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,383 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,383 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,383 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,383 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:31,384 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:44:31,384 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:44:31,384 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:44:31,384 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:44:31,384 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:44:31,384 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:44:36,398 - server - ERROR - 发送游戏状态到玩家 type 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:36,398 - server - ERROR - 发送游戏状态到玩家 asgi 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:36,398 - server - ERROR - 发送游戏状态到玩家 http_version 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:36,398 - server - ERROR - 发送游戏状态到玩家 scheme 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:36,398 - server - ERROR - 发送游戏状态到玩家 server 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:36,398 - server - ERROR - 发送游戏状态到玩家 client 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:36,399 - server - ERROR - 发送游戏状态到玩家 root_path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:36,399 - server - ERROR - 发送游戏状态到玩家 path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:36,399 - server - ERROR - 发送游戏状态到玩家 raw_path 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:36,399 - server - ERROR - 发送游戏状态到玩家 query_string 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:36,399 - server - ERROR - 发送游戏状态到玩家 headers 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:36,399 - server - ERROR - 发送游戏状态到玩家 subprotocols 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 state 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 extensions 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 app 时出错: 'FastAPI' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 starlette.exception_handlers 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 router 时出错: 'APIRouter' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 endpoint 时出错: 'function' object has no attribute 'send_json'
2025-03-10 21:44:36,400 - server - ERROR - 发送游戏状态到玩家 path_params 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:36,401 - server - ERROR - 发送游戏状态到玩家 route 时出错: 'APIWebSocketRoute' object has no attribute 'send_json'
2025-03-10 21:44:36,401 - server - ERROR - 发送游戏状态到玩家 fastapi_astack 时出错: 'AsyncExitStack' object has no attribute 'send_json'
2025-03-10 21:44:36,401 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,401 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,401 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,401 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,401 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,402 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,402 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,402 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,402 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,402 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,403 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,403 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,403 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,403 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,403 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,404 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,404 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,404 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,404 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,404 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:36,404 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,429 - server - ERROR - 发送游戏状态到玩家 type 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:41,429 - server - ERROR - 发送游戏状态到玩家 asgi 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:41,429 - server - ERROR - 发送游戏状态到玩家 http_version 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:41,430 - server - ERROR - 发送游戏状态到玩家 scheme 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:41,430 - server - ERROR - 发送游戏状态到玩家 server 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:41,430 - server - ERROR - 发送游戏状态到玩家 client 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:41,430 - server - ERROR - 发送游戏状态到玩家 root_path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:41,431 - server - ERROR - 发送游戏状态到玩家 path 时出错: 'str' object has no attribute 'send_json'
2025-03-10 21:44:41,431 - server - ERROR - 发送游戏状态到玩家 raw_path 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:41,431 - server - ERROR - 发送游戏状态到玩家 query_string 时出错: 'bytes' object has no attribute 'send_json'
2025-03-10 21:44:41,431 - server - ERROR - 发送游戏状态到玩家 headers 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:41,431 - server - ERROR - 发送游戏状态到玩家 subprotocols 时出错: 'list' object has no attribute 'send_json'
2025-03-10 21:44:41,432 - server - ERROR - 发送游戏状态到玩家 state 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:41,432 - server - ERROR - 发送游戏状态到玩家 extensions 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:41,432 - server - ERROR - 发送游戏状态到玩家 app 时出错: 'FastAPI' object has no attribute 'send_json'
2025-03-10 21:44:41,432 - server - ERROR - 发送游戏状态到玩家 starlette.exception_handlers 时出错: 'tuple' object has no attribute 'send_json'
2025-03-10 21:44:41,433 - server - ERROR - 发送游戏状态到玩家 router 时出错: 'APIRouter' object has no attribute 'send_json'
2025-03-10 21:44:41,433 - server - ERROR - 发送游戏状态到玩家 endpoint 时出错: 'function' object has no attribute 'send_json'
2025-03-10 21:44:41,433 - server - ERROR - 发送游戏状态到玩家 path_params 时出错: 'dict' object has no attribute 'send_json'
2025-03-10 21:44:41,433 - server - ERROR - 发送游戏状态到玩家 route 时出错: 'APIWebSocketRoute' object has no attribute 'send_json'
2025-03-10 21:44:41,433 - server - ERROR - 发送游戏状态到玩家 fastapi_astack 时出错: 'AsyncExitStack' object has no attribute 'send_json'
2025-03-10 21:44:41,433 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,434 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,434 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,434 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,434 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,434 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,434 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,435 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,435 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,435 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,435 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,435 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,436 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,437 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:44:41,437 - server - ERROR - 清理断开连接时出错: disconnect() takes 2 positional arguments but 3 were given
2025-03-10 21:48:41,926 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:48:41,930 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:48:47,665 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 21:48:47,669 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 21:48:48,731 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 21:48:49,118 - server - INFO - 正在创建游戏: 45b89217-2954-4e9b-a84a-f6f014639d91, 玩家数量: 5
2025-03-10 21:48:49,119 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 21:48:49,119 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 21:48:49,120 - src.engine.game - INFO - 游戏 45b89217-2954-4e9b-a84a-f6f014639d91 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 21:48:49,120 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 21:48:49,121 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 21:48:49,121 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:48:49,123 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 21:48:49,124 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 21:48:49,124 - src.engine.game - INFO - Added player ai_1 to game 45b89217-2954-4e9b-a84a-f6f014639d91
2025-03-10 21:48:49,124 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 21:48:49,124 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:48:49,125 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 21:48:49,126 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 21:48:49,126 - src.engine.game - INFO - Added player ai_2 to game 45b89217-2954-4e9b-a84a-f6f014639d91
2025-03-10 21:48:49,126 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 21:48:49,127 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:48:49,129 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 21:48:49,129 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 21:48:49,129 - src.engine.game - INFO - Added player ai_3 to game 45b89217-2954-4e9b-a84a-f6f014639d91
2025-03-10 21:48:49,130 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:48:49,131 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 21:48:49,133 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 21:48:49,134 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 21:48:49,134 - src.engine.game - INFO - Added player ai_4 to game 45b89217-2954-4e9b-a84a-f6f014639d91
2025-03-10 21:48:49,135 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 21:48:49,135 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 21:48:49,135 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 21:48:49,135 - src.engine.game - INFO - 玩家 player_0 手牌: ('J♠', '10♠')
2025-03-10 21:48:49,135 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♠', '5♣')
2025-03-10 21:48:49,136 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♦', '8♦')
2025-03-10 21:48:49,136 - src.engine.game - INFO - 玩家 ai_3 手牌: ('K♣', '3♣')
2025-03-10 21:48:49,136 - src.engine.game - INFO - 玩家 ai_4 手牌: ('9♣', 'J♣')
2025-03-10 21:48:49,136 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 21:48:49,137 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 21:48:49,137 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 21:48:49,137 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 21:48:49,137 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 21:48:49,137 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 21:48:49,138 - src.engine.game - INFO - 游戏 45b89217-2954-4e9b-a84a-f6f014639d91 开始，进入翻牌前阶段
2025-03-10 21:48:49,138 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 21:48:49,138 - server - INFO - 游戏 45b89217-2954-4e9b-a84a-f6f014639d91 已开始
2025-03-10 21:48:49,138 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 21:48:49,494 - server - INFO - WebSocket连接已建立: 游戏=45b89217-2954-4e9b-a84a-f6f014639d91, 玩家=player_4224
2025-03-10 21:48:49,494 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♠', '10♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♠', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '3♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', 'J♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:48:49,496 - server - INFO - 当前AI玩家: ai_3
2025-03-10 21:48:49,496 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 21:48:49,496 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 21:48:49,497 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:48:49,497 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:48:49,497 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 21:48:57,374 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"K♣3♣是一手较弱的起手牌，虽然同花，但牌间距离大，连接性差，很难形成强牌。","position_analysis":"我在第3位置，已经有人在我前面加注，且我的位置不是很晚，后面还有玩家要行动。","pot_odds":"当前底池30，需要下注20，底池赔率为1.5:1，不足以支持我用这手牌跟注。","opponent_reads":["ai_2已经加注到20，显示出一定的强度","我的位置不利，后面还有玩家可能再次加注"]},"table_talk":{"message":"这手牌不太行，留着筹码打更好的牌吧。","tone":"平静"}}
2025-03-10 21:48:57,375 - src.agents.llm - INFO - ==================================================

2025-03-10 21:48:57,375 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太行，留着筹码打更好的牌吧。', 'tone': '平静'}
2025-03-10 21:48:57,376 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 21:48:57,376 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 21:48:57,378 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 21:48:57,379 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 21:48:57,379 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 21:48:57,380 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 21:48:57,380 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 21:48:57,381 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:48:57,381 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 21:48:57,382 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 21:48:57,382 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 21:48:57,383 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:48:57,383 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:48:57,384 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:48:57,385 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:48:57,386 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:48:57,386 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:48:57,386 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:48:57,387 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♠', '10♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♠', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', 'J♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太行，留着筹码打更好的牌吧。', 'tone': '平静'}}
2025-03-10 21:48:57,389 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:48:57,389 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:48:57,390 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 21:48:57,390 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:48:57,390 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:48:57,391 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:02,410 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:02,411 - server - INFO - 当前AI玩家: ai_4
2025-03-10 21:49:02,412 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 21:49:02,412 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 21:49:02,412 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:49:02,413 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:49:02,414 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 21:49:18,417 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"持有同花色的9和J，虽然不是非常强的手牌，但具有一定的潜力。考虑到位置较好，可以尝试控制底池大小同时观察对手反应。","position_analysis":"处于较晚的位置，有利于根据前面玩家的行为做出更灵活的决策。","pot_odds":"当前加注后，即使被跟注，底池赔率也相对有利。","opponent_reads":["ai_1只进行了小额下注，可能手牌不强；ai_2加注到最大注，显示出一定强度或试图展现强势。"]},"table_talk":{"message":"看来大家都挺谨慎的嘛，我这里有点小想法，咱们来点刺激的如何？","tone":"轻松自信"}}
2025-03-10 21:49:18,418 - src.agents.llm - INFO - ==================================================

2025-03-10 21:49:18,419 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺谨慎的嘛，我这里有点小想法，咱们来点刺激的如何？', 'tone': '轻松自信'}
2025-03-10 21:49:18,420 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 21:49:18,420 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 21:49:18,422 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 21:49:18,422 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 21:49:18,422 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 21:49:18,423 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 21:49:18,424 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 21:49:18,424 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:49:18,425 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 21:49:18,425 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 21:49:18,426 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 21:49:18,426 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:49:18,427 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:49:18,427 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:49:18,428 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:49:18,428 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:49:18,429 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:18,429 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:49:18,429 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♠', '10♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♠', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('9♣', 'J♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺谨慎的嘛，我这里有点小想法，咱们来点刺激的如何？', 'tone': '轻松自信'}}
2025-03-10 21:49:18,431 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:49:18,431 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:49:18,432 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 21:49:18,432 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 21:49:18,433 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 21:49:18,433 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:18,434 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:23,438 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:28,450 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:33,470 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:38,488 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:39,438 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 1000}
2025-03-10 21:49:39,439 - server - INFO - 收到加注请求，金额: 1000
2025-03-10 21:49:39,439 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 1000, 'timestamp': '2025-03-10T21:49:39.439950', 'table_talk': None}
2025-03-10 21:49:39,440 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 21:49:39,441 - src.engine.state - INFO - 玩家 player_0 加注到 1000 筹码，已标记为已行动
2025-03-10 21:49:39,442 - src.engine.game - INFO - 玩家 player_0 加注到 1000
2025-03-10 21:49:39,444 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 21:49:39,444 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 21:49:39,444 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 21:49:39,445 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:49:39,445 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 21:49:39,446 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 21:49:39,446 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 21:49:39,447 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:49:39,448 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:49:39,448 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:49:39,450 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=False
2025-03-10 21:49:39,451 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:49:39,452 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:49:39,454 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:39,455 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:49:39,458 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 1090, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 1000, 'is_active': True, 'cards': ('J♠', '10♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 1000}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♠', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('9♣', 'J♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 21:49:39,461 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:49:39,462 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 21:49:39,462 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:49:39,463 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=False
2025-03-10 21:49:39,464 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 21:49:39,467 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 21:49:39,468 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:43,492 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:43,493 - server - INFO - 当前AI玩家: ai_1
2025-03-10 21:49:43,493 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 21:49:43,494 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 21:49:43,494 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:49:43,495 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:49:43,495 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 21:49:56,629 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌Q♠,5♣整体实力较弱，缺乏成牌潜力", "position_analysis": "位置较靠前，且在对手激进行动下处于劣势", "pot_odds": "面对对手巨额下注，我需投入超过自己筹码的资金，风险远大于回报", "opponent_reads": ["player_0已全下显示强烈进攻信号", "ai_4的小额加注不构成足够威胁"]}, "table_talk": {"message": "看来今晚的牌局不属于我，我选择保留实力，等待更好的机会。", "tone": "冷静且略带不屑"}}
2025-03-10 21:49:56,631 - src.agents.llm - INFO - ==================================================

2025-03-10 21:49:56,631 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今晚的牌局不属于我，我选择保留实力，等待更好的机会。', 'tone': '冷静且略带不屑'}
2025-03-10 21:49:56,632 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 21:49:56,632 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 21:49:56,633 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 21:49:56,633 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 21:49:56,634 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 21:49:56,634 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 21:49:56,635 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 21:49:56,635 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:49:56,636 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 21:49:56,636 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 21:49:56,637 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 21:49:56,637 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:49:56,637 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_4']
2025-03-10 21:49:56,638 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:49:56,638 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=False
2025-03-10 21:49:56,639 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:49:56,639 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:49:56,640 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:56,640 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:49:56,641 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 1090, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 1000, 'is_active': True, 'cards': ('J♠', '10♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('9♣', 'J♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今晚的牌局不属于我，我选择保留实力，等待更好的机会。', 'tone': '冷静且略带不屑'}}
2025-03-10 21:49:56,642 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:49:56,643 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_4']
2025-03-10 21:49:56,643 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:49:56,644 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=False
2025-03-10 21:49:56,644 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 21:49:56,645 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 21:49:56,645 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 21:49:56,646 - server - ERROR - 无效的JSON消息
2025-03-10 21:49:56,647 - server - INFO - 当前AI玩家: ai_2
2025-03-10 21:49:56,648 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 21:49:56,648 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 21:49:56,649 - src.agents.llm - INFO - 
==================================================
2025-03-10 21:49:56,649 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 21:49:56,650 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 21:50:03,713 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌6♦, 8♦在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，难以控制后续行动","pot_odds":"底池赔率不理想，跟注或加注的风险过高","opponent_reads":["player_0进行了大幅加注，显示出强牌或诈唬意图","ai_4的加注较小，可能是在试探或保护手牌"]},"table_talk":{"message":"看来你们这局玩得挺大，我选择退出","tone":"轻松"}}
2025-03-10 21:50:03,715 - src.agents.llm - INFO - ==================================================

2025-03-10 21:50:03,716 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们这局玩得挺大，我选择退出', 'tone': '轻松'}
2025-03-10 21:50:03,717 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 21:50:03,718 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 21:50:03,718 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 21:50:03,719 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 21:50:03,719 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 21:50:03,720 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 21:50:03,720 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 21:50:03,721 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 21:50:03,722 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 21:50:03,722 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:50:03,723 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:50:03,723 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:50:03,724 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=False
2025-03-10 21:50:03,724 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:50:03,725 - src.engine.game - INFO - 玩家 ai_4 下注额(60)不等于最大下注额(1000)，回合继续
2025-03-10 21:50:03,725 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:50:03,725 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 21:50:03,726 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 1090, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 1000, 'is_active': True, 'cards': ('J♠', '10♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('9♣', 'J♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们这局玩得挺大，我选择退出', 'tone': '轻松'}}
2025-03-10 21:50:03,727 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 21:50:03,728 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 21:50:03,728 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 21:50:03,729 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=False
2025-03-10 21:50:03,729 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 21:50:03,730 - src.engine.game - INFO - 玩家 ai_4 下注额(60)不等于最大下注额(1000)，回合继续
2025-03-10 21:50:03,731 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 21:50:03,732 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:08,752 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:13,778 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:18,784 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:23,797 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:28,824 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:33,817 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:38,827 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:43,845 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:48,859 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:53,872 - server - ERROR - 无效的JSON消息
2025-03-10 21:50:58,877 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:03,882 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:08,895 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:13,898 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:18,910 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:23,928 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:28,937 - server - ERROR - 无效的JSON消息
2025-03-10 21:51:31,682 - server - INFO - WebSocket连接断开: game_id=45b89217-2954-4e9b-a84a-f6f014639d91, player_id=ai_4
2025-03-10 22:03:00,538 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:03:00,542 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:03:06,503 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:03:06,507 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:03:06,720 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:03:07,073 - server - INFO - 正在创建游戏: df153468-e58b-4fca-a7dd-105594bd2d10, 玩家数量: 5
2025-03-10 22:03:07,074 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:03:07,074 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:03:07,075 - src.engine.game - INFO - 游戏 df153468-e58b-4fca-a7dd-105594bd2d10 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:03:07,075 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:03:07,075 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:03:07,076 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:03:07,077 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:03:07,078 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:03:07,078 - src.engine.game - INFO - Added player ai_1 to game df153468-e58b-4fca-a7dd-105594bd2d10
2025-03-10 22:03:07,078 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:03:07,079 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:03:07,080 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:03:07,081 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:03:07,081 - src.engine.game - INFO - Added player ai_2 to game df153468-e58b-4fca-a7dd-105594bd2d10
2025-03-10 22:03:07,081 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:03:07,082 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:03:07,083 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:03:07,083 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:03:07,083 - src.engine.game - INFO - Added player ai_3 to game df153468-e58b-4fca-a7dd-105594bd2d10
2025-03-10 22:03:07,084 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:03:07,084 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:03:07,085 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:03:07,085 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:03:07,085 - src.engine.game - INFO - Added player ai_4 to game df153468-e58b-4fca-a7dd-105594bd2d10
2025-03-10 22:03:07,086 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:03:07,086 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:03:07,086 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:03:07,086 - src.engine.game - INFO - 玩家 player_0 手牌: ('6♣', '8♣')
2025-03-10 22:03:07,087 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♥', '5♣')
2025-03-10 22:03:07,087 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♦', 'A♣')
2025-03-10 22:03:07,087 - src.engine.game - INFO - 玩家 ai_3 手牌: ('9♠', '9♥')
2025-03-10 22:03:07,087 - src.engine.game - INFO - 玩家 ai_4 手牌: ('Q♣', '9♦')
2025-03-10 22:03:07,088 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:03:07,088 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:03:07,088 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:03:07,088 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:03:07,088 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:03:07,089 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:03:07,089 - src.engine.game - INFO - 游戏 df153468-e58b-4fca-a7dd-105594bd2d10 开始，进入翻牌前阶段
2025-03-10 22:03:07,089 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:03:07,089 - server - INFO - 游戏 df153468-e58b-4fca-a7dd-105594bd2d10 已开始
2025-03-10 22:03:07,090 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:03:07,544 - server - INFO - WebSocket连接已建立: 游戏=df153468-e58b-4fca-a7dd-105594bd2d10, 玩家=player_6400
2025-03-10 22:03:07,545 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:03:07,546 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:03:07,546 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:03:07,547 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:03:07,547 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:03:07,547 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:03:07,547 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:03:15,546 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"我手持一对9，这是一手相当强的起手牌，在德州扑克中排名前15%的起手牌。","position_analysis":"我在相对早的位置(位置3)，但已经有人在我前面下注，我需要表明我手牌的强度。","pot_odds":"当前底池30，最大注20，我加注到60会使底池增加到90，这给了我合理的风险回报比。","opponent_reads":["ai_2已经加注到20，表明可能有不错的手牌","其他玩家尚未表现出强势，可以通过适度加注测试他们的手牌强度"]},"table_talk":{"message":"嗯，有点意思。让我们加点料。","tone":"自信"}}
2025-03-10 22:03:15,547 - src.agents.llm - INFO - ==================================================

2025-03-10 22:03:15,547 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '嗯，有点意思。让我们加点料。', 'tone': '自信'}
2025-03-10 22:03:15,547 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:03:15,548 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:03:15,548 - src.engine.game - ERROR - 处理玩家动作时出错: 'type' object is not subscriptable
2025-03-10 22:03:15,548 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有点意思。让我们加点料。', 'tone': '自信'}}
2025-03-10 22:03:15,550 - src.engine.state - INFO - 以下玩家未行动: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']，回合未完成
2025-03-10 22:03:20,550 - server - ERROR - 无效的JSON消息
2025-03-10 22:03:20,551 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:03:20,551 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:03:20,552 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:03:20,552 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:03:20,552 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:03:20,553 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:03:30,279 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"我手持一对9，这是一手相当强的起手牌，在德州扑克中排名前20%的起手牌。一对中等口袋对子在前期有很好的价值。","position_analysis":"我的位置不是很理想，在早期位置，但手牌强度足以支撑我在这个位置加注。","pot_odds":"当前底池30，最大注20，我加注到60会使底池增加到90。这给了我约3:1的隐含赔率，考虑到我的口袋对子可能击中三条，这是有利可图的。","opponent_reads":["前面的玩家已经下注和加注，表明他们可能有一定强度的牌，但我的一对9仍然是一手强牌","后面还有一名玩家未行动，适度加注可以获取更多信息并建立形象"]},"table_talk":{"message":"让我们把节奏提高一点，看看谁是认真的。","tone":"自信"}}
2025-03-10 22:03:30,280 - src.agents.llm - INFO - ==================================================

2025-03-10 22:03:30,281 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '让我们把节奏提高一点，看看谁是认真的。', 'tone': '自信'}
2025-03-10 22:03:30,281 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:03:30,282 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:03:30,282 - src.engine.game - ERROR - 处理玩家动作时出错: 'type' object is not subscriptable
2025-03-10 22:03:30,282 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '让我们把节奏提高一点，看看谁是认真的。', 'tone': '自信'}}
2025-03-10 22:03:30,284 - src.engine.state - INFO - 以下玩家未行动: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']，回合未完成
2025-03-10 22:03:30,285 - server - ERROR - 无效的JSON消息
2025-03-10 22:03:30,286 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:03:30,286 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:03:30,286 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:03:30,287 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:03:30,287 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:03:30,287 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:03:37,042 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"我有一对9，这是一手中等强度的起手牌，在六人桌上属于前25%的起手牌","position_analysis":"我在早期位置，位置不是很有利，但手牌强度足够支撑我加注","pot_odds":"底池有30，当前最大注是20，我加注到60，使用3倍底池大小的加注来获取价值并筛选对手","opponent_reads":["目前还没有太多对手信息，但我持有的一对9值得在前面有人小注的情况下进行加注"]},"table_talk":{"message":"嗯，有点意思，我们来玩大一点。","tone":"自信"}}
2025-03-10 22:03:37,042 - src.agents.llm - INFO - ==================================================

2025-03-10 22:03:37,042 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '嗯，有点意思，我们来玩大一点。', 'tone': '自信'}
2025-03-10 22:03:37,043 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:03:37,043 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:03:37,043 - src.engine.game - ERROR - 处理玩家动作时出错: 'type' object is not subscriptable
2025-03-10 22:03:37,043 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有点意思，我们来玩大一点。', 'tone': '自信'}}
2025-03-10 22:03:37,044 - src.engine.state - INFO - 以下玩家未行动: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']，回合未完成
2025-03-10 22:03:37,045 - server - ERROR - 无效的JSON消息
2025-03-10 22:03:37,045 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:03:37,045 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:03:37,045 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:03:37,046 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:03:37,046 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:03:37,046 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:03:45,847 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"一对9是一手相当强的起手牌，在德州扑克中排名前15%的起手牌。","position_analysis":"我在相对靠前的位置(位置3)，已经有人在我前面加注，但我有强牌。","pot_odds":"当前底池30，需要跟注20，底池赔率为1.5:1。考虑到我的手牌强度，这是一个有利可图的跟注。但我选择加注以建立底池和获取更多信息。","opponent_reads":["ai_2已经加注到20，表明他可能有一手不错的牌，但我的一对9足够强大可以应对。","其他玩家尚未行动，通过加注我可以获取位置优势并收集更多信息。"]},"table_talk":{"message":"嗯，有点意思了。让我们看看这手牌能走多远。","tone":"自信但不张扬"}}
2025-03-10 22:03:45,849 - src.agents.llm - INFO - ==================================================

2025-03-10 22:03:45,850 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '嗯，有点意思了。让我们看看这手牌能走多远。', 'tone': '自信但不张扬'}
2025-03-10 22:03:45,850 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:03:45,851 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:03:45,851 - src.engine.game - ERROR - 处理玩家动作时出错: 'type' object is not subscriptable
2025-03-10 22:03:45,852 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有点意思了。让我们看看这手牌能走多远。', 'tone': '自信但不张扬'}}
2025-03-10 22:03:45,853 - src.engine.state - INFO - 以下玩家未行动: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']，回合未完成
2025-03-10 22:03:45,854 - server - ERROR - 无效的JSON消息
2025-03-10 22:03:45,854 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:03:45,855 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:03:45,855 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:03:45,855 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:03:45,856 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:03:45,856 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:03:53,569 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"我手持一对9，这是一手中等偏强的起手牌，在6人桌中排名前25%的起手牌。","position_analysis":"我在位置3，处于中间位置，有两名玩家已经下注，后面还有一名玩家要行动。","pot_odds":"当前底池30，最大注20，我加注到60会使底池增加到90。这给了我大约3:1的隐含赔率，对一对中等口袋对子来说是合理的。","opponent_reads":["ai_2已经加注到20，显示出一定的强度","ai_1只是跟注小盲，没有表现出特别强的手牌","player_0和ai_4尚未行动，需要建立足够的压力"]},"table_talk":{"message":"一对9，不错的开始。让我们看看这手牌能走多远。","tone":"自信"}}
2025-03-10 22:03:53,570 - src.agents.llm - INFO - ==================================================

2025-03-10 22:03:53,570 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '一对9，不错的开始。让我们看看这手牌能走多远。', 'tone': '自信'}
2025-03-10 22:03:53,571 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:03:53,571 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:03:53,571 - src.engine.game - ERROR - 处理玩家动作时出错: 'type' object is not subscriptable
2025-03-10 22:03:53,571 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '一对9，不错的开始。让我们看看这手牌能走多远。', 'tone': '自信'}}
2025-03-10 22:03:53,572 - src.engine.state - INFO - 以下玩家未行动: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']，回合未完成
2025-03-10 22:03:53,574 - server - ERROR - 无效的JSON消息
2025-03-10 22:03:53,574 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:03:53,574 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:03:53,575 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:03:53,575 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:03:53,575 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:03:53,576 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:04:01,189 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"一对9是一手相当强的起手牌，在德州扑克中排名前15%的起手牌。","position_analysis":"我处于相对早的位置(位置3)，这意味着后面还有玩家要行动，需要谨慎但也可以利用位置优势施加压力。","pot_odds":"当前底池30，最大注20，我加注到60可以建立优势位置并获取信息。","opponent_reads":["ai_2已经加注到20，显示出一定强度，但这可能是标准的盲注位置加注","其他玩家尚未表现出明显的强势手牌"]},"table_talk":{"message":"口袋对子，让我们看看谁真正想玩这手牌。","tone":"自信"}}
2025-03-10 22:04:01,190 - src.agents.llm - INFO - ==================================================

2025-03-10 22:04:01,190 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '口袋对子，让我们看看谁真正想玩这手牌。', 'tone': '自信'}
2025-03-10 22:04:01,191 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:04:01,191 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:04:01,191 - src.engine.game - ERROR - 处理玩家动作时出错: 'type' object is not subscriptable
2025-03-10 22:04:01,191 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '8♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '5♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '9♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '9♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '口袋对子，让我们看看谁真正想玩这手牌。', 'tone': '自信'}}
2025-03-10 22:04:01,192 - src.engine.state - INFO - 以下玩家未行动: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']，回合未完成
2025-03-10 22:04:01,193 - server - INFO - WebSocket连接断开: game_id=df153468-e58b-4fca-a7dd-105594bd2d10, player_id=ai_4
2025-03-10 22:04:01,193 - server - ERROR - 发送游戏状态到玩家 player_6400 时出错: 
2025-03-10 22:04:01,193 - server - INFO - WebSocket连接已断开: 游戏=df153468-e58b-4fca-a7dd-105594bd2d10, 玩家=player_6400
2025-03-10 22:14:08,658 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:14:08,661 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:14:14,582 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:14:14,586 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:14:14,787 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:14:15,135 - server - INFO - 正在创建游戏: d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c, 玩家数量: 5
2025-03-10 22:14:15,135 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:14:15,135 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:14:15,136 - src.engine.game - INFO - 游戏 d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:14:15,136 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:14:15,136 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:14:15,137 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:14:15,138 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:14:15,138 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:14:15,139 - src.engine.game - INFO - Added player ai_1 to game d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c
2025-03-10 22:14:15,139 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:14:15,139 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:14:15,140 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:14:15,141 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:14:15,141 - src.engine.game - INFO - Added player ai_2 to game d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c
2025-03-10 22:14:15,141 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:14:15,142 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:14:15,143 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:14:15,143 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:14:15,143 - src.engine.game - INFO - Added player ai_3 to game d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c
2025-03-10 22:14:15,143 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:14:15,144 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:14:15,145 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:14:15,145 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:14:15,145 - src.engine.game - INFO - Added player ai_4 to game d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c
2025-03-10 22:14:15,145 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:14:15,146 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:15,146 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:14:15,146 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♣', 'Q♥')
2025-03-10 22:14:15,146 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♥', 'A♦')
2025-03-10 22:14:15,146 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♦', 'K♠')
2025-03-10 22:14:15,146 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♥', '7♥')
2025-03-10 22:14:15,147 - src.engine.game - INFO - 玩家 ai_4 手牌: ('10♣', '8♠')
2025-03-10 22:14:15,147 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:14:15,147 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:14:15,147 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:14:15,147 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:14:15,148 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:14:15,148 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:14:15,148 - src.engine.game - INFO - 游戏 d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c 开始，进入翻牌前阶段
2025-03-10 22:14:15,148 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:14:15,148 - server - INFO - 游戏 d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c 已开始
2025-03-10 22:14:15,149 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:14:15,633 - server - INFO - WebSocket连接已建立: d7ed0919-fcf1-4844-8dd0-fc81e1d22d9c
2025-03-10 22:14:15,633 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:14:15,635 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:14:15,635 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:14:15,635 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:14:15,636 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:14:15,636 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:14:15,636 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:14:23,483 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":20,"confidence":0.6},"reasoning":{"hand_strength":"6♥, 7♥是一手中等连牌，同花听牌，有一定潜力，但当前强度不高","position_analysis":"我在相对靠后的位置3，已经有人下注，位置不是特别有利","pot_odds":"当前底池30，需要跟注20，底池赔率为1.5:1，考虑到手牌的潜在价值，值得跟注看翻牌","opponent_reads":["ai_2已经加注到20，显示出一定的强度，但在前期这可能只是标准加注","ai_1只是跟注小盲，没有显示出特别强的意图","其他玩家尚未行动"]},"table_talk":{"message":"嗯，连牌有潜力，我跟一下看看翻牌","tone":"平静自信"}}
2025-03-10 22:14:23,484 - src.agents.llm - INFO - ==================================================

2025-03-10 22:14:23,485 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，连牌有潜力，我跟一下看看翻牌', 'tone': '平静自信'}
2025-03-10 22:14:23,485 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:14:23,486 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:14:23,486 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-03-10 22:14:23,487 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:14:23,487 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:14:23,487 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:14:23,488 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:14:23,488 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:23,489 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:14:23,489 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:14:23,489 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:14:23,490 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:14:23,490 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:23,491 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:23,491 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:14:23,492 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:14:23,492 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:14:23,492 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:14:23,493 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，连牌有潜力，我跟一下看看翻牌', 'tone': '平静自信'}}
2025-03-10 22:14:23,494 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:14:23,494 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:23,495 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:23,495 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:14:23,495 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:14:23,496 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:14:28,516 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:14:28,517 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:14:28,518 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:14:28,518 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:14:28,519 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:14:28,519 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:14:42,263 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"20","confidence":0.5},"reasoning":{"hand_strength":"手牌10♣, 8♠在没有公共牌的情况下属于中等偏弱，但考虑到位置优势和对手可能的试探性加注，直接弃牌显得过于保守。","position_analysis":"处于中间位置，既不是盲注也不是按钮位，这意味着需要谨慎行事同时保持灵活性。","pot_odds":"底池赔率为50:20=2.5:1，对于跟注来说是合理的，特别是如果后续能够免费看到翻牌的话。","opponent_reads":["ai_3选择跟注而非加注可能表明他们也持有一手中等强度的手牌或是在尝试控制底池大小。"]},"table_talk":{"message":"看看翻牌再说吧。","tone":"轻松"}}
2025-03-10 22:14:42,264 - src.agents.llm - INFO - ==================================================

2025-03-10 22:14:42,264 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看看翻牌再说吧。', 'tone': '轻松'}
2025-03-10 22:14:42,265 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 22:14:42,265 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 22:14:42,266 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-03-10 22:14:42,266 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 22:14:42,266 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 22:14:42,267 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:14:42,267 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:14:42,268 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:42,268 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:14:42,268 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:14:42,269 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:14:42,269 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:14:42,270 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:42,270 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:42,271 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:14:42,271 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:14:42,272 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:14:42,272 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:14:42,273 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '看看翻牌再说吧。', 'tone': '轻松'}}
2025-03-10 22:14:42,274 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:14:42,274 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:42,275 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:42,275 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:14:42,276 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:14:42,276 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:14:57,968 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 22:14:57,969 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T22:14:57.969430', 'table_talk': None}
2025-03-10 22:14:57,970 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 22:14:57,970 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 22:14:57,971 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 22:14:57,972 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 22:14:57,972 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:14:57,973 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:14:57,973 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:57,974 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:14:57,974 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:14:57,975 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:14:57,975 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:14:57,976 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:57,977 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:57,978 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:14:57,979 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:14:57,979 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:14:57,980 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:14:57,980 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:14:57,980 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:14:57,981 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:14:57,982 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:14:57,982 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:14:57,983 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:14:57,983 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:14:57,983 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:14:57,984 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:15:02,282 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:15:02,283 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:15:02,284 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:15:02,285 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:15:02,285 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:15:02,286 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:15:24,336 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.85"}, "reasoning": {"hand_strength": "我的手牌是A♦和9♥，虽然不是最顶级的起手牌，但拥有不错的潜力，尤其在多人底池中可以发挥作用", "position_analysis": "作为较早行动者，加注能帮助我掌控主动权，同时筛选对手，加大心理压力", "pot_odds": "底池目前90筹码，加上加注40后，对手需要支付相对较高的价格参与，底池赔率较为诱人", "opponent_reads": ["对手均选择CALL，表明他们手牌范围较宽或不愿过早暴露牌力，这给我的加注制造压迫感提供了机会"]}, "table_talk": {"message": "各位，准备好被我压制了吗？", "tone": "自信且挑衅"}}
2025-03-10 22:15:24,337 - src.agents.llm - INFO - ==================================================

2025-03-10 22:15:24,337 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 22:15:24,338 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '各位，准备好被我压制了吗？', 'tone': '自信且挑衅'}
2025-03-10 22:15:24,338 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 22:15:24,339 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 22:15:24,339 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 22:15:24,340 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 22:15:24,341 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 22:15:24,341 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:15:24,343 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:15:24,343 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:24,345 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:15:24,345 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:15:24,346 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:15:24,347 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:24,347 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:15:24,348 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:24,348 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:24,349 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:24,349 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:24,350 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:15:24,351 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 120, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，准备好被我压制了吗？', 'tone': '自信且挑衅'}}
2025-03-10 22:15:24,352 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:24,352 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:15:24,353 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:24,354 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:24,354 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:24,355 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:24,356 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:15:24,357 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:15:24,358 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:15:24,359 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:15:24,360 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:15:24,360 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:15:30,796 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌4♦和K♠在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"处于中间位置，缺乏信息优势，不利于后续行动","pot_odds":"底池赔率不划算，不值得冒险跟注或加注","opponent_reads":["ai_1进行了加注，显示其手牌较强，可能持有高对或强牌"]},"table_talk":{"message":"看来这手牌不适合我，我选择退出","tone":"冷静"}}
2025-03-10 22:15:30,797 - src.agents.llm - INFO - ==================================================

2025-03-10 22:15:30,797 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择退出', 'tone': '冷静'}
2025-03-10 22:15:30,798 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:15:30,799 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:15:30,799 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:15:30,800 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:15:30,801 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:15:30,801 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:15:30,802 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:15:30,802 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:30,803 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:15:30,803 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:15:30,804 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:15:30,805 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:30,806 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:15:30,806 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:30,807 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:30,807 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:30,808 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:30,808 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:15:30,809 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 120, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择退出', 'tone': '冷静'}}
2025-03-10 22:15:30,810 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:30,811 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:15:30,811 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:30,812 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:30,812 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:30,813 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:30,814 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:15:30,814 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:15:30,815 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:15:30,815 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:15:30,816 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:15:30,816 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:15:37,877 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":40,"confidence":0.7},"reasoning":{"hand_strength":"6♥7♥是一手中等连牌，同花的潜力，但当前强度不高","position_analysis":"我在相对靠后的位置，已经有多名玩家参与，显示底池有一定价值","pot_odds":"需要投入40筹码赢取120筹码底池，底池赔率为3:1，有足够的隐含赔率支持跟注","opponent_reads":["ai_1的加注可能表明有一手不错的牌，但加注幅度不大，可能是尝试性加注或中等强牌","多名玩家跟注表明底池竞争度较高"]},"table_talk":{"message":"同花连牌，值得看一看。","tone":"平静自信"}}
2025-03-10 22:15:37,878 - src.agents.llm - INFO - ==================================================

2025-03-10 22:15:37,878 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '同花连牌，值得看一看。', 'tone': '平静自信'}
2025-03-10 22:15:37,879 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:15:37,879 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:15:37,879 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-03-10 22:15:37,880 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:15:37,880 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:15:37,881 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:15:37,881 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:15:37,882 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:37,882 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:15:37,883 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:15:37,884 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:15:37,885 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:37,885 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:15:37,886 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:37,886 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:37,887 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:37,887 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:37,888 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:15:37,888 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 140, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '同花连牌，值得看一看。', 'tone': '平静自信'}}
2025-03-10 22:15:37,890 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:37,890 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:15:37,890 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:37,891 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:37,891 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:37,892 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:37,896 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:15:37,896 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:15:37,897 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:15:37,898 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:15:37,898 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:15:37,899 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:15:50,516 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"40","confidence":0.5},"reasoning":{"hand_strength":"手牌10♣, 8♠在没有公共牌的情况下属于中等偏弱，但考虑到对手可能也在试探，直接弃牌显得过于保守。","position_analysis":"处于中间位置，既不是最晚也不是最早行动，这给予了一定的灵活性来观察后续玩家的动作。","pot_odds":"跟注的成本相对于底池大小来说是可以接受的，特别是如果能够看到翻牌后有改善的机会。","opponent_reads":["ai_1选择加注显示了其对当前手牌的信心，但也可能是为了控制底池大小或进行诈唬；其他玩家均选择了跟随，表明他们也可能持有不错的手牌或者采取观望态度。"]},"table_talk":{"message":"让我们看看接下来会发生什么吧！","tone":"轻松"}}
2025-03-10 22:15:50,517 - src.agents.llm - INFO - ==================================================

2025-03-10 22:15:50,517 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我们看看接下来会发生什么吧！', 'tone': '轻松'}
2025-03-10 22:15:50,517 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 22:15:50,518 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 22:15:50,518 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-03-10 22:15:50,518 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 22:15:50,518 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 22:15:50,518 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:15:50,518 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:15:50,518 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:50,519 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:15:50,519 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:15:50,519 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:15:50,519 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:50,519 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:15:50,519 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:50,519 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:50,520 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:50,520 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:15:50,520 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:15:50,520 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 160, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '让我们看看接下来会发生什么吧！', 'tone': '轻松'}}
2025-03-10 22:15:50,521 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:15:50,521 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:15:50,521 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:15:50,523 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:15:50,523 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 22:15:50,523 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:16:07,132 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 22:16:07,133 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T22:16:07.133001', 'table_talk': None}
2025-03-10 22:16:07,134 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 22:16:07,134 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 22:16:07,135 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 22:16:07,136 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 22:16:07,136 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:16:07,136 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:16:07,137 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:16:07,137 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:16:07,138 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:16:07,138 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:16:07,139 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:16:07,139 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:07,140 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:16:07,141 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:16:07,141 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:16:07,142 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:16:07,142 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:16:07,143 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:16:07,143 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:16:07,143 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:16:07,144 - src.engine.game - INFO - 活跃玩家数量: 4, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 22:16:07,144 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:16:07,145 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 22:16:07,145 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:07,146 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 22:16:07,146 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 22:16:07,146 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:16:07,147 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:16:07,147 - src.engine.dealer - INFO - Dealt 3 community cards: ['5♦', '7♣', 'A♠']
2025-03-10 22:16:07,148 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['5♦', '7♣', 'A♠']
2025-03-10 22:16:07,148 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:16:07,149 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 22:16:07,149 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 22:16:07,150 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:16:07,150 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 180, 'community_cards': ['5♦', '7♣', 'A♠'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:16:07,151 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:16:07,151 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:07,152 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:16:07,152 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:16:07,153 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:16:07,153 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:16:10,529 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:16:10,530 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:16:10,530 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:16:10,531 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:16:10,531 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:16:10,532 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:16:41,897 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "60", "confidence": "0.85"}, "reasoning": {"hand_strength": "虽然我的手牌是9♥, A♦，但在翻牌中拿到了A♠，形成了顶对，具备很好的价值。", "position_analysis": "位于早位，我选择主动出击，以控制局面并迫使对手在后续做出决策。", "pot_odds": "180的底池对我960的筹码来说风险不大，此时加注能为未来下注建立更好的赔率。", "opponent_reads": ["ai_1的激进行为可能是在虚张声势", "其他玩家的跟注范围相对宽泛，容易受到加注压力"]}, "table_talk": {"message": "大家准备好了吗？这局我可不会轻易放水！", "tone": "自信且具有挑衅性"}}
2025-03-10 22:16:41,898 - src.agents.llm - INFO - ==================================================

2025-03-10 22:16:41,898 - src.agents.llm - INFO - 成功将字符串金额 60 转换为数字 60.0
2025-03-10 22:16:41,898 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '大家准备好了吗？这局我可不会轻易放水！', 'tone': '自信且具有挑衅性'}
2025-03-10 22:16:41,898 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 60
2025-03-10 22:16:41,899 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 22:16:41,899 - src.engine.state - INFO - 玩家 ai_1 加注到 60 筹码，已标记为已行动
2025-03-10 22:16:41,899 - src.engine.game - INFO - 玩家 ai_1 加注到 60
2025-03-10 22:16:41,899 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 22:16:41,899 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:16:41,900 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:16:41,900 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:16:41,900 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:16:41,900 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_3
2025-03-10 22:16:41,900 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:16:41,900 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:16:41,901 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:41,902 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:16:41,902 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:16:41,903 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:16:41,903 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:16:41,904 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:16:41,904 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 240, 'community_cards': ['5♦', '7♣', 'A♠'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 900, 'current_bet': 60, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '大家准备好了吗？这局我可不会轻易放水！', 'tone': '自信且具有挑衅性'}}
2025-03-10 22:16:41,905 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:16:41,906 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:41,906 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:16:41,907 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:16:41,907 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:16:41,908 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:16:41,913 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:16:41,913 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:16:41,914 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:16:41,914 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:16:41,915 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:16:41,915 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:16:51,864 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"我手上有一对7，这是中等强度的一对。同时我有6♥和7♥，有潜力组成顺子（如果出现4和8）或同花（如果出现更多红心）。","position_analysis":"我在位置3，不是特别有利的位置，但也不是最差的。在这个位置上，我需要谨慎行动，因为后面还有玩家要行动。","pot_odds":"底池已经有240，我需要跟注60，所以底池赔率是4:1，这是有利的赔率，值得跟注看转牌。","opponent_reads":["ai_1比较激进，已经连续加注两次，可能有强牌如A配高踢脚或者超对，但也可能是在诈唬","其他玩家都选择跟注而不是再加注，说明他们手牌可能中等强度"]},"table_talk":{"message":"嗯，有意思的局面。我跟你玩玩看。","tone":"沉着冷静"}}
2025-03-10 22:16:51,866 - src.agents.llm - INFO - ==================================================

2025-03-10 22:16:51,866 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，有意思的局面。我跟你玩玩看。', 'tone': '沉着冷静'}
2025-03-10 22:16:51,867 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:16:51,867 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:16:51,868 - src.engine.state - INFO - 玩家 ai_3 跟注 60 筹码，已标记为已行动
2025-03-10 22:16:51,868 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:16:51,869 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:16:51,869 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:16:51,870 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:16:51,870 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:16:51,870 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:16:51,871 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:16:51,871 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:16:51,872 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:16:51,872 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:51,873 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:16:51,873 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:16:51,874 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:16:51,874 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:16:51,875 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:16:51,875 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 300, 'community_cards': ['5♦', '7♣', 'A♠'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 900, 'current_bet': 60, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 900, 'current_bet': 60, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有意思的局面。我跟你玩玩看。', 'tone': '沉着冷静'}}
2025-03-10 22:16:51,876 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:16:51,877 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:16:51,877 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:16:51,877 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:16:51,877 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:16:51,877 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:16:51,881 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:16:51,882 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:16:51,882 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:16:51,883 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:16:51,883 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:16:51,884 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:17:03,744 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"60","confidence":"0.5"},"reasoning":{"hand_strength":"手牌10♣, 8♠在FLOP阶段没有直接构成强组合，但存在顺子听牌的可能性。考虑到当前公共牌面较为干燥，我的手牌仍有潜在的价值。","position_analysis":"处于中间位置，这要求我更加谨慎地处理自己的动作，避免过早暴露信息。","pot_odds":"底池为300，跟注60的代价相对较低，从数学上看是合理的。","opponent_reads":["ai_1连续两次加注显示出一定的强势，可能是持有较好的起手牌或是在尝试通过激进打法施压；其他玩家选择跟随，表明他们可能也在寻找机会或持有听牌。"]},"table_talk":{"message":"让我们看看接下来会发生什么吧。","tone":"轻松"}}
2025-03-10 22:17:03,745 - src.agents.llm - INFO - ==================================================

2025-03-10 22:17:03,746 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我们看看接下来会发生什么吧。', 'tone': '轻松'}
2025-03-10 22:17:03,746 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 22:17:03,746 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 22:17:03,746 - src.engine.state - INFO - 玩家 ai_4 跟注 60 筹码，已标记为已行动
2025-03-10 22:17:03,746 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 22:17:03,747 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 22:17:03,747 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:17:03,748 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:17:03,748 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:17:03,749 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:17:03,750 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:17:03,750 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:17:03,751 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:17:03,752 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:17:03,752 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:17:03,753 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:17:03,753 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:17:03,754 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:17:03,755 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:17:03,756 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 360, 'community_cards': ['5♦', '7♣', 'A♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 900, 'current_bet': 60, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 900, 'current_bet': 60, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 900, 'current_bet': 60, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '让我们看看接下来会发生什么吧。', 'tone': '轻松'}}
2025-03-10 22:17:03,757 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:17:03,758 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:17:03,758 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:17:03,758 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:17:03,759 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:17:03,759 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:19:14,253 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 22:19:14,253 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T22:19:14.253640', 'table_talk': None}
2025-03-10 22:19:14,253 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 22:19:14,254 - src.engine.state - INFO - 玩家 player_0 跟注 60 筹码，已标记为已行动
2025-03-10 22:19:14,254 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 22:19:14,254 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 22:19:14,254 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:19:14,254 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:19:14,255 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:19:14,255 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:19:14,255 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:19:14,255 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:19:14,255 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:19:14,255 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:19:14,256 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:19:14,256 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:19:14,256 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:19:14,256 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:19:14,256 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:19:14,257 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:19:14,257 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:19:14,258 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:19:14,259 - src.engine.game - INFO - 活跃玩家数量: 4, 当前游戏阶段: GameStage.FLOP
2025-03-10 22:19:14,259 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:19:14,260 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 22:19:14,260 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:19:14,261 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 22:19:14,261 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 22:19:14,261 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:19:14,262 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:19:14,262 - src.engine.dealer - INFO - Dealt 1 community cards: ['8♦']
2025-03-10 22:19:14,262 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['5♦', '7♣', 'A♠', '8♦']
2025-03-10 22:19:14,263 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:19:14,263 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 22:19:14,263 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 22:19:14,263 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:19:14,264 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 420, 'community_cards': ['5♦', '7♣', 'A♠', '8♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:19:14,265 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:19:14,265 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:19:14,265 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:19:14,266 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:19:14,266 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:19:14,266 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:19:18,906 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:19:18,907 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:19:18,908 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:19:18,909 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:19:18,910 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:19:18,910 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:19:52,932 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "120", "confidence": "0.8"}, "reasoning": {"hand_strength": "手牌A9在翻牌和转牌中形成顶对，有一定价值，尽管对手可能持有更强的组合，但当前局面下算有竞争力", "position_analysis": "位置靠前能先行动，利用主动权迫使对手做出反应，有利于后续观察他们的行动", "pot_odds": "底池已420，跟注60或加注能获得较好的赔率，同时通过加注可以保护自己的手牌，减少对手追逐可能的顺子或其他牌型", "opponent_reads": ["观察到ai_1两次加注，显示一定激进性，但同时也可能在利用诈唬试探弱牌；其他玩家连续跟注，可能在观望或持有边缘牌"]}, "table_talk": {"message": "各位小心了，我今天可不是来喝茶的！", "tone": "自信且带有挑衅气息"}}
2025-03-10 22:19:52,932 - src.agents.llm - INFO - ==================================================

2025-03-10 22:19:52,933 - src.agents.llm - INFO - 成功将字符串金额 120 转换为数字 120.0
2025-03-10 22:19:52,933 - src.agents.llm - INFO - 生成动作: RAISE 金额: 120 table_talk: {'message': '各位小心了，我今天可不是来喝茶的！', 'tone': '自信且带有挑衅气息'}
2025-03-10 22:19:52,933 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 120
2025-03-10 22:19:52,934 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 22:19:52,934 - src.engine.state - INFO - 玩家 ai_1 加注到 120 筹码，已标记为已行动
2025-03-10 22:19:52,934 - src.engine.game - INFO - 玩家 ai_1 加注到 120
2025-03-10 22:19:52,934 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 22:19:52,934 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:19:52,935 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:19:52,935 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:19:52,935 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:19:52,935 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_3
2025-03-10 22:19:52,935 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:19:52,935 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:19:52,936 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:19:52,936 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:19:52,936 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:19:52,936 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:19:52,936 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:19:52,936 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:19:52,936 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 540, 'community_cards': ['5♦', '7♣', 'A♠', '8♦'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 780, 'current_bet': 120, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 120}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位小心了，我今天可不是来喝茶的！', 'tone': '自信且带有挑衅气息'}}
2025-03-10 22:19:52,937 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:19:52,937 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:19:52,938 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:19:52,938 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:19:52,938 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:19:52,938 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:19:52,943 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:19:52,943 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:19:52,944 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:19:52,944 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:19:52,945 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:19:52,945 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:20:02,216 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":120,"confidence":0.7},"reasoning":{"hand_strength":"我有一对7，这是中等强度的手牌。在转牌圈，公共牌是5♦, 7♣, A♠, 8♦，我有三条7。目前可能的顺子是4-8，但我没有顺子。","position_analysis":"我在位置3，相对靠前，在我之后还有两名玩家要行动。","pot_odds":"底池已经有540，我需要跟注120，底池赔率是4.5:1，对于我的三条7来说，这是有利的赔率。","opponent_reads":["ai_1非常激进，已经连续三次加注，可能有强牌如A配高踢脚或两对，但也可能在诈唬","其他玩家都选择跟注而不是重新加注，表明他们可能有中等强度的牌"]},"table_talk":{"message":"看来有人今天很有信心啊。我跟你这一把，让我们看看谁的牌更强。","tone":"自信但谨慎"}}
2025-03-10 22:20:02,217 - src.agents.llm - INFO - ==================================================

2025-03-10 22:20:02,218 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来有人今天很有信心啊。我跟你这一把，让我们看看谁的牌更强。', 'tone': '自信但谨慎'}
2025-03-10 22:20:02,218 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:20:02,218 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:20:02,219 - src.engine.state - INFO - 玩家 ai_3 跟注 120 筹码，已标记为已行动
2025-03-10 22:20:02,219 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:20:02,219 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:20:02,219 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:20:02,219 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:20:02,220 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:20:02,220 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:20:02,220 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:20:02,221 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:20:02,221 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:20:02,221 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:20:02,221 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:20:02,222 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:20:02,222 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:20:02,222 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:20:02,222 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:20:02,222 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 660, 'community_cards': ['5♦', '7♣', 'A♠', '8♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 780, 'current_bet': 120, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 780, 'current_bet': 120, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人今天很有信心啊。我跟你这一把，让我们看看谁的牌更强。', 'tone': '自信但谨慎'}}
2025-03-10 22:20:02,223 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:20:02,223 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:20:02,223 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:20:02,224 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:20:02,224 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:20:02,224 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:20:02,225 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:20:02,225 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:20:02,226 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:20:02,226 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:20:02,226 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:20:02,226 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:20:12,507 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"120","confidence":"0.75"},"reasoning":{"hand_strength":"拥有中等对子8，加上可能的顺子听牌机会，手牌强度一般。","position_analysis":"处于较晚位置，能够观察对手行动后再做决定。","pot_odds":"跟注需要支付120进入总底池660+3*120=1020，获得的赔率约为8.5:1，考虑到潜在赢面和隐藏实力，跟注是合理的。","opponent_reads":["ai_1连续加注显示出较强的手牌或试图通过激进打法施压；其他两位玩家选择跟注，表明他们也可能持有不错的位置或听牌。"]},"table_talk":{"message":"看来大家都挺有信心啊，那我也来凑个热闹吧！","tone":"轻松友好"}}
2025-03-10 22:20:12,508 - src.agents.llm - INFO - ==================================================

2025-03-10 22:20:12,509 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来大家都挺有信心啊，那我也来凑个热闹吧！', 'tone': '轻松友好'}
2025-03-10 22:20:12,510 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 22:20:12,510 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 22:20:12,510 - src.engine.state - INFO - 玩家 ai_4 跟注 120 筹码，已标记为已行动
2025-03-10 22:20:12,510 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 22:20:12,510 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 22:20:12,511 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:20:12,511 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:20:12,511 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:20:12,511 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:20:12,511 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:20:12,511 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:20:12,512 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:20:12,512 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:20:12,512 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:20:12,512 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:20:12,512 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:20:12,512 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:20:12,512 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:20:12,513 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 780, 'community_cards': ['5♦', '7♣', 'A♠', '8♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 900, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 780, 'current_bet': 120, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 780, 'current_bet': 120, 'is_active': True, 'cards': ('6♥', '7♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 780, 'current_bet': 120, 'is_active': True, 'cards': ('10♣', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '看来大家都挺有信心啊，那我也来凑个热闹吧！', 'tone': '轻松友好'}}
2025-03-10 22:20:12,513 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:20:12,513 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:20:12,514 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:20:12,514 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:20:12,514 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:20:12,515 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:22:20,138 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:22:20,143 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:22:26,248 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:22:26,252 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:22:37,534 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:22:37,963 - server - INFO - 正在创建游戏: 308b3492-2011-4f89-a610-2b3dd16c94f1, 玩家数量: 5
2025-03-10 22:22:37,964 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:22:37,965 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:22:37,966 - src.engine.game - INFO - 游戏 308b3492-2011-4f89-a610-2b3dd16c94f1 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:22:37,966 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:22:37,967 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:22:37,968 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:22:37,971 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:22:37,972 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:22:37,973 - src.engine.game - INFO - Added player ai_1 to game 308b3492-2011-4f89-a610-2b3dd16c94f1
2025-03-10 22:22:37,973 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:22:37,974 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:22:37,977 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:22:37,978 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:22:37,978 - src.engine.game - INFO - Added player ai_2 to game 308b3492-2011-4f89-a610-2b3dd16c94f1
2025-03-10 22:22:37,979 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:22:37,980 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:22:37,983 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:22:37,984 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:22:37,984 - src.engine.game - INFO - Added player ai_3 to game 308b3492-2011-4f89-a610-2b3dd16c94f1
2025-03-10 22:22:37,985 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:22:37,986 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:22:37,989 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:22:37,990 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:22:37,991 - src.engine.game - INFO - Added player ai_4 to game 308b3492-2011-4f89-a610-2b3dd16c94f1
2025-03-10 22:22:37,991 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:22:37,992 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:22:37,992 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:22:37,993 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♣', '6♥')
2025-03-10 22:22:37,993 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♠', '3♠')
2025-03-10 22:22:37,994 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♠', '9♦')
2025-03-10 22:22:37,994 - src.engine.game - INFO - 玩家 ai_3 手牌: ('2♠', 'K♦')
2025-03-10 22:22:37,995 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♥', '4♦')
2025-03-10 22:22:37,995 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:22:37,996 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:22:37,996 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:22:37,997 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:22:37,997 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:22:37,998 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:22:37,999 - src.engine.game - INFO - 游戏 308b3492-2011-4f89-a610-2b3dd16c94f1 开始，进入翻牌前阶段
2025-03-10 22:22:38,000 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:22:38,000 - server - INFO - 游戏 308b3492-2011-4f89-a610-2b3dd16c94f1 已开始
2025-03-10 22:22:38,001 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:22:38,268 - server - INFO - WebSocket连接已建立: 308b3492-2011-4f89-a610-2b3dd16c94f1
2025-03-10 22:22:38,268 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', '6♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '9♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'K♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', '4♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:22:38,271 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:22:38,272 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:22:38,272 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:22:38,273 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:22:38,273 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:22:38,274 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:22:46,930 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"2♠K♦是一手较弱的起手牌，K高牌有一定价值，但2完全没有配合，且不同花色，没有同花潜力","position_analysis":"位置3是比较早的位置，在PRE_FLOP阶段已经有人加注，后面还有一名玩家要行动","pot_odds":"当前底池30，需要下注20才能继续，底池赔率为1.5:1，不足以支持用这样的弱牌继续","opponent_reads":["ai_2已经加注到20，表明可能有不错的手牌","我的位置较早，后面还有玩家可能再次加注"]},"table_talk":{"message":"嗯...这牌不太行，还是省点力气吧。","tone":"平静"}}
2025-03-10 22:22:46,931 - src.agents.llm - INFO - ==================================================

2025-03-10 22:22:46,931 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '嗯...这牌不太行，还是省点力气吧。', 'tone': '平静'}
2025-03-10 22:22:46,931 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:22:46,932 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:22:46,932 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:22:46,932 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:22:46,933 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:22:46,933 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:22:46,934 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:22:46,934 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:22:46,936 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:22:46,937 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:22:46,937 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:22:46,938 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:22:46,939 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:22:46,939 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:22:46,940 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:22:46,940 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:22:46,941 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:22:46,941 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:22:46,942 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', '6♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '9♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', '4♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯...这牌不太行，还是省点力气吧。', 'tone': '平静'}}
2025-03-10 22:22:46,943 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:22:46,943 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:22:46,944 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:22:46,944 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:22:46,945 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:22:46,945 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:22:51,959 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:22:51,960 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:22:51,961 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:22:51,961 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:22:51,962 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:22:51,962 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:23:01,952 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"0","confidence":"0.85"},"reasoning":{"hand_strength":"我的手牌是8♥, 4♦，这是一副非常弱的手牌，在没有看到公共牌的情况下很难有所作为。","position_analysis":"虽然我在中间位置，但鉴于我的手牌质量，位置优势并不明显。","pot_odds":"考虑到底池赔率以及我需要投入的资金量，跟注或加注的回报比不理想。","opponent_reads":["对手ai_2已经进行了一个标准的最小加注，可能持有较好的起始手牌；而player_0尚未行动，可能是等待观察局势发展。"]},"table_talk":{"message":"这次我选择放弃，看看接下来会发生什么。","tone":"轻松"}}
2025-03-10 22:23:01,953 - src.agents.llm - INFO - ==================================================

2025-03-10 22:23:01,953 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我选择放弃，看看接下来会发生什么。', 'tone': '轻松'}
2025-03-10 22:23:01,953 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:23:01,954 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:23:01,954 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:23:01,954 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:23:01,954 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 22:23:01,954 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:23:01,954 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:23:01,954 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:01,955 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:23:01,955 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:23:01,955 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:23:01,955 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:01,955 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 22:23:01,955 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:01,955 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:23:01,956 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:23:01,956 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:01,956 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:23:01,956 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', '6♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '9♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我选择放弃，看看接下来会发生什么。', 'tone': '轻松'}}
2025-03-10 22:23:01,957 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:01,957 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 22:23:01,957 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:01,957 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:23:01,958 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:23:01,958 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:09,914 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:23:09,915 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:23:09.915971', 'table_talk': None}
2025-03-10 22:23:09,916 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:23:09,917 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:23:09,917 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:23:09,918 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:23:09,919 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:23:09,920 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:23:09,921 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:09,922 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:23:09,922 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:23:09,923 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:23:09,923 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:09,923 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:23:09,925 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:09,925 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:23:09,926 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:23:09,927 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:09,927 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:23:09,927 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♠', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '9♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:23:09,928 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:09,929 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:23:09,929 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:09,930 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:23:09,930 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:23:09,931 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:11,976 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:23:11,977 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:23:11,977 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:23:11,978 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:23:11,978 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:23:11,979 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:23:24,319 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.98"}, "reasoning": {"hand_strength": "7♠和3♠是一手极其弱的起手牌，几乎没有翻牌后的改进空间", "position_analysis": "处于早位，信息较少，加上对手状态激活，更需谨慎", "pot_odds": "底池30对投入的额外筹码来说不足以抵消手牌劣势", "opponent_reads": ["对手ai_2目前表现得很激进，可能持有更好的牌或在利用位置优势"]}, "table_talk": {"message": "大家今天都看起来状态不错，我就不跟这局浪费筹码了", "tone": "冷静且果断"}}
2025-03-10 22:23:24,319 - src.agents.llm - INFO - ==================================================

2025-03-10 22:23:24,320 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '大家今天都看起来状态不错，我就不跟这局浪费筹码了', 'tone': '冷静且果断'}
2025-03-10 22:23:24,320 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:23:24,320 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:23:24,321 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:23:24,321 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 22:23:24,322 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:23:24,322 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 22:23:24,322 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:23:24,323 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:23:24,323 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 1010
2025-03-10 22:23:24,325 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-10 22:23:24,325 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:23:24,326 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♠', '9♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:23:24,326 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♠', '9♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1010, 'current_bet': 20, 'is_active': False, 'cards': ('A♠', '9♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '大家今天都看起来状态不错，我就不跟这局浪费筹码了', 'tone': '冷静且果断'}}
2025-03-10 22:23:24,328 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:24,328 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:23:24,328 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:23:24,330 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:23:24,331 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:23:24,332 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:23:24,332 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♠', '9♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:23:24,334 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:23:31,687 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:23:31,688 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:23:31,689 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 22:23:31,690 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:23:31,691 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:23:31,692 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♣', '5♥')
2025-03-10 22:23:31,692 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♥', '5♦')
2025-03-10 22:23:31,693 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♠', 'Q♣')
2025-03-10 22:23:31,693 - src.engine.game - INFO - 玩家 ai_3 手牌: ('7♠', '4♣')
2025-03-10 22:23:31,694 - src.engine.game - INFO - 玩家 ai_4 手牌: ('2♥', '5♣')
2025-03-10 22:23:31,694 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 22:23:31,695 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 22:23:31,695 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-03-10 22:23:31,695 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 22:23:31,696 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 22:23:31,696 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 22:23:31,697 - src.engine.game - INFO - 游戏 308b3492-2011-4f89-a610-2b3dd16c94f1 开始，进入翻牌前阶段
2025-03-10 22:23:31,697 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:23:34,358 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:23:34,359 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:23:34,360 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:23:34,360 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:23:34,361 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:23:34,361 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:23:45,204 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"0","confidence":0.85},"reasoning":{"hand_strength":"我的手牌2♥, 5♣在德州扑克中属于非常弱的组合，尤其是在预翻牌阶段。这样的手牌很难形成强牌，除非公共牌面出现奇迹般的配合。","position_analysis":"虽然我在中间位置，这通常允许一些灵活性，但鉴于手牌质量极低，位置优势在这里并不足以弥补手牌的劣势。","pot_odds":"考虑到当前底池为30，而我需要至少加注到40才能继续游戏，这意味着即使跟注也需要投入更多资金去追逐一个胜率较低的局面，从数学角度来看这是不划算的。","opponent_reads":["对手们似乎都表现得比较谨慎，除了ai_2和ai_3有小额下注外，并没有显示出特别激进的行为模式。"]},"table_talk":{"message":"看来今天不是我的幸运日啊，希望下次能拿到更好的牌！","tone":"轻松友好"}}
2025-03-10 22:23:45,205 - src.agents.llm - INFO - ==================================================

2025-03-10 22:23:45,205 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天不是我的幸运日啊，希望下次能拿到更好的牌！', 'tone': '轻松友好'}
2025-03-10 22:23:45,206 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:23:45,206 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:23:45,206 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:23:45,206 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:23:45,206 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 22:23:45,207 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:23:45,207 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:23:45,207 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:45,207 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:23:45,207 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:23:45,207 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:23:45,207 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:45,207 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 22:23:45,207 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:45,208 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:23:45,208 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:23:45,208 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:45,208 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:23:45,209 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', '5♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '看来今天不是我的幸运日啊，希望下次能拿到更好的牌！', 'tone': '轻松友好'}}
2025-03-10 22:23:45,209 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:45,210 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 22:23:45,210 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:45,210 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:23:45,211 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:23:45,211 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:48,437 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:23:48,437 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:23:48.437286', 'table_talk': None}
2025-03-10 22:23:48,438 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:23:48,439 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:23:48,439 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:23:48,440 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:23:48,440 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:23:48,441 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:23:48,441 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:48,442 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:23:48,442 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:23:48,442 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:23:48,443 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:48,444 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:23:48,444 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:48,444 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:23:48,445 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:23:48,445 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:48,446 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:23:48,446 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:23:48,448 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:23:48,448 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:23:48,449 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:23:48,449 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:23:48,450 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:23:48,450 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:23:50,225 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:23:50,226 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:23:50,227 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:23:50,227 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:23:50,228 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:23:50,228 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:24:08,056 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.8"}, "reasoning": {"hand_strength": "A♥ and 5♦在预翻牌阶段属于边缘手牌，不足以进行大额押注，但也有成牌潜力。

", "position_analysis": "处于位置1，意味着应在其他玩家行动后做决定，同时面对两个竞争对手，要采用谨慎而观察的策略。", "pot_odds": "底池为30，跟注20后底池赔率尚可，可以尝试看翻牌情况。", "opponent_reads": ["ai_3已经下注20，可能手牌较强或在试图孤注一掷；", "ai_2下注10，显示出犹豫或试图诱导较低投入。"]}, "table_talk": {"message": "跟注看看你们谁能撑到翻牌，我可不会给你们太多机会。", "tone": "自信且略带挑衅"}}
2025-03-10 22:24:08,057 - src.agents.llm - INFO - ==================================================

2025-03-10 22:24:08,057 - src.agents.llm - ERROR - JSON解析失败: Invalid control character at: line 1 column 139 (char 138)
2025-03-10 22:24:08,057 - src.agents.llm - ERROR - 解析LLM响应时出错: Invalid control character at: line 1 column 139 (char 138)
2025-03-10 22:24:08,058 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): Invalid control character at: line 1 column 139 (char 138)
2025-03-10 22:24:09,062 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: Invalid control character at: line 1 column 139 (char 138)
2025-03-10 22:24:09,063 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 22:24:09,064 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 22:24:09,065 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 22:24:09,066 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 22:24:09,067 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 22:24:09,069 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:24:09,070 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:24:09,070 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:24:09,071 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:24:09,071 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:24:09,071 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:24:09,072 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:24:09,073 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:24:09,073 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:24:09,074 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:24:09,075 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:24:09,081 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:24:09,081 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:24:09,084 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:24:09,086 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 970, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:24:09,087 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:24:09,087 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:24:09,089 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:24:09,089 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:24:09,090 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:24:09,091 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:24:09,092 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:24:09,094 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:24:09,094 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:24:09,095 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:24:09,095 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:24:09,096 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:24:09,097 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:24:15,251 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌较弱，9♠和Q♣没有形成强牌组合","position_analysis":"位置2，处于早期位置，不利于后续行动","pot_odds":"底池赔率不高，不值得冒险","opponent_reads":["ai_1选择了CALL，可能持有中等强度的牌"]},"table_talk":{"message":"看来这局不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 22:24:15,254 - src.agents.llm - INFO - ==================================================

2025-03-10 22:24:15,255 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这局不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 22:24:15,256 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:24:15,256 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:24:15,257 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:24:15,258 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:24:15,259 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:24:15,260 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:24:15,262 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:24:15,263 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:24:15,264 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:24:15,265 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:24:15,265 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:24:15,266 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:24:15,266 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_3']
2025-03-10 22:24:15,267 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:24:15,267 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:24:15,268 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:24:15,268 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:24:15,269 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:24:15,270 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:24:15,270 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 970, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '4♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这局不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 22:24:15,272 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:24:15,272 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_3']
2025-03-10 22:24:15,273 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:24:15,274 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:24:15,274 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:24:15,274 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:24:15,275 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:24:15,276 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:24:15,277 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:24:15,277 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:24:15,278 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:24:15,279 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:24:15,279 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:24:23,394 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"7♠, 4♣是一手非常弱的起手牌，没有同花潜力，没有顺子潜力，没有高牌价值","position_analysis":"我处于相对靠后的位置(位置3)，已经有人跟注，如果我继续玩这手牌将处于不利位置","pot_odds":"底池有50，需要投入20才能继续，底池赔率约为2.5:1，但我的手牌胜率估计低于20%，不值得跟注","opponent_reads":["ai_1选择跟注，表明他可能有一手中等或较强的牌"]},"table_talk":{"message":"这手牌不适合战斗，留着火力下一把再战","tone":"平静"}}
2025-03-10 22:24:23,395 - src.agents.llm - INFO - ==================================================

2025-03-10 22:24:23,396 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不适合战斗，留着火力下一把再战', 'tone': '平静'}
2025-03-10 22:24:23,397 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:24:23,398 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:24:23,398 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:24:23,399 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 22:24:23,400 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:24:23,401 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 22:24:23,402 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:24:23,403 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:24:23,404 - src.engine.state - INFO - 玩家 ai_1 获得底池 50 筹码，当前筹码: 1020
2025-03-10 22:24:23,404 - src.engine.game - INFO - 玩家 ai_1 获得底池 50 筹码
2025-03-10 22:24:23,405 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:24:23,405 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('A♥', '5♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:24:23,406 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('A♥', '5♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 1020, 'current_bet': 20, 'is_active': False, 'cards': ('A♥', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不适合战斗，留着火力下一把再战', 'tone': '平静'}}
2025-03-10 22:24:23,407 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:24:23,408 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:24:23,408 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:24:23,409 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:24:23,409 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:24:23,410 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:24:23,410 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('A♥', '5♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:24:23,411 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:24:35,561 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:24:35,562 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:24:35,563 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 22:24:35,563 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:24:35,564 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:24:35,564 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♦', '3♥')
2025-03-10 22:24:35,565 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♣', '4♦')
2025-03-10 22:24:35,565 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♥', '4♠')
2025-03-10 22:24:35,565 - src.engine.game - INFO - 玩家 ai_3 手牌: ('7♠', '5♥')
2025-03-10 22:24:35,566 - src.engine.game - INFO - 玩家 ai_4 手牌: ('6♥', '9♠')
2025-03-10 22:24:35,566 - src.engine.state - INFO - 玩家 ai_3 下注 10 筹码
2025-03-10 22:24:35,567 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 22:24:35,567 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 22:24:35,568 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 22:24:35,568 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 22:24:35,569 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 22:24:35,569 - src.engine.game - INFO - 游戏 308b3492-2011-4f89-a610-2b3dd16c94f1 开始，进入翻牌前阶段
2025-03-10 22:24:35,570 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 22:25:30,137 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:25:30,140 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:25:36,140 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:25:36,144 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:25:49,283 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:25:49,287 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:25:49,331 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:25:49,749 - server - INFO - 正在创建游戏: c35c3b33-1319-480d-bdeb-17dfc1db25ed, 玩家数量: 5
2025-03-10 22:25:49,750 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:25:49,750 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:25:49,751 - src.engine.game - INFO - 游戏 c35c3b33-1319-480d-bdeb-17dfc1db25ed 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:25:49,751 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:25:49,751 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:25:49,752 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:25:49,753 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:25:49,753 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:25:49,754 - src.engine.game - INFO - Added player ai_1 to game c35c3b33-1319-480d-bdeb-17dfc1db25ed
2025-03-10 22:25:49,754 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:25:49,754 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:25:49,755 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:25:49,755 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:25:49,756 - src.engine.game - INFO - Added player ai_2 to game c35c3b33-1319-480d-bdeb-17dfc1db25ed
2025-03-10 22:25:49,756 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:25:49,756 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:25:49,758 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:25:49,758 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:25:49,758 - src.engine.game - INFO - Added player ai_3 to game c35c3b33-1319-480d-bdeb-17dfc1db25ed
2025-03-10 22:25:49,758 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:25:49,759 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:25:49,760 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:25:49,760 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:25:49,760 - src.engine.game - INFO - Added player ai_4 to game c35c3b33-1319-480d-bdeb-17dfc1db25ed
2025-03-10 22:25:49,761 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:25:49,761 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:25:49,761 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:25:49,762 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♠', '7♠')
2025-03-10 22:25:49,762 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♥', '5♥')
2025-03-10 22:25:49,762 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♠', '6♠')
2025-03-10 22:25:49,762 - src.engine.game - INFO - 玩家 ai_3 手牌: ('10♠', 'J♠')
2025-03-10 22:25:49,763 - src.engine.game - INFO - 玩家 ai_4 手牌: ('6♣', '3♣')
2025-03-10 22:25:49,763 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:25:49,763 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:25:49,763 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:25:49,764 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:25:49,764 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:25:49,764 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:25:49,764 - src.engine.game - INFO - 游戏 c35c3b33-1319-480d-bdeb-17dfc1db25ed 开始，进入翻牌前阶段
2025-03-10 22:25:49,764 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:25:49,764 - server - INFO - 游戏 c35c3b33-1319-480d-bdeb-17dfc1db25ed 已开始
2025-03-10 22:25:49,765 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:25:50,235 - server - INFO - WebSocket连接已建立: c35c3b33-1319-480d-bdeb-17dfc1db25ed
2025-03-10 22:25:50,235 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', '7♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('8♥', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♠', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'J♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '3♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:25:50,237 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:25:50,237 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:25:50,237 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:25:50,237 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:25:50,237 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:25:50,238 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:25:58,131 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":20,"confidence":0.75},"reasoning":{"hand_strength":"10♠-J♠是一手中等强度的同花连牌，有潜力发展成同花或顺子，但目前还不是特别强的起手牌。","position_analysis":"我在相对靠后的位置(位置3)，已经有人在我前面下注，这给了我一些信息优势。","pot_odds":"底池已有30，我需要投入20才能继续，底池赔率是30:20=1.5:1，对于同花连牌来说值得跟注。","opponent_reads":["ai_2已经加注到20，可能有不错的起手牌，但也可能只是在尝试偷盲。","其他玩家尚未采取行动，需要保持警惕。"]},"table_talk":{"message":"同花连牌，有点意思。我跟了。","tone":"平静自信"}}
2025-03-10 22:25:58,132 - src.agents.llm - INFO - ==================================================

2025-03-10 22:25:58,133 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '同花连牌，有点意思。我跟了。', 'tone': '平静自信'}
2025-03-10 22:25:58,134 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:25:58,134 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:25:58,135 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-03-10 22:25:58,135 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:25:58,136 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:25:58,137 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:25:58,139 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:25:58,140 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:25:58,142 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:25:58,143 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:25:58,143 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:25:58,144 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:25:58,144 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:25:58,144 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:25:58,145 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:25:58,145 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:25:58,146 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:25:58,146 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:25:58,147 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', '7♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('8♥', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♠', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'J♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '3♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '同花连牌，有点意思。我跟了。', 'tone': '平静自信'}}
2025-03-10 22:25:58,148 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:25:58,149 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:25:58,149 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:25:58,150 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:25:58,151 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:25:58,151 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:26:03,124 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:26:03,126 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:26:03,126 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:26:03,127 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:26:03,128 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:26:03,130 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:26:13,348 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"我的手牌6♣, 3♣在预翻牌阶段非常弱，没有直接的赢面。","position_analysis":"处于中间位置，既不是最好的也不是最差的位置来采取激进行动。","pot_odds":"当前底池赔率并不支持我用这样的手牌跟注或加注。","opponent_reads":["ai_2和ai_3已经选择跟注，表明他们可能持有较好的起始手牌。"]},"table_talk":{"message":"这次就让给你们了，好运！","tone":"轻松"}}
2025-03-10 22:26:13,349 - src.agents.llm - INFO - ==================================================

2025-03-10 22:26:13,351 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次就让给你们了，好运！', 'tone': '轻松'}
2025-03-10 22:26:13,351 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:26:13,352 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:26:13,352 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:26:13,353 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:26:13,353 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 22:26:13,353 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:26:13,354 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:26:13,354 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:26:13,355 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:26:13,355 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:26:13,356 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:26:13,356 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:26:13,357 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 22:26:13,357 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:26:13,358 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:26:13,358 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:26:13,359 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:26:13,361 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:26:13,361 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', '7♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('8♥', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♠', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'J♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次就让给你们了，好运！', 'tone': '轻松'}}
2025-03-10 22:26:13,363 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:26:13,363 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 22:26:13,364 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:26:13,364 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:26:13,365 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:26:13,365 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:27:11,663 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:27:11,666 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:27:17,292 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:27:17,296 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:27:33,217 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:27:33,584 - server - INFO - 正在创建游戏: 97f0bed0-f9fc-49b3-8156-bcc10002b186, 玩家数量: 5
2025-03-10 22:27:33,584 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:27:33,586 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:27:33,586 - src.engine.game - INFO - 游戏 97f0bed0-f9fc-49b3-8156-bcc10002b186 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:27:33,587 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:27:33,587 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:27:33,587 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:33,589 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:27:33,589 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:27:33,589 - src.engine.game - INFO - Added player ai_1 to game 97f0bed0-f9fc-49b3-8156-bcc10002b186
2025-03-10 22:27:33,589 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:27:33,590 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:33,592 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:27:33,592 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:27:33,592 - src.engine.game - INFO - Added player ai_2 to game 97f0bed0-f9fc-49b3-8156-bcc10002b186
2025-03-10 22:27:33,592 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:27:33,593 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:33,594 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:27:33,594 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:27:33,594 - src.engine.game - INFO - Added player ai_3 to game 97f0bed0-f9fc-49b3-8156-bcc10002b186
2025-03-10 22:27:33,595 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:27:33,595 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:33,596 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:27:33,596 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:27:33,597 - src.engine.game - INFO - Added player ai_4 to game 97f0bed0-f9fc-49b3-8156-bcc10002b186
2025-03-10 22:27:33,597 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:27:33,597 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:27:33,597 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:27:33,597 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♦', '4♠')
2025-03-10 22:27:33,598 - src.engine.game - INFO - 玩家 ai_1 手牌: ('J♥', '2♠')
2025-03-10 22:27:33,598 - src.engine.game - INFO - 玩家 ai_2 手牌: ('J♣', 'A♣')
2025-03-10 22:27:33,598 - src.engine.game - INFO - 玩家 ai_3 手牌: ('9♦', 'A♦')
2025-03-10 22:27:33,598 - src.engine.game - INFO - 玩家 ai_4 手牌: ('K♥', '9♠')
2025-03-10 22:27:33,599 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:27:33,599 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:27:33,599 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:27:33,599 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:27:33,600 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:27:33,600 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:27:33,600 - src.engine.game - INFO - 游戏 97f0bed0-f9fc-49b3-8156-bcc10002b186 开始，进入翻牌前阶段
2025-03-10 22:27:33,600 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:27:33,601 - server - INFO - 游戏 97f0bed0-f9fc-49b3-8156-bcc10002b186 已开始
2025-03-10 22:27:33,601 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:27:37,349 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:27:37,608 - server - INFO - 正在创建游戏: 0be225cc-d212-4d48-9f68-7aed974ff8f4, 玩家数量: 5
2025-03-10 22:27:37,609 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:27:37,609 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:27:37,610 - src.engine.game - INFO - 游戏 0be225cc-d212-4d48-9f68-7aed974ff8f4 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:27:37,610 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:27:37,611 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:27:37,611 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:37,612 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:27:37,613 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:27:37,613 - src.engine.game - INFO - Added player ai_1 to game 0be225cc-d212-4d48-9f68-7aed974ff8f4
2025-03-10 22:27:37,613 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:27:37,614 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:37,615 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:27:37,616 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:27:37,616 - src.engine.game - INFO - Added player ai_2 to game 0be225cc-d212-4d48-9f68-7aed974ff8f4
2025-03-10 22:27:37,616 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:27:37,616 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:37,618 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:27:37,618 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:27:37,619 - src.engine.game - INFO - Added player ai_3 to game 0be225cc-d212-4d48-9f68-7aed974ff8f4
2025-03-10 22:27:37,619 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:27:37,619 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:37,621 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:27:37,621 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:27:37,622 - src.engine.game - INFO - Added player ai_4 to game 0be225cc-d212-4d48-9f68-7aed974ff8f4
2025-03-10 22:27:37,622 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:27:37,622 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:27:37,623 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:27:37,623 - src.engine.game - INFO - 玩家 player_0 手牌: ('J♦', '7♠')
2025-03-10 22:27:37,623 - src.engine.game - INFO - 玩家 ai_1 手牌: ('J♥', 'Q♦')
2025-03-10 22:27:37,623 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♣', 'K♦')
2025-03-10 22:27:37,624 - src.engine.game - INFO - 玩家 ai_3 手牌: ('A♠', '8♥')
2025-03-10 22:27:37,624 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♥', '4♠')
2025-03-10 22:27:37,624 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:27:37,624 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:27:37,625 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:27:37,625 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:27:37,625 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:27:37,625 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:27:37,626 - src.engine.game - INFO - 游戏 0be225cc-d212-4d48-9f68-7aed974ff8f4 开始，进入翻牌前阶段
2025-03-10 22:27:37,626 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:27:37,626 - server - INFO - 游戏 0be225cc-d212-4d48-9f68-7aed974ff8f4 已开始
2025-03-10 22:27:37,626 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:27:40,441 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:27:40,508 - server - INFO - 正在创建游戏: 1f81c2ea-6366-4835-b0df-0391de8c9116, 玩家数量: 5
2025-03-10 22:27:40,509 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:27:40,509 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:27:40,509 - src.engine.game - INFO - 游戏 1f81c2ea-6366-4835-b0df-0391de8c9116 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:27:40,509 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:27:40,509 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:27:40,510 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:40,511 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:27:40,511 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:27:40,511 - src.engine.game - INFO - Added player ai_1 to game 1f81c2ea-6366-4835-b0df-0391de8c9116
2025-03-10 22:27:40,512 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:27:40,512 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:40,513 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:27:40,513 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:27:40,514 - src.engine.game - INFO - Added player ai_2 to game 1f81c2ea-6366-4835-b0df-0391de8c9116
2025-03-10 22:27:40,514 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:27:40,514 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:40,516 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:27:40,517 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:27:40,517 - src.engine.game - INFO - Added player ai_3 to game 1f81c2ea-6366-4835-b0df-0391de8c9116
2025-03-10 22:27:40,517 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:27:40,517 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:40,519 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:27:40,519 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:27:40,519 - src.engine.game - INFO - Added player ai_4 to game 1f81c2ea-6366-4835-b0df-0391de8c9116
2025-03-10 22:27:40,520 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:27:40,520 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:27:40,520 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:27:40,520 - src.engine.game - INFO - 玩家 player_0 手牌: ('J♣', 'Q♣')
2025-03-10 22:27:40,521 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♣', '6♠')
2025-03-10 22:27:40,521 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♠', 'Q♥')
2025-03-10 22:27:40,521 - src.engine.game - INFO - 玩家 ai_3 手牌: ('Q♦', '7♥')
2025-03-10 22:27:40,521 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♦', '6♥')
2025-03-10 22:27:40,522 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:27:40,522 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:27:40,522 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:27:40,522 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:27:40,522 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:27:40,523 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:27:40,523 - src.engine.game - INFO - 游戏 1f81c2ea-6366-4835-b0df-0391de8c9116 开始，进入翻牌前阶段
2025-03-10 22:27:40,523 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:27:40,523 - server - INFO - 游戏 1f81c2ea-6366-4835-b0df-0391de8c9116 已开始
2025-03-10 22:27:40,523 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:27:48,671 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:27:48,864 - server - INFO - 正在创建游戏: 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91, 玩家数量: 5
2025-03-10 22:27:48,865 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:27:48,865 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:27:48,866 - src.engine.game - INFO - 游戏 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:27:48,866 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:27:48,866 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:27:48,867 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:48,869 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:27:48,869 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:27:48,870 - src.engine.game - INFO - Added player ai_1 to game 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91
2025-03-10 22:27:48,870 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:27:48,870 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:48,872 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:27:48,873 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:27:48,874 - src.engine.game - INFO - Added player ai_2 to game 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91
2025-03-10 22:27:48,874 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:27:48,875 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:48,877 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:27:48,878 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:27:48,878 - src.engine.game - INFO - Added player ai_3 to game 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91
2025-03-10 22:27:48,878 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:27:48,879 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:27:48,880 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:27:48,880 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:27:48,881 - src.engine.game - INFO - Added player ai_4 to game 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91
2025-03-10 22:27:48,881 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:27:48,881 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:27:48,881 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:27:48,882 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♥', '9♣')
2025-03-10 22:27:48,882 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♠', '5♣')
2025-03-10 22:27:48,882 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♥', '5♦')
2025-03-10 22:27:48,882 - src.engine.game - INFO - 玩家 ai_3 手牌: ('K♥', '3♦')
2025-03-10 22:27:48,883 - src.engine.game - INFO - 玩家 ai_4 手牌: ('K♦', '6♣')
2025-03-10 22:27:48,883 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:27:48,883 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:27:48,884 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:27:48,884 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:27:48,885 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:27:48,885 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:27:48,885 - src.engine.game - INFO - 游戏 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91 开始，进入翻牌前阶段
2025-03-10 22:27:48,886 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:27:48,886 - server - INFO - 游戏 5ffe64dc-24c8-46fd-a4a6-309a09c1ca91 已开始
2025-03-10 22:27:48,886 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:28:02,546 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:28:02,550 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:30:39,513 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:30:39,517 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:30:45,327 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 22:30:45,331 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 22:30:46,759 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:30:47,086 - server - INFO - 正在创建游戏: 34a90bed-c71c-4a18-a303-522cd8a5fbe5, 玩家数量: 5
2025-03-10 22:30:47,086 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:30:47,087 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:30:47,087 - src.engine.game - INFO - 游戏 34a90bed-c71c-4a18-a303-522cd8a5fbe5 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:30:47,088 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:30:47,088 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:30:47,088 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:30:47,090 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:30:47,091 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:30:47,091 - src.engine.game - INFO - Added player ai_1 to game 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:30:47,092 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:30:47,092 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:30:47,096 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:30:47,096 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:30:47,097 - src.engine.game - INFO - Added player ai_2 to game 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:30:47,097 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:30:47,098 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:30:47,101 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:30:47,101 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:30:47,102 - src.engine.game - INFO - Added player ai_3 to game 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:30:47,102 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:30:47,103 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:30:47,107 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:30:47,107 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:30:47,108 - src.engine.game - INFO - Added player ai_4 to game 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:30:47,108 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:30:47,108 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:30:47,109 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:30:47,109 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', '10♣')
2025-03-10 22:30:47,109 - src.engine.game - INFO - 玩家 ai_1 手牌: ('2♣', '7♦')
2025-03-10 22:30:47,109 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♦', 'Q♥')
2025-03-10 22:30:47,110 - src.engine.game - INFO - 玩家 ai_3 手牌: ('8♥', '2♠')
2025-03-10 22:30:47,110 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♠', 'A♥')
2025-03-10 22:30:47,110 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:30:47,111 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:30:47,111 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:30:47,111 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:30:47,111 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:30:47,112 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:30:47,112 - src.engine.game - INFO - 游戏 34a90bed-c71c-4a18-a303-522cd8a5fbe5 开始，进入翻牌前阶段
2025-03-10 22:30:47,112 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:30:47,112 - server - INFO - 游戏 34a90bed-c71c-4a18-a303-522cd8a5fbe5 已开始
2025-03-10 22:30:47,113 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:30:47,390 - server - INFO - WebSocket连接已建立: 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:30:47,390 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('2♣', '7♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', '2♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:30:47,392 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:30:47,392 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:30:47,392 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:30:47,393 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:30:47,393 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:30:47,393 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:30:56,996 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"8-2异花是德州扑克中最差的起手牌之一，几乎没有任何价值。没有同花潜力，没有顺子潜力，没有高牌价值。","position_analysis":"我处于早期位置(位置3)，这是一个不利的位置，因为在我之后还有一名玩家要行动。在这个位置玩弱牌风险很大。","pot_odds":"底池有30，需要下注20才能继续，底池赔率为1.5:1，但我的手牌胜率极低，不值得继续投入。","opponent_reads":["ai_2已经加注到20，表明可能有强力手牌","前面的ai_1选择了跟注而不是弃牌，也可能有一定强度的手牌","在这种情况下与多个可能有强牌的对手对抗风险太大"]},"table_talk":{"message":"这手牌连擦鞋都不配，我弃了。","tone":"轻松幽默"}}
2025-03-10 22:30:56,997 - src.agents.llm - INFO - ==================================================

2025-03-10 22:30:56,997 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌连擦鞋都不配，我弃了。', 'tone': '轻松幽默'}
2025-03-10 22:30:56,998 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:30:56,998 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:30:56,998 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:30:56,998 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:30:56,998 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:30:56,999 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:30:56,999 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:30:56,999 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:30:56,999 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:30:56,999 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:30:56,999 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:30:57,000 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:30:57,000 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:30:57,000 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:30:57,000 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:30:57,000 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:30:57,000 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:30:57,001 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:30:57,001 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('2♣', '7♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌连擦鞋都不配，我弃了。', 'tone': '轻松幽默'}}
2025-03-10 22:30:57,001 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:30:57,002 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:30:57,002 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:30:57,003 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:30:57,004 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:30:57,005 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:02,012 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:31:02,013 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:31:02,013 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:31:02,014 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:31:02,015 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:31:02,015 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:31:15,670 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"持有A高牌，虽然不是最强的手牌但具有一定的潜力。在没有公共牌的情况下，A8可以尝试控制底池大小来观察对手反应。","position_analysis":"处于中后位置，可以根据前面玩家的动作做出更灵活的决策。目前看来，至少有一位玩家已经表现出兴趣（加注），这可能意味着他们手上有不错的牌。通过加注，我可以测试他们的决心并可能迫使弱手退出。","pot_odds":"当前底池为30，我的加注将使底池增加到90，对于我来说这是一个合理的投资，特别是考虑到我的筹码量足够支持后续的游戏。","opponent_reads":["ai_2进行了标准的最小加注，可能是试探性的动作；ai_1跟注了这个小加注，显示出对游戏的兴趣，但不一定是强牌。"]},"table_talk":{"message":"看起来大家都有点保守啊，让我们加快一点节奏吧！","tone":"轻松自信"}}
2025-03-10 22:31:15,671 - src.agents.llm - INFO - ==================================================

2025-03-10 22:31:15,672 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看起来大家都有点保守啊，让我们加快一点节奏吧！', 'tone': '轻松自信'}
2025-03-10 22:31:15,672 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 22:31:15,672 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:31:15,672 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 22:31:15,673 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 22:31:15,673 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:31:15,673 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:31:15,673 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:31:15,673 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:31:15,674 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:31:15,674 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:31:15,674 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:31:15,674 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:15,674 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:31:15,674 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:31:15,675 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:31:15,675 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:31:15,675 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:15,675 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:31:15,675 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '10♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('2♣', '7♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看起来大家都有点保守啊，让我们加快一点节奏吧！', 'tone': '轻松自信'}}
2025-03-10 22:31:15,676 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:15,676 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:31:15,676 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:31:15,676 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:31:15,677 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:31:15,677 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:26,393 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'ALL_IN', 'amount': 0}
2025-03-10 22:31:26,394 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'ALL_IN', 'amount': 0, 'timestamp': '2025-03-10T22:31:26.394252', 'table_talk': None}
2025-03-10 22:31:26,394 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.ALL_IN
2025-03-10 22:31:26,394 - src.engine.state - INFO - 玩家 player_0 全下 1000 筹码，已标记为已行动
2025-03-10 22:31:26,394 - src.engine.game - INFO - 玩家 player_0 全下
2025-03-10 22:31:26,395 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by player_0
2025-03-10 22:31:26,395 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:31:26,395 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:31:26,395 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:26,395 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:31:26,396 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:31:26,396 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:31:26,396 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:26,396 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:31:26,397 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:26,397 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=True
2025-03-10 22:31:26,397 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:31:26,398 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:31:26,398 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:26,398 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:31:26,399 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 1090, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 1000, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 1000, 'is_active': True, 'cards': ('10♠', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': 'ALL_IN', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('2♣', '7♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:31:26,400 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:26,400 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:31:26,400 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:26,401 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=True
2025-03-10 22:31:26,401 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:31:26,402 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:31:26,402 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:30,707 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:31:30,709 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:31:30,710 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:31:30,712 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:31:30,712 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:31:30,713 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:31:42,801 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "手牌2♣, 7♦是德州扑克中最弱的起手牌，几乎没有任何发展潜力", "position_analysis": "在这个早期位置上面对对手的激进动作，我处于不利位置", "pot_odds": "尽管底池较大，但跟注所需投入与手牌强度完全不成正比，风险远大于回报", "opponent_reads": ["player_0全下明显展示强势，ai_4和ai_2的下注虽小但也不得不小心应对"]}, "table_talk": {"message": "这牌简直垃圾，我绝不会浪费筹码在这种毫无希望的牌上！", "tone": "轻蔑"} }
2025-03-10 22:31:42,802 - src.agents.llm - INFO - ==================================================

2025-03-10 22:31:42,802 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌简直垃圾，我绝不会浪费筹码在这种毫无希望的牌上！', 'tone': '轻蔑'}
2025-03-10 22:31:42,802 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:31:42,803 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:31:42,803 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:31:42,803 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:31:42,803 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:31:42,803 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:31:42,803 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:31:42,804 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:42,804 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:31:42,804 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:31:42,804 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:31:42,804 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:42,804 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_4']
2025-03-10 22:31:42,805 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:42,805 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=True
2025-03-10 22:31:42,805 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:31:42,805 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:31:42,805 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:42,805 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:31:42,806 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 1090, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 1000, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 1000, 'is_active': True, 'cards': ('10♠', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌简直垃圾，我绝不会浪费筹码在这种毫无希望的牌上！', 'tone': '轻蔑'}}
2025-03-10 22:31:42,806 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:42,807 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_4']
2025-03-10 22:31:42,807 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:42,808 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=True
2025-03-10 22:31:42,809 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:31:42,810 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:31:42,810 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:31:42,812 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:31:42,812 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:31:42,813 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:31:42,813 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:31:42,813 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:31:42,814 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:31:53,617 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"手牌为3♦和Q♥，属于较弱的手牌，尤其是在PRE_FLOP阶段，没有形成任何潜在强牌的可能性。","position_analysis":"处于中间位置，前面有玩家已经ALL_IN，后面还有玩家未行动，位置优势不明显。","pot_odds":"底池为1090，当前最大注为1000，我的筹码为980，不足以进行最小加注，且手牌强度不足以支持跟注或加注。","opponent_reads":["player_0已经ALL_IN，表明其手牌可能较强，ai_4进行了小额加注，可能是试探性行为。"]},"table_talk":{"message":"看来这局不适合我，我选择弃牌。","tone":"冷静"}}
2025-03-10 22:31:53,617 - src.agents.llm - INFO - ==================================================

2025-03-10 22:31:53,618 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这局不适合我，我选择弃牌。', 'tone': '冷静'}
2025-03-10 22:31:53,618 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:31:53,618 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:31:53,619 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:31:53,619 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:31:53,619 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:31:53,620 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:31:53,620 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:31:53,620 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:53,620 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:31:53,620 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_4
2025-03-10 22:31:53,621 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:31:53,621 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:53,621 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:31:53,621 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:53,621 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=True
2025-03-10 22:31:53,621 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:31:53,621 - src.engine.game - INFO - 玩家 ai_4 下注额(60)不等于最大下注额(1000)，回合继续
2025-03-10 22:31:53,622 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:31:53,622 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:31:53,622 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 1090, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 1000, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 1000, 'is_active': True, 'cards': ('10♠', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这局不适合我，我选择弃牌。', 'tone': '冷静'}}
2025-03-10 22:31:53,623 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:31:53,623 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:31:53,623 - src.engine.game - INFO - 当前最大下注额: 1000
2025-03-10 22:31:53,623 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=1000, is_all_in=True
2025-03-10 22:31:53,624 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:31:53,625 - src.engine.game - INFO - 玩家 ai_4 下注额(60)不等于最大下注额(1000)，回合继续
2025-03-10 22:31:53,626 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:31:53,628 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:31:53,629 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:31:53,629 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:31:53,629 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:31:53,629 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:31:53,630 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:32:04,998 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"我的手牌是A高，但面对对手的全下，考虑到我剩余的筹码量不足以满足最小加注要求，且没有足够的信息来判断对手的手牌强度，这使得跟注的风险较大。","position_analysis":"虽然我在桌上的位置较好，可以观察到其他玩家的行为后再做决定，但在这种情况下，位置优势并不足以弥补筹码劣势。","pot_odds":"底池赔率目前不利于我进行大额投资，特别是考虑到需要投入所有剩余筹码才能继续游戏。","opponent_reads":["对手直接选择了全下，表明他可能持有非常强的手牌或者是在尝试通过激进的打法逼迫他人弃牌。"]},"table_talk":{"message":"这次就先让给你了，下次见！","tone":"轻松友好"}}
2025-03-10 22:32:04,999 - src.agents.llm - INFO - ==================================================

2025-03-10 22:32:04,999 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次就先让给你了，下次见！', 'tone': '轻松友好'}
2025-03-10 22:32:04,999 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:32:05,000 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:32:05,000 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:32:05,001 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 22:32:05,001 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:32:05,001 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 22:32:05,001 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:32:05,001 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:32:05,002 - src.engine.state - INFO - 玩家 player_0 获得底池 1090 筹码，当前筹码: 1090
2025-03-10 22:32:05,002 - src.engine.game - INFO - 玩家 player_0 获得底池 1090 筹码
2025-03-10 22:32:05,002 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:32:05,002 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 1090, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('10♠', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:32:05,002 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 1000, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 1090, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('10♠', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1090, 'current_bet': 1000, 'is_active': False, 'cards': ('10♠', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次就先让给你了，下次见！', 'tone': '轻松友好'}}
2025-03-10 22:32:05,003 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:05,003 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:32:05,004 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:32:05,004 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:32:05,004 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:32:05,004 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:32:05,005 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 1090, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('10♠', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:32:05,006 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:32:06,039 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:32:06,039 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:32:06,039 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 22:32:06,039 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:06,040 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:32:06,040 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♣', 'A♣')
2025-03-10 22:32:06,040 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♥', '10♥')
2025-03-10 22:32:06,040 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', '7♠')
2025-03-10 22:32:06,040 - src.engine.game - INFO - 玩家 ai_3 手牌: ('A♠', '2♣')
2025-03-10 22:32:06,041 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♥', 'Q♠')
2025-03-10 22:32:06,041 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 22:32:06,041 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 22:32:06,041 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-03-10 22:32:06,042 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 22:32:06,043 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 22:32:06,043 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 22:32:06,043 - src.engine.game - INFO - 游戏 34a90bed-c71c-4a18-a303-522cd8a5fbe5 开始，进入翻牌前阶段
2025-03-10 22:32:06,043 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:32:10,013 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:32:10,014 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:32:10,014 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:32:10,014 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:32:10,014 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:32:10,014 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:32:21,949 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"60","confidence":0.75},"reasoning":{"hand_strength":"JQ是一个不错起手牌，特别是在前位有加注的情况下，这表明我的牌可能比平均更好。","position_analysis":"位于中间位置，有足够的信息来做出决策，同时也有机会控制底池大小。","pot_odds":"当前底池赔率尚可接受，通过适当加注可以增加潜在回报。","opponent_reads":["ai_3的20筹码下注显示出一定的牌力或尝试偷取盲注，但考虑到我的牌面，我认为值得继续游戏。"]},"table_talk":{"message":"看来大家都挺有信心的嘛，那我也来加点乐趣吧。","tone":"轻松自信"}}
2025-03-10 22:32:21,950 - src.agents.llm - INFO - ==================================================

2025-03-10 22:32:21,951 - src.agents.llm - INFO - 成功将字符串金额 60 转换为数字 60.0
2025-03-10 22:32:21,951 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺有信心的嘛，那我也来加点乐趣吧。', 'tone': '轻松自信'}
2025-03-10 22:32:21,951 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 22:32:21,951 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:32:21,951 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 22:32:21,951 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 22:32:21,952 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:32:21,952 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:32:21,952 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:32:21,952 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:21,952 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:32:21,952 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:32:21,952 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:32:21,953 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:21,953 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:21,953 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:21,953 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:32:21,953 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:32:21,954 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:32:21,954 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:32:21,954 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1090, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', 'A♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', '10♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('Q♣', '7♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '2♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 60, 'is_active': True, 'cards': ('J♥', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺有信心的嘛，那我也来加点乐趣吧。', 'tone': '轻松自信'}}
2025-03-10 22:32:21,954 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:21,955 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:21,955 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:21,955 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:32:21,955 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:32:21,956 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:32:21,956 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:32:22,292 - server - INFO - 正在创建游戏: 194985da-8b3f-4a8f-a549-a2cb3401ee19, 玩家数量: 5
2025-03-10 22:32:22,293 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:32:22,293 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:32:22,294 - src.engine.game - INFO - 游戏 194985da-8b3f-4a8f-a549-a2cb3401ee19 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:32:22,294 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:32:22,294 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:32:22,295 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:22,296 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:32:22,296 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:32:22,296 - src.engine.game - INFO - Added player ai_1 to game 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:32:22,296 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:32:22,297 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:22,298 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:32:22,298 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:32:22,298 - src.engine.game - INFO - Added player ai_2 to game 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:32:22,298 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:32:22,298 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:22,299 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:32:22,300 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:32:22,300 - src.engine.game - INFO - Added player ai_3 to game 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:32:22,300 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:32:22,300 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:22,301 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:32:22,301 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:32:22,302 - src.engine.game - INFO - Added player ai_4 to game 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:32:22,302 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:32:22,302 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:22,302 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:32:22,302 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♦', '2♦')
2025-03-10 22:32:22,302 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♣', '10♠')
2025-03-10 22:32:22,303 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♥', '8♦')
2025-03-10 22:32:22,303 - src.engine.game - INFO - 玩家 ai_3 手牌: ('K♦', 'K♣')
2025-03-10 22:32:22,303 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♦', '10♣')
2025-03-10 22:32:22,303 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:32:22,303 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:32:22,303 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:32:22,304 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:32:22,304 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:32:22,304 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:32:22,304 - src.engine.game - INFO - 游戏 194985da-8b3f-4a8f-a549-a2cb3401ee19 开始，进入翻牌前阶段
2025-03-10 22:32:22,304 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:32:22,304 - server - INFO - 游戏 194985da-8b3f-4a8f-a549-a2cb3401ee19 已开始
2025-03-10 22:32:22,304 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:32:22,839 - server - INFO - WebSocket连接已建立: 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:32:22,839 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', '10♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♦', 'K♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♦', '10♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:32:22,840 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:32:22,841 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:32:22,841 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:32:22,841 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:32:22,841 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:32:22,842 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:32:31,546 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.9},"reasoning":{"hand_strength":"我有一对K，这是非常强的起手牌，在德州扑克中仅次于AA。","position_analysis":"我在相对早位置(位置3)，虽然不是最理想的位置，但手牌强度足以弥补位置劣势。","pot_odds":"当前底池30，最大注20，我加注到60是底池的2倍，给出了合理的价值。","opponent_reads":["ai_2已经加注到20，显示出一定的手牌强度，但我的一对K足够强大可以进行再加注","其他玩家还未表现出强势，通过加注我可以获取更多信息并建立桌面形象"]},"table_talk":{"message":"看来有人想玩点大的啊。我很乐意奉陪。","tone":"自信"}}
2025-03-10 22:32:31,547 - src.agents.llm - INFO - ==================================================

2025-03-10 22:32:31,548 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来有人想玩点大的啊。我很乐意奉陪。', 'tone': '自信'}
2025-03-10 22:32:31,548 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 22:32:31,548 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 22:32:31,548 - src.engine.state - INFO - 玩家 ai_3 加注到 60 筹码，已标记为已行动
2025-03-10 22:32:31,549 - src.engine.game - INFO - 玩家 ai_3 加注到 60
2025-03-10 22:32:31,549 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_3
2025-03-10 22:32:31,549 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:32:31,549 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:32:31,549 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:31,549 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:32:31,550 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:32:31,550 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:32:31,550 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:31,550 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:31,551 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:31,551 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:32:31,551 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:32:31,551 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:32:31,552 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:32:31,552 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', '10♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('K♦', 'K♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('J♦', '10♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想玩点大的啊。我很乐意奉陪。', 'tone': '自信'}}
2025-03-10 22:32:31,553 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:31,553 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:31,553 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:31,553 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:32:31,554 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:32:31,554 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:32:31,554 - server - INFO - WebSocket连接已断开: 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:32:31,554 - server - ERROR - 连接已关闭，无法发送游戏状态: 34a90bed-c71c-4a18-a303-522cd8a5fbe5
2025-03-10 22:32:36,571 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:32:36,572 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:32:36,572 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:32:36,572 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:32:36,572 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:32:36,573 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:32:48,604 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"60","confidence":0.75},"reasoning":{"hand_strength":"J♦, 10♣构成了一手中等偏上的起手牌，有潜力形成顺子。在没有看到公共牌前，这手牌值得跟注看翻牌。","position_analysis":"位于中间位置，需要谨慎行事以避免被后面的玩家利用。但是鉴于已经有人加注，表明可能存在强手，跟注是合理的策略。","pot_odds":"考虑到当前底池大小与所需投入的比例，跟注的代价是可以接受的。","opponent_reads":["ai_3进行了显著的加注，可能持有较强的手牌或尝试进行诈唬。"]},"table_talk":{"message":"看来今天大家的手气都不错啊，我也来凑个热闹吧。","tone":"轻松友好"}}
2025-03-10 22:32:48,604 - src.agents.llm - INFO - ==================================================

2025-03-10 22:32:48,604 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来今天大家的手气都不错啊，我也来凑个热闹吧。', 'tone': '轻松友好'}
2025-03-10 22:32:48,604 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 22:32:48,605 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 22:32:48,605 - src.engine.state - INFO - 玩家 ai_4 跟注 60 筹码，已标记为已行动
2025-03-10 22:32:48,605 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 22:32:48,605 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 22:32:48,605 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:32:48,606 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:32:48,606 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:48,606 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:32:48,606 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:32:48,606 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:32:48,606 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:48,606 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:48,607 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:48,607 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:32:48,607 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:32:48,607 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:32:48,607 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:32:48,607 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 150, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', '10♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('K♦', 'K♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('J♦', '10♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '看来今天大家的手气都不错啊，我也来凑个热闹吧。', 'tone': '轻松友好'}}
2025-03-10 22:32:48,608 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:32:48,608 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:48,609 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:32:48,609 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:32:48,609 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:32:48,609 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:32:51,972 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:32:52,044 - server - INFO - 正在创建游戏: 1ef237b8-8360-4306-8eb9-29e05f1bd273, 玩家数量: 5
2025-03-10 22:32:52,044 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:32:52,044 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:32:52,045 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:32:52,045 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:32:52,045 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:32:52,045 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:52,047 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:32:52,047 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:32:52,048 - src.engine.game - INFO - Added player ai_1 to game 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 22:32:52,048 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:32:52,048 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:52,050 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:32:52,050 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:32:52,050 - src.engine.game - INFO - Added player ai_2 to game 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 22:32:52,051 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:32:52,051 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:52,052 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:32:52,052 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:32:52,052 - src.engine.game - INFO - Added player ai_3 to game 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 22:32:52,053 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:32:52,053 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:32:52,054 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:32:52,054 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:32:52,054 - src.engine.game - INFO - Added player ai_4 to game 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 22:32:52,055 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:32:52,055 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:32:52,055 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:32:52,055 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♣', '6♦')
2025-03-10 22:32:52,055 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♦', '5♥')
2025-03-10 22:32:52,056 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♣', 'A♥')
2025-03-10 22:32:52,056 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♣', '6♠')
2025-03-10 22:32:52,056 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♥', 'K♠')
2025-03-10 22:32:52,056 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:32:52,056 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:32:52,057 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:32:52,057 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:32:52,057 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:32:52,057 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:32:52,058 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:32:52,058 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:32:52,058 - server - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 已开始
2025-03-10 22:32:52,058 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:32:52,103 - server - INFO - WebSocket连接已建立: 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 22:32:52,103 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'A♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:32:52,105 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:32:52,106 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:32:52,106 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:32:52,106 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:32:52,106 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:32:52,107 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:33:01,242 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":20,"confidence":0.75},"reasoning":{"hand_strength":"我手里有一对6，这是一手中等强度的起手牌。在9人桌中，一对6的价值不算特别高，但在前期仍有一定的价值。","position_analysis":"我在相对早的位置(位置3)，这不是理想的位置，因为后面还有一名玩家要行动。","pot_odds":"当前底池30，我需要下注20来跟注，底池赔率是30:20=1.5:1，考虑到我有一对，这个赔率值得跟注。","opponent_reads":["ai_2在我前面加注到20，这可能表明他有一手不错的牌，但也可能只是标准的位置加注。","ai_1只是跟注了小盲，没有表现出特别强的意图。"]},"table_talk":{"message":"嗯，口袋对子，值得看看翻牌。","tone":"平静自信"}}
2025-03-10 22:33:01,243 - src.agents.llm - INFO - ==================================================

2025-03-10 22:33:01,244 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，口袋对子，值得看看翻牌。', 'tone': '平静自信'}
2025-03-10 22:33:01,244 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:33:01,244 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:33:01,244 - src.engine.state - INFO - 玩家 ai_3 跟注 20 筹码，已标记为已行动
2025-03-10 22:33:01,245 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:33:01,245 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:33:01,245 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:33:01,245 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:33:01,245 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:33:01,246 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:33:01,246 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:33:01,246 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:33:01,246 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:33:01,247 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:33:01,247 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:33:01,247 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:33:01,247 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:33:01,248 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:33:01,248 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:33:01,248 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'A♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，口袋对子，值得看看翻牌。', 'tone': '平静自信'}}
2025-03-10 22:33:01,249 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:33:01,249 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:33:01,249 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:33:01,249 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:33:01,250 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:33:01,250 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:33:01,250 - server - INFO - WebSocket连接已断开: 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:33:01,250 - server - ERROR - 连接已关闭，无法发送游戏状态: 194985da-8b3f-4a8f-a549-a2cb3401ee19
2025-03-10 22:33:06,254 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:33:06,255 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:33:06,256 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:33:06,257 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:33:06,257 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:33:06,258 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:33:18,684 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.7},"reasoning":{"hand_strength":"持有K♠,4♥，在没有公共牌的情况下，这手牌有潜在的赢面，但不是很强。不过考虑到我的位置较好，可以尝试控制底池大小来获取更多信息。","position_analysis":"位于中间偏后的位置，能够观察到大部分玩家的行为再做决定，有利于根据对手反应调整策略。","pot_odds":"当前加注后的底池赔率对于我来说是可接受的，即使不中牌也有机会通过后续操作盈利。","opponent_reads":["ai_2和ai_3都选择了跟注，表明他们可能持有中等强度的手牌；而player_0尚未行动，需要小心其可能持有的强牌。"]},"table_talk":{"message":"看来大家都挺有信心嘛，那我也来凑个热闹吧！","tone":"轻松友好"}}
2025-03-10 22:33:18,685 - src.agents.llm - INFO - ==================================================

2025-03-10 22:33:18,685 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺有信心嘛，那我也来凑个热闹吧！', 'tone': '轻松友好'}
2025-03-10 22:33:18,685 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 22:33:18,685 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:33:18,686 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 22:33:18,686 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 22:33:18,686 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:33:18,686 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:33:18,686 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:33:18,687 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:33:18,687 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:33:18,687 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:33:18,687 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:33:18,687 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:33:18,688 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:33:18,688 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:33:18,688 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:33:18,688 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:33:18,688 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:33:18,688 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:33:18,689 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'A♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺有信心嘛，那我也来凑个热闹吧！', 'tone': '轻松友好'}}
2025-03-10 22:33:18,689 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:33:18,689 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:33:18,690 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:33:18,690 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:33:18,690 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:33:18,691 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:33:25,444 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:33:25,445 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:33:25.445742', 'table_talk': None}
2025-03-10 22:33:25,445 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:33:25,446 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:33:25,446 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:33:25,446 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:33:25,446 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:33:25,447 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:33:25,447 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:33:25,447 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:33:25,447 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:33:25,448 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:33:25,448 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:33:25,448 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:33:25,448 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:33:25,448 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:33:25,449 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:33:25,449 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:33:25,449 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:33:25,449 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'A♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:33:25,450 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:33:25,450 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:33:25,450 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:33:25,451 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:33:25,451 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:33:25,451 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:33:28,706 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:33:28,707 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:33:28,707 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:33:28,707 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:33:28,708 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:33:28,708 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:34:04,117 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "60", "confidence": "0.8"}, "reasoning": {"hand_strength": "口袋5虽然不是顶级起手牌，但作为set-mining手牌，在深筹码情况下具有较好的爆发潜力。", "position_analysis": "虽然处于较早位置，但深筹码和局面宽裕使我有足够耐心等待有利局面。", "pot_odds": "当前底池110，对手已投入的注较少，跟注60相对风险不大，尤其在中套的情况下能获得高额回报。", "opponent_reads": ["ai_4主动加注可能体现强势，但也可能是假装强劲以吓退对手", "ai_3和ai_2表现较为谨慎，跟注显示牌力有限"]}, "table_talk": {"message": "慢慢来，各位，今天的小牌也能翻盘，等着瞧我的秘密武器吧！", "tone": "轻松挑衅"}}
2025-03-10 22:34:04,118 - src.agents.llm - INFO - ==================================================

2025-03-10 22:34:04,118 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '慢慢来，各位，今天的小牌也能翻盘，等着瞧我的秘密武器吧！', 'tone': '轻松挑衅'}
2025-03-10 22:34:04,119 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 22:34:04,119 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 22:34:04,119 - src.engine.state - INFO - 玩家 ai_1 跟注 50 筹码，已标记为已行动
2025-03-10 22:34:04,120 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 22:34:04,120 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 22:34:04,120 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:34:04,120 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:34:04,121 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:04,121 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:34:04,121 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:34:04,121 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:34:04,122 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:04,122 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:34:04,122 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:04,122 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:04,122 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:34:04,123 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:34:04,123 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:04,123 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:34:04,123 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 160, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'A♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '慢慢来，各位，今天的小牌也能翻盘，等着瞧我的秘密武器吧！', 'tone': '轻松挑衅'}}
2025-03-10 22:34:04,124 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:04,124 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:34:04,124 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:04,124 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:04,125 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:34:04,125 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:34:04,125 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:04,126 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:34:04,126 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:34:04,126 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:34:04,127 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:34:04,127 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:34:04,127 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:34:11,798 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌较弱，A4不同花，没有形成强牌或潜在强牌的可能性","position_analysis":"位置靠前，不利于后续行动，难以获取更多信息","pot_odds":"底池赔率不理想，跟注或加注的风险较高","opponent_reads":["ai_4的加注行为显示出一定的牌力，可能持有较强的起手牌","ai_1跟注，可能持有中等强度的牌或试图看翻牌"]},"table_talk":{"message":"看来这手牌不适合我继续，你们继续玩吧","tone":"轻松"}}
2025-03-10 22:34:11,799 - src.agents.llm - INFO - ==================================================

2025-03-10 22:34:11,800 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我继续，你们继续玩吧', 'tone': '轻松'}
2025-03-10 22:34:11,800 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:34:11,800 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:34:11,800 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:34:11,800 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:34:11,801 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:34:11,801 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:34:11,801 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:34:11,801 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:11,801 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:34:11,801 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:34:11,801 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:34:11,802 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:11,802 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:34:11,802 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:11,802 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:11,802 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:34:11,802 - src.engine.game - INFO - 玩家 ai_3 下注额(20)不等于最大下注额(60)，回合继续
2025-03-10 22:34:11,802 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:34:11,803 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:34:11,803 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 160, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我继续，你们继续玩吧', 'tone': '轻松'}}
2025-03-10 22:34:11,804 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:11,804 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:34:11,805 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:11,805 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:11,805 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:34:11,805 - src.engine.game - INFO - 玩家 ai_3 下注额(20)不等于最大下注额(60)，回合继续
2025-03-10 22:34:11,806 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:34:11,806 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:34:11,807 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:34:11,807 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:34:11,807 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:34:11,807 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:34:11,807 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:34:21,126 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"我手持一对6，这是一个中等强度的起手牌。在德州扑克中，任何一对都有一定价值，特别是在前期阶段。","position_analysis":"我在相对靠后的位置(位置3)，这给了我一定的位置优势，因为我已经看到了前面几位玩家的行动。","pot_odds":"当前底池160，我需要跟注60，底池赔率约为2.67:1，对于一对6来说，这个赔率值得跟注。","opponent_reads":["ai_4进行了加注，显示出一定的强势，但加注幅度不大，可能是试探性加注或中等强度的手牌","ai_1选择跟注而非再加注，表明手牌可能不是特别强","两名玩家选择弃牌，减少了遭遇特别强牌的可能性"]},"table_talk":{"message":"嗯，有意思的局面。我跟了。","tone":"冷静自信"}}
2025-03-10 22:34:21,128 - src.agents.llm - INFO - ==================================================

2025-03-10 22:34:21,128 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，有意思的局面。我跟了。', 'tone': '冷静自信'}
2025-03-10 22:34:21,128 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:34:21,129 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:34:21,129 - src.engine.state - INFO - 玩家 ai_3 跟注 40 筹码，已标记为已行动
2025-03-10 22:34:21,129 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:34:21,129 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:34:21,130 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:34:21,130 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:34:21,130 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:21,130 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:34:21,131 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:34:21,131 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:34:21,131 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:21,131 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:34:21,131 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:34:21,132 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:21,132 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:21,132 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:34:21,133 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:34:21,133 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:34:21,133 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:34:21,133 - src.engine.game - INFO - 活跃玩家数量: 3, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 22:34:21,133 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:34:21,134 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 22:34:21,134 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:34:21,134 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 22:34:21,134 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:34:21,134 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:34:21,134 - src.engine.dealer - INFO - Dealt 3 community cards: ['K♥', '8♣', 'J♣']
2025-03-10 22:34:21,135 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['K♥', '8♣', 'J♣']
2025-03-10 22:34:21,135 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_1', 1), ('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:34:21,135 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 22:34:21,135 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 22:34:21,135 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:34:21,136 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 200, 'community_cards': ['K♥', '8♣', 'J♣'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('5♦', '5♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有意思的局面。我跟了。', 'tone': '冷静自信'}}
2025-03-10 22:34:21,137 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:21,137 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:34:21,137 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:21,137 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:34:21,138 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:34:21,138 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:21,139 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:34:21,139 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:34:21,140 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:34:21,140 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:34:21,140 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:34:21,141 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:34:44,862 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌仅为5♦,5♥，在K♥,8♣,J♣的公共牌面前，低对缺乏竞争力且未显著改善，未形成三条或顺子听牌。", "position_analysis": "位置较早，信息有限且先前对手激进加注，使得在这种不利位置上冒险风险较大。", "pot_odds": "底池200，对手已加注至60，投入与回报比例不足以补偿追成三条的低概率。", "opponent_reads": ["ai_4的加注和ai_3的跟注显示他们可能持有更高牌或在诈唬，整体表现较为激进。"]}, "table_talk": {"message": "你们在这儿展示实力，我就不浪费筹码了。", "tone": "轻松嘲讽"}}
2025-03-10 22:34:44,862 - src.agents.llm - INFO - ==================================================

2025-03-10 22:34:44,863 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '你们在这儿展示实力，我就不浪费筹码了。', 'tone': '轻松嘲讽'}
2025-03-10 22:34:44,863 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:34:44,863 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:34:44,863 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:34:44,864 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:34:44,864 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:34:44,864 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:34:44,864 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:34:44,864 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:44,864 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:34:44,865 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_3
2025-03-10 22:34:44,865 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:34:44,865 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:44,865 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:34:44,865 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:44,865 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:34:44,865 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:34:44,866 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:44,866 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:34:44,866 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 200, 'community_cards': ['K♥', '8♣', 'J♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你们在这儿展示实力，我就不浪费筹码了。', 'tone': '轻松嘲讽'}}
2025-03-10 22:34:44,867 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:44,867 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:34:44,868 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:44,868 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:34:44,868 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:34:44,868 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:44,869 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:34:44,870 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:34:44,870 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:34:44,870 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:34:44,870 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:34:44,871 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:34:52,546 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"中等强度的一对6，在翻牌圈有一定价值，但不是特别强","position_analysis":"位置3相对靠后，可以看到多数玩家的行动","pot_odds":"底池200，需要跟注60，底池赔率约为3.3:1，有足够的赔率跟注","opponent_reads":["ai_4主动加注表明可能有强牌","多位玩家选择跟注，说明底池有竞争","公共牌K♥, 8♣, J♣没有明显的顺子或同花可能，我的一对6可能仍有价值"]},"table_talk":{"message":"嗯，有意思的局面。我跟。","tone":"沉稳"}}
2025-03-10 22:34:52,547 - src.agents.llm - INFO - ==================================================

2025-03-10 22:34:52,548 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，有意思的局面。我跟。', 'tone': '沉稳'}
2025-03-10 22:34:52,548 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:34:52,548 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:34:52,549 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-03-10 22:34:52,549 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:34:52,549 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:34:52,549 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:34:52,550 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:34:52,550 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:52,550 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:34:52,550 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:34:52,551 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:34:52,551 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:52,551 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:34:52,551 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:52,551 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:34:52,551 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:34:52,552 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:34:52,552 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:52,552 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:34:52,552 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 200, 'community_cards': ['K♥', '8♣', 'J♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有意思的局面。我跟。', 'tone': '沉稳'}}
2025-03-10 22:34:52,553 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:34:52,553 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:34:52,553 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:34:52,554 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:34:52,554 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:34:52,554 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:34:52,555 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:34:52,556 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:34:52,556 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:34:52,556 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:34:52,557 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:34:52,557 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:34:52,557 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:35:03,811 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":120,"confidence":0.75},"reasoning":{"hand_strength":"拥有一对K，目前来看是较强的牌力，尤其是在FLOP阶段出现了一张K。","position_analysis":"处于中等位置，可以采取较为积极的策略来控制底池大小或获取更多信息。","pot_odds":"当前加注到120后，对手需要以较高的代价继续游戏，这有利于我们通过下注保护自己的手牌优势。","opponent_reads":["ai_3在前几轮中表现得比较谨慎，但面对我的加注仍然跟注，可能持有不错的牌或者是在尝试用小对子追击。"]},"table_talk":{"message":"看来你也有点东西啊，不过我更看好自己手中的牌。","tone":"自信且略带挑衅"}}
2025-03-10 22:35:03,812 - src.agents.llm - INFO - ==================================================

2025-03-10 22:35:03,812 - src.agents.llm - INFO - 生成动作: RAISE 金额: 120 table_talk: {'message': '看来你也有点东西啊，不过我更看好自己手中的牌。', 'tone': '自信且略带挑衅'}
2025-03-10 22:35:03,813 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 120
2025-03-10 22:35:03,813 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:35:03,814 - src.engine.state - INFO - 玩家 ai_4 加注到 120 筹码，已标记为已行动
2025-03-10 22:35:03,814 - src.engine.game - INFO - 玩家 ai_4 加注到 120
2025-03-10 22:35:03,814 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:35:03,815 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:35:03,815 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:35:03,815 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:35:03,816 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_3, 位置: 3
2025-03-10 22:35:03,816 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_3
2025-03-10 22:35:03,816 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:35:03,816 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:03,816 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:03,817 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:35:03,817 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:35:03,817 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(120)，回合继续
2025-03-10 22:35:03,818 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:35:03,818 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:35:03,818 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 320, 'community_cards': ['K♥', '8♣', 'J♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 820, 'current_bet': 120, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 120}], 'table_talk': {'message': '看来你也有点东西啊，不过我更看好自己手中的牌。', 'tone': '自信且略带挑衅'}}
2025-03-10 22:35:03,819 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:03,819 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:03,819 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:35:03,820 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:35:03,821 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(120)，回合继续
2025-03-10 22:35:03,821 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:35:03,822 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:35:03,822 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:35:03,822 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:35:03,822 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:35:03,823 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:35:03,824 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:35:12,369 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":120,"confidence":0.7},"reasoning":{"hand_strength":"我手上有一对6，这是一个中等偏弱的口袋对子。公共牌K♥, 8♣, J♣没有与我的手牌匹配，但也没有明显的顺子或同花威胁。","position_analysis":"我处于中间位置，前面已经有玩家加注，且ai_4表现积极。","pot_odds":"当前底池320，我需要跟注120，底池赔率约为2.67:1。考虑到我手上的一对6，这个赔率勉强值得跟注观望转牌。","opponent_reads":["ai_4在翻牌前和翻牌后都选择加注，显示出强势态度，可能有高对或更好的牌。","其他玩家的弃牌行为表明牌力普遍不高。"]},"table_talk":{"message":"嗯...让我看看这个局面。","tone":"沉思"}}
2025-03-10 22:35:12,371 - src.agents.llm - INFO - ==================================================

2025-03-10 22:35:12,371 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯...让我看看这个局面。', 'tone': '沉思'}
2025-03-10 22:35:12,371 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:35:12,372 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:35:12,372 - src.engine.state - INFO - 玩家 ai_3 跟注 120 筹码，已标记为已行动
2025-03-10 22:35:12,372 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:35:12,372 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:35:12,373 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:35:12,373 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:35:12,373 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:35:12,373 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:35:12,374 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:35:12,374 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:35:12,374 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:12,374 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:12,374 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:35:12,374 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 22:35:12,374 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 22:35:12,375 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:35:12,375 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:35:12,375 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:35:12,375 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 22:35:12,375 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:35:12,376 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 22:35:12,376 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:12,376 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:35:12,376 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:35:12,376 - src.engine.dealer - INFO - Dealt 1 community cards: ['7♣']
2025-03-10 22:35:12,376 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['K♥', '8♣', 'J♣', '7♣']
2025-03-10 22:35:12,377 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:35:12,377 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 22:35:12,377 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_3, 位置: 3
2025-03-10 22:35:12,377 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:35:12,377 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 440, 'community_cards': ['K♥', '8♣', 'J♣', '7♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 820, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 820, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯...让我看看这个局面。', 'tone': '沉思'}}
2025-03-10 22:35:12,378 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:12,378 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:12,379 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:35:12,379 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:35:12,379 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:35:12,379 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:35:12,381 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:35:12,381 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:35:12,381 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:35:12,381 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:35:12,382 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:35:12,382 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:35:21,595 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":0,"confidence":0.75},"reasoning":{"hand_strength":"我有一对6，中等强度的口袋对。目前公共牌上有K♥, 8♣, J♣, 7♣，没有配对我的6，但有三张梅花，存在同花风险。","position_analysis":"我在位置3，相对中后位置，有一定的位置优势可以观察其他玩家行动。","pot_odds":"底池已经有440，我需要跟注120，底池赔率约为3.7:1，考虑到我有一对，值得跟注看河牌。","opponent_reads":["ai_4比较激进，在翻牌圈和转牌圈都选择加注，可能有强牌或者在诈唬","ai_3一直选择跟注，可能有中等强度的牌或者在抽牌"]},"table_talk":{"message":"让我看看河牌会带来什么惊喜。","tone":"冷静沉着"}}
2025-03-10 22:35:21,596 - src.agents.llm - INFO - ==================================================

2025-03-10 22:35:21,597 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我看看河牌会带来什么惊喜。', 'tone': '冷静沉着'}
2025-03-10 22:35:21,597 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:35:21,597 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:35:21,597 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-03-10 22:35:21,597 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:35:21,598 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:35:21,598 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:35:21,598 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:35:21,598 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:35:21,598 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:35:21,598 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:35:21,599 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:35:21,599 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:21,599 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:21,599 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:35:21,599 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:35:21,599 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:35:21,600 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:35:21,600 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:35:21,600 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:35:21,600 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 440, 'community_cards': ['K♥', '8♣', 'J♣', '7♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 820, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 820, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '让我看看河牌会带来什么惊喜。', 'tone': '冷静沉着'}}
2025-03-10 22:35:21,601 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:21,601 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:21,601 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:35:21,602 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:35:21,602 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:35:21,602 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:35:21,602 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:35:21,603 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:35:21,603 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:35:21,604 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:35:21,604 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:35:21,604 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:35:21,604 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:35:38,128 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"240","confidence":"0.75"},"reasoning":{"hand_strength":"拥有一对K，目前来看是较强的牌力。考虑到公共牌面没有明显的听牌迹象，这对我的手牌是有利的。","position_analysis":"位于较晚的位置，可以更好地观察对手的动作后再做决定，有利于采取控制性的加注策略来增加底池大小同时给对手施压。","pot_odds":"当前底池为440，通过加注240使得总投入达到680，相对于可能赢得的总额来说，这是一个合理的价格来尝试获取更多信息或直接赢下底池。","opponent_reads":["ai_3在之前几轮中表现得相对保守，主要采取跟注策略，这可能是试图以较低成本看到河牌阶段，或者是在等待更强的手牌出现。"]},"table_talk":{"message":"看来大家都挺谨慎的嘛，那我就稍微加点吧，希望你们能跟上。","tone":"轻松自信"}}
2025-03-10 22:35:38,130 - src.agents.llm - INFO - ==================================================

2025-03-10 22:35:38,130 - src.agents.llm - INFO - 成功将字符串金额 240 转换为数字 240.0
2025-03-10 22:35:38,131 - src.agents.llm - INFO - 生成动作: RAISE 金额: 240 table_talk: {'message': '看来大家都挺谨慎的嘛，那我就稍微加点吧，希望你们能跟上。', 'tone': '轻松自信'}
2025-03-10 22:35:38,131 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 240
2025-03-10 22:35:38,131 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:35:38,132 - src.engine.state - INFO - 玩家 ai_4 加注到 240 筹码，已标记为已行动
2025-03-10 22:35:38,132 - src.engine.game - INFO - 玩家 ai_4 加注到 240
2025-03-10 22:35:38,132 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:35:38,132 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:35:38,133 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:35:38,133 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 22:35:38,133 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_3, 位置: 3
2025-03-10 22:35:38,133 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_3
2025-03-10 22:35:38,133 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:35:38,134 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:38,134 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:38,134 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 22:35:38,134 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:35:38,135 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(240)，回合继续
2025-03-10 22:35:38,135 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:35:38,135 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:35:38,135 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 680, 'community_cards': ['K♥', '8♣', 'J♣', '7♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 820, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 580, 'current_bet': 240, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 240}], 'table_talk': {'message': '看来大家都挺谨慎的嘛，那我就稍微加点吧，希望你们能跟上。', 'tone': '轻松自信'}}
2025-03-10 22:35:38,136 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:38,137 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:38,137 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 22:35:38,137 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:35:38,137 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(240)，回合继续
2025-03-10 22:35:38,137 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:35:38,138 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:35:38,138 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:35:38,138 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:35:38,139 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:35:38,139 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:35:38,139 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:35:49,544 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":240,"confidence":0.75},"reasoning":{"hand_strength":"我手上有一对6，目前公共牌是K♥, 8♣, J♣, 7♣。我有一对中等口袋对，但桌面上有三张梅花，这意味着对手可能有梅花同花的可能。","position_analysis":"我在位置3，已经看到ai_4多次加注，显示出强势。我处于相对不利的位置。","pot_odds":"底池已经有680筹码，我需要跟注240才能继续游戏。底池赔率约为2.8:1，考虑到我可能有一对，以及潜在的顺子机会(如果河牌是5或9)，这个赔率勉强值得跟注。","opponent_reads":["ai_4在转牌圈继续加大注码，表现出强势，可能有强牌或同花听牌。","ai_4在每个阶段都选择加注，这种激进行为可能是真实力量也可能是诈唬。"]},"table_talk":{"message":"嗯...你似乎对你的牌很有信心啊。我跟了，让我们看看河牌会带来什么惊喜。","tone":"沉思但略带挑战"}}
2025-03-10 22:35:49,545 - src.agents.llm - INFO - ==================================================

2025-03-10 22:35:49,546 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯...你似乎对你的牌很有信心啊。我跟了，让我们看看河牌会带来什么惊喜。', 'tone': '沉思但略带挑战'}
2025-03-10 22:35:49,546 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:35:49,547 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:35:49,547 - src.engine.state - INFO - 玩家 ai_3 跟注 240 筹码，已标记为已行动
2025-03-10 22:35:49,547 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:35:49,548 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:35:49,548 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:35:49,548 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:35:49,549 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 22:35:49,550 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:35:49,550 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:35:49,550 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:35:49,550 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:49,551 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:49,551 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 22:35:49,551 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 22:35:49,551 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 22:35:49,551 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:35:49,552 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:35:49,552 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:35:49,552 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 22:35:49,552 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:35:49,552 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 22:35:49,552 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:49,553 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:35:49,553 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:35:49,553 - src.engine.dealer - INFO - Dealt 1 community cards: ['3♦']
2025-03-10 22:35:49,553 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['K♥', '8♣', 'J♣', '7♣', '3♦']
2025-03-10 22:35:49,553 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:35:49,553 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 22:35:49,554 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_3, 位置: 3
2025-03-10 22:35:49,554 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:35:49,555 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 920, 'community_cards': ['K♥', '8♣', 'J♣', '7♣', '3♦'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 580, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 580, 'current_bet': 0, 'is_active': True, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯...你似乎对你的牌很有信心啊。我跟了，让我们看看河牌会带来什么惊喜。', 'tone': '沉思但略带挑战'}}
2025-03-10 22:35:49,555 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:49,556 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:35:49,556 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:35:49,556 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:35:49,556 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:35:49,556 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:35:49,557 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:35:49,557 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:35:49,557 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:35:49,558 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:35:49,558 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:35:49,558 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:35:58,926 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"我有一对6，在河牌阶段非常弱。桌面上有K♥, 8♣, J♣, 7♣, 3♦，其中有三张梅花，对手很可能凑成了梅花同花。我的一对6几乎没有胜算。","position_analysis":"位置不利，我是后手行动，对手已经展示了强烈的攻击性。","pot_odds":"对手持续加注，最后一次加注到240，显示出极强的信心。即使我跟注，获胜概率极低，不值得继续投入筹码。","opponent_reads":["对手ai_4在翻牌前就开始加注，翻牌后继续加注，转牌后再次加注，河牌后依然保持攻击性，非常可能拥有强牌，如同花、顺子或高对。","对手的连续加注模式表明他非常自信，可能已经在河牌圈完成了他的牌型。"]},"table_talk":{"message":"这手牌你打得不错，我认输了。","tone":"平静"}}
2025-03-10 22:35:58,927 - src.agents.llm - INFO - ==================================================

2025-03-10 22:35:58,928 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌你打得不错，我认输了。', 'tone': '平静'}
2025-03-10 22:35:58,928 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:35:58,928 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:35:58,928 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:35:58,929 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:35:58,929 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:35:58,929 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:35:58,930 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:35:58,930 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:35:58,930 - src.engine.state - INFO - 玩家 ai_4 获得底池 920 筹码，当前筹码: 1500
2025-03-10 22:35:58,930 - src.engine.game - INFO - 玩家 ai_4 获得底池 920 筹码
2025-03-10 22:35:58,930 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:35:58,931 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 920, 'winning_hand': None, 'community_cards': ['K♥', '8♣', 'J♣', '7♣', '3♦'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('4♥', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:35:58,931 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['K♥', '8♣', 'J♣', '7♣', '3♦'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 920, 'winning_hand': None, 'community_cards': ['K♥', '8♣', 'J♣', '7♣', '3♦'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('4♥', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 580, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1500, 'current_bet': 0, 'is_active': False, 'cards': ('4♥', 'K♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌你打得不错，我认输了。', 'tone': '平静'}}
2025-03-10 22:35:58,931 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:35:58,932 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:35:58,932 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:35:58,932 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:35:58,932 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:35:58,933 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:35:58,933 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 920, 'winning_hand': None, 'community_cards': ['K♥', '8♣', 'J♣', '7♣', '3♦'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('4♥', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:35:58,933 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:36:01,721 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:36:01,721 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:36:01,722 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 22:36:01,723 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:01,723 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:36:01,723 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♣', 'K♦')
2025-03-10 22:36:01,724 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♦', '8♥')
2025-03-10 22:36:01,724 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♥', '7♠')
2025-03-10 22:36:01,724 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♣', '6♠')
2025-03-10 22:36:01,725 - src.engine.game - INFO - 玩家 ai_4 手牌: ('6♥', 'A♥')
2025-03-10 22:36:01,725 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 22:36:01,725 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 22:36:01,725 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-03-10 22:36:01,725 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 22:36:01,726 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 22:36:01,726 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 22:36:01,726 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:36:01,726 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:36:03,948 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:36:03,949 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:36:03,950 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:36:03,950 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:36:03,951 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:36:03,951 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:36:18,614 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"持有一张A，这在德州扑克中是相对较强的手牌，尤其是在前翻牌圈。虽然另一张6较弱，但考虑到位置优势和对手可能的反应，这张A足以支持一次试探性的加注来收集更多信息。","position_analysis":"位于中间偏后的位置，这意味着已经观察到了一些玩家的动作，可以基于这些信息做出更明智的选择。同时，这样的位置也允许采取更加积极主动的策略，因为后面还有玩家需要行动，可能会提供额外的信息或机会。","pot_odds":"当前底池为30，通过加注到60，增加了底池的价值，同时也为自己创造了一个更有利的局面，如果后续公共牌对我的手牌有利，则有可能赢得更大的收益。","opponent_reads":["ai_2只跟了最小注10，显示出一定的谨慎态度；而ai_3则直接加注至20，表明其手牌可能较强或者是在尝试施压。"]},"table_talk":{"message":"看来大家都挺有信心嘛，我也来凑个热闹。","tone":"轻松自信"}}
2025-03-10 22:36:18,615 - src.agents.llm - INFO - ==================================================

2025-03-10 22:36:18,615 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺有信心嘛，我也来凑个热闹。', 'tone': '轻松自信'}
2025-03-10 22:36:18,616 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 22:36:18,616 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:36:18,616 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 22:36:18,616 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 22:36:18,616 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:36:18,616 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:36:18,617 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:36:18,617 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:18,617 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:36:18,617 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:36:18,618 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:36:18,618 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:36:18,618 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:18,618 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:18,618 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:36:18,619 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:36:18,619 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:36:18,619 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:36:18,619 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '8♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', '7♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 560, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1440, 'current_bet': 60, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺有信心嘛，我也来凑个热闹。', 'tone': '轻松自信'}}
2025-03-10 22:36:18,620 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:36:18,620 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:18,621 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:18,621 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:36:18,621 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:36:18,621 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:36:35,314 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:36:35,315 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:36:35.314843', 'table_talk': None}
2025-03-10 22:36:35,315 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:36:35,315 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:36:35,315 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:36:35,316 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:36:35,316 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:36:35,316 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:36:35,316 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:35,317 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:36:35,317 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:36:35,317 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:36:35,318 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:36:35,318 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:35,318 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:35,319 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:36:35,319 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:36:35,319 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:36:35,319 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:36:35,319 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '8♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', '7♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 560, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1440, 'current_bet': 60, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:36:35,320 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:36:35,320 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:35,320 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:35,320 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:36:35,321 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:36:35,321 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:36:38,642 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:36:38,643 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:36:38,643 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:36:38,643 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:36:38,644 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:36:38,644 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:36:54,703 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌3♦, 8♥非常弱，无论从潜力还是成牌概率来看都不足以支撑面对加注的局面", "position_analysis": "处于早位，缺乏信息，加上位置不利，更倾向于弃牌", "pot_odds": "底池仅90，但需要支付至少60甚至80的注额，赔率不足以弥补手牌劣势", "opponent_reads": ["ai_4表现出激进加注的态度，其他玩家的信息也显示出他们可能持有较强牌型"]}, "table_talk": {"message": "看来这手牌真是送的，朋友们，加注的浪费筹码不值得我冒险！", "tone": "冷静且略带讽刺"}}
2025-03-10 22:36:54,704 - src.agents.llm - INFO - ==================================================

2025-03-10 22:36:54,704 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌真是送的，朋友们，加注的浪费筹码不值得我冒险！', 'tone': '冷静且略带讽刺'}
2025-03-10 22:36:54,705 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:36:54,705 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:36:54,705 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:36:54,706 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:36:54,706 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:36:54,706 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:36:54,706 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:36:54,707 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:54,707 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:36:54,707 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:36:54,707 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:36:54,707 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:36:54,707 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:54,708 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:54,708 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:36:54,708 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:36:54,708 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:36:54,708 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:36:54,708 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', '7♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 560, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1440, 'current_bet': 60, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌真是送的，朋友们，加注的浪费筹码不值得我冒险！', 'tone': '冷静且略带讽刺'}}
2025-03-10 22:36:54,709 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:36:54,709 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:36:54,709 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:36:54,710 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:36:54,710 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:36:54,710 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:36:54,711 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:36:54,712 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:36:54,712 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:36:54,712 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:36:54,712 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:36:54,713 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:37:02,906 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌9♥, 7♠在PRE_FLOP阶段相对较弱，缺乏形成强牌的基础。","position_analysis":"位置2在PRE_FLOP阶段处于早期位置，不利于观察其他玩家的行动。","pot_odds":"底池赔率为90:60，即1.5:1，手牌强度不足以支持跟注。","opponent_reads":["ai_4进行了加注，显示出较强的牌力或激进的策略。","ai_3仅跟注，可能持有中等强度的牌或采取保守策略。"]},"table_talk":{"message":"看来今天的手气不太顺，先弃牌观察一下。","tone":"轻松"}}
2025-03-10 22:37:02,907 - src.agents.llm - INFO - ==================================================

2025-03-10 22:37:02,908 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天的手气不太顺，先弃牌观察一下。', 'tone': '轻松'}
2025-03-10 22:37:02,908 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:37:02,908 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:37:02,909 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:37:02,909 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:37:02,909 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:37:02,910 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:37:02,910 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:37:02,910 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:37:02,911 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:37:02,911 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:37:02,911 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:37:02,912 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:02,912 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:02,912 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:37:02,912 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:37:02,913 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:37:02,913 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:02,913 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:37:02,913 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 560, 'current_bet': 20, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1440, 'current_bet': 60, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天的手气不太顺，先弃牌观察一下。', 'tone': '轻松'}}
2025-03-10 22:37:02,914 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:02,914 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:02,914 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:37:02,914 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:37:02,915 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:37:02,915 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:02,916 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:37:02,916 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:37:02,916 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:37:02,916 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:37:02,916 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:37:02,917 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:37:11,523 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":60,"confidence":0.7},"reasoning":{"hand_strength":"我手上有一对6，这是一手中等强度的起手牌。在德州扑克中，任何一对都有一定的价值，特别是在前期阶段。","position_analysis":"我处于比较晚的位置(位置3)，这给了我一些位置优势，因为我已经看到了大多数玩家的行动。","pot_odds":"当前底池90，我需要跟注60，底池赔率约为1.5:1。考虑到我手上有一对，这个赔率值得跟注。","opponent_reads":["ai_4选择加注到60，显示出一定的攻击性，但并不是特别大的加注。这可能表明他有一手不错的牌，但也可能是在尝试偷盲。"]},"table_talk":{"message":"嗯，一对6...不错的起手牌，我跟了。","tone":"沉稳自信"}}
2025-03-10 22:37:11,524 - src.agents.llm - INFO - ==================================================

2025-03-10 22:37:11,525 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，一对6...不错的起手牌，我跟了。', 'tone': '沉稳自信'}
2025-03-10 22:37:11,525 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:37:11,525 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:37:11,525 - src.engine.state - INFO - 玩家 ai_3 跟注 40 筹码，已标记为已行动
2025-03-10 22:37:11,525 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:37:11,525 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:37:11,526 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:37:11,526 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:37:11,527 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:37:11,527 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:37:11,527 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:37:11,527 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:37:11,527 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:11,528 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:11,528 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:37:11,528 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:37:11,528 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:37:11,528 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:37:11,529 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:37:11,529 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:37:11,529 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 22:37:11,529 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:37:11,529 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 22:37:11,529 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:11,530 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:37:11,530 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:37:11,530 - src.engine.dealer - INFO - Dealt 3 community cards: ['J♦', 'A♣', '5♠']
2025-03-10 22:37:11,530 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['J♦', 'A♣', '5♠']
2025-03-10 22:37:11,530 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:37:11,530 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 22:37:11,531 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_3, 位置: 3
2025-03-10 22:37:11,531 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:37:11,531 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 130, 'community_cards': ['J♦', 'A♣', '5♠'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 520, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1440, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，一对6...不错的起手牌，我跟了。', 'tone': '沉稳自信'}}
2025-03-10 22:37:11,532 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:11,532 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:11,532 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:11,532 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:37:11,532 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:37:11,533 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:11,534 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:37:11,535 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:37:11,535 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:37:11,535 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:37:11,535 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:37:11,536 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:37:20,164 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"我有一对6，这是一个中等强度的起手牌。在J♦, A♣, 5♠的翻牌中，我的一对6没有得到改善，但也没有明显的威胁。","position_analysis":"我在相对较晚的位置，有一名玩家在我之后行动。我的位置不是最理想的。","pot_odds":"底池已有130，我需要跟注60，底池赔率约为2.17:1，考虑到我有一对，这个赔率足够支持我跟注。","opponent_reads":["ai_4选择加注到60，这表明他可能有一手不错的牌，但也可能是在尝试偷底池。","ai_3选择跟注，说明他手上可能有某种价值，但不足以再加注。"]},"table_talk":{"message":"嗯，有意思的局面。我愿意看看转牌会带来什么。","tone":"冷静观察"}}
2025-03-10 22:37:20,165 - src.agents.llm - INFO - ==================================================

2025-03-10 22:37:20,165 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，有意思的局面。我愿意看看转牌会带来什么。', 'tone': '冷静观察'}
2025-03-10 22:37:20,165 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:37:20,165 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:37:20,166 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-03-10 22:37:20,166 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:37:20,166 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:37:20,166 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:37:20,166 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:37:20,167 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:20,167 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:37:20,167 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:37:20,167 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:37:20,167 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:20,167 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:20,168 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:20,168 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:37:20,169 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:37:20,169 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:37:20,169 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:20,169 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:37:20,170 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 130, 'community_cards': ['J♦', 'A♣', '5♠'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 520, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1440, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有意思的局面。我愿意看看转牌会带来什么。', 'tone': '冷静观察'}}
2025-03-10 22:37:20,170 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:20,171 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:20,171 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:20,171 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:37:20,171 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:37:20,171 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:37:20,172 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:20,172 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:37:20,173 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:37:20,173 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:37:20,173 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:37:20,173 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:37:20,174 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:37:34,749 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "RAISE",
    "amount": "120",
    "confidence": "0.75"
  },
  "reasoning": {
    "hand_strength": "拥有顶对A，这在FLOP阶段是一个相对较强的手牌。",
    "position_analysis": "处于中后位置，可以利用位置优势来观察对手反应并采取行动。",
    "pot_odds": "考虑到当前底池大小与加注后的比例，这个加注是有利可图的。",
    "opponent_reads": ["ai_3之前跟注了我们的加注，显示出一定的兴趣或可能持有强牌。通过再次加注测试其手牌强度。"]
  },
  "table_talk": {
    "message": "看来我得再给点压力了。",
    "tone": "自信但不挑衅"
  }
}
2025-03-10 22:37:34,751 - src.agents.llm - INFO - ==================================================

2025-03-10 22:37:34,751 - src.agents.llm - INFO - 成功将字符串金额 120 转换为数字 120.0
2025-03-10 22:37:34,751 - src.agents.llm - INFO - 生成动作: RAISE 金额: 120 table_talk: {'message': '看来我得再给点压力了。', 'tone': '自信但不挑衅'}
2025-03-10 22:37:34,752 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 120
2025-03-10 22:37:34,752 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:37:34,752 - src.engine.state - INFO - 玩家 ai_4 加注到 120 筹码，已标记为已行动
2025-03-10 22:37:34,752 - src.engine.game - INFO - 玩家 ai_4 加注到 120
2025-03-10 22:37:34,752 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:37:34,753 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:37:34,753 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:37:34,753 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:37:34,753 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_3, 位置: 3
2025-03-10 22:37:34,753 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_3
2025-03-10 22:37:34,753 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:37:34,754 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:34,754 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:34,754 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:37:34,754 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:37:34,754 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(120)，回合继续
2025-03-10 22:37:34,754 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:37:34,755 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:37:34,755 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 250, 'community_cards': ['J♦', 'A♣', '5♠'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 520, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1320, 'current_bet': 120, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 120}], 'table_talk': {'message': '看来我得再给点压力了。', 'tone': '自信但不挑衅'}}
2025-03-10 22:37:34,755 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:34,756 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:34,756 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:37:34,756 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:37:34,756 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(120)，回合继续
2025-03-10 22:37:34,757 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:37:34,758 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:37:34,759 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:37:34,759 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:37:34,759 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:37:34,759 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:37:34,760 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:37:43,135 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":120,"confidence":0.75},"reasoning":{"hand_strength":"我手上有一对6，这是一个中等强度的口袋对。目前公共牌是J♦, A♣, 5♠，没有与我的手牌匹配，但我仍然有一对。","position_analysis":"我在位置3，相对靠后，对手ai_4在我之后行动，他已经加注了两次，显示出强势。","pot_odds":"底池现在有250，我需要跟注120，底池赔率约为2.08:1，考虑到我有一对，这个赔率勉强值得跟注。","opponent_reads":["ai_4连续加注，显示出强势，可能有高对或更好的牌，但也可能是在诈唬。"]},"table_talk":{"message":"嗯，有意思的局面。我跟了。","tone":"冷静"}}
2025-03-10 22:37:43,137 - src.agents.llm - INFO - ==================================================

2025-03-10 22:37:43,137 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，有意思的局面。我跟了。', 'tone': '冷静'}
2025-03-10 22:37:43,138 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:37:43,138 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:37:43,139 - src.engine.state - INFO - 玩家 ai_3 跟注 120 筹码，已标记为已行动
2025-03-10 22:37:43,140 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:37:43,140 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:37:43,140 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:37:43,140 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:37:43,141 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:37:43,141 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:37:43,141 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:37:43,141 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:37:43,142 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:43,142 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:43,142 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 22:37:43,142 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 22:37:43,143 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 22:37:43,143 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:37:43,143 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:37:43,143 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:37:43,143 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 22:37:43,144 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:37:43,144 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 22:37:43,144 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:43,144 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:37:43,145 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:37:43,145 - src.engine.dealer - INFO - Dealt 1 community cards: ['Q♣']
2025-03-10 22:37:43,145 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['J♦', 'A♣', '5♠', 'Q♣']
2025-03-10 22:37:43,145 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:37:43,145 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 22:37:43,146 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_3, 位置: 3
2025-03-10 22:37:43,146 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:37:43,146 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 370, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 400, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1320, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有意思的局面。我跟了。', 'tone': '冷静'}}
2025-03-10 22:37:43,147 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:43,147 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:43,147 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:43,147 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:37:43,148 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:37:43,148 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:43,149 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:37:43,149 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:37:43,149 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:37:43,149 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:37:43,149 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:37:43,150 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:37:51,578 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CHECK","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"我有一对6，在当前的牌面上属于中等偏弱的手牌。公共牌上有J、A、5、Q，没有和我的口袋对子形成三条，也没有顺子或同花的可能性。","position_analysis":"我在位置3，是相对靠后的位置。当前阶段是转牌圈(TURN)，还有一张河牌将要发出。","pot_odds":"当前底池370，没有人下注，我可以选择过牌不用投入额外筹码。","opponent_reads":["ai_4在前几轮表现积极，多次加注，但在这一轮选择了过牌，可能手牌强度一般或在等待河牌。"]},"table_talk":{"message":"让我们看看河牌会带来什么惊喜。","tone":"平静自信"}}
2025-03-10 22:37:51,579 - src.agents.llm - INFO - ==================================================

2025-03-10 22:37:51,580 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '让我们看看河牌会带来什么惊喜。', 'tone': '平静自信'}
2025-03-10 22:37:51,580 - server - INFO - AI玩家 ai_3 决定执行动作: CHECK, 金额: 0
2025-03-10 22:37:51,580 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CHECK
2025-03-10 22:37:51,580 - src.engine.game - INFO - 玩家 ai_3 过牌，已标记为已行动
2025-03-10 22:37:51,580 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_3
2025-03-10 22:37:51,581 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:37:51,581 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:37:51,581 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:51,581 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:37:51,581 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:37:51,581 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:37:51,582 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:51,582 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:51,582 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:51,582 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:37:51,582 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:37:51,582 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:37:51,583 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:51,583 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:37:51,583 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 370, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 400, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1320, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '让我们看看河牌会带来什么惊喜。', 'tone': '平静自信'}}
2025-03-10 22:37:51,583 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:37:51,584 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:37:51,584 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:37:51,584 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:37:51,584 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:37:51,585 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:37:51,585 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:37:51,586 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:37:51,586 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:37:51,587 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:37:51,587 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:37:51,587 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:37:51,588 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:38:04,432 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":200,"confidence":0.8},"reasoning":{"hand_strength":"持有A高牌，且有一对A，这在当前公共牌面是较强的组合。考虑到对手可能也在等待更强的手牌出现或试图通过check来控制底池大小，我的手牌有较好的胜率。","position_analysis":"处于较后的位置，可以观察到对手的行为后再做决定，有利于信息收集和心理战术的应用。","pot_odds":"加注后的潜在回报比风险更有吸引力，特别是如果能够促使对手犯错的话。","opponent_reads":["对手之前采取了跟注策略，显示出他对自己的手牌有一定信心但又不是非常强势，可能是中等强度的成牌或者听牌。"]},"table_talk":{"message":"看来你对自己的手牌挺有信心啊，那我也得表示一下才行。","tone":"挑衅"}}
2025-03-10 22:38:04,434 - src.agents.llm - INFO - ==================================================

2025-03-10 22:38:04,434 - src.agents.llm - INFO - 生成动作: RAISE 金额: 200 table_talk: {'message': '看来你对自己的手牌挺有信心啊，那我也得表示一下才行。', 'tone': '挑衅'}
2025-03-10 22:38:04,434 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 200
2025-03-10 22:38:04,435 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:38:04,435 - src.engine.state - INFO - 玩家 ai_4 加注到 200 筹码，已标记为已行动
2025-03-10 22:38:04,435 - src.engine.game - INFO - 玩家 ai_4 加注到 200
2025-03-10 22:38:04,435 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:38:04,435 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:38:04,436 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:38:04,436 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:38:04,436 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_3, 位置: 3
2025-03-10 22:38:04,436 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_3
2025-03-10 22:38:04,437 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:38:04,437 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:04,437 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:04,437 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:38:04,437 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:38:04,438 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(200)，回合继续
2025-03-10 22:38:04,438 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:38:04,438 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:38:04,438 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 570, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 400, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1120, 'current_bet': 200, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 200}], 'table_talk': {'message': '看来你对自己的手牌挺有信心啊，那我也得表示一下才行。', 'tone': '挑衅'}}
2025-03-10 22:38:04,439 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:04,439 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:04,440 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:38:04,440 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:38:04,440 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(200)，回合继续
2025-03-10 22:38:04,440 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:38:04,441 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:38:04,441 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:38:04,441 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:38:04,441 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:38:04,441 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:38:04,441 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:38:13,957 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":200,"confidence":0.75},"reasoning":{"hand_strength":"我有一对6，这是一手中等强度的手牌。公共牌上有J、A、5、Q，没有形成明显的顺子或同花可能性。目前没有比我的一对6更高的对子出现在公共牌上，但有A、Q、J这些高牌。","position_analysis":"我在后位，这给了我一定的位置优势，但对手ai_4一直在积极加注，显示出强势。","pot_odds":"底池已有570筹码，我需要跟注200，底池赔率约为2.85:1，考虑到我的手牌强度，这个赔率勉强值得跟注。","opponent_reads":["ai_4在每个阶段都选择加注，表现得非常强势，这可能意味着他有强牌，但也可能是在诈唬。","他的连续加注模式值得警惕，但我的一对6可能仍有价值。"]},"table_talk":{"message":"你一直在施压啊，我很欣赏这种打法。不过这次我决定陪你玩下去，看看河牌会给我们带来什么惊喜。","tone":"冷静自信"}}
2025-03-10 22:38:13,958 - src.agents.llm - INFO - ==================================================

2025-03-10 22:38:13,959 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '你一直在施压啊，我很欣赏这种打法。不过这次我决定陪你玩下去，看看河牌会给我们带来什么惊喜。', 'tone': '冷静自信'}
2025-03-10 22:38:13,959 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:38:13,960 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:38:13,960 - src.engine.state - INFO - 玩家 ai_3 跟注 200 筹码，已标记为已行动
2025-03-10 22:38:13,960 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:38:13,961 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:38:13,961 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:38:13,961 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:38:13,961 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:38:13,961 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:38:13,962 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:38:13,962 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:38:13,962 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:13,962 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:13,963 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:38:13,963 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 22:38:13,963 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 22:38:13,963 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:38:13,964 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:38:13,964 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:38:13,964 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 22:38:13,964 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:38:13,964 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 22:38:13,964 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:13,965 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:38:13,965 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:38:13,965 - src.engine.dealer - INFO - Dealt 1 community cards: ['4♣']
2025-03-10 22:38:13,965 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['J♦', 'A♣', '5♠', 'Q♣', '4♣']
2025-03-10 22:38:13,966 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:38:13,966 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 22:38:13,966 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_3, 位置: 3
2025-03-10 22:38:13,966 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:38:13,967 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 770, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 200, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1120, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你一直在施压啊，我很欣赏这种打法。不过这次我决定陪你玩下去，看看河牌会给我们带来什么惊喜。', 'tone': '冷静自信'}}
2025-03-10 22:38:13,968 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:13,968 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:13,968 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:38:13,969 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:38:13,969 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:38:13,969 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:38:13,970 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:38:13,970 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:38:13,970 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:38:13,970 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:38:13,971 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:38:13,971 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:38:23,876 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CHECK","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"我手上有一对6，公共牌是J♦, A♣, 5♠, Q♣, 4♣。目前我的牌力是一对6，在河牌阶段这是一手较弱的牌。公共牌上没有同花的可能性（虽然有3张梅花，但我手上没有梅花），也没有顺子的可能。","position_analysis":"我在位置3，是比较早的位置。河牌阶段已经没有更多的牌会发出，我需要谨慎行动。","pot_odds":"当前底池是770，没有人下注，所以我可以选择过牌不用投入任何筹码。","opponent_reads":["对手ai_4在前几轮表现非常激进，多次加注，可能手上有强牌如A或Q的高对，甚至可能是两对或三条。他在河牌没有继续下注，可能是试图诱导我下注，或者他的牌力也不强。"]},"table_talk":{"message":"看来我们都想看牌面啊，朋友。","tone":"轻松谨慎"}}
2025-03-10 22:38:23,877 - src.agents.llm - INFO - ==================================================

2025-03-10 22:38:23,877 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '看来我们都想看牌面啊，朋友。', 'tone': '轻松谨慎'}
2025-03-10 22:38:23,878 - server - INFO - AI玩家 ai_3 决定执行动作: CHECK, 金额: 0
2025-03-10 22:38:23,878 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CHECK
2025-03-10 22:38:23,878 - src.engine.game - INFO - 玩家 ai_3 过牌，已标记为已行动
2025-03-10 22:38:23,878 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_3
2025-03-10 22:38:23,879 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:38:23,879 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:38:23,879 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:38:23,879 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:38:23,880 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:38:23,880 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:38:23,880 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:23,880 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:23,880 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:38:23,880 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:38:23,881 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:38:23,881 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:38:23,881 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:38:23,881 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:38:23,881 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 770, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 200, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1120, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我们都想看牌面啊，朋友。', 'tone': '轻松谨慎'}}
2025-03-10 22:38:23,882 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:23,882 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:23,882 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:38:23,883 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:38:23,883 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:38:23,883 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:38:23,884 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:38:23,885 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:38:23,886 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:38:23,886 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:38:23,886 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:38:23,887 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:38:23,887 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:38:39,132 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"400","confidence":"0.85"},"reasoning":{"hand_strength":"我有一对A，这在当前的公共牌面上是相当强的手牌。考虑到对手的行为模式，我的手牌很可能领先。","position_analysis":"虽然我不是最后行动者，但在这个阶段拥有较强的手牌让我有机会通过加注来控制底池大小，并可能直接赢得底池。","pot_odds":"目前底池为770，加上我的加注后将超过1100，即使对手跟注，我的投资回报率也是正向的。","opponent_reads":["ai_3之前采取了较为被动的策略，主要以跟注为主，表明他可能持有中等强度的手牌，试图控制损失而不是积极争取胜利。"]},"table_talk":{"message":"看来今天运气不错啊，不过既然大家都这么谨慎，那我就稍微提高点赌注吧！","tone":"轻松自信"}}
2025-03-10 22:38:39,133 - src.agents.llm - INFO - ==================================================

2025-03-10 22:38:39,134 - src.agents.llm - INFO - 成功将字符串金额 400 转换为数字 400.0
2025-03-10 22:38:39,134 - src.agents.llm - INFO - 生成动作: RAISE 金额: 400 table_talk: {'message': '看来今天运气不错啊，不过既然大家都这么谨慎，那我就稍微提高点赌注吧！', 'tone': '轻松自信'}
2025-03-10 22:38:39,135 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 400
2025-03-10 22:38:39,135 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:38:39,135 - src.engine.state - INFO - 玩家 ai_4 加注到 400 筹码，已标记为已行动
2025-03-10 22:38:39,135 - src.engine.game - INFO - 玩家 ai_4 加注到 400
2025-03-10 22:38:39,136 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:38:39,136 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:38:39,136 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:38:39,137 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 22:38:39,137 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_3, 位置: 3
2025-03-10 22:38:39,137 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_3
2025-03-10 22:38:39,138 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:38:39,138 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:39,138 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:39,138 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 22:38:39,139 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:38:39,139 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(400)，回合继续
2025-03-10 22:38:39,139 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:38:39,139 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:38:39,139 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 1170, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 200, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '6♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 720, 'current_bet': 400, 'is_active': True, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 400}], 'table_talk': {'message': '看来今天运气不错啊，不过既然大家都这么谨慎，那我就稍微提高点赌注吧！', 'tone': '轻松自信'}}
2025-03-10 22:38:39,140 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:39,140 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:39,141 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 22:38:39,141 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:38:39,141 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(400)，回合继续
2025-03-10 22:38:39,141 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:38:39,143 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:38:39,143 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:38:39,144 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:38:39,144 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:38:39,144 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:38:39,144 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:38:47,471 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"ALL_IN","amount":200,"confidence":0.65},"reasoning":{"hand_strength":"我手里有一对6，目前公共牌是J♦, A♣, 5♠, Q♣, 4♣。没有同花可能，没有顺子可能，我只有一对6。","position_analysis":"我在后位，但面对对手的持续加注压力很大。","pot_odds":"底池已经有1170，我的200筹码全下只需要赢15%左右的概率就有正期望值。","opponent_reads":["对手在每个街都选择加注，表现出很强的攻击性。他可能有一手强牌，如A配高踢脚，或者可能在诈唬。他的持续加注模式让我怀疑他可能在尝试用压力迫使我弃牌。"]},"table_talk":{"message":"既然你这么喜欢施压，那我就陪你玩到底吧。全下！","tone":"坚决但略带挑衅"}}
2025-03-10 22:38:47,472 - src.agents.llm - INFO - ==================================================

2025-03-10 22:38:47,473 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 200 table_talk: {'message': '既然你这么喜欢施压，那我就陪你玩到底吧。全下！', 'tone': '坚决但略带挑衅'}
2025-03-10 22:38:47,473 - server - INFO - AI玩家 ai_3 决定执行动作: ALL_IN, 金额: 200
2025-03-10 22:38:47,473 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.ALL_IN
2025-03-10 22:38:47,474 - src.engine.state - INFO - 玩家 ai_3 全下 200 筹码，已标记为已行动
2025-03-10 22:38:47,474 - src.engine.game - INFO - 玩家 ai_3 全下
2025-03-10 22:38:47,474 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_3
2025-03-10 22:38:47,474 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:38:47,474 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:38:47,474 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 22:38:47,475 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:38:47,475 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:38:47,475 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:38:47,475 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:47,475 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:47,475 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 22:38:47,476 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=200, is_all_in=True
2025-03-10 22:38:47,476 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=400, is_all_in=False
2025-03-10 22:38:47,476 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:38:47,476 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:38:47,476 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:38:47,476 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.RIVER
2025-03-10 22:38:47,476 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:38:47,477 - src.engine.game - INFO - 从阶段 GameStage.RIVER 进入下一阶段
2025-03-10 22:38:47,477 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:38:47,477 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:38:47,477 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:38:47,477 - src.engine.game - INFO - 河牌阶段结束，进入摊牌阶段
2025-03-10 22:38:47,478 - src.engine.game - INFO - 游戏结束，执行结算
2025-03-10 22:38:47,478 - src.engine.game - INFO - 结算时活跃玩家数量: 2
2025-03-10 22:38:47,478 - src.engine.game - INFO - 需要比较牌面大小进行结算
2025-03-10 22:38:47,479 - src.engine.game - INFO - 玩家 ai_4 赢得底池 1370
2025-03-10 22:38:47,479 - src.engine.game - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 1370, 'winning_hand': 'PAIR', 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'showdown_data': [{'player_id': 'ai_3', 'hole_cards': ('6♣', '6♠'), 'hand_rank': 'PAIR', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('6♥', 'A♥'), 'hand_rank': 'PAIR', 'is_winner': True}]}
2025-03-10 22:38:47,479 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:38:47,480 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'current_player': None, 'min_raise': 200, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 1370, 'winning_hand': 'PAIR', 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'showdown_data': [{'player_id': 'ai_3', 'hole_cards': ('6♣', '6♠'), 'hand_rank': 'PAIR', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('6♥', 'A♥'), 'hand_rank': 'PAIR', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': ('6♣', '6♠'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'ALL_IN', 'last_amount': 200}, {'id': 'ai_4', 'chips': 2090, 'current_bet': 0, 'is_active': False, 'cards': ('6♥', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '既然你这么喜欢施压，那我就陪你玩到底吧。全下！', 'tone': '坚决但略带挑衅'}}
2025-03-10 22:38:47,480 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:38:47,481 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:38:47,481 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:38:47,481 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:38:47,481 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:38:47,481 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:38:47,482 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 1370, 'winning_hand': 'PAIR', 'community_cards': ['J♦', 'A♣', '5♠', 'Q♣', '4♣'], 'showdown_data': [{'player_id': 'ai_3', 'hole_cards': ('6♣', '6♠'), 'hand_rank': 'PAIR', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('6♥', 'A♥'), 'hand_rank': 'PAIR', 'is_winner': True}]}
2025-03-10 22:38:47,482 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:38:57,562 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:38:57,563 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:38:57,564 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 22:38:57,564 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:38:57,564 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:38:57,564 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♥', '2♥')
2025-03-10 22:38:57,565 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♦', '7♥')
2025-03-10 22:38:57,565 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♦', 'K♠')
2025-03-10 22:38:57,565 - src.engine.game - INFO - 玩家 ai_3 手牌: ('9♦', '3♣')
2025-03-10 22:38:57,565 - src.engine.game - INFO - 玩家 ai_4 手牌: ('10♠', 'Q♠')
2025-03-10 22:38:57,565 - src.engine.state - INFO - 玩家 ai_3 筹码不足，转为全下 0 筹码
2025-03-10 22:38:57,565 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 22:38:57,566 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 22:38:57,566 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 22:38:57,566 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 22:38:57,566 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 22:38:57,566 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:38:57,566 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 22:39:14,662 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:39:14,663 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:39:14.663432', 'table_talk': None}
2025-03-10 22:39:14,663 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:39:14,663 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:39:14,664 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:39:14,664 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:39:14,664 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:39:14,664 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:39:14,664 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:14,664 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:39:14,665 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:39:14,665 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:39:14,665 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:14,665 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:39:14,665 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:14,666 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:39:14,666 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:39:14,666 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:14,666 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:39:14,666 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('7♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '3♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2070, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:39:14,667 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:14,667 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:39:14,668 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:14,668 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:39:14,668 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:39:14,668 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:17,549 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:39:17,549 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:39:17,550 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:39:17,550 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:39:17,550 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:39:17,551 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:39:42,106 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.7"}, "reasoning": {"hand_strength": "8♦,7♥是有潜力但属于边缘型手牌，主要依靠成顺或双对的隐蔽力，在预翻牌阶段实力有限。", "position_analysis": "身处早位，需要谨慎行动，避免以弱牌过早投入过多筹码。", "pot_odds": "底池20，对应跟注20，投入风险较低，具备一定的赔率优势。", "opponent_reads": ["ai_4已经下注20，可能持有较强牌型或在试探；ai_2尚未行动，后续态度不明。"]}, "table_talk": {"message": "我选择跟注，稳扎稳打，等待翻牌展现隐藏潜力。", "tone": "沉稳冷静"}}
2025-03-10 22:39:42,107 - src.agents.llm - INFO - ==================================================

2025-03-10 22:39:42,107 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我选择跟注，稳扎稳打，等待翻牌展现隐藏潜力。', 'tone': '沉稳冷静'}
2025-03-10 22:39:42,107 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 22:39:42,107 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 22:39:42,108 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 22:39:42,108 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 22:39:42,108 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 22:39:42,108 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:39:42,108 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:39:42,108 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:42,108 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:39:42,109 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:39:42,109 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:39:42,109 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:42,109 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:39:42,109 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:42,109 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:39:42,109 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:39:42,110 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:39:42,110 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:42,110 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:39:42,110 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('7♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '3♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2070, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我选择跟注，稳扎稳打，等待翻牌展现隐藏潜力。', 'tone': '沉稳冷静'}}
2025-03-10 22:39:42,111 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:42,111 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:39:42,111 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:42,112 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:39:42,112 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:39:42,112 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:39:42,112 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:42,114 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:39:42,114 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:39:42,114 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:39:42,114 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:39:42,115 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:39:42,115 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:39:48,872 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌7♦和K♠在PRE_FLOP阶段强度较低，缺乏同花或顺子的潜力","position_analysis":"位置2处于早期位置，不利于观察其他玩家的行动","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["ai_1选择跟注，可能持有较强的起手牌"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 22:39:48,873 - src.agents.llm - INFO - ==================================================

2025-03-10 22:39:48,873 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 22:39:48,873 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:39:48,874 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:39:48,874 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:39:48,874 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:39:48,874 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:39:48,874 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:39:48,875 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:39:48,875 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:48,875 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:39:48,875 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:39:48,875 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:39:48,876 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:48,876 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:39:48,876 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:48,876 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:39:48,876 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:39:48,877 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:39:48,877 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:39:48,877 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:48,877 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:39:48,877 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '3♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2070, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 22:39:48,878 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:48,878 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:39:48,879 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:48,879 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:39:48,879 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:39:48,879 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:39:48,880 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:39:48,880 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:48,880 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:39:48,881 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:39:48,881 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:39:48,881 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:39:48,881 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:39:48,882 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:39:56,253 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"9-3不同花是一手非常弱的起手牌，在德州扑克手牌排名中处于最底层","position_analysis":"我在相对较早的位置，后面还有玩家要行动，且我已经没有筹码了","pot_odds":"我已经没有筹码了，无法下注","opponent_reads":["ai_1选择跟注，表明他可能有一手中等强度的牌","ai_4还未行动，但他筹码充足，可能会加注"]},"table_talk":{"message":"看来今天运气不太好，我已经没有筹码了，只能弃牌了。祝各位好运！","tone":"轻松幽默"}}
2025-03-10 22:39:56,254 - src.agents.llm - INFO - ==================================================

2025-03-10 22:39:56,254 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天运气不太好，我已经没有筹码了，只能弃牌了。祝各位好运！', 'tone': '轻松幽默'}
2025-03-10 22:39:56,254 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:39:56,255 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:39:56,255 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:39:56,255 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:39:56,255 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:39:56,255 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:39:56,255 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:39:56,256 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:56,256 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:39:56,256 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:39:56,256 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:39:56,256 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:56,257 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:39:56,257 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:56,257 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:39:56,257 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:39:56,257 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:39:56,257 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:56,258 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:39:56,258 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 2070, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天运气不太好，我已经没有筹码了，只能弃牌了。祝各位好运！', 'tone': '轻松幽默'}}
2025-03-10 22:39:56,259 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:39:56,259 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:39:56,259 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:39:56,260 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:39:56,260 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:39:56,260 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:39:56,260 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:39:56,261 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:39:56,261 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:39:56,262 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:39:56,262 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:39:56,262 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:39:56,262 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:40:12,984 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":80,"confidence":0.75},"reasoning":{"hand_strength":"拥有一对Q，这在pre-flop阶段是一个相当不错的起手牌。考虑到对手已经call了20筹码，我的手牌足够强来尝试加注以获取更多价值或信息。","position_analysis":"位于中间位置，不是最佳也不是最差的位置。这意味着我有一定的灵活性来控制底池大小，同时也能观察到后续玩家的动作。","pot_odds":"当前底池为40，通过加注至80，我将使底池达到120，而只需额外投入60筹码。这是一个合理的投资，特别是对于我的手牌来说。","opponent_reads":["ai_1选择跟注而不是直接加注可能表明他们持有中等强度的手牌，既不想放弃也不愿意过多投入。"]},"table_talk":{"message":"看来我们都有些东西值得一看呢。","tone":"自信但不挑衅"}}
2025-03-10 22:40:12,985 - src.agents.llm - INFO - ==================================================

2025-03-10 22:40:12,985 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '看来我们都有些东西值得一看呢。', 'tone': '自信但不挑衅'}
2025-03-10 22:40:12,985 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 80
2025-03-10 22:40:12,985 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:40:12,986 - src.engine.state - INFO - 玩家 ai_4 加注到 80 筹码，已标记为已行动
2025-03-10 22:40:12,986 - src.engine.game - INFO - 玩家 ai_4 加注到 80
2025-03-10 22:40:12,986 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:40:12,986 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:40:12,986 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:40:12,986 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:40:12,987 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-10 22:40:12,987 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_1
2025-03-10 22:40:12,987 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:40:12,988 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:40:12,988 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:40:12,988 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:40:12,988 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:40:12,988 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(80)，回合继续
2025-03-10 22:40:12,989 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:40:12,989 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:40:12,989 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 100, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2010, 'current_bet': 80, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 80}], 'table_talk': {'message': '看来我们都有些东西值得一看呢。', 'tone': '自信但不挑衅'}}
2025-03-10 22:40:12,990 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:40:12,990 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:40:12,991 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:40:12,991 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 22:40:12,991 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(80)，回合继续
2025-03-10 22:40:12,992 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:40:12,992 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:40:12,993 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:40:12,993 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:40:12,993 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:40:12,993 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:40:12,994 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:40:46,448 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "8♦, 7♥在预翻牌阶段显得较弱，尤其是非同花且连接性不足，进攻潜力有限", "position_analysis": "处于早期位置，信息不足，加上对手展现的攻击性令情况更为不利", "pot_odds": "底池与投入比不具吸引力，面对对手加注风险较高", "opponent_reads": ["对手的加注可能代表更强的牌或积极的诈唬，此时跟注风险过大"]}, "table_talk": {"message": "抱歉，今天我可不打无聊牌，你们继续玩吧！", "tone": "冷静且带点讽刺"}}
2025-03-10 22:40:46,449 - src.agents.llm - INFO - ==================================================

2025-03-10 22:40:46,449 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉，今天我可不打无聊牌，你们继续玩吧！', 'tone': '冷静且带点讽刺'}
2025-03-10 22:40:46,450 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:40:46,450 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:40:46,451 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:40:46,451 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:40:46,451 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:40:46,451 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:40:46,451 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:40:46,452 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:40:46,452 - src.engine.state - INFO - 玩家 ai_4 获得底池 100 筹码，当前筹码: 2110
2025-03-10 22:40:46,452 - src.engine.game - INFO - 玩家 ai_4 获得底池 100 筹码
2025-03-10 22:40:46,452 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:40:46,452 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 100, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♠', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:40:46,453 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 100, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♠', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2110, 'current_bet': 80, 'is_active': False, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉，今天我可不打无聊牌，你们继续玩吧！', 'tone': '冷静且带点讽刺'}}
2025-03-10 22:40:46,454 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:40:46,454 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:40:46,454 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:40:46,454 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:40:46,455 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:40:46,455 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:40:46,455 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 100, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♠', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:40:46,455 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:40:55,697 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:40:55,697 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:40:55,698 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 22:40:55,698 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:40:55,699 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:40:55,700 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♥', 'A♥')
2025-03-10 22:40:55,700 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♦', '2♠')
2025-03-10 22:40:55,700 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♣', 'A♠')
2025-03-10 22:40:55,701 - src.engine.game - INFO - 玩家 ai_3 手牌: ('5♣', '7♣')
2025-03-10 22:40:55,701 - src.engine.game - INFO - 玩家 ai_4 手牌: ('3♠', 'J♠')
2025-03-10 22:40:55,701 - src.engine.state - INFO - 玩家 ai_4 下注 10 筹码
2025-03-10 22:40:55,701 - src.engine.game - INFO - 玩家 ai_4 下注小盲注 10
2025-03-10 22:40:55,701 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 22:40:55,701 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 22:40:55,702 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_4(10)，大盲注=player_0(20)
2025-03-10 22:40:55,702 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 22:40:55,702 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:40:55,702 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:40:56,452 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:40:56,453 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:40:56,453 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:40:56,454 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:40:56,454 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:40:56,454 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:41:07,177 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": 0, "confidence": 0.95}, "reasoning": {"hand_strength": "7♦, 2♠ is widely recognized as the weakest starting hand in Texas Hold'em, offering almost no potential to win.", "position_analysis": "Being in an early position with such a hand makes the situation even worse, as I have to act without knowing the other players’ moves.", "pot_odds": "The pot odds do not justify risking my chips with a hand that has very low equity.", "opponent_reads": ["player_0 and ai_4 are showing standard aggression, implying they have stronger holdings", "Overall table dynamics favor caution rather than a desperate call with this hand"]}, "table_talk": {"message": "这手牌太弱，不值得冒险。", "tone": "冷静而直接"}}
2025-03-10 22:41:07,178 - src.agents.llm - INFO - ==================================================

2025-03-10 22:41:07,178 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌太弱，不值得冒险。', 'tone': '冷静而直接'}
2025-03-10 22:41:07,179 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:41:07,179 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:41:07,179 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:41:07,180 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:41:07,180 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:41:07,180 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:41:07,180 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:41:07,181 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:07,181 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:41:07,181 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:41:07,181 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:41:07,181 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:07,182 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:41:07,182 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:07,182 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:07,182 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:07,182 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:07,182 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:41:07,182 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', 'A♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', '7♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2100, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌太弱，不值得冒险。', 'tone': '冷静而直接'}}
2025-03-10 22:41:07,183 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:07,184 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:41:07,184 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:07,184 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:07,184 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:07,184 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:07,186 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:41:07,187 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:41:07,187 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:41:07,187 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:41:07,188 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:41:07,188 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:41:15,659 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"0","confidence":"0.8"},"reasoning":{"hand_strength":"手牌4♣和A♠在PRE_FLOP阶段较弱，A♠虽有一定潜力，但4♣的协同作用有限，整体手牌强度不足","position_analysis":"位于第2位，早期位置不利于观察对手行动，增加了决策的不确定性","pot_odds":"底池30，当前最大注20，跟注需要20，底池赔率较低，不值得冒险","opponent_reads":["player_0下注20，显示出一定的进攻性，可能持有较强手牌","ai_4下注10，可能是在试探，但筹码量较大，潜在威胁较高"]},"table_talk":{"message":"看来这手牌不太适合我，先弃牌观察一下","tone":"冷静"}}
2025-03-10 22:41:15,660 - src.agents.llm - INFO - ==================================================

2025-03-10 22:41:15,660 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，先弃牌观察一下', 'tone': '冷静'}
2025-03-10 22:41:15,661 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:41:15,661 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:41:15,661 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:41:15,662 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:41:15,662 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:41:15,662 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:41:15,663 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:41:15,663 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:15,663 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:41:15,663 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:41:15,663 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:41:15,663 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:15,664 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_3', 'ai_4']
2025-03-10 22:41:15,664 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:15,664 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:15,664 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:15,664 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:15,665 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:41:15,665 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', '7♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2100, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，先弃牌观察一下', 'tone': '冷静'}}
2025-03-10 22:41:15,666 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:15,666 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_3', 'ai_4']
2025-03-10 22:41:15,666 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:15,666 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:15,667 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:15,667 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:15,668 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:41:15,668 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:41:15,669 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:41:15,669 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:41:15,669 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:41:15,670 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:41:22,479 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"5♣, 7♣是一手较弱的起手牌，不同花色的57连牌，没有成牌潜力","position_analysis":"我在相对靠前的位置(位置3)，后面还有玩家要行动，位置不利","pot_odds":"当前我的筹码为0，无法进行任何下注操作","opponent_reads":["player_0已经下注20，显示出一定的强势","ai_4只下了小盲注，还未真正行动"]},"table_talk":{"message":"看来我已经没有筹码了，这一把只能弃牌了。祝各位好运！","tone":"平静"}}
2025-03-10 22:41:22,480 - src.agents.llm - INFO - ==================================================

2025-03-10 22:41:22,480 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我已经没有筹码了，这一把只能弃牌了。祝各位好运！', 'tone': '平静'}
2025-03-10 22:41:22,481 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:41:22,481 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:41:22,481 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:41:22,481 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:41:22,482 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:41:22,482 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:41:22,482 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:41:22,482 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:22,482 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:41:22,483 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:41:22,483 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:41:22,483 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:22,483 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:22,483 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:22,483 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:22,484 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:22,484 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:22,484 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:41:22,484 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 2100, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我已经没有筹码了，这一把只能弃牌了。祝各位好运！', 'tone': '平静'}}
2025-03-10 22:41:22,485 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:22,485 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:22,486 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:41:22,486 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:22,487 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:22,487 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:22,487 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:41:22,488 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:41:22,488 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:41:22,488 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:41:22,488 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:41:22,489 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:41:42,630 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"虽然我的手牌不是很强，但考虑到J♠可以作为潜在的听牌使用，且对手已经下注20，显示了一定的手牌强度或尝试偷盲。通过加注来测试对手的决心，并可能在翻牌圈获得更好的位置优势。","position_analysis":"位于中间偏后的位置，这给了我观察对手行动的机会，同时也能够对后续玩家施加压力。","pot_odds":"当前底池为30，如果我加注到60，则需要考虑对手跟注的可能性以及之后如何利用公共牌发展策略。","opponent_reads":["对手直接选择了加注而不是过牌看翻牌，表明他对自己手牌有一定信心，但也可能是试图控制底池大小。"]},"table_talk":{"message":"看来你对自己的手牌很有信心啊，那我也得表示一下了。","tone":"轻松自信"}}
2025-03-10 22:41:42,631 - src.agents.llm - INFO - ==================================================

2025-03-10 22:41:42,632 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来你对自己的手牌很有信心啊，那我也得表示一下了。', 'tone': '轻松自信'}
2025-03-10 22:41:42,632 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 22:41:42,633 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:41:42,633 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 22:41:42,634 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 22:41:42,634 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:41:42,634 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:41:42,634 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:41:42,634 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:41:42,635 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:41:42,635 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:41:42,635 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:41:42,635 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:42,635 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:42,636 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:41:42,636 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:42,636 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:42,636 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:42,636 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:41:42,637 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2050, 'current_bet': 60, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来你对自己的手牌很有信心啊，那我也得表示一下了。', 'tone': '轻松自信'}}
2025-03-10 22:41:42,638 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:42,639 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:42,639 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:41:42,639 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:41:42,640 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:42,640 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:47,031 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 22:41:47,031 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T22:41:47.031276', 'table_talk': None}
2025-03-10 22:41:47,032 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 22:41:47,033 - src.engine.state - INFO - 玩家 player_0 跟注 40 筹码，已标记为已行动
2025-03-10 22:41:47,033 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 22:41:47,033 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 22:41:47,034 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:41:47,034 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:41:47,034 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:41:47,035 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:41:47,035 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:41:47,035 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:41:47,035 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:47,035 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:47,035 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:41:47,036 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:41:47,036 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 22:41:47,036 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:41:47,036 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:41:47,036 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:41:47,036 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 22:41:47,037 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:41:47,037 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 22:41:47,037 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:47,037 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 22:41:47,037 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:41:47,038 - src.engine.dealer - INFO - Dealt 3 community cards: ['10♥', '10♠', '3♥']
2025-03-10 22:41:47,038 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['10♥', '10♠', '3♥']
2025-03-10 22:41:47,038 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_4', 4)]
2025-03-10 22:41:47,039 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 22:41:47,039 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 22:41:47,039 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:41:47,040 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 120, 'community_cards': ['10♥', '10♠', '3♥'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2050, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:41:47,042 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:41:47,042 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:41:47,043 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:41:47,043 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:41:47,044 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:41:47,045 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:41:47,651 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:41:47,652 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:41:47,652 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:41:47,652 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:41:47,653 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:41:47,653 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:42:01,475 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":100,"confidence":0.75},"reasoning":{"hand_strength":"拥有三条，是一个很强的手牌组合，尤其是在这个阶段。考虑到公共牌面的结构，我的手牌很可能领先于对手。","position_analysis":"位于后位，这给了我观察对手行动后再做决定的优势。在这样的位置上采取主动可以给对手施加压力。","pot_odds":"当前底池为120，通过增加注额到100来提高底池大小，同时保持对底池的良好控制。即使被跟注，也有利于后续回合的操作。","opponent_reads":["对手之前选择了跟注60的加注，显示出他对自己的手牌有一定信心，但未必强到足以立即反击。"]},"table_talk":{"message":"看来我们都认为这里有些值得争夺的东西。","tone":"挑衅"}}
2025-03-10 22:42:01,476 - src.agents.llm - INFO - ==================================================

2025-03-10 22:42:01,476 - src.agents.llm - INFO - 生成动作: RAISE 金额: 100 table_talk: {'message': '看来我们都认为这里有些值得争夺的东西。', 'tone': '挑衅'}
2025-03-10 22:42:01,476 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 100
2025-03-10 22:42:01,477 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:42:01,477 - src.engine.state - INFO - 玩家 ai_4 加注到 100 筹码，已标记为已行动
2025-03-10 22:42:01,477 - src.engine.game - INFO - 玩家 ai_4 加注到 100
2025-03-10 22:42:01,478 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:42:01,478 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:42:01,478 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:42:01,478 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:42:01,479 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:42:01,479 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:42:01,479 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:42:01,479 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:01,480 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:01,480 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:42:01,480 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:01,480 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:01,480 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:01,481 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:42:01,481 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 220, 'community_cards': ['10♥', '10♠', '3♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1950, 'current_bet': 100, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 100}], 'table_talk': {'message': '看来我们都认为这里有些值得争夺的东西。', 'tone': '挑衅'}}
2025-03-10 22:42:01,482 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:01,482 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:01,482 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:42:01,483 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:01,483 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:01,483 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:07,568 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 22:42:07,568 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T22:42:07.568757', 'table_talk': None}
2025-03-10 22:42:07,569 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 22:42:07,569 - src.engine.state - INFO - 玩家 player_0 跟注 100 筹码，已标记为已行动
2025-03-10 22:42:07,569 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 22:42:07,570 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 22:42:07,570 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:42:07,570 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:42:07,570 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:42:07,570 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:42:07,570 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:42:07,571 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:42:07,571 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:07,571 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:07,571 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:42:07,571 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 22:42:07,571 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 22:42:07,572 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:42:07,572 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:42:07,572 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:42:07,572 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 22:42:07,573 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:42:07,573 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 22:42:07,573 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:07,573 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 22:42:07,573 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:42:07,574 - src.engine.dealer - INFO - Dealt 1 community cards: ['10♦']
2025-03-10 22:42:07,574 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['10♥', '10♠', '3♥', '10♦']
2025-03-10 22:42:07,574 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_4', 4)]
2025-03-10 22:42:07,574 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 22:42:07,574 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 22:42:07,575 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:42:07,575 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 320, 'community_cards': ['10♥', '10♠', '3♥', '10♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1950, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:42:07,575 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:07,575 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:07,575 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:42:07,576 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:07,576 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:07,576 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:11,521 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:42:11,521 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:42:11,521 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:42:11,522 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:42:11,522 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:42:11,522 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:42:24,398 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":200,"confidence":0.75},"reasoning":{"hand_strength":"我的手牌是3♠, J♠，目前公共牌面为10♥, 10♠, 3♥, 10♦，这给了我一对三和潜在的同花听牌机会。考虑到已经出现的三条十，我的牌力相对较强，但不是绝对优势。","position_analysis":"处于较晚的位置，能够观察对手反应后再做决定，这是有利的。","pot_odds":"底池赔率为320:200=1.6:1，考虑到我还有较好的听牌机会，这个赔率是可以接受的。","opponent_reads":["对手之前两次跟注了我的加注，显示出他可能持有较强的牌或者也在尝试听牌。"]},"table_talk":{"message":"看来我们都对这张桌子上的游戏很感兴趣啊！","tone":"轻松自信"}}
2025-03-10 22:42:24,400 - src.agents.llm - INFO - ==================================================

2025-03-10 22:42:24,401 - src.agents.llm - INFO - 生成动作: RAISE 金额: 200 table_talk: {'message': '看来我们都对这张桌子上的游戏很感兴趣啊！', 'tone': '轻松自信'}
2025-03-10 22:42:24,401 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 200
2025-03-10 22:42:24,402 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:42:24,402 - src.engine.state - INFO - 玩家 ai_4 加注到 200 筹码，已标记为已行动
2025-03-10 22:42:24,402 - src.engine.game - INFO - 玩家 ai_4 加注到 200
2025-03-10 22:42:24,403 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:42:24,403 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:42:24,403 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:42:24,403 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:42:24,404 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:42:24,404 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:42:24,404 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:42:24,404 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:24,404 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:24,405 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:42:24,405 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:24,405 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:24,405 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:24,405 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:42:24,406 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 520, 'community_cards': ['10♥', '10♠', '3♥', '10♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1750, 'current_bet': 200, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 200}], 'table_talk': {'message': '看来我们都对这张桌子上的游戏很感兴趣啊！', 'tone': '轻松自信'}}
2025-03-10 22:42:24,406 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:24,406 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:24,407 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:42:24,407 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:24,407 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:24,407 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:27,117 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 22:42:27,117 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T22:42:27.117263', 'table_talk': None}
2025-03-10 22:42:27,118 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 22:42:27,118 - src.engine.state - INFO - 玩家 player_0 跟注 200 筹码，已标记为已行动
2025-03-10 22:42:27,118 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 22:42:27,119 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 22:42:27,119 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:42:27,120 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:42:27,120 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:42:27,121 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:42:27,121 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:42:27,121 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:42:27,122 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:27,122 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:27,123 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 22:42:27,123 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 22:42:27,123 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 22:42:27,123 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:42:27,124 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:42:27,124 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:42:27,124 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 22:42:27,124 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:42:27,124 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 22:42:27,124 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:27,125 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 22:42:27,125 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:42:27,125 - src.engine.dealer - INFO - Dealt 1 community cards: ['K♥']
2025-03-10 22:42:27,125 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['10♥', '10♠', '3♥', '10♦', 'K♥']
2025-03-10 22:42:27,126 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_4', 4)]
2025-03-10 22:42:27,126 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 22:42:27,126 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 22:42:27,126 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:42:27,126 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 720, 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 640, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1750, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:42:27,127 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:27,127 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:27,127 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:42:27,127 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:27,128 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:27,128 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:29,424 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:42:29,425 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:42:29,426 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:42:29,427 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:42:29,427 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:42:29,428 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:42:41,334 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"300","confidence":"0.75"},"reasoning":{"hand_strength":"拥有三条，一手非常强的手牌。考虑到公共牌面存在可能的全屋或更大的牌型，但基于当前信息我的手牌依然处于有利位置。","position_analysis":"位于后位，这给予我观察对手行动后再做决策的优势。","pot_odds":"底池赔率支持进行加注，因为即使被跟注，也有很好的赢率来赢得这个底池。","opponent_reads":["player_0一直选择跟注，显示出对他的手牌有信心，但也可能是试图控制底池大小。"]},"table_talk":{"message":"看来我们都有些好东西呢，不过我觉得自己今晚运气更好一点。","tone":"自信"}}
2025-03-10 22:42:41,335 - src.agents.llm - INFO - ==================================================

2025-03-10 22:42:41,336 - src.agents.llm - INFO - 成功将字符串金额 300 转换为数字 300.0
2025-03-10 22:42:41,336 - src.agents.llm - INFO - 生成动作: RAISE 金额: 300 table_talk: {'message': '看来我们都有些好东西呢，不过我觉得自己今晚运气更好一点。', 'tone': '自信'}
2025-03-10 22:42:41,337 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 300
2025-03-10 22:42:41,337 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:42:41,338 - src.engine.state - INFO - 玩家 ai_4 加注到 300 筹码，已标记为已行动
2025-03-10 22:42:41,338 - src.engine.game - INFO - 玩家 ai_4 加注到 300
2025-03-10 22:42:41,338 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:42:41,338 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:42:41,339 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:42:41,339 - src.engine.game - INFO - 当前最大下注额: 300
2025-03-10 22:42:41,339 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:42:41,339 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:42:41,339 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:42:41,340 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:41,340 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:41,340 - src.engine.game - INFO - 当前最大下注额: 300
2025-03-10 22:42:41,340 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:41,341 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:41,341 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:41,341 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:42:41,341 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 1020, 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 640, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1450, 'current_bet': 300, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 300}], 'table_talk': {'message': '看来我们都有些好东西呢，不过我觉得自己今晚运气更好一点。', 'tone': '自信'}}
2025-03-10 22:42:41,342 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:41,342 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:41,342 - src.engine.game - INFO - 当前最大下注额: 300
2025-03-10 22:42:41,343 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:42:41,343 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:42:41,344 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:42:44,533 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'ALL_IN', 'amount': 0}
2025-03-10 22:42:44,534 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'ALL_IN', 'amount': 0, 'timestamp': '2025-03-10T22:42:44.534620', 'table_talk': None}
2025-03-10 22:42:44,534 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.ALL_IN
2025-03-10 22:42:44,534 - src.engine.state - INFO - 玩家 player_0 全下 640 筹码，已标记为已行动
2025-03-10 22:42:44,535 - src.engine.game - INFO - 玩家 player_0 全下
2025-03-10 22:42:44,535 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by player_0
2025-03-10 22:42:44,535 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:42:44,536 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:42:44,536 - src.engine.game - INFO - 当前最大下注额: 640
2025-03-10 22:42:44,536 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:42:44,536 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_4
2025-03-10 22:42:44,536 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:42:44,537 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:44,537 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:44,537 - src.engine.game - INFO - 当前最大下注额: 640
2025-03-10 22:42:44,537 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=640, is_all_in=True
2025-03-10 22:42:44,537 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=300, is_all_in=False
2025-03-10 22:42:44,538 - src.engine.game - INFO - 玩家 ai_4 下注额(300)不等于最大下注额(640)，回合继续
2025-03-10 22:42:44,538 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:42:44,538 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:42:44,538 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 1660, 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'current_player': 'ai_4', 'min_raise': 640, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 640, 'is_active': True, 'cards': ('5♥', 'A♥'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': 'ALL_IN', 'last_amount': 0}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1450, 'current_bet': 300, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:42:44,539 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:42:44,539 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:42:44,540 - src.engine.game - INFO - 当前最大下注额: 640
2025-03-10 22:42:44,540 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=640, is_all_in=True
2025-03-10 22:42:44,540 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=300, is_all_in=False
2025-03-10 22:42:44,540 - src.engine.game - INFO - 玩家 ai_4 下注额(300)不等于最大下注额(640)，回合继续
2025-03-10 22:42:44,541 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:42:46,368 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:42:46,368 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:42:46,369 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:42:46,369 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:42:46,370 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:42:46,370 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:43:02,028 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"ALL_IN","amount":"1450","confidence":0.7},"reasoning":{"hand_strength":"我的手牌为一对3，加上公共牌上的三张10，形成了三条。这是一手相当强的手牌，尤其是在这个阶段。","position_analysis":"我处于较晚的位置，这意味着我可以基于其他玩家的动作做出反应，增加了信息优势。","pot_odds":"考虑到对手已经全下，此时考虑底池赔率变得不太相关，关键在于评估胜率与潜在回报。","opponent_reads":["对手在整个过程中表现得非常激进，每次我都加注时他都选择跟注或再次加注，显示出很强的信心。但这也可能是试图通过大额下注来吓退对手的策略。"]},"table_talk":{"message":"好吧，既然你这么有信心，那我们就来看看谁更幸运吧！","tone":"挑衅"}}
2025-03-10 22:43:02,029 - src.agents.llm - INFO - ==================================================

2025-03-10 22:43:02,030 - src.agents.llm - INFO - 成功将字符串金额 1450 转换为数字 1450.0
2025-03-10 22:43:02,030 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 1450 table_talk: {'message': '好吧，既然你这么有信心，那我们就来看看谁更幸运吧！', 'tone': '挑衅'}
2025-03-10 22:43:02,030 - server - INFO - AI玩家 ai_4 决定执行动作: ALL_IN, 金额: 1450
2025-03-10 22:43:02,031 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.ALL_IN
2025-03-10 22:43:02,031 - src.engine.state - INFO - 玩家 ai_4 全下 1450 筹码，已标记为已行动
2025-03-10 22:43:02,031 - src.engine.game - INFO - 玩家 ai_4 全下
2025-03-10 22:43:02,031 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_4
2025-03-10 22:43:02,031 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:43:02,031 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:43:02,031 - src.engine.game - INFO - 当前最大下注额: 1750
2025-03-10 22:43:02,032 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:43:02,032 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:43:02,032 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:43:02,032 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:43:02,032 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:43:02,032 - src.engine.game - INFO - 当前最大下注额: 1750
2025-03-10 22:43:02,033 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=640, is_all_in=True
2025-03-10 22:43:02,033 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=1750, is_all_in=True
2025-03-10 22:43:02,033 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:43:02,033 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:43:02,033 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:43:02,033 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.RIVER
2025-03-10 22:43:02,033 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:43:02,034 - src.engine.game - INFO - 从阶段 GameStage.RIVER 进入下一阶段
2025-03-10 22:43:02,034 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:43:02,034 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 22:43:02,034 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:43:02,034 - src.engine.game - INFO - 河牌阶段结束，进入摊牌阶段
2025-03-10 22:43:02,034 - src.engine.game - INFO - 游戏结束，执行结算
2025-03-10 22:43:02,034 - src.engine.game - INFO - 结算时活跃玩家数量: 2
2025-03-10 22:43:02,035 - src.engine.game - INFO - 需要比较牌面大小进行结算
2025-03-10 22:43:02,035 - src.engine.game - INFO - 玩家 ai_4 赢得底池 3110
2025-03-10 22:43:02,035 - src.engine.game - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 3110, 'winning_hand': 'FULL_HOUSE', 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♥', 'A♥'), 'hand_rank': 'FLUSH', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('3♠', 'J♠'), 'hand_rank': 'FULL_HOUSE', 'is_winner': True}]}
2025-03-10 22:43:02,036 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:43:02,036 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'current_player': None, 'min_raise': 1750, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 3110, 'winning_hand': 'FULL_HOUSE', 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♥', 'A♥'), 'hand_rank': 'FLUSH', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('3♠', 'J♠'), 'hand_rank': 'FULL_HOUSE', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': ('5♥', 'A♥'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 920, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': ('3♠', 'J♠'), 'is_all_in': True, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'ALL_IN', 'last_amount': 1450}], 'table_talk': {'message': '好吧，既然你这么有信心，那我们就来看看谁更幸运吧！', 'tone': '挑衅'}}
2025-03-10 22:43:02,037 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:43:02,037 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:43:02,037 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:43:02,037 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:43:02,038 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:43:02,038 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:43:02,038 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 3110, 'winning_hand': 'FULL_HOUSE', 'community_cards': ['10♥', '10♠', '3♥', '10♦', 'K♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♥', 'A♥'), 'hand_rank': 'FLUSH', 'is_winner': False}, {'player_id': 'ai_4', 'hole_cards': ('3♠', 'J♠'), 'hand_rank': 'FULL_HOUSE', 'is_winner': True}]}
2025-03-10 22:43:02,039 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:44:00,305 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:44:00,306 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:44:00,306 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 22:44:00,307 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:44:00,307 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:44:00,307 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♦', '9♥')
2025-03-10 22:44:00,307 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♦', 'K♣')
2025-03-10 22:44:00,307 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♦', 'J♥')
2025-03-10 22:44:00,308 - src.engine.game - INFO - 玩家 ai_3 手牌: ('K♠', 'Q♥')
2025-03-10 22:44:00,308 - src.engine.game - INFO - 玩家 ai_4 手牌: ('Q♠', 'A♥')
2025-03-10 22:44:00,308 - src.engine.state - INFO - 玩家 player_0 筹码不足，转为全下 0 筹码
2025-03-10 22:44:00,308 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 22:44:00,308 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 22:44:00,309 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 22:44:00,309 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 22:44:00,309 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 22:44:00,309 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:44:00,309 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 22:44:02,143 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:44:02,143 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:44:02,144 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:44:02,144 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:44:02,144 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:44:02,145 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:44:08,653 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌4♦和J♥在PRE_FLOP阶段较弱，缺乏同花或顺子的潜力","position_analysis":"位置2处于中间位置，不利于观察对手行动","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["ai_1已经下注20，可能持有较强的手牌，其他对手尚未行动，存在潜在威胁"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 22:44:08,654 - src.agents.llm - INFO - ==================================================

2025-03-10 22:44:08,655 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 22:44:08,655 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:44:08,655 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:44:08,655 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:44:08,655 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:44:08,656 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:44:08,656 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:44:08,656 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:44:08,657 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:44:08,657 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:44:08,657 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:44:08,657 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:44:08,658 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:08,658 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:44:08,658 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:44:08,659 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:44:08,659 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:08,659 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:08,659 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:08,659 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:44:08,660 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('K♦', '9♥'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3110, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 22:44:08,660 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:08,661 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:44:08,661 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:44:08,661 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:44:08,661 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:08,661 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:08,662 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:08,662 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:44:08,662 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:44:08,663 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:44:08,663 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:44:08,663 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:44:08,664 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:44:15,973 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"我有KQ同花，这是一手中等偏强的起手牌，但不是顶级牌。","position_analysis":"我处于早期位置(位置3)，这不是一个有利的位置。","pot_odds":"我的筹码为0，无法进行任何下注操作。","opponent_reads":["ai_1已经下注20，显示出一定的强度","ai_4还未行动，后面可能还有加注"]},"table_talk":{"message":"看来我已经没有筹码了，只能弃牌了。祝各位好运！","tone":"平静"}}
2025-03-10 22:44:15,974 - src.agents.llm - INFO - ==================================================

2025-03-10 22:44:15,974 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我已经没有筹码了，只能弃牌了。祝各位好运！', 'tone': '平静'}
2025-03-10 22:44:15,975 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:44:15,975 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:44:15,975 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:44:15,975 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:44:15,976 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:44:15,976 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:44:15,976 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:44:15,976 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:44:15,976 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:44:15,977 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:44:15,977 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:44:15,977 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:15,977 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:44:15,977 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:44:15,977 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:44:15,977 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:15,978 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:15,978 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:15,978 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:44:15,978 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('K♦', '9♥'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3110, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我已经没有筹码了，只能弃牌了。祝各位好运！', 'tone': '平静'}}
2025-03-10 22:44:15,979 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:15,979 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:44:15,979 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:44:15,979 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:44:15,979 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:15,980 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:15,980 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:15,981 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:44:15,981 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:44:15,981 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:44:15,981 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:44:15,982 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:44:15,982 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:44:35,660 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"100","confidence":0.85},"reasoning":{"hand_strength":"持有A高牌，虽然不是最好的起手牌但也有不错的潜力。Q♠, A♥组合在翻牌前算是中上水平的手牌，特别是考虑到位置优势。","position_analysis":"位于较晚的位置，可以观察到更多玩家的动作后再做决定，这增加了信息量并允许更灵活的策略调整。","pot_odds":"鉴于当前底池大小为20，而我计划加注至100，这意味着我需要大约1/6的机会来赢得底池以保证这个加注是正EV（期望值）的。基于我的手牌和位置，我认为这是合理的。","opponent_reads":["ai_1已经进行了小额下注，可能表明他们有较强的起手牌或是在尝试偷取盲注。考虑到他们的筹码量相对较小，他们可能不愿意轻易放弃。"]},"table_talk":{"message":"看来有人想要试试运气了，但我可不会这么容易就让步。","tone":"自信"}}
2025-03-10 22:44:35,661 - src.agents.llm - INFO - ==================================================

2025-03-10 22:44:35,661 - src.agents.llm - INFO - 成功将字符串金额 100 转换为数字 100.0
2025-03-10 22:44:35,662 - src.agents.llm - INFO - 生成动作: RAISE 金额: 100 table_talk: {'message': '看来有人想要试试运气了，但我可不会这么容易就让步。', 'tone': '自信'}
2025-03-10 22:44:35,662 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 100
2025-03-10 22:44:35,662 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:44:35,663 - src.engine.state - INFO - 玩家 ai_4 加注到 100 筹码，已标记为已行动
2025-03-10 22:44:35,663 - src.engine.game - INFO - 玩家 ai_4 加注到 100
2025-03-10 22:44:35,663 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:44:35,664 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:44:35,665 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:44:35,666 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:44:35,666 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:44:35,667 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:44:35,668 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:44:35,669 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:35,669 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:44:35,670 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:44:35,670 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:44:35,670 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:35,670 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:35,670 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:35,670 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:44:35,670 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 120, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('K♦', '9♥'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3010, 'current_bet': 100, 'is_active': True, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 100}], 'table_talk': {'message': '看来有人想要试试运气了，但我可不会这么容易就让步。', 'tone': '自信'}}
2025-03-10 22:44:35,671 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:35,671 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:44:35,672 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:44:35,672 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:44:35,672 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:35,672 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:35,673 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:41,265 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:44:41,266 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:44:41.266719', 'table_talk': None}
2025-03-10 22:44:41,266 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:44:41,266 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:44:41,266 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:44:41,267 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:44:41,267 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:44:41,267 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:44:41,267 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:44:41,267 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:44:41,268 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:44:41,268 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:44:41,268 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:41,268 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:44:41,268 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:44:41,268 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:41,269 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:41,269 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:41,269 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:44:41,269 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 120, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 900, 'current_bet': 20, 'is_active': True, 'cards': ('9♦', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3010, 'current_bet': 100, 'is_active': True, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:44:41,270 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:44:41,270 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:44:41,270 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:44:41,270 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:44:41,271 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:44:41,271 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:44:45,681 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:44:45,681 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:44:45,682 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:44:45,682 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:44:45,682 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:44:45,682 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:45:13,352 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "220", "confidence": "0.8"}, "reasoning": {"hand_strength": "虽然手牌不是豪华组合，但K高配9在对阵单一对手时具有一定潜力，能在翻牌后形成良好局面", "position_analysis": "目前处于较为主动的位置，对手单挑的局面更容易施加压迫", "pot_odds": "底池较小且投入成本合理，加注可以迫使对手做出决策", "opponent_reads": ["对手表现出激进风格，可能在较宽范围内开局，加注能利用心理优势"]}, "table_talk": {"message": "准备好迎接我的进攻了吗？让我们看看谁更有底气！", "tone": "挑衅且自信"}}
2025-03-10 22:45:13,353 - src.agents.llm - INFO - ==================================================

2025-03-10 22:45:13,354 - src.agents.llm - INFO - 成功将字符串金额 220 转换为数字 220.0
2025-03-10 22:45:13,354 - src.agents.llm - INFO - 生成动作: RAISE 金额: 220 table_talk: {'message': '准备好迎接我的进攻了吗？让我们看看谁更有底气！', 'tone': '挑衅且自信'}
2025-03-10 22:45:13,354 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 220
2025-03-10 22:45:13,354 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 22:45:13,355 - src.engine.state - INFO - 玩家 ai_1 加注到 220 筹码，已标记为已行动
2025-03-10 22:45:13,355 - src.engine.game - INFO - 玩家 ai_1 加注到 220
2025-03-10 22:45:13,355 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 22:45:13,356 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:45:13,356 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:45:13,356 - src.engine.game - INFO - 当前最大下注额: 220
2025-03-10 22:45:13,357 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:45:13,357 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_4
2025-03-10 22:45:13,357 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:45:13,357 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:45:13,357 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:45:13,358 - src.engine.game - INFO - 当前最大下注额: 220
2025-03-10 22:45:13,358 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=220, is_all_in=False
2025-03-10 22:45:13,358 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 22:45:13,358 - src.engine.game - INFO - 玩家 ai_4 下注额(100)不等于最大下注额(220)，回合继续
2025-03-10 22:45:13,359 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:45:13,359 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:45:13,359 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 320, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 700, 'current_bet': 220, 'is_active': True, 'cards': ('9♦', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 220}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3010, 'current_bet': 100, 'is_active': True, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '准备好迎接我的进攻了吗？让我们看看谁更有底气！', 'tone': '挑衅且自信'}}
2025-03-10 22:45:13,360 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:45:13,360 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:45:13,360 - src.engine.game - INFO - 当前最大下注额: 220
2025-03-10 22:45:13,360 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=220, is_all_in=False
2025-03-10 22:45:13,361 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 22:45:13,361 - src.engine.game - INFO - 玩家 ai_4 下注额(100)不等于最大下注额(220)，回合继续
2025-03-10 22:45:13,361 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:45:13,362 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:45:13,362 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:45:13,362 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:45:13,363 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:45:13,363 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:45:13,363 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:45:31,451 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"480","confidence":"0.75"},"reasoning":{"hand_strength":"持有A高牌和Q，这在前翻牌圈是一个相当强的起手牌。考虑到对手已经加注，表明他们可能也有不错的牌，但我的牌足够强去尝试控制底池大小并获取更多信息。","position_analysis":"处于中间位置，虽然不是最佳，但也不是最差的位置。这意味着我需要更加谨慎地考虑行动，同时也要利用好这个位置来观察后续玩家的动作。","pot_odds":"当前底池为320，通过加注到480，我增加了底池的价值，同时也给对手施加了压力。如果他选择跟注或再次加注，那么底池赔率将变得更有利。","opponent_reads":["ai_1之前进行了加注，显示出一定的侵略性或者对自身手牌的信心。考虑到其剩余筹码量相对较少，可能存在全下的可能性，因此通过适当的加注可以测试他的决心。"]},"table_talk":{"message":"看来你对自己的牌很有信心啊，那我也得展示一下我的实力了。","tone":"自信且略带挑衅"}}
2025-03-10 22:45:31,452 - src.agents.llm - INFO - ==================================================

2025-03-10 22:45:31,452 - src.agents.llm - INFO - 成功将字符串金额 480 转换为数字 480.0
2025-03-10 22:45:31,453 - src.agents.llm - INFO - 生成动作: RAISE 金额: 480 table_talk: {'message': '看来你对自己的牌很有信心啊，那我也得展示一下我的实力了。', 'tone': '自信且略带挑衅'}
2025-03-10 22:45:31,453 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 480
2025-03-10 22:45:31,453 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:45:31,453 - src.engine.state - INFO - 玩家 ai_4 加注到 480 筹码，已标记为已行动
2025-03-10 22:45:31,453 - src.engine.game - INFO - 玩家 ai_4 加注到 480
2025-03-10 22:45:31,453 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:45:31,454 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:45:31,454 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:45:31,454 - src.engine.game - INFO - 当前最大下注额: 480
2025-03-10 22:45:31,454 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-10 22:45:31,455 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 ai_1
2025-03-10 22:45:31,455 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:45:31,455 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:45:31,455 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:45:31,455 - src.engine.game - INFO - 当前最大下注额: 480
2025-03-10 22:45:31,456 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=220, is_all_in=False
2025-03-10 22:45:31,456 - src.engine.game - INFO - 玩家 ai_1 下注额(220)不等于最大下注额(480)，回合继续
2025-03-10 22:45:31,456 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:45:31,456 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:45:31,456 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 700, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 700, 'current_bet': 220, 'is_active': True, 'cards': ('9♦', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 2630, 'current_bet': 480, 'is_active': True, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 480}], 'table_talk': {'message': '看来你对自己的牌很有信心啊，那我也得展示一下我的实力了。', 'tone': '自信且略带挑衅'}}
2025-03-10 22:45:31,457 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:45:31,457 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:45:31,457 - src.engine.game - INFO - 当前最大下注额: 480
2025-03-10 22:45:31,458 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=220, is_all_in=False
2025-03-10 22:45:31,458 - src.engine.game - INFO - 玩家 ai_1 下注额(220)不等于最大下注额(480)，回合继续
2025-03-10 22:45:31,458 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:45:31,459 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:45:31,459 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:45:31,459 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:45:31,460 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:45:31,460 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:45:31,460 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:45:57,975 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": 0, "confidence": 0.9}, "reasoning": {"hand_strength": "手牌K♣9♦虽有潜力但不够扎实，面对多次激进加注形势明显吃亏", "position_analysis": "处于早位，信息较少，且面对主动出击的对手", "pot_odds": "投入480筹码到700底池中，赔率并不诱人，加上剩余筹码不多风险过大", "opponent_reads": ["ai_4多次加注显示出强势，很可能持有好牌", "ai_1的加注进一步证明形势不好"]}, "table_talk": {"message": "看来今晚对手状态火热，我宁可保存实力，下次再找机会出手。", "tone": "冷静且略带讽刺"}}
2025-03-10 22:45:57,976 - src.agents.llm - INFO - ==================================================

2025-03-10 22:45:57,976 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今晚对手状态火热，我宁可保存实力，下次再找机会出手。', 'tone': '冷静且略带讽刺'}
2025-03-10 22:45:57,977 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:45:57,977 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:45:57,977 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:45:57,977 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:45:57,978 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:45:57,978 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:45:57,978 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:45:57,978 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:45:57,979 - src.engine.state - INFO - 玩家 ai_4 获得底池 700 筹码，当前筹码: 3330
2025-03-10 22:45:57,979 - src.engine.game - INFO - 玩家 ai_4 获得底池 700 筹码
2025-03-10 22:45:57,979 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:45:57,979 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 700, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('Q♠', 'A♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:45:57,979 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 700, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('Q♠', 'A♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 700, 'current_bet': 220, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 480, 'is_active': False, 'cards': ('Q♠', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今晚对手状态火热，我宁可保存实力，下次再找机会出手。', 'tone': '冷静且略带讽刺'}}
2025-03-10 22:45:57,980 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:45:57,980 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:45:57,980 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:45:57,980 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:45:57,981 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:45:57,981 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:45:57,981 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 700, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('Q♠', 'A♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:45:57,982 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:46:08,645 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:46:08,646 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:46:08,646 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 22:46:08,646 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:46:08,647 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:46:08,647 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♠', 'K♠')
2025-03-10 22:46:08,647 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♦', 'A♦')
2025-03-10 22:46:08,647 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', 'J♥')
2025-03-10 22:46:08,647 - src.engine.game - INFO - 玩家 ai_3 手牌: ('2♣', '2♥')
2025-03-10 22:46:08,648 - src.engine.game - INFO - 玩家 ai_4 手牌: ('Q♦', '4♦')
2025-03-10 22:46:08,648 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:46:08,648 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:46:08,648 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:46:08,648 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:46:08,648 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:46:08,649 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:46:08,649 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:46:08,649 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:46:13,036 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:46:13,037 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:46:13,038 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:46:13,038 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:46:13,039 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:46:13,039 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:46:19,410 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"我有一对2，这是德州扑克中最低的一对，在前期价值有限","position_analysis":"我在相对较早的位置，后面还有一名玩家要行动","pot_odds":"当前我需要下注20筹码才能继续游戏，但我的筹码为0，无法继续参与","opponent_reads":["ai_2已经加注到20，显示出一定的攻击性"]},"table_talk":{"message":"没筹码了，只能弃牌了，下把见！","tone":"轻松"}}
2025-03-10 22:46:19,411 - src.agents.llm - INFO - ==================================================

2025-03-10 22:46:19,411 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '没筹码了，只能弃牌了，下把见！', 'tone': '轻松'}
2025-03-10 22:46:19,411 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:46:19,411 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:46:19,412 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:46:19,412 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:46:19,412 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:46:19,412 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:46:19,413 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:46:19,413 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:19,413 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:46:19,413 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:46:19,413 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:46:19,414 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:46:19,414 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:46:19,414 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:19,414 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:46:19,414 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:46:19,414 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:46:19,415 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:46:19,415 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 690, 'current_bet': 10, 'is_active': True, 'cards': ('7♦', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '4♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '没筹码了，只能弃牌了，下把见！', 'tone': '轻松'}}
2025-03-10 22:46:19,415 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:46:19,416 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:46:19,416 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:19,416 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:46:19,416 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:46:19,417 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:46:19,417 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:46:19,417 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:46:19,418 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:46:19,418 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:46:19,418 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:46:19,418 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:46:36,368 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "FOLD",
    "amount": "0",
    "confidence": "0.8"
  },
  "reasoning": {
    "hand_strength": "我的手牌Q♦, 4♦在预翻牌阶段显得非常弱，没有直接的赢面。",
    "position_analysis": "虽然我在中间位置，但考虑到手牌质量，这个位置并不利于我采取激进策略。",
    "pot_odds": "目前底池为30，而最小加注需要达到60才能继续游戏。基于当前手牌，这样的投资回报比并不吸引人。",
    "opponent_reads": ["ai_2已经进行了加注，显示出较强的手牌或试图通过加注来获取更多信息；根据其筹码量判断，他可能更倾向于保护自己的筹码而非轻率行动。"]
  },
  "table_talk": {
    "message": "这次我就先放弃了，看看接下来会发生什么吧。",
    "tone": "轻松"
  }
}
2025-03-10 22:46:36,369 - src.agents.llm - INFO - ==================================================

2025-03-10 22:46:36,370 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我就先放弃了，看看接下来会发生什么吧。', 'tone': '轻松'}
2025-03-10 22:46:36,370 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:46:36,370 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:46:36,371 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:46:36,371 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:46:36,371 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 22:46:36,371 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:46:36,372 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:46:36,372 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:36,372 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:46:36,372 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:46:36,372 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:46:36,372 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:46:36,373 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 22:46:36,373 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:36,373 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:46:36,373 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:46:36,373 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:46:36,373 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:46:36,374 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 690, 'current_bet': 10, 'is_active': True, 'cards': ('7♦', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我就先放弃了，看看接下来会发生什么吧。', 'tone': '轻松'}}
2025-03-10 22:46:36,374 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:46:36,374 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 22:46:36,375 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:36,375 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:46:36,375 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:46:36,375 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:46:38,809 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:46:38,809 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:46:38.809477', 'table_talk': None}
2025-03-10 22:46:38,809 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:46:38,810 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:46:38,810 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:46:38,810 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:46:38,810 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:46:38,810 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:46:38,811 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:38,811 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:46:38,811 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:46:38,811 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:46:38,811 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:46:38,811 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:46:38,812 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:38,812 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:46:38,812 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:46:38,812 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:46:38,813 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:46:38,813 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 690, 'current_bet': 10, 'is_active': True, 'cards': ('7♦', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:46:38,813 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:46:38,814 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:46:38,814 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:46:38,814 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:46:38,814 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:46:38,815 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:46:41,396 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:46:41,398 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:46:41,398 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:46:41,398 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:46:41,399 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:46:41,399 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:47:00,396 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.85"}, "reasoning": {"hand_strength": "A♦7♦虽然不是顶级牌，但同花及A高优势赋予一定潜力，可以在后续街道发挥作用", "position_analysis": "虽然位置靠前，但在当前仅剩一名对手的情况下，积极出击占据主动是关键", "pot_odds": "底池已有30，对手已投入20，加上我的加注能获得更好的赔率，风险较为可控", "opponent_reads": ["ai_2表现活跃，可能意图利用较宽范围偷底池，加注可以测试其底牌"]}, "table_talk": {"message": "各位，让我们看看今天这局牌究竟归谁所有吧！", "tone": "自信且略带挑衅"}}
2025-03-10 22:47:00,397 - src.agents.llm - INFO - ==================================================

2025-03-10 22:47:00,398 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 22:47:00,399 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '各位，让我们看看今天这局牌究竟归谁所有吧！', 'tone': '自信且略带挑衅'}
2025-03-10 22:47:00,399 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 22:47:00,400 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 22:47:00,400 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 22:47:00,400 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 22:47:00,401 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 22:47:00,401 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:47:00,401 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:47:00,402 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:47:00,402 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:47:00,402 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:47:00,402 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:47:00,402 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:00,403 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:47:00,403 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:47:00,403 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:47:00,403 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:47:00,404 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:47:00,404 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:00,404 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:47:00,404 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 40, 'is_active': True, 'cards': ('7♦', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，让我们看看今天这局牌究竟归谁所有吧！', 'tone': '自信且略带挑衅'}}
2025-03-10 22:47:00,405 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:00,405 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:47:00,406 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:47:00,406 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:47:00,406 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:47:00,406 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:47:00,407 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:00,408 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:47:00,408 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:47:00,408 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:47:00,409 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:47:00,409 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:47:00,409 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:47:09,049 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":40,"confidence":0.7},"reasoning":{"hand_strength":"Q♣和J♥是中等强度的手牌，有一定的潜力，特别是在PRE_FLOP阶段。","position_analysis":"位置2相对较早，但仍有足够的信息来做出决策。","pot_odds":"底池赔率为1.5:1，值得跟注。","opponent_reads":["ai_1在PRE_FLOP阶段加注40，可能是中等强度的手牌或试图偷盲。"]},"table_talk":{"message":"看来你有些信心，但我也不是那么容易放弃的。","tone":"冷静而自信"}}
2025-03-10 22:47:09,050 - src.agents.llm - INFO - ==================================================

2025-03-10 22:47:09,051 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来你有些信心，但我也不是那么容易放弃的。', 'tone': '冷静而自信'}
2025-03-10 22:47:09,051 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-03-10 22:47:09,052 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-03-10 22:47:09,053 - src.engine.state - INFO - 玩家 ai_2 跟注 20 筹码，已标记为已行动
2025-03-10 22:47:09,053 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-03-10 22:47:09,053 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-03-10 22:47:09,054 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:47:09,054 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:47:09,054 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:47:09,054 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 22:47:09,055 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 22:47:09,055 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 22:47:09,055 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:09,055 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:47:09,056 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 22:47:09,056 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:47:09,056 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 22:47:09,056 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:47:09,056 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:47:09,057 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:47:09,057 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 22:47:09,057 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:47:09,057 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 22:47:09,057 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:47:09,057 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 22:47:09,057 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 22:47:09,058 - src.engine.dealer - INFO - Dealt 3 community cards: ['8♠', 'J♠', '3♠']
2025-03-10 22:47:09,058 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['8♠', 'J♠', '3♠']
2025-03-10 22:47:09,058 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_1', 1), ('ai_2', 2)]
2025-03-10 22:47:09,058 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 22:47:09,058 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 22:47:09,059 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:47:09,059 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 80, 'community_cards': ['8♠', 'J♠', '3♠'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': True, 'cards': ('7♦', 'A♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你有些信心，但我也不是那么容易放弃的。', 'tone': '冷静而自信'}}
2025-03-10 22:47:09,060 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:09,060 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:47:09,061 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:47:09,061 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:47:09,061 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:47:09,061 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:09,062 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:47:09,062 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:47:09,062 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:47:09,063 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:47:09,063 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:47:09,063 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:47:27,739 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌仅有A高，没有成对或顺子、同花的潜在优势，无法很好地支撑对抗对手的主动加注", "position_analysis": "目前处于早期位置，后面的对手已经表明了较强的进攻性，这使得我的处境更加被动", "pot_odds": "投入40筹码争夺80底池，但凭借当前极弱的牌面和局面来看赔率不足以支持冒险", "opponent_reads": ["ai_1的40加注显示出一定力度，ai_2的跟注也暗示可能有中等甚至很强的牌，双方都有更好的机会"]}, "table_talk": {"message": "我看出对手下了大注，显然他们都有好牌，我不愿意在这种局势中冒险，选择弃牌走人。", "tone": "冷静、果断"}}
2025-03-10 22:47:27,741 - src.agents.llm - INFO - ==================================================

2025-03-10 22:47:27,741 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '我看出对手下了大注，显然他们都有好牌，我不愿意在这种局势中冒险，选择弃牌走人。', 'tone': '冷静、果断'}
2025-03-10 22:47:27,742 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:47:27,742 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:47:27,742 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:47:27,742 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 22:47:27,742 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:47:27,743 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 22:47:27,743 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:47:27,743 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:47:27,743 - src.engine.state - INFO - 玩家 ai_2 获得底池 80 筹码，当前筹码: 1010
2025-03-10 22:47:27,743 - src.engine.game - INFO - 玩家 ai_2 获得底池 80 筹码
2025-03-10 22:47:27,744 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:47:27,744 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 80, 'winning_hand': None, 'community_cards': ['8♠', 'J♠', '3♠'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♣', 'J♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:47:27,744 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['8♠', 'J♠', '3♠'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 80, 'winning_hand': None, 'community_cards': ['8♠', 'J♠', '3♠'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♣', 'J♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1010, 'current_bet': 0, 'is_active': False, 'cards': ('Q♣', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我看出对手下了大注，显然他们都有好牌，我不愿意在这种局势中冒险，选择弃牌走人。', 'tone': '冷静、果断'}}
2025-03-10 22:47:27,745 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:27,745 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:47:27,745 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:47:27,745 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:47:27,746 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:47:27,746 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:47:27,746 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 80, 'winning_hand': None, 'community_cards': ['8♠', 'J♠', '3♠'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♣', 'J♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:47:27,747 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:47:36,109 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:47:36,109 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:47:36,110 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 22:47:36,111 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:47:36,111 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:47:36,111 - src.engine.game - INFO - 玩家 player_0 手牌: ('J♦', '2♦')
2025-03-10 22:47:36,112 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♣', '8♦')
2025-03-10 22:47:36,112 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♣', 'K♣')
2025-03-10 22:47:36,112 - src.engine.game - INFO - 玩家 ai_3 手牌: ('4♦', '8♥')
2025-03-10 22:47:36,112 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♣', 'K♦')
2025-03-10 22:47:36,112 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 22:47:36,112 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 22:47:36,112 - src.engine.state - INFO - 玩家 ai_3 筹码不足，转为全下 0 筹码
2025-03-10 22:47:36,113 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 22:47:36,113 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 22:47:36,113 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 22:47:36,113 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:47:36,113 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:47:37,770 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:47:37,771 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:47:37,772 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:47:37,772 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:47:37,773 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:47:37,773 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:47:47,569 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"70","confidence":"0.65"},"reasoning":{"hand_strength":"持有一张大牌K，虽然不是特别强的手牌，但在前期可以尝试控制底池大小来观察对手反应。","position_analysis":"位于中间位置，既不处于盲注也不在按钮位，这允许我采取稍微激进一点的策略以获取更多信息。","pot_odds":"当前加注后，底池赔率对于后续跟注是有利的，特别是如果能引诱更多玩家进入底池的话。","opponent_reads":["ai_2已经进行了小额下注，可能持有中等强度的手牌或是在试探。"]},"table_talk":{"message":"让我们看看谁更勇敢一些吧！","tone":"挑衅"}}
2025-03-10 22:47:47,570 - src.agents.llm - INFO - ==================================================

2025-03-10 22:47:47,570 - src.agents.llm - INFO - 成功将字符串金额 70 转换为数字 70.0
2025-03-10 22:47:47,571 - src.agents.llm - INFO - 生成动作: RAISE 金额: 70 table_talk: {'message': '让我们看看谁更勇敢一些吧！', 'tone': '挑衅'}
2025-03-10 22:47:47,571 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 70
2025-03-10 22:47:47,571 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:47:47,572 - src.engine.state - INFO - 玩家 ai_4 加注到 70 筹码，已标记为已行动
2025-03-10 22:47:47,572 - src.engine.game - INFO - 玩家 ai_4 加注到 70
2025-03-10 22:47:47,572 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:47:47,572 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:47:47,572 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:47:47,573 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:47:47,573 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:47:47,573 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:47:47,573 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:47:47,573 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:47,574 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:47:47,574 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:47:47,574 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:47:47,574 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:47:47,575 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:47,575 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:47:47,575 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('J♦', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '8♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', 'K♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', '8♥'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3260, 'current_bet': 70, 'is_active': True, 'cards': ('8♣', 'K♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 70}], 'table_talk': {'message': '让我们看看谁更勇敢一些吧！', 'tone': '挑衅'}}
2025-03-10 22:47:47,576 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:47,576 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:47:47,577 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:47:47,577 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:47:47,577 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:47:47,577 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:51,544 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:47:51,544 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:47:51.544287', 'table_talk': None}
2025-03-10 22:47:51,545 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:47:51,545 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:47:51,546 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:47:51,546 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:47:51,546 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:47:51,547 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:47:51,547 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:47:51,547 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:47:51,547 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:47:51,547 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:47:51,548 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:51,548 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:47:51,548 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:47:51,548 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:47:51,548 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:47:51,549 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:51,549 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:47:51,549 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '8♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', 'K♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', '8♥'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3260, 'current_bet': 70, 'is_active': True, 'cards': ('8♣', 'K♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:47:51,550 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:47:51,550 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:47:51,550 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:47:51,550 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:47:51,550 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:47:51,550 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:47:52,593 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:47:52,595 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:47:52,597 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:47:52,598 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:47:52,600 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:47:52,600 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:48:13,254 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.9"}, "reasoning": {"hand_strength": "我的手牌9♣、8♦属于边缘牌，没有足够的前翻优势；", "position_analysis": "在早位并且面对激进玩家的加注，处境不利，没有利用位置优势反击的空间；", "pot_odds": "跟注70投入底池后风险较高，底池赔率不足以弥补牌力劣势；", "opponent_reads": ["ai_4主动加注表明其牌力可能较强", "ai_2虽然下注较小，但在此局中也可能持有比边缘牌更好的组合"]}, "table_talk": {"message": "看来今天他们势头不错，我不想在这局与强虎纠缠，等待更好的机会再发力。", "tone": "冷静且略带轻蔑"}}
2025-03-10 22:48:13,256 - src.agents.llm - INFO - ==================================================

2025-03-10 22:48:13,257 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天他们势头不错，我不想在这局与强虎纠缠，等待更好的机会再发力。', 'tone': '冷静且略带轻蔑'}
2025-03-10 22:48:13,258 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:48:13,258 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:48:13,258 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:48:13,258 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:48:13,259 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:48:13,259 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:48:13,259 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:48:13,260 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:48:13,260 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:48:13,260 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:48:13,260 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:48:13,260 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:13,260 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:48:13,261 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:48:13,261 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:48:13,261 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:48:13,262 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:48:13,262 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:48:13,262 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', 'K♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', '8♥'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3260, 'current_bet': 70, 'is_active': True, 'cards': ('8♣', 'K♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天他们势头不错，我不想在这局与强虎纠缠，等待更好的机会再发力。', 'tone': '冷静且略带轻蔑'}}
2025-03-10 22:48:13,264 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:13,264 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:48:13,264 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:48:13,265 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:48:13,265 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:48:13,265 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:48:13,266 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:48:13,266 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:48:13,267 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:48:13,267 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:48:13,267 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:48:13,268 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:48:19,080 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌7♣, K♣在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2处于较早的位置，不利于观察后续玩家的行动","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["ai_4进行了加注，显示出较强的牌力或策略性"]},"table_talk":{"message":"看来这手牌不太适合我，我弃牌。","tone":"冷静"}}
2025-03-10 22:48:19,081 - src.agents.llm - INFO - ==================================================

2025-03-10 22:48:19,082 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我弃牌。', 'tone': '冷静'}
2025-03-10 22:48:19,082 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:48:19,083 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:48:19,083 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:48:19,083 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:48:19,083 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:48:19,083 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:48:19,084 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:48:19,084 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:48:19,084 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:48:19,084 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:48:19,085 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:48:19,085 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:19,085 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:48:19,085 - src.engine.game - INFO - 当前最大下注额: 70
2025-03-10 22:48:19,086 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:48:19,086 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=70, is_all_in=False
2025-03-10 22:48:19,086 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 22:48:19,086 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 22:48:19,086 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 22:48:19,087 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 22:48:19,087 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 22:48:19,087 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 22:48:19,087 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:48:19,087 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 22:48:19,088 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 22:48:19,088 - src.engine.dealer - INFO - Dealt 3 community cards: ['10♦', '6♠', 'J♥']
2025-03-10 22:48:19,088 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['10♦', '6♠', 'J♥']
2025-03-10 22:48:19,088 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_3', 3), ('ai_4', 4)]
2025-03-10 22:48:19,088 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 22:48:19,088 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_3, 位置: 3
2025-03-10 22:48:19,088 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:48:19,089 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 80, 'community_cards': ['10♦', '6♠', 'J♥'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', '8♥'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3260, 'current_bet': 0, 'is_active': True, 'cards': ('8♣', 'K♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我弃牌。', 'tone': '冷静'}}
2025-03-10 22:48:19,089 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:19,089 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:48:19,090 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 22:48:19,090 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:48:19,090 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:48:19,090 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:48:19,090 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:48:19,093 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:48:19,093 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:48:19,093 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:48:19,093 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:48:19,094 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:48:19,094 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:48:26,177 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"我手上只有4♦和8♥，没有形成任何有价值的牌型。公共牌是10♦, 6♠, J♥，与我的手牌没有形成顺子或同花的潜力。","position_analysis":"我的筹码显示为0，这意味着我已经没有筹码可以下注了。在这种情况下，我只能弃牌。","pot_odds":"由于我没有筹码，无法计算底池赔率。","opponent_reads":["对手ai_4选择加注70，显示出一定的攻击性，可能有不错的手牌。"]},"table_talk":{"message":"看来我已经没有筹码了，只能弃牌了。祝各位好运！","tone":"平静"}}
2025-03-10 22:48:26,178 - src.agents.llm - INFO - ==================================================

2025-03-10 22:48:26,178 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我已经没有筹码了，只能弃牌了。祝各位好运！', 'tone': '平静'}
2025-03-10 22:48:26,179 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:48:26,179 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:48:26,179 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:48:26,180 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:48:26,180 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:48:26,180 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:48:26,180 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:48:26,180 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:48:26,181 - src.engine.state - INFO - 玩家 ai_4 获得底池 80 筹码，当前筹码: 3340
2025-03-10 22:48:26,181 - src.engine.game - INFO - 玩家 ai_4 获得底池 80 筹码
2025-03-10 22:48:26,181 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:48:26,181 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 80, 'winning_hand': None, 'community_cards': ['10♦', '6♠', 'J♥'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♣', 'K♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:48:26,181 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['10♦', '6♠', 'J♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 80, 'winning_hand': None, 'community_cards': ['10♦', '6♠', 'J♥'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♣', 'K♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3340, 'current_bet': 0, 'is_active': False, 'cards': ('8♣', 'K♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我已经没有筹码了，只能弃牌了。祝各位好运！', 'tone': '平静'}}
2025-03-10 22:48:26,181 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:26,183 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:48:26,183 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:48:26,183 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:48:26,183 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:48:26,184 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:48:26,184 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 80, 'winning_hand': None, 'community_cards': ['10♦', '6♠', 'J♥'], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♣', 'K♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:48:26,184 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:48:33,639 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:48:33,639 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:48:33,640 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 22:48:33,640 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:48:33,640 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:48:33,640 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♥', 'A♠')
2025-03-10 22:48:33,640 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♥', '7♥')
2025-03-10 22:48:33,641 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♣', '3♣')
2025-03-10 22:48:33,641 - src.engine.game - INFO - 玩家 ai_3 手牌: ('10♦', 'K♠')
2025-03-10 22:48:33,641 - src.engine.game - INFO - 玩家 ai_4 手牌: ('2♣', '6♥')
2025-03-10 22:48:33,641 - src.engine.state - INFO - 玩家 ai_3 筹码不足，转为全下 0 筹码
2025-03-10 22:48:33,641 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 22:48:33,641 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 22:48:33,641 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 22:48:33,641 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 22:48:33,641 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 22:48:33,642 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:48:33,642 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 22:48:36,741 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:48:36,741 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:48:36.741364', 'table_talk': None}
2025-03-10 22:48:36,742 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:48:36,742 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:48:36,742 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:48:36,743 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:48:36,743 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:48:36,743 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:48:36,743 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:48:36,743 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:48:36,744 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:48:36,744 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:48:36,744 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:36,744 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:48:36,744 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:48:36,744 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:48:36,745 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:48:36,745 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:48:36,745 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:48:36,745 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': True, 'cards': ('10♥', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', 'K♠'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3320, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '6♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:48:36,746 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:48:36,746 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:48:36,746 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:48:36,746 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:48:36,746 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:48:36,747 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:48:41,190 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:48:41,190 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:48:41,191 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:48:41,191 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:48:41,192 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:48:41,192 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:49:05,980 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "10♥和7♥的组合较弱，没有足够的潜力在翻牌前取得优势", "position_analysis": "处于较早位置，加上已有对手积极下注，处境不佳", "pot_odds": "底池只有20，但需要投入同样的金额继续，风险与回报不匹配", "opponent_reads": ["ai_4表现活跃且下注，显示出一定实力", "ai_2虽然尚未下注，但筹码充裕，可能随时反应"]}, "table_talk": {"message": "这牌不值得冒险，就留着筹码再等更有利的机会吧。", "tone": "冷静且略带不屑"}}
2025-03-10 22:49:05,981 - src.agents.llm - INFO - ==================================================

2025-03-10 22:49:05,981 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌不值得冒险，就留着筹码再等更有利的机会吧。', 'tone': '冷静且略带不屑'}
2025-03-10 22:49:05,981 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:49:05,982 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:49:05,982 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:49:05,982 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:49:05,982 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:49:05,982 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:49:05,983 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:49:05,983 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:49:05,983 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:49:05,983 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:49:05,983 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:49:05,983 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:05,984 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:49:05,984 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:49:05,984 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:49:05,985 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:49:05,985 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:05,985 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:49:05,985 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', 'K♠'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3320, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '6♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌不值得冒险，就留着筹码再等更有利的机会吧。', 'tone': '冷静且略带不屑'}}
2025-03-10 22:49:05,986 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:05,987 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:49:05,987 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:49:05,987 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:49:05,988 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:49:05,988 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:05,989 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:49:05,989 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:49:05,989 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:49:05,989 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:49:05,989 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:49:05,990 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:49:15,203 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌A♣, 3♣在PRE_FLOP阶段强度较低，缺乏成牌潜力","position_analysis":"位置2处于早期位置，不利于观察对手行动","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["ai_4已经下注20，显示出一定的进攻性，可能持有较强手牌"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 22:49:15,204 - src.agents.llm - INFO - ==================================================

2025-03-10 22:49:15,204 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 22:49:15,205 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:49:15,205 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:49:15,205 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:49:15,205 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:49:15,205 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:49:15,205 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:49:15,206 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:49:15,206 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:49:15,206 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:49:15,206 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:49:15,206 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:49:15,206 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:15,206 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:49:15,207 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:49:15,207 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:49:15,207 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:49:15,207 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:49:15,207 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:15,208 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:49:15,208 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', 'K♠'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3320, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '6♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 22:49:15,209 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:15,209 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:49:15,209 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:49:15,210 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:49:15,210 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:49:15,210 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:49:15,210 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:15,211 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:49:15,211 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:49:15,212 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:49:15,212 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:49:15,212 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:49:15,212 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:49:21,985 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"K10不同花是一手中等强度的起手牌，但不是特别强的牌。它有一些潜力，但需要配合才能形成强牌。","position_analysis":"我在位置3，是比较早的位置，位置不太有利。","pot_odds":"我的筹码为0，无法进行任何下注操作。","opponent_reads":["对手ai_4有足够的筹码，但我没有筹码进行任何操作。"]},"table_talk":{"message":"看来我已经没有筹码了，只能弃牌了。祝你们好运！","tone":"平静"}}
2025-03-10 22:49:21,986 - src.agents.llm - INFO - ==================================================

2025-03-10 22:49:21,987 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我已经没有筹码了，只能弃牌了。祝你们好运！', 'tone': '平静'}
2025-03-10 22:49:21,987 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:49:21,987 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:49:21,987 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:49:21,988 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:49:21,988 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:49:21,988 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:49:21,988 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:49:21,988 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:49:21,989 - src.engine.state - INFO - 玩家 ai_4 获得底池 20 筹码，当前筹码: 3340
2025-03-10 22:49:21,989 - src.engine.game - INFO - 玩家 ai_4 获得底池 20 筹码
2025-03-10 22:49:21,989 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:49:21,989 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 20, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('2♣', '6♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:49:21,989 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 20, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('2♣', '6♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3340, 'current_bet': 20, 'is_active': False, 'cards': ('2♣', '6♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我已经没有筹码了，只能弃牌了。祝你们好运！', 'tone': '平静'}}
2025-03-10 22:49:21,990 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:21,991 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:49:21,991 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:49:21,991 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:49:21,991 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:49:21,992 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:49:21,992 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 20, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('2♣', '6♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:49:21,992 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:49:27,122 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:49:27,122 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:49:27,123 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 22:49:27,123 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:49:27,123 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:49:27,124 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♠', 'A♣')
2025-03-10 22:49:27,124 - src.engine.game - INFO - 玩家 ai_1 手牌: ('J♣', '2♦')
2025-03-10 22:49:27,124 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♦', '4♥')
2025-03-10 22:49:27,124 - src.engine.game - INFO - 玩家 ai_3 手牌: ('J♦', '10♠')
2025-03-10 22:49:27,124 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♠', '8♠')
2025-03-10 22:49:27,125 - src.engine.state - INFO - 玩家 ai_4 下注 10 筹码
2025-03-10 22:49:27,125 - src.engine.game - INFO - 玩家 ai_4 下注小盲注 10
2025-03-10 22:49:27,125 - src.engine.state - INFO - 玩家 player_0 筹码不足，转为全下 0 筹码
2025-03-10 22:49:27,125 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 22:49:27,126 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_4(10)，大盲注=player_0(20)
2025-03-10 22:49:27,126 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 22:49:27,126 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:49:27,126 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:49:32,013 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:49:32,014 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:49:32,016 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:49:32,017 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:49:32,017 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:49:32,018 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:49:47,451 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌J♣, 2♦非常弱，没有任何潜在的翻牌组合或改善机会", "position_analysis": "处于较早位置，在不利情况下无法利用位置优势", "pot_odds": "底池仅10，投入风险大而潜在回报不足", "opponent_reads": ["对手筹码充足且可能持有较强牌型", "前面玩家已经投入筹码，显示出一定实力"]}, "table_talk": {"message": "你们这些家伙似乎太依赖运气了，我可不打无谓的牌。", "tone": "冷静且略带讽刺"}}
2025-03-10 22:49:47,452 - src.agents.llm - INFO - ==================================================

2025-03-10 22:49:47,452 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '你们这些家伙似乎太依赖运气了，我可不打无谓的牌。', 'tone': '冷静且略带讽刺'}
2025-03-10 22:49:47,452 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:49:47,453 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:49:47,453 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:49:47,453 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:49:47,454 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:49:47,454 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:49:47,454 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:49:47,454 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:49:47,455 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:49:47,455 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:49:47,455 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:49:47,455 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:47,455 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:49:47,455 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:49:47,455 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:49:47,456 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:49:47,456 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:49:47,456 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:47,456 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:49:47,457 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 10, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'A♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '4♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('J♦', '10♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 10, 'is_active': True, 'cards': ('4♠', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你们这些家伙似乎太依赖运气了，我可不打无谓的牌。', 'tone': '冷静且略带讽刺'}}
2025-03-10 22:49:47,457 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:47,457 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:49:47,458 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:49:47,458 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:49:47,458 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:49:47,458 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:49:47,458 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:47,459 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:49:47,460 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:49:47,460 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:49:47,460 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:49:47,460 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:49:47,461 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:49:53,497 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌3♦和4♥在PRE_FLOP阶段非常弱，几乎没有任何成牌潜力","position_analysis":"处于中间位置，没有位置优势，不利于后续操作","pot_odds":"底池赔率不理想，不值得冒险跟注或加注","opponent_reads":["ai_4已经下注10，显示出一定的攻击性，可能持有较强的手牌"]},"table_talk":{"message":"看来你们这轮很有信心，我选择退出","tone":"轻松"}}
2025-03-10 22:49:53,498 - src.agents.llm - INFO - ==================================================

2025-03-10 22:49:53,499 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们这轮很有信心，我选择退出', 'tone': '轻松'}
2025-03-10 22:49:53,499 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:49:53,499 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:49:53,499 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:49:53,499 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:49:53,499 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:49:53,500 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:49:53,500 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:49:53,500 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:49:53,500 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:49:53,501 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:49:53,501 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:49:53,501 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:53,501 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_3', 'ai_4']
2025-03-10 22:49:53,501 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:49:53,502 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:49:53,502 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:49:53,502 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:49:53,502 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:53,502 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:49:53,502 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 10, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'A♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('J♦', '10♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 10, 'is_active': True, 'cards': ('4♠', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们这轮很有信心，我选择退出', 'tone': '轻松'}}
2025-03-10 22:49:53,503 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:49:53,503 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_3', 'ai_4']
2025-03-10 22:49:53,503 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:49:53,504 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:49:53,504 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:49:53,504 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:49:53,504 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:49:53,505 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:49:53,505 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:49:53,505 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:49:53,506 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:49:53,506 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:49:53,506 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:50:01,114 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"J♦, 10♠ 是一手中等强度的起手牌，虽然是同花连牌，但没有形成同花，只是一个差一张的同花连牌(one-gapper)。在早期位置，这手牌不算特别强。","position_analysis":"我在位置3，属于早期位置，这个位置需要更强的手牌才能进入底池。","pot_odds":"当前底池10，需要跟注10，底池赔率为1:1，但考虑到我的筹码为0，无法进行任何操作。","opponent_reads":["ai_4已经下注10，显示出一定的强度"]},"table_talk":{"message":"看来我今天运气不太好，这手牌就到此为止了。","tone":"平静"}}
2025-03-10 22:50:01,115 - src.agents.llm - INFO - ==================================================

2025-03-10 22:50:01,116 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我今天运气不太好，这手牌就到此为止了。', 'tone': '平静'}
2025-03-10 22:50:01,116 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:50:01,117 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:50:01,117 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:50:01,117 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:50:01,118 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:50:01,118 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:50:01,120 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:50:01,120 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:50:01,120 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:50:01,121 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:50:01,121 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:50:01,121 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:01,121 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:50:01,122 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:50:01,122 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:50:01,122 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:01,122 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:50:01,122 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:01,122 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:50:01,123 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 10, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'A♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 10, 'is_active': True, 'cards': ('4♠', '8♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我今天运气不太好，这手牌就到此为止了。', 'tone': '平静'}}
2025-03-10 22:50:01,123 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:01,123 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 22:50:01,123 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:50:01,125 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:50:01,125 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:01,125 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:50:01,126 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:01,126 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:50:01,127 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:50:01,127 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:50:01,127 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:50:01,127 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:50:01,128 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:50:12,954 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"我的手牌是4♠, 8♠，这在德州扑克中属于非常弱的手牌组合，特别是在没有看到公共牌的情况下。","position_analysis":"虽然我在桌上的位置不错，但考虑到手牌质量较差，这个优势并不足以弥补手牌的劣势。","pot_odds":"底池赔率目前为10，对于我来说，即使以最小加注额30加入游戏，从长远来看也是不划算的。","opponent_reads":["对手尚未采取任何行动，但是基于当前信息，没有必要用这么弱的手牌去冒险。"]},"table_talk":{"message":"这次我选择放弃，希望下一把能有更好的运气！","tone":"友好"}}
2025-03-10 22:50:12,955 - src.agents.llm - INFO - ==================================================

2025-03-10 22:50:12,956 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我选择放弃，希望下一把能有更好的运气！', 'tone': '友好'}
2025-03-10 22:50:12,956 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:50:12,956 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:50:12,957 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:50:12,957 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 22:50:12,957 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:50:12,957 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 22:50:12,957 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:50:12,958 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:50:12,958 - src.engine.state - INFO - 玩家 player_0 获得底池 10 筹码，当前筹码: 10
2025-03-10 22:50:12,958 - src.engine.game - INFO - 玩家 player_0 获得底池 10 筹码
2025-03-10 22:50:12,958 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:50:12,959 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 10, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♠', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:50:12,959 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 10, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♠', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 10, 'current_bet': 0, 'is_active': False, 'cards': ('7♠', 'A♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 660, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我选择放弃，希望下一把能有更好的运气！', 'tone': '友好'}}
2025-03-10 22:50:12,960 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:12,960 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:50:12,961 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:50:12,961 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:50:12,961 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:50:12,961 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:50:12,961 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 10, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♠', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:50:12,962 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:50:15,200 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:50:15,200 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:50:15,201 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 22:50:15,201 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:50:15,201 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:50:15,201 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♣', 'Q♦')
2025-03-10 22:50:15,201 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♦', '5♠')
2025-03-10 22:50:15,202 - src.engine.game - INFO - 玩家 ai_2 手牌: ('8♦', '4♠')
2025-03-10 22:50:15,202 - src.engine.game - INFO - 玩家 ai_3 手牌: ('4♣', '7♦')
2025-03-10 22:50:15,202 - src.engine.game - INFO - 玩家 ai_4 手牌: ('2♥', '2♠')
2025-03-10 22:50:15,202 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 22:50:15,202 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 22:50:15,202 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 22:50:15,203 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 22:50:15,203 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 22:50:15,203 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 22:50:15,203 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:50:15,203 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 22:50:17,975 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:50:17,976 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:50:17,978 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:50:17,979 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:50:17,979 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:50:17,980 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:50:25,185 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌8♦, 4♠非常弱，没有形成任何有潜力的组合","position_analysis":"位置2在PRE_FLOP阶段并不理想，容易受到后面玩家的压力","pot_odds":"底池赔率不足以支持跟注或加注","opponent_reads":["ai_1已经加注到20，显示出一定的牌力","ai_4筹码充足，可能在后位进行更大的加注"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 22:50:25,186 - src.agents.llm - INFO - ==================================================

2025-03-10 22:50:25,187 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 22:50:25,187 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:50:25,188 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:50:25,188 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:50:25,188 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:50:25,189 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:50:25,189 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:50:25,189 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:50:25,189 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:50:25,190 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:50:25,190 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:50:25,190 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:50:25,190 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:25,190 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:50:25,190 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:50:25,191 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:25,191 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:50:25,191 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:25,191 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:50:25,191 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 640, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', '5♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♣', '7♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': True, 'cards': ('2♥', '2♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 22:50:25,192 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:25,192 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:50:25,192 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:50:25,193 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:25,193 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:50:25,193 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:25,195 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:50:25,195 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:50:25,196 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:50:25,196 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:50:25,196 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:50:25,196 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:50:32,568 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"4♣, 7♦是一手非常弱的起手牌，没有同花潜力，没有顺子潜力，没有高牌价值。","position_analysis":"我在相对靠前的位置(位置3)，后面还有一位玩家要行动，处于不利位置。","pot_odds":"我的筹码为0，无法跟注或加注。即使有筹码，4-7不成对的低牌也不值得跟注。","opponent_reads":["ai_1已经加注到20，显示出一定的强度","ai_4还未行动，可能会继续加注"]},"table_talk":{"message":"看来今天运气不太好，这手牌不值得继续了。","tone":"平静"}}
2025-03-10 22:50:32,570 - src.agents.llm - INFO - ==================================================

2025-03-10 22:50:32,571 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天运气不太好，这手牌不值得继续了。', 'tone': '平静'}
2025-03-10 22:50:32,571 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:50:32,572 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:50:32,572 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:50:32,572 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:50:32,573 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:50:32,573 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:50:32,573 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:50:32,574 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:50:32,574 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:50:32,574 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:50:32,574 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:50:32,575 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:32,575 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:50:32,575 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:50:32,576 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:32,576 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:50:32,577 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:32,578 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:50:32,580 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 640, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', '5♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 0, 'is_active': True, 'cards': ('2♥', '2♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天运气不太好，这手牌不值得继续了。', 'tone': '平静'}}
2025-03-10 22:50:32,584 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:32,585 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:50:32,586 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:50:32,587 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:32,587 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:50:32,587 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:32,589 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:50:32,589 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:50:32,590 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:50:32,590 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:50:32,590 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:50:32,590 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:50:49,500 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":80,"confidence":0.65},"reasoning":{"hand_strength":"虽然我的手牌是口袋对2，这在德州扑克中属于较弱的起手牌，但考虑到当前阶段为PRE_FLOP且我处于相对较好的位置（4号位），有机会通过加注来控制底池大小并测试对手的实力。","position_analysis":"位于中间偏后的位置给予了一定的操作空间，既可以观察前面玩家的动作也可以利用位置优势施压后面的对手。","pot_odds":"鉴于目前底池较小而我的筹码量充足，适当增加投入以扩大潜在收益是合理的策略。","opponent_reads":["player_0仅跟了最小注10，显示出可能持有边缘牌或尝试低成本看翻牌；ai_1则选择了标准的再加注到20，表明其对自己手牌有一定信心，但仍留有试探的空间。"]},"table_talk":{"message":"让我们看看谁更勇敢一些吧！","tone":"挑衅"}}
2025-03-10 22:50:49,501 - src.agents.llm - INFO - ==================================================

2025-03-10 22:50:49,502 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '让我们看看谁更勇敢一些吧！', 'tone': '挑衅'}
2025-03-10 22:50:49,502 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 80
2025-03-10 22:50:49,502 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:50:49,502 - src.engine.state - INFO - 玩家 ai_4 加注到 80 筹码，已标记为已行动
2025-03-10 22:50:49,502 - src.engine.game - INFO - 玩家 ai_4 加注到 80
2025-03-10 22:50:49,503 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:50:49,503 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:50:49,503 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:50:49,503 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:50:49,503 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:50:49,504 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:50:49,504 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:50:49,504 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:49,504 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:50:49,504 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:50:49,504 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:49,505 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:50:49,505 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:49,505 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:50:49,505 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', 'Q♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 640, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', '5♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3250, 'current_bet': 80, 'is_active': True, 'cards': ('2♥', '2♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 80}], 'table_talk': {'message': '让我们看看谁更勇敢一些吧！', 'tone': '挑衅'}}
2025-03-10 22:50:49,506 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:49,507 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:50:49,507 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:50:49,507 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:50:49,507 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:50:49,507 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:51,730 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:50:51,731 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:50:51.731637', 'table_talk': None}
2025-03-10 22:50:51,731 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:50:51,731 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:50:51,731 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:50:51,732 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:50:51,732 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:50:51,732 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:50:51,732 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:50:51,733 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:50:51,733 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:50:51,733 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:50:51,733 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:51,733 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:50:51,734 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:50:51,734 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:50:51,734 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:50:51,734 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:51,735 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:50:51,735 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 640, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', '5♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3250, 'current_bet': 80, 'is_active': True, 'cards': ('2♥', '2♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:50:51,736 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:50:51,736 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_4']
2025-03-10 22:50:51,736 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:50:51,736 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:50:51,737 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:50:51,737 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:50:54,512 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:50:54,513 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:50:54,513 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:50:54,513 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:50:54,514 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:50:54,514 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:51:11,442 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"","confidence":"0.95"},"reasoning":{"hand_strength":"手牌4♦,5♠在PRE_FLOP阶段显得非常薄弱，没有足够的潜力去对抗激进加注，对手可能已经握有更强的牌","position_analysis":"处于早位，信息有限，而且后续可能面对更多加注，选择保守策略能减少损失","pot_odds":"底池110对跟注80的赔率并不理想，加上手牌弱，不值得冒险跟注","opponent_reads":["对手已表现出激进风格，可能用较强手牌或利用行动压制弱牌"]},"table_talk":{"message":"今晚的牌运明显不在我这边，不如让你们乐一乐吧。","tone":"冷静中带点讽刺"}}
2025-03-10 22:51:11,443 - src.agents.llm - INFO - ==================================================

2025-03-10 22:51:11,443 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今晚的牌运明显不在我这边，不如让你们乐一乐吧。', 'tone': '冷静中带点讽刺'}
2025-03-10 22:51:11,444 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:51:11,444 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:51:11,444 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:51:11,444 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:51:11,444 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:51:11,445 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:51:11,445 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:51:11,445 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:51:11,445 - src.engine.state - INFO - 玩家 ai_4 获得底池 110 筹码，当前筹码: 3360
2025-03-10 22:51:11,445 - src.engine.game - INFO - 玩家 ai_4 获得底池 110 筹码
2025-03-10 22:51:11,445 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:51:11,446 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 110, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('2♥', '2♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:51:11,446 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 110, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('2♥', '2♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 640, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3360, 'current_bet': 80, 'is_active': False, 'cards': ('2♥', '2♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚的牌运明显不在我这边，不如让你们乐一乐吧。', 'tone': '冷静中带点讽刺'}}
2025-03-10 22:51:11,447 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:11,447 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:51:11,447 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:51:11,447 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:51:11,448 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:51:11,448 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:51:11,448 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 110, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('2♥', '2♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:51:11,448 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:51:15,291 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:51:15,292 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:51:15,292 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 22:51:15,292 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:51:15,292 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:51:15,293 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♦', '7♣')
2025-03-10 22:51:15,293 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♥', '2♦')
2025-03-10 22:51:15,293 - src.engine.game - INFO - 玩家 ai_2 手牌: ('J♠', '3♣')
2025-03-10 22:51:15,293 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♠', 'A♠')
2025-03-10 22:51:15,293 - src.engine.game - INFO - 玩家 ai_4 手牌: ('K♣', '9♠')
2025-03-10 22:51:15,294 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:51:15,294 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:51:15,294 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:51:15,294 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:51:15,294 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:51:15,295 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:51:15,295 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:51:15,295 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:51:16,463 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:51:16,463 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:51:16,464 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:51:16,464 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:51:16,464 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:51:16,465 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:51:24,903 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"A6不同花是一手中等偏弱的起手牌。虽然有一张A，但6作为配牌价值不高，且不是同花，组合价值有限。","position_analysis":"我在相对早的位置(位置3)，后面还有一位玩家要行动。这个位置需要更强的起手牌来建立优势。","pot_odds":"当前底池30，需要下注20才能继续，底池赔率为1.5:1。而且我的筹码为0，无法继续参与游戏。","opponent_reads":["ai_2已经加注到20，显示出一定的强度","ai_4还未行动，位置更好，可能有更强的牌","我的筹码为0，无法继续参与游戏"]},"table_talk":{"message":"看来我已经出局了，祝各位好运！","tone":"轻松友好"}}
2025-03-10 22:51:24,903 - src.agents.llm - INFO - ==================================================

2025-03-10 22:51:24,904 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我已经出局了，祝各位好运！', 'tone': '轻松友好'}
2025-03-10 22:51:24,904 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:51:24,904 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:51:24,905 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:51:24,905 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:51:24,905 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:51:24,905 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:51:24,905 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:51:24,906 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:51:24,906 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:51:24,906 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:51:24,906 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:51:24,906 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:24,906 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:51:24,907 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:51:24,907 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:51:24,907 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:51:24,907 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:51:24,907 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:51:24,908 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 630, 'current_bet': 10, 'is_active': True, 'cards': ('A♥', '2♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♠', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3360, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '9♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我已经出局了，祝各位好运！', 'tone': '轻松友好'}}
2025-03-10 22:51:24,908 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:24,908 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:51:24,909 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:51:24,909 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:51:24,909 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:51:24,909 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:51:24,911 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:51:24,911 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:51:24,912 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:51:24,912 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:51:24,912 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:51:24,912 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:51:38,701 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":80,"confidence":0.75},"reasoning":{"hand_strength":"手牌K♣, 9♠在前翻牌阶段具有一定的潜力，特别是考虑到可能击中顶对或顺子听牌。","position_analysis":"处于中间位置，可以采取稍微激进的策略来测试对手，并控制底池大小。","pot_odds":"当前加注至80后，底池赔率有利于我们看到翻牌，同时给对手施加压力。","opponent_reads":["ai_1只跟了小盲注，显示出较弱的手牌可能性；ai_2选择加注，可能是持有较强的手牌或者尝试偷取底池。"]},"table_talk":{"message":"让我们看看谁更勇敢一些吧！","tone":"挑战性的"}}
2025-03-10 22:51:38,702 - src.agents.llm - INFO - ==================================================

2025-03-10 22:51:38,703 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '让我们看看谁更勇敢一些吧！', 'tone': '挑战性的'}
2025-03-10 22:51:38,703 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 80
2025-03-10 22:51:38,703 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:51:38,703 - src.engine.state - INFO - 玩家 ai_4 加注到 80 筹码，已标记为已行动
2025-03-10 22:51:38,704 - src.engine.game - INFO - 玩家 ai_4 加注到 80
2025-03-10 22:51:38,704 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:51:38,704 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:51:38,704 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:51:38,704 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:51:38,705 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:51:38,705 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:51:38,705 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:51:38,705 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:38,705 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:51:38,706 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:51:38,706 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:51:38,706 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:51:38,706 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:51:38,706 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:51:38,707 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 630, 'current_bet': 10, 'is_active': True, 'cards': ('A♥', '2♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♠', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3280, 'current_bet': 80, 'is_active': True, 'cards': ('K♣', '9♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 80}], 'table_talk': {'message': '让我们看看谁更勇敢一些吧！', 'tone': '挑战性的'}}
2025-03-10 22:51:38,707 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:38,708 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:51:38,708 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:51:38,708 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:51:38,708 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:51:38,709 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:51:48,975 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:51:48,975 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:51:48.975987', 'table_talk': None}
2025-03-10 22:51:48,976 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:51:48,976 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:51:48,976 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:51:48,977 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:51:48,977 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:51:48,977 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:51:48,977 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:51:48,977 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:51:48,977 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:51:48,978 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:51:48,978 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:48,978 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 22:51:48,978 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:51:48,978 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:51:48,978 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:51:48,979 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:51:48,979 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:51:48,979 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 630, 'current_bet': 10, 'is_active': True, 'cards': ('A♥', '2♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♠', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3280, 'current_bet': 80, 'is_active': True, 'cards': ('K♣', '9♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:51:48,980 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:51:48,980 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 22:51:48,980 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:51:48,980 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:51:48,981 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:51:48,981 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:51:53,735 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:51:53,735 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:51:53,737 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:51:53,737 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:51:53,737 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:51:53,738 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:52:11,454 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "A♥和2♦组合较弱，尤其是非同花且低位，面对加注时胜率不高。", "position_analysis": "处于前位且当前处于激进对局中，不利于用这种较弱手牌展开搏杀。", "pot_odds": "底池赔率不足以补偿跟注所面临的不利形势。", "opponent_reads": ["ai_4的加注显示出一定的实力，ai_2的跟注也暗示可能持有有竞争力的牌。"]}, "table_talk": {"message": "这一局牌势不明，我选择放弃，下局再战。", "tone": "果断而冷静"}}
2025-03-10 22:52:11,454 - src.agents.llm - INFO - ==================================================

2025-03-10 22:52:11,455 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这一局牌势不明，我选择放弃，下局再战。', 'tone': '果断而冷静'}
2025-03-10 22:52:11,455 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:52:11,455 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:52:11,455 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:52:11,455 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:52:11,456 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:52:11,456 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:52:11,456 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:52:11,456 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:52:11,457 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:52:11,457 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:52:11,457 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:52:11,457 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:11,457 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 22:52:11,458 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:52:11,458 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:52:11,458 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:52:11,458 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:52:11,458 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:52:11,459 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 110, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 630, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('J♠', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3280, 'current_bet': 80, 'is_active': True, 'cards': ('K♣', '9♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这一局牌势不明，我选择放弃，下局再战。', 'tone': '果断而冷静'}}
2025-03-10 22:52:11,459 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:11,460 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 22:52:11,460 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 22:52:11,460 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:52:11,460 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:52:11,461 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:52:11,462 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:52:11,463 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:52:11,463 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:52:11,463 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:52:11,464 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:52:11,464 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:52:20,168 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌J♠, 3♣在PRE_FLOP阶段非常弱，几乎没有形成强牌的可能","position_analysis":"位置2在PRE_FLOP阶段相对较晚，但手牌太弱，无法利用位置优势","pot_odds":"底池赔率不理想，跟注80的风险远高于潜在回报","opponent_reads":["对手ai_4在PRE_FLOP阶段加注80，显示出较强的牌力或策略性下注"]},"table_talk":{"message":"看起来这手牌不太适合我，我选择退出","tone":"冷静"}}
2025-03-10 22:52:20,169 - src.agents.llm - INFO - ==================================================

2025-03-10 22:52:20,169 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看起来这手牌不太适合我，我选择退出', 'tone': '冷静'}
2025-03-10 22:52:20,170 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:52:20,170 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:52:20,170 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:52:20,170 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:52:20,170 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:52:20,170 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:52:20,171 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:52:20,171 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:52:20,171 - src.engine.state - INFO - 玩家 ai_4 获得底池 110 筹码，当前筹码: 3390
2025-03-10 22:52:20,171 - src.engine.game - INFO - 玩家 ai_4 获得底池 110 筹码
2025-03-10 22:52:20,171 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:52:20,171 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 110, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♣', '9♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:52:20,172 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 110, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♣', '9♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 630, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 80, 'is_active': False, 'cards': ('K♣', '9♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来这手牌不太适合我，我选择退出', 'tone': '冷静'}}
2025-03-10 22:52:20,172 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:20,173 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:52:20,173 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:52:20,173 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:52:20,173 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:52:20,174 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:52:20,174 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 110, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♣', '9♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:52:20,174 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:52:22,084 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:52:22,084 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:52:22,084 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 22:52:22,085 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:52:22,085 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:52:22,085 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♣', '8♠')
2025-03-10 22:52:22,085 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♠', 'K♣')
2025-03-10 22:52:22,085 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♠', 'Q♥')
2025-03-10 22:52:22,086 - src.engine.game - INFO - 玩家 ai_3 手牌: ('10♣', '8♣')
2025-03-10 22:52:22,086 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♠', '6♠')
2025-03-10 22:52:22,086 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 22:52:22,086 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 22:52:22,087 - src.engine.state - INFO - 玩家 ai_3 筹码不足，转为全下 0 筹码
2025-03-10 22:52:22,087 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 22:52:22,087 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 22:52:22,087 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 22:52:22,087 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:52:22,088 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 22:52:25,190 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:52:25,191 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:52:25,191 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:52:25,191 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:52:25,192 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:52:25,192 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:52:37,787 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"","confidence":0.75},"reasoning":{"hand_strength":"手牌4♠, 6♠属于较弱组合，在没有位置优势的情况下，很难通过后续的公共牌得到提升。","position_analysis":"位于中间位置，既不是最早也不是最晚行动，这限制了对其他玩家行为的观察空间。","pot_odds":"考虑到需要至少加注到30才能继续游戏，而当前底池为10，这样的投资回报率并不理想。","opponent_reads":["ai_2已经下注10，显示出一定的手牌信心；其他对手尚未采取行动，但根据筹码量判断他们可能也在寻找合适的时机进入或退出。"]},"table_talk":{"message":"这次我选择放弃，希望下次能有更好的机会。","tone":"平静"}}
2025-03-10 22:52:37,788 - src.agents.llm - INFO - ==================================================

2025-03-10 22:52:37,789 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我选择放弃，希望下次能有更好的机会。', 'tone': '平静'}
2025-03-10 22:52:37,789 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 22:52:37,789 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 22:52:37,789 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 22:52:37,790 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 22:52:37,790 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 22:52:37,790 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:52:37,791 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:52:37,791 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:52:37,791 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:52:37,791 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:52:37,791 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:52:37,792 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:37,792 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 22:52:37,792 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:52:37,792 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:52:37,792 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:52:37,792 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:52:37,793 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:52:37,793 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 10, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♣', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 630, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我选择放弃，希望下次能有更好的机会。', 'tone': '平静'}}
2025-03-10 22:52:37,793 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:37,794 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 22:52:37,794 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:52:37,794 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:52:37,795 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:52:37,795 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:52:59,142 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:52:59,142 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:52:59.142139', 'table_talk': None}
2025-03-10 22:52:59,143 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:52:59,143 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:52:59,143 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:52:59,144 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:52:59,144 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:52:59,144 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:52:59,145 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:52:59,145 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:52:59,145 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:52:59,145 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:52:59,145 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:59,146 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:52:59,146 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:52:59,146 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:52:59,146 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:52:59,146 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:52:59,146 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:52:59,147 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 10, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 630, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:52:59,147 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:52:59,147 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:52:59,147 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:52:59,148 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:52:59,148 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:52:59,148 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:53:02,863 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:53:02,863 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:53:02,864 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:53:02,864 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:53:02,864 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:53:02,864 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:54:50,477 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "10", "confidence": "0.7"}, "reasoning": {"hand_strength": "手牌3♠, K♣整体较弱，K高虽然有潜力，但搭配3显得过于边缘", "position_analysis": "当前处于早期位置，采取保守策略较为稳妥，先以跟注观察对手行动", "pot_odds": "仅需投入少量筹码（10）便可参与底池，提供较好的底池赔率", "opponent_reads": ["对手ai_2处于激活状态，可能利用位置优势发动攻势，谨慎观察为上策"]}, "table_talk": {"message": "跟注一下，看清对手动向再做决断。", "tone": "冷静且试探"}}
2025-03-10 22:54:50,478 - src.agents.llm - INFO - ==================================================

2025-03-10 22:54:50,478 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '跟注一下，看清对手动向再做决断。', 'tone': '冷静且试探'}
2025-03-10 22:54:50,479 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 22:54:50,479 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 22:54:50,479 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-10 22:54:50,479 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 22:54:50,480 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 22:54:50,480 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:54:50,480 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:54:50,480 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:54:50,481 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:54:50,481 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:54:50,481 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:54:50,482 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:54:50,482 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:54:50,482 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:54:50,482 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:54:50,483 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:54:50,483 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:54:50,483 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:54:50,484 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:54:50,484 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '跟注一下，看清对手动向再做决断。', 'tone': '冷静且试探'}}
2025-03-10 22:54:50,485 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:54:50,485 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:54:50,486 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:54:50,486 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:54:50,486 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 22:54:50,486 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:54:50,487 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:54:50,488 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:54:50,488 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:54:50,489 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:54:50,489 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:54:50,489 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:54:50,489 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:54:58,335 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"30","confidence":"0.8"},"reasoning":{"hand_strength":"K♠, Q♥ 是一手较强的起手牌，尤其是在PRE_FLOP阶段，有很好的潜力形成顺子或同花","position_analysis":"位置2是一个相对有利的位置，可以在后续轮次中更好地观察对手的动作","pot_odds":"底池当前为20，加注到30可以获得较好的底池赔率，增加潜在的回报","opponent_reads":["ai_1选择了CALL，显示其可能持有中等强度的牌，但不太可能是极强的牌"]},"table_talk":{"message":"看来大家都挺谨慎的，我来加点压力吧","tone":"自信"}}
2025-03-10 22:54:58,337 - src.agents.llm - INFO - ==================================================

2025-03-10 22:54:58,337 - src.agents.llm - INFO - 成功将字符串金额 30 转换为数字 30.0
2025-03-10 22:54:58,338 - src.agents.llm - INFO - 生成动作: RAISE 金额: 30 table_talk: {'message': '看来大家都挺谨慎的，我来加点压力吧', 'tone': '自信'}
2025-03-10 22:54:58,338 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 30
2025-03-10 22:54:58,339 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 22:54:58,339 - src.engine.state - INFO - 玩家 ai_2 加注到 30 筹码，已标记为已行动
2025-03-10 22:54:58,339 - src.engine.game - INFO - 玩家 ai_2 加注到 30
2025-03-10 22:54:58,340 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 22:54:58,340 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:54:58,340 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:54:58,340 - src.engine.game - INFO - 当前最大下注额: 30
2025-03-10 22:54:58,341 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:54:58,341 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:54:58,341 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:54:58,341 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:54:58,342 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:54:58,342 - src.engine.game - INFO - 当前最大下注额: 30
2025-03-10 22:54:58,342 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:54:58,342 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(30)，回合继续
2025-03-10 22:54:58,342 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:54:58,343 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:54:58,343 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 30, 'is_active': True, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 30}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', '8♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来大家都挺谨慎的，我来加点压力吧', 'tone': '自信'}}
2025-03-10 22:54:58,343 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:54:58,344 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_3']
2025-03-10 22:54:58,344 - src.engine.game - INFO - 当前最大下注额: 30
2025-03-10 22:54:58,344 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:54:58,344 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(30)，回合继续
2025-03-10 22:54:58,345 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:54:58,346 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:54:58,346 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:54:58,347 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:54:58,347 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:54:58,347 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:54:58,348 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:55:06,292 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"10-8同花是一手中等强度的起手牌，有一定的同花和顺子潜力，但在早期位置面对加注时并不算强牌。","position_analysis":"我在相对早的位置(位置3)，后面还有玩家要行动，位置不利。","pot_odds":"当前底池40，需要跟注30，底池赔率约为1.33:1，不够好。更重要的是，我的筹码为0，无法跟注或加注。","opponent_reads":["ai_2进行了加注，显示出一定的手牌强度","ai_1选择跟注，可能有一定的牌力"]},"table_talk":{"message":"看来我已经出局了，祝各位好运！","tone":"轻松"}}
2025-03-10 22:55:06,293 - src.agents.llm - INFO - ==================================================

2025-03-10 22:55:06,293 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我已经出局了，祝各位好运！', 'tone': '轻松'}
2025-03-10 22:55:06,293 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:55:06,294 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:55:06,294 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:55:06,294 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:55:06,294 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:55:06,294 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:55:06,295 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:55:06,295 - src.engine.game - INFO - 当前最大下注额: 30
2025-03-10 22:55:06,295 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-10 22:55:06,295 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_1
2025-03-10 22:55:06,295 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:55:06,296 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:06,296 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:55:06,296 - src.engine.game - INFO - 当前最大下注额: 30
2025-03-10 22:55:06,296 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:55:06,296 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(30)，回合继续
2025-03-10 22:55:06,296 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:55:06,297 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:55:06,297 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 30, 'is_active': True, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我已经出局了，祝各位好运！', 'tone': '轻松'}}
2025-03-10 22:55:06,297 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:06,298 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 22:55:06,298 - src.engine.game - INFO - 当前最大下注额: 30
2025-03-10 22:55:06,298 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:55:06,299 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(30)，回合继续
2025-03-10 22:55:06,300 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:55:06,301 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:55:06,301 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:55:06,301 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:55:06,301 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:55:06,302 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:55:06,302 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:55:20,355 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.9"}, "reasoning": {"hand_strength": "持有K♣和3♠，仅有K高，整体手牌实力较弱，很容易被更好的K或对子击败", "position_analysis": "在第一个行动的位置上，且面对对手的激进动作，处于劣势位置", "pot_odds": "底池为40，对手已投入30，跟注所需投入比例较高，而手牌获胜概率不高", "opponent_reads": ["ai_2展现出激进和自信的下注行为，可能持有较强手牌或进行诈唬，但面对弱牌不具备跟注的底气"]}, "table_talk": {"message": "对手这么强势，我暂时不冒险，等待更好的时机出击！", "tone": "冷静果断"}}
2025-03-10 22:55:20,356 - src.agents.llm - INFO - ==================================================

2025-03-10 22:55:20,356 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '对手这么强势，我暂时不冒险，等待更好的时机出击！', 'tone': '冷静果断'}
2025-03-10 22:55:20,356 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:55:20,357 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:55:20,357 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:55:20,357 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 22:55:20,357 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:55:20,358 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 22:55:20,358 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:55:20,358 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:55:20,358 - src.engine.state - INFO - 玩家 ai_2 获得底池 40 筹码，当前筹码: 990
2025-03-10 22:55:20,358 - src.engine.game - INFO - 玩家 ai_2 获得底池 40 筹码
2025-03-10 22:55:20,358 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:55:20,358 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('K♠', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:55:20,359 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('K♠', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 990, 'current_bet': 30, 'is_active': False, 'cards': ('K♠', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '对手这么强势，我暂时不冒险，等待更好的时机出击！', 'tone': '冷静果断'}}
2025-03-10 22:55:20,359 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:20,360 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:55:20,360 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:55:20,360 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:55:20,360 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:55:20,361 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:55:20,361 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('K♠', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:55:20,361 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:55:23,410 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:55:23,410 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:55:23,411 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 22:55:23,411 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:55:23,412 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:55:23,412 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♠', '5♥')
2025-03-10 22:55:23,413 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♥', '3♠')
2025-03-10 22:55:23,413 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♦', 'J♥')
2025-03-10 22:55:23,414 - src.engine.game - INFO - 玩家 ai_3 手牌: ('Q♦', '2♣')
2025-03-10 22:55:23,414 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♥', 'J♠')
2025-03-10 22:55:23,414 - src.engine.state - INFO - 玩家 ai_3 筹码不足，转为全下 0 筹码
2025-03-10 22:55:23,415 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 22:55:23,415 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 22:55:23,415 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 22:55:23,415 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 22:55:23,416 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 22:55:23,416 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:55:23,416 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 22:55:25,317 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:55:25,317 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:55:25.317999', 'table_talk': None}
2025-03-10 22:55:25,318 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:55:25,318 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:55:25,318 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:55:25,318 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:55:25,318 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:55:25,318 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:55:25,319 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:25,319 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:55:25,319 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:55:25,319 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:55:25,319 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:25,320 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:55:25,320 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:25,320 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:55:25,320 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:55:25,320 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:55:25,321 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:55:25,321 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 620, 'current_bet': 0, 'is_active': True, 'cards': ('10♥', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '2♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3370, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:55:25,321 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:25,322 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:55:25,322 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:25,322 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:55:25,322 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:55:25,322 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:55:25,373 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:55:25,374 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:55:25,374 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:55:25,374 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:55:25,375 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:55:25,375 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:55:36,707 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "手牌10♥和3♠非常弱，几乎没有较好的发展潜力，无论翻牌如何都难以构成强牌", "position_analysis": "位置较前且主动下注的对手可能掌握了较好的牌，处于劣势位置，继续跟注风险过高", "pot_odds": "底池仅20，对手已下注20，我需要投入的成本相对较高，底池赔率不足以补偿劣势牌力", "opponent_reads": ["ai_4已下注，可能持有较强牌或者在利用位置优势施压", "ai_2虽然未下注，但整体局势显示继续参与风险较大"]}, "table_talk": {"message": "抱歉，我今晚运气似乎不在我这边，我选择暂时退出这一局。", "tone": "轻松并略带戏谑"}}
2025-03-10 22:55:36,708 - src.agents.llm - INFO - ==================================================

2025-03-10 22:55:36,708 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉，我今晚运气似乎不在我这边，我选择暂时退出这一局。', 'tone': '轻松并略带戏谑'}
2025-03-10 22:55:36,709 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:55:36,709 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:55:36,709 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:55:36,710 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:55:36,710 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:55:36,710 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:55:36,710 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:55:36,710 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:36,711 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:55:36,711 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:55:36,711 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:55:36,711 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:36,711 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:55:36,711 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:36,711 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:55:36,712 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:55:36,712 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:55:36,712 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:55:36,712 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('4♦', 'J♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '2♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3370, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉，我今晚运气似乎不在我这边，我选择暂时退出这一局。', 'tone': '轻松并略带戏谑'}}
2025-03-10 22:55:36,712 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:36,712 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 22:55:36,712 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:36,713 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:55:36,713 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:55:36,713 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:55:36,714 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:55:36,714 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:55:36,714 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:55:36,714 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:55:36,715 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:55:36,715 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:55:43,802 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌4♦和J♥在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2处于早期位置，不利于后续行动","pot_odds":"底池赔率不吸引人，不值得冒险跟注","opponent_reads":["ai_4已经下注20，显示出一定的进攻性，可能持有较强的手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"轻松"}}
2025-03-10 22:55:43,804 - src.agents.llm - INFO - ==================================================

2025-03-10 22:55:43,804 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '轻松'}
2025-03-10 22:55:43,805 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:55:43,806 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:55:43,806 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:55:43,806 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:55:43,806 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:55:43,807 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:55:43,807 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:55:43,807 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:43,807 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:55:43,807 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:55:43,808 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:55:43,808 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:43,808 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:55:43,809 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:43,809 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:55:43,809 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:55:43,810 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:55:43,810 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:55:43,810 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:55:43,810 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '2♣'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3370, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '轻松'}}
2025-03-10 22:55:43,811 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:43,811 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:55:43,811 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:55:43,811 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:55:43,812 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:55:43,812 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 22:55:43,812 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:55:43,813 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:55:43,813 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:55:43,813 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:55:43,814 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:55:43,814 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:55:43,814 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:55:52,046 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"Q♦2♣是一手非常弱的起手牌，属于德州扑克中的垃圾牌。高牌Q有一定价值，但2几乎没有任何帮助，且两张牌不同花色，没有同花潜力。","position_analysis":"我在位置3，属于前中位，这是一个不利的位置，因为后面还有玩家要行动。在这个位置玩弱牌风险很大。","pot_odds":"底池只有20，要跟注20，赔率是1:1，但我的手牌胜率远低于50%，不值得跟注。","opponent_reads":["前面三位玩家都选择了弃牌，说明他们手牌较弱。但ai_4选择了跟注，可能有一定的手牌强度。"]},"table_talk":{"message":"这手牌连我都看不下去了，弃了。","tone":"轻松幽默"}}
2025-03-10 22:55:52,048 - src.agents.llm - INFO - ==================================================

2025-03-10 22:55:52,048 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌连我都看不下去了，弃了。', 'tone': '轻松幽默'}
2025-03-10 22:55:52,048 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:55:52,049 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:55:52,049 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:55:52,049 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:55:52,050 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:55:52,050 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:55:52,050 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:55:52,051 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:55:52,051 - src.engine.state - INFO - 玩家 ai_4 获得底池 20 筹码，当前筹码: 3390
2025-03-10 22:55:52,051 - src.engine.game - INFO - 玩家 ai_4 获得底池 20 筹码
2025-03-10 22:55:52,051 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:55:52,051 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 20, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♥', 'J♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:55:52,052 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 20, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♥', 'J♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 620, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3390, 'current_bet': 20, 'is_active': False, 'cards': ('8♥', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌连我都看不下去了，弃了。', 'tone': '轻松幽默'}}
2025-03-10 22:55:52,052 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:55:52,053 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:55:52,053 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:55:52,053 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:55:52,053 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:55:52,054 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:55:52,054 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 20, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♥', 'J♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:55:52,054 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:56:15,727 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:56:15,727 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:56:15,727 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 22:56:15,728 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:56:15,728 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:56:15,728 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♦', '4♣')
2025-03-10 22:56:15,728 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♥', '6♥')
2025-03-10 22:56:15,728 - src.engine.game - INFO - 玩家 ai_2 手牌: ('8♠', 'K♠')
2025-03-10 22:56:15,728 - src.engine.game - INFO - 玩家 ai_3 手牌: ('A♣', '4♦')
2025-03-10 22:56:15,729 - src.engine.game - INFO - 玩家 ai_4 手牌: ('K♦', '8♣')
2025-03-10 22:56:15,729 - src.engine.state - INFO - 玩家 ai_4 下注 10 筹码
2025-03-10 22:56:15,729 - src.engine.game - INFO - 玩家 ai_4 下注小盲注 10
2025-03-10 22:56:15,729 - src.engine.state - INFO - 玩家 player_0 筹码不足，转为全下 0 筹码
2025-03-10 22:56:15,729 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 22:56:15,730 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_4(10)，大盲注=player_0(20)
2025-03-10 22:56:15,730 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 22:56:15,730 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:56:15,730 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 22:56:17,074 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:56:17,075 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:56:17,075 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:56:17,076 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:56:17,076 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:56:17,077 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:56:50,035 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "10", "confidence": "0.7"}, "reasoning": {"hand_strength": "7♥,6♥虽然不是强牌，但同花连牌具有一定的隐含潜力，可以在翻牌后发挥作用", "position_analysis": "处于早位，本来不适合过于激进，但目前投注较低，风险相对有限", "pot_odds": "跟注10的成本较低，可以用较少投入争取看翻牌的潜在回报", "opponent_reads": ["部分对手筹码为0，可能已全下，被动局面减少抗拒", "ai_4已投入10，显示出稳健姿态，但也可能试探底池"]}, "table_talk": {"message": "各位，耐心一点，机会会到来的，现在不必过于冒进", "tone": "淡定自信"}}
2025-03-10 22:56:50,036 - src.agents.llm - INFO - ==================================================

2025-03-10 22:56:50,037 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位，耐心一点，机会会到来的，现在不必过于冒进', 'tone': '淡定自信'}
2025-03-10 22:56:50,037 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 22:56:50,037 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 22:56:50,037 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-10 22:56:50,038 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 22:56:50,038 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 22:56:50,038 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:56:50,038 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:56:50,039 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:56:50,039 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 22:56:50,039 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 22:56:50,039 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 22:56:50,039 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:56:50,039 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:56:50,040 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:56:50,040 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:56:50,040 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:56:50,040 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:56:50,040 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:56:50,040 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:56:50,040 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:56:50,041 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '4♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '6♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('8♠', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '4♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3380, 'current_bet': 10, 'is_active': True, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，耐心一点，机会会到来的，现在不必过于冒进', 'tone': '淡定自信'}}
2025-03-10 22:56:50,041 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:56:50,042 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:56:50,042 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:56:50,042 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:56:50,042 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:56:50,043 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:56:50,043 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 22:56:50,044 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:56:50,046 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:56:50,046 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:56:50,047 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:56:50,047 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:56:50,047 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:56:50,048 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:56:56,480 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"8♠和K♠的组合在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2在早期行动，不利于后续观察对手行为","pot_odds":"底池赔率不高，不值得冒险跟注或加注","opponent_reads":["ai_1选择跟注，可能持有中等强度手牌，其他玩家尚未行动，存在不确定性"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"轻松"}}
2025-03-10 22:56:56,481 - src.agents.llm - INFO - ==================================================

2025-03-10 22:56:56,482 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '轻松'}
2025-03-10 22:56:56,482 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:56:56,482 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:56:56,482 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:56:56,483 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:56:56,483 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:56:56,483 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:56:56,484 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:56:56,484 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:56:56,484 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:56:56,485 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:56:56,485 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:56:56,485 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:56:56,485 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:56:56,485 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:56:56,485 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:56:56,486 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:56:56,486 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:56:56,486 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:56:56,486 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:56:56,486 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:56:56,487 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '4♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '6♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '4♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3380, 'current_bet': 10, 'is_active': True, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '轻松'}}
2025-03-10 22:56:56,487 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:56:56,487 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:56:56,488 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:56:56,488 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:56:56,488 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:56:56,488 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:56:56,489 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 22:56:56,489 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:56:56,490 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:56:56,490 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:56:56,491 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:56:56,491 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:56:56,491 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:56:56,492 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:57:00,086 - src.agents.llm - ERROR - ❌ LLM调用失败: litellm.APIError: APIError: OpenrouterException - [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-03-10 22:57:00,086 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): litellm.APIError: APIError: OpenrouterException - [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-03-10 22:57:01,091 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: litellm.APIError: APIError: OpenrouterException - [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-03-10 22:57:01,091 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 22:57:01,091 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 22:57:01,092 - src.engine.state - INFO - 玩家 ai_3 跟注 0 筹码，已标记为已行动
2025-03-10 22:57:01,092 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 22:57:01,092 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 22:57:01,092 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:57:01,092 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:57:01,093 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:57:01,093 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:57:01,093 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:57:01,093 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:57:01,093 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:01,093 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:57:01,093 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:57:01,094 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:57:01,094 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:57:01,094 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:57:01,094 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(10)，回合继续
2025-03-10 22:57:01,094 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:01,094 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:57:01,094 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '4♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '6♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '4♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3380, 'current_bet': 10, 'is_active': True, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:57:01,095 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:01,096 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:57:01,096 - src.engine.game - INFO - 当前最大下注额: 10
2025-03-10 22:57:01,096 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:57:01,096 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:57:01,097 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:57:01,097 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(10)，回合继续
2025-03-10 22:57:01,097 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:01,506 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:57:01,506 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:57:01,507 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:57:01,507 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:57:01,507 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:57:01,508 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:57:19,538 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.7},"reasoning":{"hand_strength":"K高牌在前位有一定的强度，但不是最强的手牌。8♣提供了一些后门听牌的机会，比如同花或顺子。","position_analysis":"位于中间位置，这给了我们一定的灵活性来观察后续行动，并根据情况调整策略。","pot_odds":"当前底池赔率较低，通过加注可以提高对手跟注的成本，同时增加底池大小以利于后续操作。","opponent_reads":["ai_1和ai_3都选择了跟注，显示出他们可能持有中等强度的手牌或者是在尝试看翻牌。"]},"table_talk":{"message":"看来大家都挺有信心的嘛，那我也得表现一下了。","tone":"轻松自信"}}
2025-03-10 22:57:19,539 - src.agents.llm - INFO - ==================================================

2025-03-10 22:57:19,539 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺有信心的嘛，那我也得表现一下了。', 'tone': '轻松自信'}
2025-03-10 22:57:19,539 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 22:57:19,540 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:57:19,540 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 22:57:19,540 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 22:57:19,540 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:57:19,540 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:57:19,541 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:57:19,541 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:19,541 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:57:19,541 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:57:19,542 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:57:19,542 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:19,542 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:57:19,542 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:19,542 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:57:19,543 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:57:19,543 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(60)，回合继续
2025-03-10 22:57:19,543 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:19,543 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:57:19,544 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '4♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '6♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '4♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 60, 'is_active': True, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺有信心的嘛，那我也得表现一下了。', 'tone': '轻松自信'}}
2025-03-10 22:57:19,544 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:19,544 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:57:19,545 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:19,545 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:57:19,545 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:57:19,545 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(60)，回合继续
2025-03-10 22:57:19,546 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:22,726 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 22:57:22,727 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T22:57:22.727596', 'table_talk': None}
2025-03-10 22:57:22,727 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 22:57:22,728 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 22:57:22,728 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 22:57:22,728 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 22:57:22,728 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 22:57:22,729 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 22:57:22,729 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:22,729 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 22:57:22,729 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 22:57:22,730 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 22:57:22,730 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:22,730 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:57:22,730 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:22,731 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:57:22,731 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(60)，回合继续
2025-03-10 22:57:22,731 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:22,732 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:57:22,732 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '6♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '4♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 60, 'is_active': True, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:57:22,732 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:22,733 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_3', 'ai_4']
2025-03-10 22:57:22,733 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:22,733 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=10, is_all_in=False
2025-03-10 22:57:22,733 - src.engine.game - INFO - 玩家 ai_1 下注额(10)不等于最大下注额(60)，回合继续
2025-03-10 22:57:22,733 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:24,561 - server - INFO - 当前AI玩家: ai_1
2025-03-10 22:57:24,562 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 22:57:24,562 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 22:57:24,562 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:57:24,563 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:57:24,563 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 22:57:43,366 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "7♥, 6♥虽然是同花连牌，但整体牌力较弱，不足以对抗加注范围较宽的对手", "position_analysis": "处于早位容易遭遇后续激进玩家的反击，不利于后续战术调整", "pot_odds": "跟注需要投入60筹码，而底池已有70筹码，但风险与潜在收益不匹配", "opponent_reads": ["ai_4主动加注表明对牌局有较高信心，ai_1和ai_3的跟注也暗示存在较强牌力"]}, "table_talk": {"message": "我不浪费筹码去跟那些虚张声势的人玩垃圾牌！", "tone": "果断且稍带讽刺"}}
2025-03-10 22:57:43,367 - src.agents.llm - INFO - ==================================================

2025-03-10 22:57:43,367 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '我不浪费筹码去跟那些虚张声势的人玩垃圾牌！', 'tone': '果断且稍带讽刺'}
2025-03-10 22:57:43,368 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 22:57:43,368 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 22:57:43,368 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 22:57:43,369 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 22:57:43,369 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 22:57:43,369 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 22:57:43,369 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 22:57:43,369 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:43,370 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:57:43,370 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_3
2025-03-10 22:57:43,370 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:57:43,370 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:43,371 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:57:43,371 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:43,371 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:57:43,371 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(60)，回合继续
2025-03-10 22:57:43,371 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:43,371 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:57:43,372 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '4♦'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3330, 'current_bet': 60, 'is_active': True, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我不浪费筹码去跟那些虚张声势的人玩垃圾牌！', 'tone': '果断且稍带讽刺'}}
2025-03-10 22:57:43,372 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:43,373 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 22:57:43,373 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 22:57:43,373 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 22:57:43,373 - src.engine.game - INFO - 玩家 ai_3 下注额(0)不等于最大下注额(60)，回合继续
2025-03-10 22:57:43,374 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 22:57:43,374 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:57:43,374 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:57:43,375 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:57:43,375 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:57:43,375 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:57:43,375 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:57:52,578 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"A♣4♦是一手中等偏弱的起手牌。虽然有一张A，但4作为配牌很弱，不同花色使得我们没有同花的潜力。","position_analysis":"我在位置3，相对靠前，这不是一个有利位置。在前位拿到这样的牌力通常应该谨慎行动。","pot_odds":"当前底池70，需要跟注60，底池赔率不到2:1。考虑到我的筹码为0，无法进行任何操作。","opponent_reads":["ai_4选择加注到60，显示出一定的强势，可能拿到了不错的手牌。"]},"table_talk":{"message":"看来我今天的牌运到此为止了，祝各位好运！","tone":"轻松"}}
2025-03-10 22:57:52,579 - src.agents.llm - INFO - ==================================================

2025-03-10 22:57:52,580 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我今天的牌运到此为止了，祝各位好运！', 'tone': '轻松'}
2025-03-10 22:57:52,580 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:57:52,580 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:57:52,581 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:57:52,581 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:57:52,581 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:57:52,582 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 22:57:52,582 - src.engine.game - INFO - 开始游戏结算
2025-03-10 22:57:52,582 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 22:57:52,582 - src.engine.state - INFO - 玩家 ai_4 获得底池 70 筹码，当前筹码: 3400
2025-03-10 22:57:52,583 - src.engine.game - INFO - 玩家 ai_4 获得底池 70 筹码
2025-03-10 22:57:52,583 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 22:57:52,583 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♦', '8♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:57:52,583 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♦', '8♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 610, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3400, 'current_bet': 60, 'is_active': False, 'cards': ('K♦', '8♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我今天的牌运到此为止了，祝各位好运！', 'tone': '轻松'}}
2025-03-10 22:57:52,584 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:57:52,584 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 22:57:52,585 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 22:57:52,585 - server - INFO - 回合结束，进入下一阶段
2025-03-10 22:57:52,585 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 22:57:52,586 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 22:57:52,586 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('K♦', '8♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 22:57:52,586 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 22:58:17,618 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:58:17,618 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 22:58:17,618 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 22:58:17,618 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:58:17,619 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:58:17,619 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♦', '10♣')
2025-03-10 22:58:17,619 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♠', '7♥')
2025-03-10 22:58:17,619 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♣', '8♥')
2025-03-10 22:58:17,619 - src.engine.game - INFO - 玩家 ai_3 手牌: ('9♠', '2♠')
2025-03-10 22:58:17,620 - src.engine.game - INFO - 玩家 ai_4 手牌: ('7♠', 'J♥')
2025-03-10 22:58:17,620 - src.engine.state - INFO - 玩家 player_0 筹码不足，转为全下 0 筹码
2025-03-10 22:58:17,620 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 22:58:17,620 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 22:58:17,620 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 22:58:17,620 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 22:58:17,621 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 22:58:17,621 - src.engine.game - INFO - 游戏 1ef237b8-8360-4306-8eb9-29e05f1bd273 开始，进入翻牌前阶段
2025-03-10 22:58:17,621 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 22:58:17,624 - server - INFO - 当前AI玩家: ai_2
2025-03-10 22:58:17,625 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 22:58:17,625 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 22:58:17,625 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:58:17,625 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:58:17,626 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 22:58:24,595 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌3♣和8♥在PRE_FLOP阶段非常弱，几乎没有形成强牌的可能性","position_analysis":"位置2在PRE_FLOP阶段并不占优势，尤其是面对多个对手时","pot_odds":"当前底池为20，跟注需要20，赔率不理想","opponent_reads":["ai_1已经下注20，显示出一定的积极性，可能持有较强的起手牌","ai_4筹码充足，可能在后位进行加注"]},"table_talk":{"message":"看来这把牌不适合我，你们继续吧","tone":"轻松"}}
2025-03-10 22:58:24,596 - src.agents.llm - INFO - ==================================================

2025-03-10 22:58:24,596 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这把牌不适合我，你们继续吧', 'tone': '轻松'}
2025-03-10 22:58:24,597 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 22:58:24,597 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 22:58:24,597 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 22:58:24,597 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 22:58:24,597 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 22:58:24,597 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 22:58:24,598 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 22:58:24,598 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:58:24,598 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 22:58:24,599 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 22:58:24,599 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 22:58:24,599 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:58:24,599 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:58:24,599 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:58:24,600 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:58:24,600 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:58:24,600 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:58:24,600 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:58:24,600 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:58:24,601 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 590, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '2♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3400, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这把牌不适合我，你们继续吧', 'tone': '轻松'}}
2025-03-10 22:58:24,601 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:58:24,601 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 22:58:24,602 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:58:24,602 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:58:24,602 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:58:24,602 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:58:24,602 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:58:24,603 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:58:24,603 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:58:24,604 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:58:24,604 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:58:24,604 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:58:24,604 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:58:30,974 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"9-2同花是一手非常弱的起手牌，即使同花也需要配合才有价值","position_analysis":"位置3是早期位置，不利于弱牌操作","pot_odds":"我已经没有筹码了，无法进行任何下注操作","opponent_reads":["ai_1已经下注，说明可能有不错的手牌","ai_4还未行动，后面可能还有加注"]},"table_talk":{"message":"我这手牌不值得打，聪明的选择是知道什么时候该退出。","tone":"平静"}}
2025-03-10 22:58:30,975 - src.agents.llm - INFO - ==================================================

2025-03-10 22:58:30,975 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '我这手牌不值得打，聪明的选择是知道什么时候该退出。', 'tone': '平静'}
2025-03-10 22:58:30,975 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:58:30,975 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:58:30,976 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:58:30,976 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:58:30,976 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:58:30,976 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:58:30,976 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:58:30,976 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:58:30,977 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:58:30,977 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:58:30,977 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:58:30,977 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:58:30,977 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:58:30,977 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:58:30,977 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:58:30,978 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:58:30,978 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:58:30,978 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:58:30,978 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:58:30,978 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 20, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 590, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 3400, 'current_bet': 0, 'is_active': True, 'cards': ('7♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我这手牌不值得打，聪明的选择是知道什么时候该退出。', 'tone': '平静'}}
2025-03-10 22:58:30,979 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:58:30,979 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:58:30,979 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:58:30,979 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:58:30,980 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:58:30,980 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:58:30,980 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:58:30,983 - server - INFO - 当前AI玩家: ai_4
2025-03-10 22:58:30,983 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 22:58:30,983 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 22:58:30,984 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:58:30,984 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:58:30,984 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 22:58:45,083 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"100","confidence":0.65},"reasoning":{"hand_strength":"我的手牌是7♠, J♥，这是一手中等偏弱的起始手牌。但考虑到对手可能也持有类似强度的手牌，且在前翻牌圈利用位置优势施加压力可以获取更多信息或直接赢得底池。","position_analysis":"位于中间位置，有一定的信息优势来观察前面玩家的行为，并且有足够的空间来进行后续操作。","pot_odds":"当前底池为20，通过适当加注至100，既不会过分暴露自己的意图，也能测试对手的决心。","opponent_reads":["ai_1已经进行了20的下注，显示出一定的兴趣或可能是试探性行为。"]},"table_talk":{"message":"看来今天运气不错，我得试试水深了。","tone":"轻松自信"}}
2025-03-10 22:58:45,084 - src.agents.llm - INFO - ==================================================

2025-03-10 22:58:45,084 - src.agents.llm - INFO - 成功将字符串金额 100 转换为数字 100.0
2025-03-10 22:58:45,084 - src.agents.llm - INFO - 生成动作: RAISE 金额: 100 table_talk: {'message': '看来今天运气不错，我得试试水深了。', 'tone': '轻松自信'}
2025-03-10 22:58:45,084 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 100
2025-03-10 22:58:45,084 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 22:58:45,085 - src.engine.state - INFO - 玩家 ai_4 加注到 100 筹码，已标记为已行动
2025-03-10 22:58:45,085 - src.engine.game - INFO - 玩家 ai_4 加注到 100
2025-03-10 22:58:45,085 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 22:58:45,085 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 22:58:45,086 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 22:58:45,086 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:58:45,086 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 22:58:45,087 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 22:58:45,087 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 22:58:45,087 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:58:45,087 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:58:45,087 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:58:45,088 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:58:45,088 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:58:45,088 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:58:45,088 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:58:45,088 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:58:45,089 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 120, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 0, 'current_bet': 0, 'is_active': True, 'cards': ('3♦', '10♣'), 'is_all_in': True, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 590, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', '7♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 3300, 'current_bet': 100, 'is_active': True, 'cards': ('7♠', 'J♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 100}], 'table_talk': {'message': '看来今天运气不错，我得试试水深了。', 'tone': '轻松自信'}}
2025-03-10 22:58:45,089 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:58:45,089 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 22:58:45,090 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 22:58:45,090 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=True
2025-03-10 22:58:45,090 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 22:58:45,090 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 22:58:45,091 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:58:59,109 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 22:58:59,317 - server - INFO - 正在创建游戏: ac08935a-95bf-4d59-a4ac-0b6f2c0b187c, 玩家数量: 5
2025-03-10 22:58:59,318 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 22:58:59,318 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 22:58:59,318 - src.engine.game - INFO - 游戏 ac08935a-95bf-4d59-a4ac-0b6f2c0b187c 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 22:58:59,319 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 22:58:59,319 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 22:58:59,319 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:58:59,320 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 22:58:59,320 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 22:58:59,321 - src.engine.game - INFO - Added player ai_1 to game ac08935a-95bf-4d59-a4ac-0b6f2c0b187c
2025-03-10 22:58:59,321 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 22:58:59,321 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:58:59,323 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 22:58:59,323 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 22:58:59,323 - src.engine.game - INFO - Added player ai_2 to game ac08935a-95bf-4d59-a4ac-0b6f2c0b187c
2025-03-10 22:58:59,324 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 22:58:59,324 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:58:59,325 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 22:58:59,325 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 22:58:59,325 - src.engine.game - INFO - Added player ai_3 to game ac08935a-95bf-4d59-a4ac-0b6f2c0b187c
2025-03-10 22:58:59,325 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:58:59,326 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 22:58:59,327 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 22:58:59,327 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 22:58:59,327 - src.engine.game - INFO - Added player ai_4 to game ac08935a-95bf-4d59-a4ac-0b6f2c0b187c
2025-03-10 22:58:59,327 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 22:58:59,328 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 22:58:59,328 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 22:58:59,328 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', 'K♦')
2025-03-10 22:58:59,329 - src.engine.game - INFO - 玩家 ai_1 手牌: ('2♠', '8♦')
2025-03-10 22:58:59,329 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♥', 'K♠')
2025-03-10 22:58:59,329 - src.engine.game - INFO - 玩家 ai_3 手牌: ('10♦', '4♠')
2025-03-10 22:58:59,329 - src.engine.game - INFO - 玩家 ai_4 手牌: ('Q♣', '4♣')
2025-03-10 22:58:59,329 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 22:58:59,330 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 22:58:59,330 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 22:58:59,330 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 22:58:59,330 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 22:58:59,330 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 22:58:59,331 - src.engine.game - INFO - 游戏 ac08935a-95bf-4d59-a4ac-0b6f2c0b187c 开始，进入翻牌前阶段
2025-03-10 22:58:59,331 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 22:58:59,331 - server - INFO - 游戏 ac08935a-95bf-4d59-a4ac-0b6f2c0b187c 已开始
2025-03-10 22:58:59,331 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 22:58:59,736 - server - INFO - WebSocket连接已建立: ac08935a-95bf-4d59-a4ac-0b6f2c0b187c
2025-03-10 22:58:59,737 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('2♠', '8♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♦', '4♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '4♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 22:58:59,738 - server - INFO - 当前AI玩家: ai_3
2025-03-10 22:58:59,738 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 22:58:59,738 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 22:58:59,738 - src.agents.llm - INFO - 
==================================================
2025-03-10 22:58:59,739 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 22:58:59,739 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 22:59:09,113 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"10♦, 4♠是一手非常弱的起手牌，没有同花潜力，没有顺子潜力，牌值也不高。","position_analysis":"我在位置3，相对靠前，已经有人在我前面加注，这增加了我继续玩这手牌的风险。","pot_odds":"底池有30，需要下注20才能继续，底池赔率为1.5:1，但我的手牌胜率远低于这个数值。","opponent_reads":["ai_2已经加注到20，显示出一定的强度","前面已经有两位玩家下注，表明至少有一位玩家可能有强牌"]},"table_talk":{"message":"这手牌不值得冒险，我选择保存实力等待更好的机会。","tone":"冷静"}}
2025-03-10 22:59:09,114 - src.agents.llm - INFO - ==================================================

2025-03-10 22:59:09,115 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不值得冒险，我选择保存实力等待更好的机会。', 'tone': '冷静'}
2025-03-10 22:59:09,115 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 22:59:09,115 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 22:59:09,116 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 22:59:09,116 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 22:59:09,116 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 22:59:09,116 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 22:59:09,117 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 22:59:09,117 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:59:09,117 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 22:59:09,117 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 22:59:09,118 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 22:59:09,118 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:59:09,118 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:59:09,118 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:59:09,118 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:59:09,119 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:59:09,119 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:59:09,119 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 22:59:09,119 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('2♠', '8♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', '4♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不值得冒险，我选择保存实力等待更好的机会。', 'tone': '冷静'}}
2025-03-10 22:59:09,120 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 22:59:09,120 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 22:59:09,121 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 22:59:09,121 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 22:59:09,121 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 22:59:09,121 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 22:59:09,122 - server - INFO - WebSocket连接已断开: 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 22:59:09,122 - server - ERROR - 连接已关闭，无法发送游戏状态: 1ef237b8-8360-4306-8eb9-29e05f1bd273
2025-03-10 23:03:53,370 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 23:03:53,375 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 23:03:59,542 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-10 23:03:59,546 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-10 23:04:11,798 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 23:04:12,238 - server - INFO - 正在创建游戏: fdafd42a-bedb-4d6f-9140-64b7a4851980, 玩家数量: 5
2025-03-10 23:04:12,239 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:04:12,240 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 23:04:12,241 - src.engine.game - INFO - 游戏 fdafd42a-bedb-4d6f-9140-64b7a4851980 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 23:04:12,241 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 23:04:12,242 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 23:04:12,243 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:12,245 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 23:04:12,246 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 23:04:12,246 - src.engine.game - INFO - Added player ai_1 to game fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:12,246 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 23:04:12,247 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:12,250 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 23:04:12,251 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 23:04:12,251 - src.engine.game - INFO - Added player ai_2 to game fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:12,252 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 23:04:12,253 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:12,255 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 23:04:12,256 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 23:04:12,256 - src.engine.game - INFO - Added player ai_3 to game fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:12,257 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:04:12,258 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:12,261 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 23:04:12,262 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 23:04:12,262 - src.engine.game - INFO - Added player ai_4 to game fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:12,263 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 23:04:12,263 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:04:12,264 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:04:12,264 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♠', '5♠')
2025-03-10 23:04:12,265 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♣', '3♠')
2025-03-10 23:04:12,265 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♦', '7♦')
2025-03-10 23:04:12,266 - src.engine.game - INFO - 玩家 ai_3 手牌: ('6♣', '10♠')
2025-03-10 23:04:12,266 - src.engine.game - INFO - 玩家 ai_4 手牌: ('A♥', '3♣')
2025-03-10 23:04:12,267 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:04:12,267 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:04:12,268 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:04:12,268 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:04:12,269 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:04:12,270 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 23:04:12,270 - src.engine.game - INFO - 游戏 fdafd42a-bedb-4d6f-9140-64b7a4851980 开始，进入翻牌前阶段
2025-03-10 23:04:12,271 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 23:04:12,271 - server - INFO - 游戏 fdafd42a-bedb-4d6f-9140-64b7a4851980 已开始
2025-03-10 23:04:12,272 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 23:04:12,418 - server - INFO - WebSocket连接已建立: fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:12,419 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '5♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♣', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('6♣', '10♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '3♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:04:12,421 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:04:12,422 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:04:12,422 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:04:12,423 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:04:12,423 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:04:12,424 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:04:20,788 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"6♣, 10♠是一手非常弱的起手牌，没有花色连接，没有高牌价值，在早期位置价值极低。","position_analysis":"我处于早期位置(位置3)，前面已经有人加注，这个位置用弱牌继续很危险。","pot_odds":"底池有30，需要下注20才能继续，底池赔率为1.5:1，但我的手牌胜率远低于这个数值。","opponent_reads":["ai_2已经加注到20，显示出一定的强度","其他玩家还没有行动，后面可能还有人再加注","用这手牌跟注或加注风险太大"]},"table_talk":{"message":"这手牌不值得战斗，聪明的选择是保存实力。","tone":"冷静"}}
2025-03-10 23:04:20,790 - src.agents.llm - INFO - ==================================================

2025-03-10 23:04:20,790 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不值得战斗，聪明的选择是保存实力。', 'tone': '冷静'}
2025-03-10 23:04:20,790 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:04:20,791 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:04:20,791 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:04:20,791 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:04:20,791 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:04:20,791 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:04:20,791 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:04:20,792 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:04:20,792 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:04:20,792 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:04:20,792 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:04:20,792 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:04:20,792 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:04:20,793 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:04:20,793 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:04:20,793 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:04:20,793 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:04:20,793 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:04:20,794 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '5♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♣', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '3♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不值得战斗，聪明的选择是保存实力。', 'tone': '冷静'}}
2025-03-10 23:04:20,794 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:04:20,795 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:04:20,795 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:04:20,796 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:04:20,796 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:04:20,796 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:04:25,814 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:04:25,815 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:04:25,815 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:04:25,815 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:04:25,816 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:04:25,816 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:04:39,912 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.75},"reasoning":{"hand_strength":"持有A高牌，虽然不是很强但有一定的潜力。考虑到目前阶段为PRE_FLOP且位置较好，可以尝试控制底池大小同时测试对手的反应。","position_analysis":"处于中后位置，这给了我观察前面玩家行动的机会，并根据他们的行为做出更合理的判断。","pot_odds":"当前加注至60，相对于我的筹码量来说风险可控，同时也增加了底池的价值，为后续操作留出空间。","opponent_reads":["player_0没有参与本局，可能比较谨慎；ai_1和ai_2分别进行了小额下注，显示出他们手中可能有不错的起手牌，但也可能是试探性的动作。"]},"table_talk":{"message":"看来大家都挺有信心的嘛，那我也来加点乐趣吧！","tone":"轻松自信"}}
2025-03-10 23:04:39,913 - src.agents.llm - INFO - ==================================================

2025-03-10 23:04:39,913 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺有信心的嘛，那我也来加点乐趣吧！', 'tone': '轻松自信'}
2025-03-10 23:04:39,914 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 23:04:39,914 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 23:04:39,914 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 23:04:39,914 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 23:04:39,915 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 23:04:39,915 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:04:39,915 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:04:39,915 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:04:39,915 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:04:39,915 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:04:39,916 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:04:39,916 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:04:39,916 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:04:39,916 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:04:39,916 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:04:39,916 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:04:39,916 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:04:39,917 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:04:39,917 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '5♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('Q♣', '3♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('A♥', '3♣'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺有信心的嘛，那我也来加点乐趣吧！', 'tone': '轻松自信'}}
2025-03-10 23:04:39,918 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:04:39,918 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:04:39,918 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:04:39,918 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:04:39,919 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:04:39,919 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:04:39,919 - server - INFO - 返回主页: c:\Users\YiCheng\TexasHoldemAgent\src\web\index.html
2025-03-10 23:04:39,983 - server - INFO - 正在创建游戏: ebfe7e47-85cc-4107-ada1-d8466e0d6d6e, 玩家数量: 5
2025-03-10 23:04:39,983 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:04:39,984 - src.engine.state - INFO - 游戏状态已初始化
2025-03-10 23:04:39,984 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 已初始化，玩家数量: 0，初始筹码: 1000，小盲注: 10
2025-03-10 23:04:39,984 - src.engine.state - INFO - Added player player_0 with 1000 chips at position 0
2025-03-10 23:04:39,985 - server - INFO - 添加人类玩家: player_0, 初始筹码: 1000
2025-03-10 23:04:39,985 - Agent_ai_1 - INFO - Agent ai_1 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:39,986 - src.agents.llm - INFO - LLM Agent ai_1 初始化完成，使用模型 openrouter/openai/o3-mini，性格: 擅长使用策略和心理战术
2025-03-10 23:04:39,986 - src.engine.state - INFO - Added player ai_1 with 1000 chips at position 1
2025-03-10 23:04:39,987 - src.engine.game - INFO - Added player ai_1 to game ebfe7e47-85cc-4107-ada1-d8466e0d6d6e
2025-03-10 23:04:39,987 - server - INFO - 成功创建AI玩家: ai_1, 模型: openrouter/openai/o3-mini
2025-03-10 23:04:39,987 - Agent_ai_2 - INFO - Agent ai_2 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:39,989 - src.agents.llm - INFO - LLM Agent ai_2 初始化完成，使用模型 openai/deepseek-v3，性格: 擅长使用策略和心理战术
2025-03-10 23:04:39,989 - src.engine.state - INFO - Added player ai_2 with 1000 chips at position 2
2025-03-10 23:04:39,990 - src.engine.game - INFO - Added player ai_2 to game ebfe7e47-85cc-4107-ada1-d8466e0d6d6e
2025-03-10 23:04:39,990 - server - INFO - 成功创建AI玩家: ai_2, 模型: openai/deepseek-v3
2025-03-10 23:04:39,990 - Agent_ai_3 - INFO - Agent ai_3 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:39,992 - src.agents.llm - INFO - LLM Agent ai_3 初始化完成，使用模型 openrouter/anthropic/claude-3.7-sonnet，性格: 擅长使用策略和心理战术
2025-03-10 23:04:39,992 - src.engine.state - INFO - Added player ai_3 with 1000 chips at position 3
2025-03-10 23:04:39,992 - src.engine.game - INFO - Added player ai_3 to game ebfe7e47-85cc-4107-ada1-d8466e0d6d6e
2025-03-10 23:04:39,992 - server - INFO - 成功创建AI玩家: ai_3, 模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:04:39,993 - Agent_ai_4 - INFO - Agent ai_4 initialized with config: {'ai_players': {'ai_1': {'model': 'openrouter/openai/o3-mini', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_2': {'model': 'openai/deepseek-v3', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_3': {'model': 'openrouter/anthropic/claude-3.7-sonnet', 'api_key': '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', 'base_url': 'https://openrouter.ai/api/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}, 'ai_4': {'model': 'openai/qwen-max', 'api_key': 'sk-c35f8f8afc75416daeaa412d96543299', 'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'temperature': 0.5, 'max_tokens': 8000, 'timeout': 30, 'description': '擅长使用策略和心理战术'}}, 'prompts': {'decision_making': '你是一个德州扑克玩家。{historical_context}。请根据当前游戏状态和历史信息，按照你的性格特征做出决策。\n\n游戏规则说明:\n1. 可用动作类型:\n   - FOLD (弃牌): 放弃当前手牌，退出本轮游戏\n   - CHECK (过牌): 不加注，保持当前下注额（仅当无人加注时可用）\n   - CALL (跟注): 跟随当前最大注额\n   - RAISE (加注): 将注额提高到指定数量，如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码。\n   - ALL_IN (全下): 押上所有剩余筹码，当筹码不足以加注时，可以选择全下来进行加注。\n\n2. 加注规则:\n   - 加注金额必须大于当前最大注额\n   - 加注金额必须至少是最小加注额\n   - 加注金额不能超过玩家剩余筹码\n   - 如果筹码不足以满足最小加注要求，只能选择 FOLD 或 ALL_IN\n\n3. 行动限制:\n   - 每个玩家每轮只能行动一次\n   - 必须按照顺时针顺序行动\n   - 如果前面有人加注，不能选择过牌\n   - 跟注或加注的金额必须精确匹配要求\n\n当前状态:\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 当前阶段: {phase}\n- 位置: {position}\n- 底池: {pot_size}\n- 当前最大注: {current_bet}\n- 最小加注额: {min_raise} (这是你必须加注到的最小金额)\n- 我的筹码: {chips}\n\n对手信息:\n{opponents}\n\n本轮动作历史:\n{round_actions}\n\n请记住你的性格特征，在做出决策时要体现出相应的风格。\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "action": {{\n    "type": "动作类型(FOLD/CHECK/CALL/RAISE/ALL_IN)",\n    "amount": "加注金额(如果选择加注，必须至少是当前最大注的两倍，加注金额不能超过玩家剩余筹码，如果筹码不足以满足最小加注要求，只能选择弃牌或全下)",\n    "confidence": "决策置信度(0-1)"\n  }},\n  "reasoning": {{\n    "hand_strength": "手牌强度分析",\n    "position_analysis": "位置分析",\n    "pot_odds": "底池赔率分析",\n    "opponent_reads": ["对手行为分析"]\n  }},\n  "table_talk": {{\n    "message": "对其他玩家的发言内容",\n    "tone": "发言语气"\n  }}\n}}\n', 'round_summary': '请总结本轮游戏的关键信息:\n\n牌局信息:\n- 阶段: {phase}\n- 手牌: {hand_cards}\n- 公共牌: {community_cards}\n- 最终底池: {pot_size}\n- 获得筹码: {chips_won}\n\n玩家动作:\n{player_actions}\n\n警告：这是一个严格的格式要求！\n1. 你必须只返回一个原始的JSON对象\n2. 禁止使用任何markdown标记（如```json）\n3. 禁止在JSON前后添加任何其他字符\n4. 禁止添加任何额外的换行或缩进\n5. 违反以上任何一条都将导致解析错误\n\n直接返回以下格式的JSON:\n{{\n  "analysis": {{\n    "strategy_patterns": ["策略模式分析"],\n    "key_decisions": ["关键决策分析"],\n    "improvements": ["改进建议"]\n  }},\n  "metadata": {{\n    "importance": "重要性评分(1-5)",\n    "tags": ["相关标签"]\n  }}\n}} \n'}, 'memory': {'short_term': {'max_rounds': 10}, 'long_term': {'collection': 'poker_memories', 'max_results': 5, 'similarity_threshold': 0.8, 'pruning_days': 30}}}
2025-03-10 23:04:39,994 - src.agents.llm - INFO - LLM Agent ai_4 初始化完成，使用模型 openai/qwen-max，性格: 擅长使用策略和心理战术
2025-03-10 23:04:39,994 - src.engine.state - INFO - Added player ai_4 with 1000 chips at position 4
2025-03-10 23:04:39,995 - src.engine.game - INFO - Added player ai_4 to game ebfe7e47-85cc-4107-ada1-d8466e0d6d6e
2025-03-10 23:04:39,995 - server - INFO - 成功创建AI玩家: ai_4, 模型: openai/qwen-max
2025-03-10 23:04:39,995 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:04:39,995 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:04:39,995 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♣', '2♦')
2025-03-10 23:04:39,996 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♥', 'J♥')
2025-03-10 23:04:39,996 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♦', '5♦')
2025-03-10 23:04:39,996 - src.engine.game - INFO - 玩家 ai_3 手牌: ('K♠', '3♥')
2025-03-10 23:04:39,996 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♦', '8♥')
2025-03-10 23:04:39,997 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:04:39,997 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:04:39,997 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:04:39,997 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:04:39,997 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:04:39,998 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 23:04:39,998 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:04:39,998 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 23:04:39,998 - server - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 已开始
2025-03-10 23:04:39,999 - server - INFO - 游戏初始状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': []}
2025-03-10 23:04:40,032 - server - INFO - WebSocket连接已建立: ebfe7e47-85cc-4107-ada1-d8466e0d6d6e
2025-03-10 23:04:40,032 - server - INFO - 发送初始游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 40, 'max_raise': 1000, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '3♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:04:40,034 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:04:40,034 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:04:40,034 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:04:40,034 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:04:40,035 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:04:40,035 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:04:48,129 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"K♠3♥是一手较弱的起手牌，不同花色且没有连牌价值，只有一张高牌K","position_analysis":"我在早期位置，已经有人在我前面加注，这种情况下用弱牌继续会很危险","pot_odds":"底池有30，需要下注20才能继续，赔率不太理想，特别是考虑到我的手牌强度","opponent_reads":["ai_2已经加注到20，显示出一定的强度","还有一位玩家在我之后要行动，增加了我被再次加注的风险"]},"table_talk":{"message":"嗯...不太喜欢这手牌的感觉，我弃了。","tone":"平静"}}
2025-03-10 23:04:48,130 - src.agents.llm - INFO - ==================================================

2025-03-10 23:04:48,130 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '嗯...不太喜欢这手牌的感觉，我弃了。', 'tone': '平静'}
2025-03-10 23:04:48,131 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:04:48,131 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:04:48,131 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:04:48,131 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:04:48,131 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:04:48,131 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:04:48,132 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:04:48,132 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:04:48,132 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:04:48,132 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:04:48,132 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:04:48,132 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:04:48,133 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:04:48,133 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:04:48,133 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:04:48,133 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:04:48,133 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:04:48,134 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:04:48,134 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯...不太喜欢这手牌的感觉，我弃了。', 'tone': '平静'}}
2025-03-10 23:04:48,135 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:04:48,135 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:04:48,135 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:04:48,136 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:04:48,136 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:04:48,136 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:04:48,137 - server - INFO - WebSocket连接已断开: fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:48,137 - server - ERROR - 连接已关闭，无法发送游戏状态: fdafd42a-bedb-4d6f-9140-64b7a4851980
2025-03-10 23:04:53,147 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:04:53,148 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:04:53,148 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:04:53,149 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:04:53,149 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:04:53,149 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:05:07,833 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"持有一对8，在前翻牌圈是一个不错的起手牌，特别是在没有人表现出特别强的手牌迹象时。","position_analysis":"处于中间位置，可以采取更积极的策略来获取信息或直接建立底池优势。","pot_odds":"考虑到当前底池大小和我的加注量，这个动作旨在增加底池价值而不至于过度暴露风险。","opponent_reads":["player_0尚未行动，可能在等待更多信息；ai_1和ai_2已经跟注了小额下注，显示出一定的兴趣但不强烈。"]},"table_talk":{"message":"看来大家都挺感兴趣的嘛？那我们就让游戏变得更有趣一点吧！","tone":"轻松自信"}}
2025-03-10 23:05:07,834 - src.agents.llm - INFO - ==================================================

2025-03-10 23:05:07,835 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来大家都挺感兴趣的嘛？那我们就让游戏变得更有趣一点吧！', 'tone': '轻松自信'}
2025-03-10 23:05:07,835 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 60
2025-03-10 23:05:07,835 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 23:05:07,836 - src.engine.state - INFO - 玩家 ai_4 加注到 60 筹码，已标记为已行动
2025-03-10 23:05:07,836 - src.engine.game - INFO - 玩家 ai_4 加注到 60
2025-03-10 23:05:07,836 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 23:05:07,836 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:05:07,836 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:05:07,837 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:07,837 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:05:07,837 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:05:07,837 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:05:07,837 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:07,837 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:05:07,837 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:07,838 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:05:07,838 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:05:07,838 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:05:07,838 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:05:07,838 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♦', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 60}], 'table_talk': {'message': '看来大家都挺感兴趣的嘛？那我们就让游戏变得更有趣一点吧！', 'tone': '轻松自信'}}
2025-03-10 23:05:07,839 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:07,839 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:05:07,839 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:07,840 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:05:07,840 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:05:07,840 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:05:20,776 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:05:20,777 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:05:20.777150', 'table_talk': None}
2025-03-10 23:05:20,778 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:05:20,778 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:05:20,779 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:05:20,779 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:05:20,779 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:05:20,780 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:05:20,780 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:20,780 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:05:20,780 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:05:20,780 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:05:20,781 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:20,781 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 23:05:20,781 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:20,782 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:05:20,782 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:05:20,783 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:05:20,783 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:05:20,784 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♦', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:05:20,784 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:20,784 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_1', 'ai_2', 'ai_4']
2025-03-10 23:05:20,785 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:20,785 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:05:20,785 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:05:20,785 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:05:22,855 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:05:22,856 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:05:22,856 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:05:22,856 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:05:22,856 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:05:22,857 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:05:44,208 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": null, "confidence": "0.85"}, "reasoning": {"hand_strength": "手牌7♥, J♥虽具备同花潜力，但整体牌力较边缘，不足以对抗对手的加注信号", "position_analysis": "处于较早位置，信息较少，面对已有加注的不利局面更需谨慎", "pot_odds": "底池90与后续可能的更大投入比较，不具备足够诱惑力追逐边缘手牌", "opponent_reads": ["ai_4的加注显示出一定牌力", "ai_2前注较低可能只是为了观察局势，整体对局较为激进"]}, "table_talk": {"message": "抱歉各位，这局牌我可不想跟你们打持久战，算我退出吧。", "tone": "冷静中带着果断与轻微讽刺"}}
2025-03-10 23:05:44,208 - src.agents.llm - INFO - ==================================================

2025-03-10 23:05:44,209 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉各位，这局牌我可不想跟你们打持久战，算我退出吧。', 'tone': '冷静中带着果断与轻微讽刺'}
2025-03-10 23:05:44,209 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:05:44,210 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:05:44,210 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:05:44,210 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:05:44,210 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:05:44,210 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:05:44,211 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:05:44,211 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:44,212 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:05:44,212 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:05:44,212 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:05:44,212 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:44,212 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 23:05:44,212 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:44,212 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:05:44,213 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:05:44,213 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:05:44,213 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:05:44,213 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 90, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 940, 'current_bet': 60, 'is_active': True, 'cards': ('8♦', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉各位，这局牌我可不想跟你们打持久战，算我退出吧。', 'tone': '冷静中带着果断与轻微讽刺'}}
2025-03-10 23:05:44,213 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:44,213 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_2', 'ai_4']
2025-03-10 23:05:44,214 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:05:44,214 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:05:44,214 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:05:44,214 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:05:44,216 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:05:44,217 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:05:44,217 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:05:44,217 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:05:44,217 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:05:44,218 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:05:52,023 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌7♦,5♦在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2较为靠前，不利于后续行动","pot_odds":"底池赔率不理想，不值得冒险跟注","opponent_reads":["对手ai_4在PRE_FLOP阶段加注，显示出较强的手牌或策略"]},"table_talk":{"message":"看来你们今天手气不错，我先退一步","tone":"轻松"}}
2025-03-10 23:05:52,024 - src.agents.llm - INFO - ==================================================

2025-03-10 23:05:52,024 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们今天手气不错，我先退一步', 'tone': '轻松'}
2025-03-10 23:05:52,025 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:05:52,025 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:05:52,025 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:05:52,025 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 23:05:52,025 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:05:52,026 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 23:05:52,026 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:05:52,026 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:05:52,026 - src.engine.state - INFO - 玩家 ai_4 获得底池 90 筹码，当前筹码: 1030
2025-03-10 23:05:52,026 - src.engine.game - INFO - 玩家 ai_4 获得底池 90 筹码
2025-03-10 23:05:52,026 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:05:52,026 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 90, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♦', '8♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:05:52,028 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 90, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♦', '8♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1030, 'current_bet': 60, 'is_active': False, 'cards': ('8♦', '8♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们今天手气不错，我先退一步', 'tone': '轻松'}}
2025-03-10 23:05:52,028 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:05:52,029 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:05:52,029 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:05:52,029 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:05:52,029 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:05:52,030 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:05:52,030 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 90, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('8♦', '8♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:05:52,030 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:05:55,013 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:05:55,014 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:05:55,015 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:05:55,015 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:05:55,015 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:05:55,015 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♦', '2♦')
2025-03-10 23:05:55,015 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♠', 'J♦')
2025-03-10 23:05:55,016 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♣', 'Q♥')
2025-03-10 23:05:55,016 - src.engine.game - INFO - 玩家 ai_3 手牌: ('8♥', '10♥')
2025-03-10 23:05:55,016 - src.engine.game - INFO - 玩家 ai_4 手牌: ('10♣', '8♦')
2025-03-10 23:05:55,016 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:05:55,016 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:05:55,016 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-03-10 23:05:55,017 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 23:05:55,017 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 23:05:55,017 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 23:05:55,017 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:05:55,017 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 23:05:57,039 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:05:57,039 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:05:57,040 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:05:57,040 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:05:57,041 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:05:57,041 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:06:10,305 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"20","confidence":"0.5"},"reasoning":{"hand_strength":"手牌10♣, 8♦在预翻牌阶段不算强，但也不至于立即弃牌。","position_analysis":"处于中后位置，有机会观察对手的行为后再做决定。","pot_odds":"跟注需要支付20筹码进入30的底池，考虑到可能看到的翻牌情况，这个赔率是可以接受的。","opponent_reads":["player_0和ai_1尚未行动，他们的反应可以帮助进一步判断；ai_2仅进行了小额下注，显示出试探性或弱牌的可能性；ai_3加注到20，可能是持有较好的起始手牌，也有可能是在尝试控制底池大小。"]},"table_talk":{"message":"让我们看看接下来会发生什么吧。","tone":"轻松"}}
2025-03-10 23:06:10,305 - src.agents.llm - INFO - ==================================================

2025-03-10 23:06:10,306 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我们看看接下来会发生什么吧。', 'tone': '轻松'}
2025-03-10 23:06:10,306 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 23:06:10,306 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 23:06:10,306 - src.engine.state - INFO - 玩家 ai_4 跟注 20 筹码，已标记为已行动
2025-03-10 23:06:10,307 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 23:06:10,307 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 23:06:10,307 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:06:10,307 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:06:10,307 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:10,307 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:06:10,307 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:06:10,308 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:06:10,308 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:10,308 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:06:10,308 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:10,308 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:06:10,308 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:06:10,309 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:10,309 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:06:10,309 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', '2♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', '10♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '让我们看看接下来会发生什么吧。', 'tone': '轻松'}}
2025-03-10 23:06:10,310 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:10,310 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:06:10,311 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:10,311 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:06:10,311 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:06:10,311 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:22,909 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:06:22,909 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:06:22.909618', 'table_talk': None}
2025-03-10 23:06:22,910 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:06:22,910 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:06:22,911 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:06:22,911 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:06:22,911 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:06:22,911 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:06:22,912 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:22,912 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:06:22,912 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:06:22,912 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:06:22,912 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:22,912 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:06:22,912 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:22,913 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:06:22,913 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:06:22,913 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:22,913 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:06:22,913 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('6♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', '10♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:06:22,914 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:22,914 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:06:22,914 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:22,915 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:06:22,915 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:06:22,916 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:25,359 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:06:25,361 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:06:25,361 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:06:25,361 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:06:25,362 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:06:25,362 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:06:47,444 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.85"}, "reasoning": {"hand_strength": "6♠, J♦整体较弱，在PRE_FLOP阶段没有明显优势", "position_analysis": "处于早位，后续行动受限，面对多名活跃对手风险较高", "pot_odds": "现有底池50，需支付20跟注，但多方参与使底池获胜概率降低", "opponent_reads": ["ai_4选择CALL显示出一定强度", "其他对手均处于激活状态，可能持有更好手牌"]}, "table_talk": {"message": "看来今晚风向不利，放弃这局，寻找更合适的时机", "tone": "冷静而略带冷嘲"} }
2025-03-10 23:06:47,445 - src.agents.llm - INFO - ==================================================

2025-03-10 23:06:47,445 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今晚风向不利，放弃这局，寻找更合适的时机', 'tone': '冷静而略带冷嘲'}
2025-03-10 23:06:47,446 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:06:47,446 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:06:47,446 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:06:47,446 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:06:47,446 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:06:47,447 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:06:47,447 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:06:47,447 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:47,447 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:06:47,447 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:06:47,447 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:06:47,447 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:47,447 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 23:06:47,447 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:47,447 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:06:47,447 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:06:47,448 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:47,448 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:06:47,448 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', '10♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今晚风向不利，放弃这局，寻找更合适的时机', 'tone': '冷静而略带冷嘲'}}
2025-03-10 23:06:47,448 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:47,449 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 23:06:47,449 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:47,449 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:06:47,450 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:06:47,450 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:47,451 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:06:47,452 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:06:47,452 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:06:47,452 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:06:47,452 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:06:47,453 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:06:54,355 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌7♣和Q♥在PRE_FLOP阶段强度较低，没有明显的优势","position_analysis":"位置2在PRE_FLOP阶段相对不利，无法有效观察其他玩家的行动","pot_odds":"底池赔率不足以支持继续跟注或加注","opponent_reads":["ai_4选择了CALL，可能持有中等强度的牌，ai_3尚未行动，可能持有较强的牌"]},"table_talk":{"message":"看来我的手牌不够强，我选择弃牌","tone":"冷静"}}
2025-03-10 23:06:54,356 - src.agents.llm - INFO - ==================================================

2025-03-10 23:06:54,356 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我的手牌不够强，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:06:54,356 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:06:54,356 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:06:54,357 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:06:54,357 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:06:54,357 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:06:54,357 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:06:54,357 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:06:54,357 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:54,358 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:06:54,358 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:06:54,358 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:06:54,358 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:54,358 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 23:06:54,358 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:54,360 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:06:54,360 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:06:54,360 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:54,360 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:06:54,360 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', '10♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1010, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我的手牌不够强，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:06:54,361 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:06:54,361 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 23:06:54,362 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:06:54,363 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:06:54,363 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:06:54,363 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:06:54,364 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:06:54,364 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:06:54,364 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:06:54,364 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:06:54,365 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:06:54,365 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:07:02,575 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"8♥, 10♥是一对同花听牌，但在德州扑克中属于中下等起手牌。虽然有同花可能，但连接不紧密，形成强牌的概率较低。","position_analysis":"我处于位置3，这是一个相对早的位置，后面还有玩家要行动，位置劣势明显。","pot_odds":"底池为50，需要下注20才能继续游戏，底池赔率约为2.5:1，考虑到我的手牌强度，这个赔率不足以支持我继续游戏。","opponent_reads":["ai_4选择跟注而不是加注，可能手牌强度一般，但愿意参与游戏","其他玩家都选择弃牌，说明他们手牌可能较弱"]},"table_talk":{"message":"这手牌不太理想，我选择保存实力等待更好的机会。","tone":"冷静"}}
2025-03-10 23:07:02,576 - src.agents.llm - INFO - ==================================================

2025-03-10 23:07:02,577 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太理想，我选择保存实力等待更好的机会。', 'tone': '冷静'}
2025-03-10 23:07:02,577 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:07:02,577 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:07:02,577 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:07:02,577 - src.engine.state - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 23:07:02,577 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:07:02,578 - src.engine.game - INFO - 只剩一个活跃玩家: ai_4
2025-03-10 23:07:02,578 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:07:02,578 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:07:02,578 - src.engine.state - INFO - 玩家 ai_4 获得底池 50 筹码，当前筹码: 1060
2025-03-10 23:07:02,579 - src.engine.game - INFO - 玩家 ai_4 获得底池 50 筹码
2025-03-10 23:07:02,579 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:07:02,579 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_4', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♣', '8♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:07:02,579 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_4', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♣', '8♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1060, 'current_bet': 20, 'is_active': False, 'cards': ('10♣', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太理想，我选择保存实力等待更好的机会。', 'tone': '冷静'}}
2025-03-10 23:07:02,580 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:02,580 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:07:02,580 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:07:02,581 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:07:02,581 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:07:02,581 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:07:02,581 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_4', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_4', 'hole_cards': ('10♣', '8♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:07:02,582 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:07:10,623 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:07:10,624 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:07:10,624 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:07:10,624 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:07:10,624 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:07:10,624 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♣', '9♥')
2025-03-10 23:07:10,624 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♥', 'K♥')
2025-03-10 23:07:10,625 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♥', '10♥')
2025-03-10 23:07:10,625 - src.engine.game - INFO - 玩家 ai_3 手牌: ('2♠', 'K♠')
2025-03-10 23:07:10,625 - src.engine.game - INFO - 玩家 ai_4 手牌: ('5♣', 'J♦')
2025-03-10 23:07:10,625 - src.engine.state - INFO - 玩家 ai_3 下注 10 筹码
2025-03-10 23:07:10,625 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 23:07:10,626 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 23:07:10,626 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 23:07:10,626 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 23:07:10,626 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:07:10,626 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:07:10,626 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:07:14,378 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 40}
2025-03-10 23:07:14,378 - server - INFO - 收到加注请求，金额: 40
2025-03-10 23:07:14,378 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 40, 'timestamp': '2025-03-10T23:07:14.378969', 'table_talk': None}
2025-03-10 23:07:14,378 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:07:14,380 - src.engine.state - INFO - 玩家 player_0 加注到 40 筹码，已标记为已行动
2025-03-10 23:07:14,380 - src.engine.game - INFO - 玩家 player_0 加注到 40
2025-03-10 23:07:14,380 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:07:14,381 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:07:14,381 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:07:14,381 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:07:14,381 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:07:14,381 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:07:14,382 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:07:14,382 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:14,382 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:07:14,382 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:07:14,382 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:07:14,382 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:07:14,383 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:07:14,383 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:07:14,383 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:07:14,383 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_1', 'chips': 990, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '10♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('2♠', 'K♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1040, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:07:14,384 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:14,384 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:07:14,384 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:07:14,384 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:07:14,385 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:07:14,385 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:07:14,386 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:07:17,603 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:07:17,604 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:07:17,604 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:07:17,604 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:07:17,604 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:07:17,604 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:07:50,759 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "60", "confidence": "0.7"}, "reasoning": {"hand_strength": "虽然8♥ K♥不是顶级起手牌，但同花色为未来的同花及顺子提供潜力，加上K高可以在多种情况下占据优势", "position_analysis": "作为位置1，我需要建立主动权，利用心理战和策略对抗对手的加注", "pot_odds": "底池70对跟注40的投入算是合理，但希望利用加注获得更有利的赔率和控制局面", "opponent_reads": ["player_0已通过加注展示出一定进攻性，其余玩家目前行动较为保守，可能通过我的激进行动产生畏惧心理"]}, "table_talk": {"message": "各位，今晚就让这副牌点燃战火，我的决定将会证明我的自信和实力！", "tone": "自信且挑衅"}}
2025-03-10 23:07:50,760 - src.agents.llm - INFO - ==================================================

2025-03-10 23:07:50,760 - src.agents.llm - INFO - 成功将字符串金额 60 转换为数字 60.0
2025-03-10 23:07:50,761 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '各位，今晚就让这副牌点燃战火，我的决定将会证明我的自信和实力！', 'tone': '自信且挑衅'}
2025-03-10 23:07:50,761 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 60
2025-03-10 23:07:50,761 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:07:50,761 - src.engine.state - INFO - 玩家 ai_1 加注到 60 筹码，已标记为已行动
2025-03-10 23:07:50,761 - src.engine.game - INFO - 玩家 ai_1 加注到 60
2025-03-10 23:07:50,762 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:07:50,762 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:07:50,762 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:07:50,762 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:07:50,762 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:07:50,762 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:07:50,763 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:07:50,763 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:50,763 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:07:50,763 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:07:50,763 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:07:50,763 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:07:50,764 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:07:50,764 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:07:50,764 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 130, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 60, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('6♥', '10♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('2♠', 'K♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1040, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，今晚就让这副牌点燃战火，我的决定将会证明我的自信和实力！', 'tone': '自信且挑衅'}}
2025-03-10 23:07:50,764 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:50,764 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:07:50,765 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:07:50,765 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:07:50,766 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:07:50,766 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:07:50,767 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:07:50,767 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:07:50,767 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:07:50,769 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:07:50,769 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:07:50,769 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:07:56,890 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.7},"reasoning":{"hand_strength":"6♥和10♥是中等偏下的起手牌，没有明显的成牌潜力","position_analysis":"处于中间位置，前面有玩家加注，后面可能有更多玩家跟进","pot_odds":"底池赔率不足以支持继续跟注","opponent_reads":"player_0和ai_1都进行了加注，显示出较强的牌力"},"table_talk":{"message":"看来你们都很自信，我选择退出这局","tone":"轻松"}}
2025-03-10 23:07:56,891 - src.agents.llm - INFO - ==================================================

2025-03-10 23:07:56,891 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们都很自信，我选择退出这局', 'tone': '轻松'}
2025-03-10 23:07:56,892 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:07:56,892 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:07:56,892 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:07:56,892 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:07:56,892 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:07:56,892 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:07:56,893 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:07:56,893 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:07:56,893 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:07:56,893 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:07:56,893 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:07:56,894 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:56,894 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:07:56,894 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:07:56,894 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:07:56,894 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:07:56,895 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:07:56,895 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:07:56,895 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 130, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 60, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('2♠', 'K♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1040, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们都很自信，我选择退出这局', 'tone': '轻松'}}
2025-03-10 23:07:56,896 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:07:56,896 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:07:56,896 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:07:56,896 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:07:56,896 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:07:56,896 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:07:56,897 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:07:56,897 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:07:56,897 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:07:56,898 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:07:56,898 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:07:56,898 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:08:05,318 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"2♠K♠是一手较弱的起手牌，K虽然是高牌，但2是最低点数，且不同花色，没有同花或顺子潜力","position_analysis":"我处于前期位置(位置3)，后面还有玩家要行动，位置较为不利","pot_odds":"当前底池130，我需要跟注60才能继续游戏，底池赔率约为2.17:1，考虑到手牌较弱，这个赔率不足以支持跟注","opponent_reads":["player_0从小盲位置加注到40，显示出一定的强势","ai_1再次加注到60，表明可能拿到了强牌","两位玩家的连续加注表明至少一人可能拿到了强力起手牌"]},"table_talk":{"message":"这手牌不值得战斗，留着火力下一把再战。","tone":"冷静"}}
2025-03-10 23:08:05,319 - src.agents.llm - INFO - ==================================================

2025-03-10 23:08:05,319 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不值得战斗，留着火力下一把再战。', 'tone': '冷静'}
2025-03-10 23:08:05,319 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:08:05,320 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:08:05,320 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:08:05,320 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:08:05,320 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:08:05,320 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:08:05,321 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:08:05,321 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:05,321 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:08:05,322 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:08:05,322 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:08:05,322 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:05,322 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:05,322 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:05,322 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:08:05,322 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:08:05,322 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:08:05,323 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:08:05,323 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 130, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 60, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 1040, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不值得战斗，留着火力下一把再战。', 'tone': '冷静'}}
2025-03-10 23:08:05,324 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:05,324 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:05,325 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:05,325 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:08:05,326 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:08:05,326 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:08:05,328 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:08:05,328 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:08:05,328 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:08:05,328 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:08:05,328 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:08:05,328 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:08:19,001 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"60","confidence":0.65},"reasoning":{"hand_strength":"手牌为J高，不算很强但也不至于立即弃牌。在没有更多信息的情况下，跟注观察对手反应是合理的选择。","position_analysis":"位于中间位置，既不是最早也不是最晚行动，这给了我们一定的灵活性来观察其他玩家的行为后再做决定。","pot_odds":"考虑到底池大小和需要投入的金额，跟注提供了一个合理的赔率来尝试看到翻牌圈。","opponent_reads":["player_0选择了加注，可能持有较好的起始手牌或试图通过激进打法施压；ai_1再次加注显示了更强的手牌或者是在执行一个大的诈唬策略。"]},"table_talk":{"message":"让我们看看接下来会发生什么吧。","tone":"轻松"}}
2025-03-10 23:08:19,002 - src.agents.llm - INFO - ==================================================

2025-03-10 23:08:19,002 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '让我们看看接下来会发生什么吧。', 'tone': '轻松'}
2025-03-10 23:08:19,003 - server - INFO - AI玩家 ai_4 决定执行动作: CALL, 金额: 0
2025-03-10 23:08:19,003 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.CALL
2025-03-10 23:08:19,003 - src.engine.state - INFO - 玩家 ai_4 跟注 40 筹码，已标记为已行动
2025-03-10 23:08:19,004 - src.engine.game - INFO - 玩家 ai_4 跟注
2025-03-10 23:08:19,004 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_4
2025-03-10 23:08:19,004 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:08:19,004 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:08:19,004 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:19,005 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:08:19,005 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:08:19,005 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:08:19,005 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:19,005 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:19,006 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:19,006 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:08:19,006 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:08:19,006 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:08:19,007 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:08:19,007 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 170, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 960, 'current_bet': 40, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 60, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 60, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'CALL', 'last_amount': 0}], 'table_talk': {'message': '让我们看看接下来会发生什么吧。', 'tone': '轻松'}}
2025-03-10 23:08:19,007 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:19,008 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:19,008 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:19,008 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:08:19,008 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:08:19,009 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:08:22,388 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:08:22,388 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:08:22.388838', 'table_talk': None}
2025-03-10 23:08:22,389 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:08:22,389 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:08:22,389 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:08:22,390 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:08:22,390 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:08:22,390 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:08:22,391 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:22,391 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:08:22,391 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:08:22,391 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:08:22,391 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:22,391 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:22,392 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:08:22,392 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:08:22,392 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:08:22,392 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:08:22,392 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:08:22,392 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:08:22,392 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:08:22,393 - src.engine.game - INFO - 活跃玩家数量: 3, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:08:22,393 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:08:22,393 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:08:22,393 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:22,394 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:08:22,394 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:08:22,394 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 23:08:22,395 - src.engine.dealer - INFO - Dealt 3 community cards: ['4♠', '3♣', 'Q♥']
2025-03-10 23:08:22,395 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['4♠', '3♣', 'Q♥']
2025-03-10 23:08:22,395 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_4', 4)]
2025-03-10 23:08:22,396 - src.engine.game - INFO - 庄家位置: 2
2025-03-10 23:08:22,396 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 23:08:22,397 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 23:08:22,397 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 190, 'community_cards': ['4♠', '3♣', 'Q♥'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 1000, 'current_bet': 0, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:08:22,397 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:22,397 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:22,398 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:08:22,398 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:08:22,398 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:08:22,398 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:08:24,021 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:08:24,022 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:08:24,022 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:08:24,023 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:08:24,023 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:08:24,024 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:08:37,527 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"120","confidence":0.75},"reasoning":{"hand_strength":"我的手牌目前看起来不是很强，但是考虑到对手的行为模式，他们可能也在试探。J高牌加上潜在的顺子听牌机会给予了一定的游戏空间。","position_analysis":"处于较晚的位置，这允许我根据其他玩家的动作做出更灵活的决策。","pot_odds":"底池赔率对于继续游戏是有利的，特别是考虑到加注后可能会让一些边缘牌放弃。","opponent_reads":["player_0和ai_1都表现出了对当前手牌的兴趣，通过提高赌注可以测试他们的决心，并且有可能赢得更多筹码。"]},"table_talk":{"message":"看来大家都挺有信心啊，那我也来加点乐趣吧！","tone":"轻松自信"}}
2025-03-10 23:08:37,528 - src.agents.llm - INFO - ==================================================

2025-03-10 23:08:37,528 - src.agents.llm - INFO - 成功将字符串金额 120 转换为数字 120.0
2025-03-10 23:08:37,528 - src.agents.llm - INFO - 生成动作: RAISE 金额: 120 table_talk: {'message': '看来大家都挺有信心啊，那我也来加点乐趣吧！', 'tone': '轻松自信'}
2025-03-10 23:08:37,528 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 120
2025-03-10 23:08:37,529 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 23:08:37,529 - src.engine.state - INFO - 玩家 ai_4 加注到 120 筹码，已标记为已行动
2025-03-10 23:08:37,529 - src.engine.game - INFO - 玩家 ai_4 加注到 120
2025-03-10 23:08:37,529 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 23:08:37,530 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:08:37,530 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:08:37,530 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:08:37,530 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:08:37,530 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:08:37,530 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:08:37,531 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:37,531 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:37,531 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:08:37,531 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:08:37,531 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:08:37,531 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:08:37,531 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:08:37,532 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 310, 'community_cards': ['4♠', '3♣', 'Q♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 940, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 120, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 120}], 'table_talk': {'message': '看来大家都挺有信心啊，那我也来加点乐趣吧！', 'tone': '轻松自信'}}
2025-03-10 23:08:37,532 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:37,533 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:37,533 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:08:37,533 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:08:37,533 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:08:37,534 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:08:50,415 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 240}
2025-03-10 23:08:50,415 - server - INFO - 收到加注请求，金额: 240
2025-03-10 23:08:50,416 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 240, 'timestamp': '2025-03-10T23:08:50.416947', 'table_talk': None}
2025-03-10 23:08:50,416 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:08:50,418 - src.engine.state - INFO - 玩家 player_0 加注到 240 筹码，已标记为已行动
2025-03-10 23:08:50,418 - src.engine.game - INFO - 玩家 player_0 加注到 240
2025-03-10 23:08:50,419 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:08:50,419 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:08:50,420 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:08:50,420 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:08:50,420 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:08:50,420 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:08:50,421 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:08:50,421 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:50,421 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:50,421 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:08:50,421 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:08:50,421 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:08:50,422 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:08:50,422 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:08:50,422 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:08:50,422 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 550, 'community_cards': ['4♠', '3♣', 'Q♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 700, 'current_bet': 240, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 240}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 120, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:08:50,423 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:08:50,424 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:08:50,424 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:08:50,424 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:08:50,424 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:08:50,424 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:08:50,425 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:08:52,552 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:08:52,553 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:08:52,553 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:08:52,553 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:08:52,554 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:08:52,554 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:09:18,364 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌K♥、8♥在翻牌Q♥、4♠、3♣上仅形成高牌，没有形成对子或有力的抽牌机会，手牌整体较弱", "position_analysis": "位置较早，加上面对前面玩家的激进加注，处境不利", "pot_odds": "底池550，对手当前下注240，投入风险过高且回报不足", "opponent_reads": ["player_0和ai_4的连续加注显示出强大信心，可能已经握有比我更有利的牌"]}, "table_talk": {"message": "各位，今天我不会和你们玩命，这手牌太边缘，我选择退出。", "tone": "冷静且果断"}}
2025-03-10 23:09:18,366 - src.agents.llm - INFO - ==================================================

2025-03-10 23:09:18,366 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，今天我不会和你们玩命，这手牌太边缘，我选择退出。', 'tone': '冷静且果断'}
2025-03-10 23:09:18,367 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:09:18,367 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:09:18,367 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:09:18,367 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:09:18,367 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:09:18,367 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:09:18,368 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:09:18,368 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:09:18,368 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:09:18,368 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_4
2025-03-10 23:09:18,368 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:09:18,369 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:09:18,369 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:09:18,369 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:09:18,369 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:09:18,370 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:09:18,370 - src.engine.game - INFO - 玩家 ai_4 下注额(120)不等于最大下注额(240)，回合继续
2025-03-10 23:09:18,370 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:09:18,370 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:09:18,370 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 550, 'community_cards': ['4♠', '3♣', 'Q♥'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 700, 'current_bet': 240, 'is_active': True, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 120, 'is_active': True, 'cards': ('5♣', 'J♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，今天我不会和你们玩命，这手牌太边缘，我选择退出。', 'tone': '冷静且果断'}}
2025-03-10 23:09:18,371 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:09:18,371 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:09:18,372 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:09:18,372 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:09:18,372 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:09:18,372 - src.engine.game - INFO - 玩家 ai_4 下注额(120)不等于最大下注额(240)，回合继续
2025-03-10 23:09:18,373 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:09:18,373 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:09:18,374 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:09:18,374 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:09:18,374 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:09:18,374 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:09:18,375 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:09:32,904 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"","confidence":0.85},"reasoning":{"hand_strength":"我的手牌是5♣, J♦，在翻牌圈4♠, 3♣, Q♥的情况下，并没有形成任何组合。考虑到当前的牌面情况，我的手牌强度较低。","position_analysis":"处于中间位置，虽然有一定的灵活性来观察对手的动作，但鉴于手牌较弱，继续参与的风险大于收益。","pot_odds":"底池赔率为550对至少260的投入，即大约2:1的比例，这并不足以弥补我持有弱牌时的风险。","opponent_reads":["player_0表现出较强的攻击性，连续加注可能意味着他/她持有较好的牌或试图通过施压控制底池。"]},"table_talk":{"message":"这次就让给你们了，祝好运！","tone":"友好"}}
2025-03-10 23:09:32,906 - src.agents.llm - INFO - ==================================================

2025-03-10 23:09:32,906 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次就让给你们了，祝好运！', 'tone': '友好'}
2025-03-10 23:09:32,906 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:09:32,906 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:09:32,907 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:09:32,907 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:09:32,907 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:09:32,907 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:09:32,907 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:09:32,907 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:09:32,908 - src.engine.state - INFO - 玩家 player_0 获得底池 550 筹码，当前筹码: 1250
2025-03-10 23:09:32,908 - src.engine.game - INFO - 玩家 player_0 获得底池 550 筹码
2025-03-10 23:09:32,908 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:09:32,908 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 550, 'winning_hand': None, 'community_cards': ['4♠', '3♣', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('9♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:09:32,908 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['4♠', '3♣', 'Q♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 550, 'winning_hand': None, 'community_cards': ['4♠', '3♣', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('9♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1250, 'current_bet': 240, 'is_active': False, 'cards': ('9♣', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 880, 'current_bet': 120, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次就让给你们了，祝好运！', 'tone': '友好'}}
2025-03-10 23:09:32,909 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:09:32,909 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:09:32,910 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:09:32,910 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:09:32,910 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:09:32,913 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:09:32,914 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 550, 'winning_hand': None, 'community_cards': ['4♠', '3♣', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('9♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:09:32,915 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:09:34,927 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:09:34,928 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:09:34,928 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:09:34,928 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:09:34,929 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:09:34,929 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♣', 'Q♠')
2025-03-10 23:09:34,929 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♣', '8♦')
2025-03-10 23:09:34,929 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', 'Q♥')
2025-03-10 23:09:34,929 - src.engine.game - INFO - 玩家 ai_3 手牌: ('3♥', '2♥')
2025-03-10 23:09:34,930 - src.engine.game - INFO - 玩家 ai_4 手牌: ('K♥', '4♠')
2025-03-10 23:09:34,930 - src.engine.state - INFO - 玩家 ai_4 下注 10 筹码
2025-03-10 23:09:34,930 - src.engine.game - INFO - 玩家 ai_4 下注小盲注 10
2025-03-10 23:09:34,930 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:09:34,930 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:09:34,931 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_4(10)，大盲注=player_0(20)
2025-03-10 23:09:34,931 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:09:34,931 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:09:34,931 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:09:37,919 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:09:37,919 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:09:37,920 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:09:37,920 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:09:37,921 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:09:37,921 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:10:14,883 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"0","confidence":"0.8"},"reasoning":{"hand_strength":"10♣,8♦属于边缘手牌，缺乏足够的高牌优势和连牌潜力，不具备主动进攻的实力","position_analysis":"作为早位玩家，之后还有多人未行动，轻易进池容易陷入被动局面","pot_odds":"底池30需要跟注20，数学赔率尚可，但综合风险和手牌潜力评估不足以支撑投入","opponent_reads":["player_0已加注显示强势，其他对手动作谨慎，整体局面不利于用弱牌冒险"]},"table_talk":{"message":"各位，很遗憾，今天这手牌实在不够分，先让给大家，祝你们好运。","tone":"冷静"}}
2025-03-10 23:10:14,884 - src.agents.llm - INFO - ==================================================

2025-03-10 23:10:14,884 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，很遗憾，今天这手牌实在不够分，先让给大家，祝你们好运。', 'tone': '冷静'}
2025-03-10 23:10:14,884 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:10:14,885 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:10:14,885 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:10:14,885 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:10:14,885 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:10:14,886 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:10:14,886 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:10:14,886 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:10:14,887 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:10:14,887 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:10:14,887 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:10:14,887 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:14,887 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:10:14,888 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:10:14,888 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:14,888 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:14,888 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:14,888 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:10:14,888 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1230, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('3♥', '2♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 10, 'is_active': True, 'cards': ('K♥', '4♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，很遗憾，今天这手牌实在不够分，先让给大家，祝你们好运。', 'tone': '冷静'}}
2025-03-10 23:10:14,889 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:14,889 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:10:14,890 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:10:14,890 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:14,890 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:14,891 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:14,892 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:10:14,892 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:10:14,893 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:10:14,893 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:10:14,893 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:10:14,893 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:10:23,739 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"40","confidence":"0.9"},"reasoning":{"hand_strength":"手牌为Q♣, Q♥，属于强牌，尤其是在PRE_FLOP阶段，有很高的胜率","position_analysis":"位置为2，处于中位，可以观察到其他玩家的行动，有利于做出更明智的决策","pot_odds":"底池为30，当前最大注为20，加注到40，底池赔率为1.5:1，非常有利","opponent_reads":["player_0已经下注20，可能持有中等强度的牌","ai_3尚未行动，可能持牌较弱","ai_4下注10，可能持牌较弱"]},"table_talk":{"message":"看来有人想挑战我的口袋Q，那就让我来加注吧","tone":"自信"}}
2025-03-10 23:10:23,740 - src.agents.llm - INFO - ==================================================

2025-03-10 23:10:23,740 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 23:10:23,741 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来有人想挑战我的口袋Q，那就让我来加注吧', 'tone': '自信'}
2025-03-10 23:10:23,741 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-10 23:10:23,741 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 23:10:23,741 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-10 23:10:23,742 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-10 23:10:23,742 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 23:10:23,742 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:10:23,742 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:10:23,742 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:23,742 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:10:23,743 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:10:23,743 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:10:23,743 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:23,743 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:10:23,743 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:23,743 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:23,743 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:23,743 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:23,745 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:10:23,745 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1230, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('3♥', '2♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 10, 'is_active': True, 'cards': ('K♥', '4♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想挑战我的口袋Q，那就让我来加注吧', 'tone': '自信'}}
2025-03-10 23:10:23,745 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:23,746 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:10:23,746 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:23,746 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:23,746 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:23,746 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:23,747 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:10:23,747 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:10:23,747 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:10:23,747 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:10:23,747 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:10:23,748 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:10:32,326 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"3-2同花是非常弱的起手牌，即使同花，也很难组成强牌。在德州扑克中，这种牌型通常被称为'垃圾牌'。","position_analysis":"我在早期位置，这增加了决策的难度，因为后面还有玩家要行动。在这个位置玩弱牌风险很高。","pot_odds":"当前底池70，需要跟注40，底池赔率约为1.75:1，不足以支持用这么弱的牌跟注。","opponent_reads":["ai_2已经加注到40，表明他可能有一手不错的牌。在这种情况下，我的3-2同花几乎肯定处于劣势。"]},"table_talk":{"message":"这牌不值得打，留着火力打更好的牌吧。","tone":"冷静"}}
2025-03-10 23:10:32,327 - src.agents.llm - INFO - ==================================================

2025-03-10 23:10:32,328 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌不值得打，留着火力打更好的牌吧。', 'tone': '冷静'}
2025-03-10 23:10:32,328 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:10:32,328 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:10:32,328 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:10:32,329 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:10:32,329 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:10:32,329 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:10:32,329 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:10:32,329 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:32,330 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:10:32,330 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:10:32,330 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:10:32,331 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:32,331 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_4']
2025-03-10 23:10:32,331 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:32,331 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:32,331 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:32,332 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:32,332 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:10:32,332 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1230, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 870, 'current_bet': 10, 'is_active': True, 'cards': ('K♥', '4♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌不值得打，留着火力打更好的牌吧。', 'tone': '冷静'}}
2025-03-10 23:10:32,333 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:32,333 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_4']
2025-03-10 23:10:32,333 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:32,335 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:32,335 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:32,335 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:32,336 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:10:32,336 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:10:32,337 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:10:32,337 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:10:32,337 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:10:32,338 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:10:45,792 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.5},"reasoning":{"hand_strength":"我的手牌K♥, 4♠在预翻牌阶段并不强，特别是面对已经加注的对手。","position_analysis":"位于中间位置，既不是最早的行动者也不是最晚的，这意味着我需要更强的手牌来采取积极行动。","pot_odds":"考虑到底池大小与所需跟注或加注金额之间的比例，并没有足够的赔率支持我用这手牌继续游戏。","opponent_reads":["ai_2选择了加注，显示出一定的手牌强度或者是在尝试建立形象。"]},"table_talk":{"message":"这次就让给你们了。","tone":"轻松"}}
2025-03-10 23:10:45,793 - src.agents.llm - INFO - ==================================================

2025-03-10 23:10:45,793 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次就让给你们了。', 'tone': '轻松'}
2025-03-10 23:10:45,794 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:10:45,794 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:10:45,794 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:10:45,794 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:10:45,794 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 23:10:45,794 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:10:45,795 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:10:45,795 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:45,795 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:10:45,795 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:10:45,795 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:10:45,795 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:45,795 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:10:45,795 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:45,795 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:45,796 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:45,796 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:45,796 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:10:45,796 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1230, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('Q♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次就让给你们了。', 'tone': '轻松'}}
2025-03-10 23:10:45,797 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:45,797 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:10:45,798 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:10:45,798 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:10:45,798 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:10:45,798 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:10:52,599 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:10:52,599 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:10:52.599281', 'table_talk': None}
2025-03-10 23:10:52,599 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:10:52,600 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:10:52,600 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:10:52,600 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:10:52,600 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:10:52,601 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:10:52,601 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:10:52,601 - src.engine.state - INFO - 玩家 ai_2 获得底池 70 筹码，当前筹码: 1000
2025-03-10 23:10:52,601 - src.engine.game - INFO - 玩家 ai_2 获得底池 70 筹码
2025-03-10 23:10:52,601 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:10:52,602 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♣', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:10:52,602 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♣', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1230, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 930, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 40, 'is_active': False, 'cards': ('Q♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:10:52,602 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:10:52,603 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:10:52,603 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:10:52,603 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:10:52,604 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:10:52,605 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:10:52,606 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♣', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:10:52,607 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:10:53,472 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:10:53,473 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:10:53,473 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:10:53,474 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:10:53,474 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:10:53,474 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♣', '6♠')
2025-03-10 23:10:53,475 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♣', 'Q♦')
2025-03-10 23:10:53,475 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♠', '4♥')
2025-03-10 23:10:53,475 - src.engine.game - INFO - 玩家 ai_3 手牌: ('8♠', '9♣')
2025-03-10 23:10:53,475 - src.engine.game - INFO - 玩家 ai_4 手牌: ('J♥', '8♦')
2025-03-10 23:10:53,477 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:10:53,477 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:10:53,477 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:10:53,477 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:10:53,477 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:10:53,477 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:10:53,477 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:10:53,478 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:10:55,808 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:10:55,809 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:10:55,809 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:10:55,809 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:10:55,810 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:10:55,810 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:11:01,983 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌9♠和4♥在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"处于中间位置，没有明显的优势","pot_odds":"底池赔率不利，不值得冒险跟注","opponent_reads":["对手ai_1已经加注到20，显示出一定的牌力，其他对手尚未行动"]},"table_talk":{"message":"看来这把牌不太适合我，先弃牌观望一下","tone":"轻松"}}
2025-03-10 23:11:01,985 - src.agents.llm - INFO - ==================================================

2025-03-10 23:11:01,985 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这把牌不太适合我，先弃牌观望一下', 'tone': '轻松'}
2025-03-10 23:11:01,985 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:11:01,986 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:11:01,986 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:11:01,986 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:11:01,986 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:11:01,986 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:11:01,986 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:11:01,986 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:01,987 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:11:01,987 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:11:01,987 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:11:01,987 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:01,987 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:11:01,987 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:01,987 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:11:01,988 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:11:01,988 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:01,988 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:11:01,988 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1220, 'current_bet': 10, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 910, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('8♠', '9♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': True, 'cards': ('J♥', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这把牌不太适合我，先弃牌观望一下', 'tone': '轻松'}}
2025-03-10 23:11:01,989 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:01,989 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:11:01,990 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:01,990 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:11:01,991 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:11:01,991 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:01,992 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:11:01,992 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:11:01,993 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:11:01,993 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:11:01,993 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:11:01,993 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:11:10,767 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"8♠9♣是一个中等偏弱的起手牌。虽然是连牌，但不同花色，没有高牌价值，形成顺子的潜力有限。","position_analysis":"我处于相对早的位置(位置3)，这意味着在我之后还有玩家要行动，增加了我被再次加注的风险。","pot_odds":"当前底池30，需要跟注20，底池赔率为1.5:1，考虑到我的牌力不足，这不是一个有利的跟注。","opponent_reads":["ai_1已经加注到20，显示出一定的牌力","其他玩家还未行动，存在被再次加注的风险"]},"table_talk":{"message":"这手牌不太适合我的风格，下一把再战吧。","tone":"平静"}}
2025-03-10 23:11:10,768 - src.agents.llm - INFO - ==================================================

2025-03-10 23:11:10,768 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太适合我的风格，下一把再战吧。', 'tone': '平静'}
2025-03-10 23:11:10,769 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:11:10,769 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:11:10,769 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:11:10,769 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:11:10,770 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:11:10,770 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:11:10,770 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:11:10,770 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:10,770 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:11:10,770 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:11:10,771 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:11:10,771 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:10,771 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:11:10,771 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:10,771 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:11:10,772 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:11:10,772 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:10,772 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:11:10,773 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1220, 'current_bet': 10, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 910, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': True, 'cards': ('J♥', '8♦'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太适合我的风格，下一把再战吧。', 'tone': '平静'}}
2025-03-10 23:11:10,773 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:10,773 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:11:10,773 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:10,773 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:11:10,774 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:11:10,774 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:10,775 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:11:10,775 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:11:10,775 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:11:10,775 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:11:10,775 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:11:10,776 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:11:23,947 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.75},"reasoning":{"hand_strength":"J8o是一手较弱的手牌，在没有位置优势的情况下很难玩。","position_analysis":"处于中间位置，行动空间有限。","pot_odds":"考虑到需要投入的筹码量与潜在回报不成正比。","opponent_reads":["ai_1选择加注可能意味着持有较强的手牌或采取侵略性策略。"]},"table_talk":{"message":"这次我放弃，但下次可不会这么容易让步了。","tone":"轻松自信"}}
2025-03-10 23:11:23,947 - src.agents.llm - INFO - ==================================================

2025-03-10 23:11:23,948 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我放弃，但下次可不会这么容易让步了。', 'tone': '轻松自信'}
2025-03-10 23:11:23,948 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:11:23,948 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:11:23,949 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:11:23,949 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:11:23,949 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 23:11:23,949 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:11:23,950 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:11:23,950 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:23,950 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:11:23,950 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:11:23,951 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:11:23,951 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:23,951 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:11:23,951 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:23,951 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:11:23,951 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:11:23,952 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:23,952 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:11:23,952 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1220, 'current_bet': 10, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 910, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我放弃，但下次可不会这么容易让步了。', 'tone': '轻松自信'}}
2025-03-10 23:11:23,953 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:23,953 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:11:23,954 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:23,954 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:11:23,954 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:11:23,955 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:51,228 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:11:51,228 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:11:51.228927', 'table_talk': None}
2025-03-10 23:11:51,228 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:11:51,229 - src.engine.state - INFO - 玩家 player_0 跟注 10 筹码，已标记为已行动
2025-03-10 23:11:51,229 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:11:51,229 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:11:51,229 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:11:51,229 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:11:51,229 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:51,230 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:11:51,230 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:11:51,230 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:11:51,230 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:51,230 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:11:51,230 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:51,231 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:11:51,231 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:11:51,231 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:11:51,231 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:51,231 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:11:51,231 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1210, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 910, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:11:51,232 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:11:51,232 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:11:51,232 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:11:51,232 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:11:51,232 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:11:51,232 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:11:51,234 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:11:54,027 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:11:54,028 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:11:54,028 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:11:54,029 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:11:54,029 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:11:54,030 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:12:12,736 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "60", "confidence": "0.95"}, "reasoning": {"hand_strength": "持有Q♣和Q♦，高对子在翻牌前是很强的起手牌，具有很高的赢率", "position_analysis": "位置良好，对手仅一人并且其行动较为谨慎，主动加注能控制局面", "pot_odds": "底池40，加注至60的投资比例合理，利用主动性更易迫使对手弃牌或暴露弱点", "opponent_reads": ["对手仅选择跟注，可能手牌较弱或在试探，主动加注能获得更多信息"]}, "table_talk": {"message": "今晚，我的王牌将为我证明一切！", "tone": "自信且挑衅"}}
2025-03-10 23:12:12,737 - src.agents.llm - INFO - ==================================================

2025-03-10 23:12:12,738 - src.agents.llm - INFO - 成功将字符串金额 60 转换为数字 60.0
2025-03-10 23:12:12,738 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '今晚，我的王牌将为我证明一切！', 'tone': '自信且挑衅'}
2025-03-10 23:12:12,738 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 60
2025-03-10 23:12:12,738 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:12:12,738 - src.engine.state - INFO - 玩家 ai_1 加注到 60 筹码，已标记为已行动
2025-03-10 23:12:12,739 - src.engine.game - INFO - 玩家 ai_1 加注到 60
2025-03-10 23:12:12,739 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:12:12,739 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:12:12,739 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:12:12,739 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:12,739 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:12:12,740 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:12:12,740 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:12:12,740 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:12:12,740 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:12,740 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:12,741 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:12:12,741 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(60)，回合继续
2025-03-10 23:12:12,741 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:12:12,741 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:12:12,742 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1210, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 870, 'current_bet': 60, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚，我的王牌将为我证明一切！', 'tone': '自信且挑衅'}}
2025-03-10 23:12:12,742 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:12:12,743 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:12,743 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:12,743 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:12:12,743 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(60)，回合继续
2025-03-10 23:12:12,743 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:12:19,993 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:12:19,994 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:12:19.994850', 'table_talk': None}
2025-03-10 23:12:19,995 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:12:19,995 - src.engine.state - INFO - 玩家 player_0 跟注 40 筹码，已标记为已行动
2025-03-10 23:12:19,996 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:12:19,996 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:12:19,996 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:12:19,996 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:12:19,997 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:19,997 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:12:19,997 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:12:19,997 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:12:19,997 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:12:19,997 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:19,998 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:19,998 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:12:19,998 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:12:19,998 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:12:19,998 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:12:19,998 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:12:19,998 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:12:19,998 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:12:20,000 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:12:20,000 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:20,000 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:12:20,000 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:12:20,000 - src.engine.dealer - INFO - Dealt 3 community cards: ['5♦', '7♣', 'A♦']
2025-03-10 23:12:20,001 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['5♦', '7♣', 'A♦']
2025-03-10 23:12:20,001 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:12:20,001 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:12:20,001 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:12:20,001 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:12:20,002 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 120, 'community_cards': ['5♦', '7♣', 'A♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1170, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 870, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:12:20,002 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:12:20,002 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:20,002 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:12:20,002 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:12:20,002 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:12:20,002 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:12:31,532 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 60}
2025-03-10 23:12:31,532 - server - INFO - 收到加注请求，金额: 60
2025-03-10 23:12:31,532 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 60, 'timestamp': '2025-03-10T23:12:31.532207', 'table_talk': None}
2025-03-10 23:12:31,532 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:12:31,532 - src.engine.state - INFO - 玩家 player_0 加注到 60 筹码，已标记为已行动
2025-03-10 23:12:31,533 - src.engine.game - INFO - 玩家 player_0 加注到 60
2025-03-10 23:12:31,533 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:12:31,533 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:12:31,533 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:12:31,533 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:31,534 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:12:31,534 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:12:31,534 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:12:31,535 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:12:31,535 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:31,535 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:31,535 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:12:31,536 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:12:31,536 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:12:31,536 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:12:31,537 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:12:31,537 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 180, 'community_cards': ['5♦', '7♣', 'A♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1110, 'current_bet': 60, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_1', 'chips': 870, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:12:31,537 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:12:31,538 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:12:31,538 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:12:31,538 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:12:31,538 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:12:31,538 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:12:31,539 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:12:32,794 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:12:32,794 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:12:32,795 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:12:32,795 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:12:32,795 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:12:32,796 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:13:00,944 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"80","confidence":"0.7"},"reasoning":{"hand_strength":"手持Q♣和Q♦构成一对高牌，虽然公共牌中出现A，但两Q整体上还是有竞争力的牌型，具有翻盘潜力。","position_analysis":"虽然位置较前，但当前其他玩家纷纷弃牌，对手展现出激进倾向，我可以利用我的牌面优势及心理战术来掌控局面。","pot_odds":"底池180，对手已下注60，跟注成本较低，但利用加注来挤压对手的激进行动可能会带来更大回报。","opponent_reads":["对手曾多次加注，可能试图用激进策略进行虚张声势，也存在拿到A等强牌的可能，但过度激进的行为值得借机反击。"]},"table_talk":{"message":"你这点小动作能吓到我吗？来跟我较量吧！","tone":"自信挑衅"}}
2025-03-10 23:13:00,945 - src.agents.llm - INFO - ==================================================

2025-03-10 23:13:00,946 - src.agents.llm - INFO - 成功将字符串金额 80 转换为数字 80.0
2025-03-10 23:13:00,946 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '你这点小动作能吓到我吗？来跟我较量吧！', 'tone': '自信挑衅'}
2025-03-10 23:13:00,946 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 80
2025-03-10 23:13:00,946 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:13:00,947 - src.engine.state - INFO - 玩家 ai_1 加注到 80 筹码，已标记为已行动
2025-03-10 23:13:00,947 - src.engine.game - INFO - 玩家 ai_1 加注到 80
2025-03-10 23:13:00,947 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:13:00,947 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:13:00,947 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:13:00,948 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:13:00,948 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:13:00,948 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:13:00,948 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:13:00,948 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:00,948 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:00,949 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:13:00,949 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:13:00,949 - src.engine.game - INFO - 玩家 player_0 下注额(60)不等于最大下注额(80)，回合继续
2025-03-10 23:13:00,949 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:00,949 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:13:00,950 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 260, 'community_cards': ['5♦', '7♣', 'A♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1110, 'current_bet': 60, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 790, 'current_bet': 80, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 80}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你这点小动作能吓到我吗？来跟我较量吧！', 'tone': '自信挑衅'}}
2025-03-10 23:13:00,950 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:00,951 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:00,951 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:13:00,952 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:13:00,953 - src.engine.game - INFO - 玩家 player_0 下注额(60)不等于最大下注额(80)，回合继续
2025-03-10 23:13:00,953 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:25,527 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 160}
2025-03-10 23:13:25,527 - server - INFO - 收到加注请求，金额: 160
2025-03-10 23:13:25,528 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 160, 'timestamp': '2025-03-10T23:13:25.528397', 'table_talk': None}
2025-03-10 23:13:25,528 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:13:25,528 - src.engine.state - INFO - 玩家 player_0 加注到 160 筹码，已标记为已行动
2025-03-10 23:13:25,528 - src.engine.game - INFO - 玩家 player_0 加注到 160
2025-03-10 23:13:25,528 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:13:25,529 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:13:25,529 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:13:25,530 - src.engine.game - INFO - 当前最大下注额: 160
2025-03-10 23:13:25,530 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:13:25,530 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:13:25,530 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:13:25,530 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:25,530 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:25,531 - src.engine.game - INFO - 当前最大下注额: 160
2025-03-10 23:13:25,531 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=160, is_all_in=False
2025-03-10 23:13:25,531 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:13:25,531 - src.engine.game - INFO - 玩家 ai_1 下注额(80)不等于最大下注额(160)，回合继续
2025-03-10 23:13:25,531 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:25,531 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:13:25,531 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 360, 'community_cards': ['5♦', '7♣', 'A♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1010, 'current_bet': 160, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 160}, {'id': 'ai_1', 'chips': 790, 'current_bet': 80, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:13:25,532 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:25,532 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:25,532 - src.engine.game - INFO - 当前最大下注额: 160
2025-03-10 23:13:25,532 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=160, is_all_in=False
2025-03-10 23:13:25,532 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:13:25,532 - src.engine.game - INFO - 玩家 ai_1 下注额(80)不等于最大下注额(160)，回合继续
2025-03-10 23:13:25,532 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:26,026 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:13:26,027 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:13:26,027 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:13:26,028 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:13:26,028 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:13:26,028 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:13:49,298 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "180", "confidence": "0.8"}, "reasoning": {"hand_strength": "虽然手中持有Q♣和Q♦是一手优质对子，但翻牌出现A♦让牌面偏弱，存在被对手A牌压制的风险", "position_analysis": "处于较好位置，可以利用后续下注施加压力，迫使对手犯错", "pot_odds": "底池360，对手当前下注160使得追注成本合理，但连续激进动作提醒需要主动争取主动权", "opponent_reads": ["player_0行动激进，可能在利用对手的牌面恐惧进行半诈唬，或确实持有强牌"]}, "table_talk": {"message": "让我们见识一下谁才是真正的敢打敢拼，不怕风险就来跟我对决!", "tone": "自信且挑衅"}}
2025-03-10 23:13:49,299 - src.agents.llm - INFO - ==================================================

2025-03-10 23:13:49,300 - src.agents.llm - INFO - 成功将字符串金额 180 转换为数字 180.0
2025-03-10 23:13:49,300 - src.agents.llm - INFO - 生成动作: RAISE 金额: 180 table_talk: {'message': '让我们见识一下谁才是真正的敢打敢拼，不怕风险就来跟我对决!', 'tone': '自信且挑衅'}
2025-03-10 23:13:49,300 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 180
2025-03-10 23:13:49,300 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:13:49,300 - src.engine.state - INFO - 玩家 ai_1 加注到 180 筹码，已标记为已行动
2025-03-10 23:13:49,301 - src.engine.game - INFO - 玩家 ai_1 加注到 180
2025-03-10 23:13:49,301 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:13:49,301 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:13:49,301 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:13:49,301 - src.engine.game - INFO - 当前最大下注额: 180
2025-03-10 23:13:49,301 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:13:49,302 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:13:49,302 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:13:49,302 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:49,302 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:49,302 - src.engine.game - INFO - 当前最大下注额: 180
2025-03-10 23:13:49,302 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=160, is_all_in=False
2025-03-10 23:13:49,302 - src.engine.game - INFO - 玩家 player_0 下注额(160)不等于最大下注额(180)，回合继续
2025-03-10 23:13:49,303 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:49,303 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:13:49,303 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 460, 'community_cards': ['5♦', '7♣', 'A♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1010, 'current_bet': 160, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 690, 'current_bet': 180, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 180}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '让我们见识一下谁才是真正的敢打敢拼，不怕风险就来跟我对决!', 'tone': '自信且挑衅'}}
2025-03-10 23:13:49,304 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:49,304 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:49,304 - src.engine.game - INFO - 当前最大下注额: 180
2025-03-10 23:13:49,305 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=160, is_all_in=False
2025-03-10 23:13:49,305 - src.engine.game - INFO - 玩家 player_0 下注额(160)不等于最大下注额(180)，回合继续
2025-03-10 23:13:49,305 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:59,529 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 360}
2025-03-10 23:13:59,529 - server - INFO - 收到加注请求，金额: 360
2025-03-10 23:13:59,530 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 360, 'timestamp': '2025-03-10T23:13:59.530259', 'table_talk': None}
2025-03-10 23:13:59,531 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:13:59,531 - src.engine.state - INFO - 玩家 player_0 加注到 360 筹码，已标记为已行动
2025-03-10 23:13:59,531 - src.engine.game - INFO - 玩家 player_0 加注到 360
2025-03-10 23:13:59,532 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:13:59,532 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:13:59,532 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:13:59,532 - src.engine.game - INFO - 当前最大下注额: 360
2025-03-10 23:13:59,532 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:13:59,533 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:13:59,533 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:13:59,534 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:59,534 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:59,534 - src.engine.game - INFO - 当前最大下注额: 360
2025-03-10 23:13:59,535 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=360, is_all_in=False
2025-03-10 23:13:59,535 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=180, is_all_in=False
2025-03-10 23:13:59,535 - src.engine.game - INFO - 玩家 ai_1 下注额(180)不等于最大下注额(360)，回合继续
2025-03-10 23:13:59,535 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:13:59,535 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:13:59,536 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 660, 'community_cards': ['5♦', '7♣', 'A♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 810, 'current_bet': 360, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 360}, {'id': 'ai_1', 'chips': 690, 'current_bet': 180, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:13:59,536 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:13:59,536 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:13:59,536 - src.engine.game - INFO - 当前最大下注额: 360
2025-03-10 23:13:59,537 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=360, is_all_in=False
2025-03-10 23:13:59,537 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=180, is_all_in=False
2025-03-10 23:13:59,537 - src.engine.game - INFO - 玩家 ai_1 下注额(180)不等于最大下注额(360)，回合继续
2025-03-10 23:13:59,537 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:14:04,314 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:14:04,315 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:14:04,315 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:14:04,315 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:14:04,316 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:14:04,316 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:14:29,574 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"360","confidence":"0.7"},"reasoning":{"hand_strength":"虽然口袋QQ本身很强，但公共牌中的A降低了牌力，可能让对手凭借一手A牌占优。","position_analysis":"位置较靠前，采用谨慎策略，避免过度投入以观察后续走势。","pot_odds":"当前底池为660，加上跟注的360总共1020，跟注风险与回报基本平衡，若对手有诈唬机率，依然值得一试。","opponent_reads":["对手此前的激进加注显示出强牌甚至可能拿到A，风险较高，但也有可能是在诈唬。"]},"table_talk":{"message":"牌虽好，但场上形势复杂，咱们慢慢来，看看你还能玩出什么花样！","tone":"冷静中带着一丝挑衅"}}
2025-03-10 23:14:29,575 - src.agents.llm - INFO - ==================================================

2025-03-10 23:14:29,575 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '牌虽好，但场上形势复杂，咱们慢慢来，看看你还能玩出什么花样！', 'tone': '冷静中带着一丝挑衅'}
2025-03-10 23:14:29,576 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:14:29,576 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:14:29,576 - src.engine.state - INFO - 玩家 ai_1 跟注 180 筹码，已标记为已行动
2025-03-10 23:14:29,577 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:14:29,577 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:14:29,577 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:14:29,577 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:14:29,578 - src.engine.game - INFO - 当前最大下注额: 360
2025-03-10 23:14:29,578 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:14:29,578 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:14:29,578 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:14:29,579 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:14:29,579 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:14:29,579 - src.engine.game - INFO - 当前最大下注额: 360
2025-03-10 23:14:29,579 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=360, is_all_in=False
2025-03-10 23:14:29,580 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=360, is_all_in=False
2025-03-10 23:14:29,580 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:14:29,580 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:14:29,580 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:14:29,580 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:14:29,580 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:14:29,580 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:14:29,580 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:14:29,581 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:14:29,581 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:14:29,581 - src.engine.dealer - INFO - Dealt 1 community cards: ['7♦']
2025-03-10 23:14:29,581 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['5♦', '7♣', 'A♦', '7♦']
2025-03-10 23:14:29,581 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:14:29,582 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:14:29,582 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:14:29,582 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:14:29,582 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 840, 'community_cards': ['5♦', '7♣', 'A♦', '7♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 810, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 510, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '牌虽好，但场上形势复杂，咱们慢慢来，看看你还能玩出什么花样！', 'tone': '冷静中带着一丝挑衅'}}
2025-03-10 23:14:29,583 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:14:29,583 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:14:29,584 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:14:29,584 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:14:29,585 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:14:29,585 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:14:54,269 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 100}
2025-03-10 23:14:54,269 - server - INFO - 收到加注请求，金额: 100
2025-03-10 23:14:54,270 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 100, 'timestamp': '2025-03-10T23:14:54.270321', 'table_talk': None}
2025-03-10 23:14:54,270 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:14:54,270 - src.engine.state - INFO - 玩家 player_0 加注到 100 筹码，已标记为已行动
2025-03-10 23:14:54,270 - src.engine.game - INFO - 玩家 player_0 加注到 100
2025-03-10 23:14:54,271 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:14:54,271 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:14:54,271 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:14:54,271 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:14:54,271 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:14:54,272 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:14:54,272 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:14:54,272 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:14:54,272 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:14:54,272 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:14:54,272 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:14:54,272 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:14:54,273 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:14:54,273 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:14:54,273 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:14:54,273 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 940, 'community_cards': ['5♦', '7♣', 'A♦', '7♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 710, 'current_bet': 100, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 100}, {'id': 'ai_1', 'chips': 510, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:14:54,274 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:14:54,274 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:14:54,274 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:14:54,274 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:14:54,274 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:14:54,274 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:14:54,274 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:14:54,652 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:14:54,653 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:14:54,653 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:14:54,654 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:14:54,655 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:14:54,655 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:15:20,914 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "100", "confidence": "0.85"}, "reasoning": {"hand_strength": "虽然Q♣ Q♦本身是高牌，但在A♦, 7♣, 7♦, 5♦的公共牌面上，它组合成了较为稳固的两个对子（7和Q），虽然存在被满堂红或葫芦压制的风险，但在当前局面下并非最差选择。", "position_analysis": "虽然我处于1号位，行动较早，但已知多数对手弃牌且对手player_0多次激进加注，显示出他可能在利用心理战术在试探底池，这给我提供了观察其后续行动的机会。", "pot_odds": "底池已经达到940，而跟注只需100，底池赔率诱人，适当跟注能保持参与并观察对手的下一步动作。", "opponent_reads": ["对手player_0的多次加注可能是真牌也可能是在诈唬，他的行为显示出极大的侵略性，但在这种局面下，他的牌力区间存在不确定性。"]}, "table_talk": {"message": "我选择跟注，冷静观察对方的下一步动作，看看他到底是诈唬还是持牌强劲。", "tone": "自信且镇定"}}
2025-03-10 23:15:20,914 - src.agents.llm - INFO - ==================================================

2025-03-10 23:15:20,915 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我选择跟注，冷静观察对方的下一步动作，看看他到底是诈唬还是持牌强劲。', 'tone': '自信且镇定'}
2025-03-10 23:15:20,915 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:15:20,915 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:15:20,915 - src.engine.state - INFO - 玩家 ai_1 跟注 100 筹码，已标记为已行动
2025-03-10 23:15:20,915 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:15:20,916 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:15:20,916 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:15:20,916 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:15:20,916 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:15:20,916 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:15:20,916 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:15:20,917 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:15:20,917 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:15:20,917 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:15:20,917 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:15:20,917 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:15:20,918 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:15:20,918 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:15:20,918 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:15:20,918 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:15:20,919 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 23:15:20,919 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:15:20,919 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 23:15:20,919 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:15:20,919 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:15:20,920 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:15:20,920 - src.engine.dealer - INFO - Dealt 1 community cards: ['J♣']
2025-03-10 23:15:20,920 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['5♦', '7♣', 'A♦', '7♦', 'J♣']
2025-03-10 23:15:20,920 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:15:20,920 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:15:20,921 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:15:20,921 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:15:20,921 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 1040, 'community_cards': ['5♦', '7♣', 'A♦', '7♦', 'J♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 710, 'current_bet': 0, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 410, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我选择跟注，冷静观察对方的下一步动作，看看他到底是诈唬还是持牌强劲。', 'tone': '自信且镇定'}}
2025-03-10 23:15:20,923 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:15:20,923 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:15:20,923 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:15:20,923 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:15:20,924 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:15:20,924 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:15:40,932 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 300}
2025-03-10 23:15:40,933 - server - INFO - 收到加注请求，金额: 300
2025-03-10 23:15:40,933 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 300, 'timestamp': '2025-03-10T23:15:40.933651', 'table_talk': None}
2025-03-10 23:15:40,933 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:15:40,933 - src.engine.state - INFO - 玩家 player_0 加注到 300 筹码，已标记为已行动
2025-03-10 23:15:40,933 - src.engine.game - INFO - 玩家 player_0 加注到 300
2025-03-10 23:15:40,934 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:15:40,934 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:15:40,934 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:15:40,934 - src.engine.game - INFO - 当前最大下注额: 300
2025-03-10 23:15:40,935 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:15:40,935 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:15:40,936 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:15:40,936 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:15:40,937 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:15:40,937 - src.engine.game - INFO - 当前最大下注额: 300
2025-03-10 23:15:40,938 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=300, is_all_in=False
2025-03-10 23:15:40,938 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:15:40,939 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:15:40,939 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:15:40,940 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:15:40,941 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 1340, 'community_cards': ['5♦', '7♣', 'A♦', '7♦', 'J♣'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 410, 'current_bet': 300, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 300}, {'id': 'ai_1', 'chips': 410, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'Q♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:15:40,942 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:15:40,942 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:15:40,943 - src.engine.game - INFO - 当前最大下注额: 300
2025-03-10 23:15:40,943 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=300, is_all_in=False
2025-03-10 23:15:40,943 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:15:40,943 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:15:40,943 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:15:40,945 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:15:40,945 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:15:40,945 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:15:40,945 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:15:40,945 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:15:40,946 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:16:16,131 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌Q♣, Q♦在这版面上形成的是两对(Q和7)，但由于公共牌包含A, J, 7, 7, 5，这样的牌型容易被全屋或更高的两对击败", "position_analysis": "身处位置1，在对手高压下注后处于不利位置，没有足够筹码支撑冒险", "pot_odds": "底池1340与需要跟注的300相比虽然有一定吸引力，但考虑到潜在风险，赔率不足以支持继续投入", "opponent_reads": ["对手连续激进加注，暗示其牌力较强", "对手的下注线路更可能是为了价值而非诈唬"]}, "table_talk": {"message": "对手今天火力全开，我不愿在牌力不占优势的情况下赔上大部分筹码", "tone": "冷静且果断"}}
2025-03-10 23:16:16,132 - src.agents.llm - INFO - ==================================================

2025-03-10 23:16:16,133 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '对手今天火力全开，我不愿在牌力不占优势的情况下赔上大部分筹码', 'tone': '冷静且果断'}
2025-03-10 23:16:16,133 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:16:16,133 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:16:16,133 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:16:16,134 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:16:16,134 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:16:16,134 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:16:16,134 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:16:16,134 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:16:16,135 - src.engine.state - INFO - 玩家 player_0 获得底池 1340 筹码，当前筹码: 1750
2025-03-10 23:16:16,135 - src.engine.game - INFO - 玩家 player_0 获得底池 1340 筹码
2025-03-10 23:16:16,135 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:16:16,135 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 1340, 'winning_hand': None, 'community_cards': ['5♦', '7♣', 'A♦', '7♦', 'J♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♣', '6♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:16:16,135 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['5♦', '7♣', 'A♦', '7♦', 'J♣'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 1340, 'winning_hand': None, 'community_cards': ['5♦', '7♣', 'A♦', '7♦', 'J♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♣', '6♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1750, 'current_bet': 300, 'is_active': False, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 410, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1000, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '对手今天火力全开，我不愿在牌力不占优势的情况下赔上大部分筹码', 'tone': '冷静且果断'}}
2025-03-10 23:16:16,136 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:16,136 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:16:16,136 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:16:16,137 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:16:16,137 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:16:16,137 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:16:16,138 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 1340, 'winning_hand': None, 'community_cards': ['5♦', '7♣', 'A♦', '7♦', 'J♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♣', '6♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:16:16,139 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:16:18,617 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:16:18,617 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:16:18,617 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:16:18,618 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:16:18,618 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:16:18,618 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♦', '3♦')
2025-03-10 23:16:18,618 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♥', '9♣')
2025-03-10 23:16:18,618 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♦', '6♠')
2025-03-10 23:16:18,618 - src.engine.game - INFO - 玩家 ai_3 手牌: ('J♣', '2♠')
2025-03-10 23:16:18,619 - src.engine.game - INFO - 玩家 ai_4 手牌: ('3♠', 'J♠')
2025-03-10 23:16:18,619 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:16:18,619 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:16:18,619 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:16:18,619 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:16:18,619 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:16:18,620 - src.engine.game - INFO - 当前玩家: ai_3
2025-03-10 23:16:18,620 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:16:18,620 - src.engine.game - INFO - 第一个行动玩家: ai_3, 位置: 3
2025-03-10 23:16:21,122 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:16:21,123 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:16:21,123 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:16:21,123 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:16:21,124 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:16:21,124 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:16:30,101 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"J♣, 2♠是一个非常弱的起手牌，不同花色且没有连牌潜力，2是最低点数，即使J有一定价值，这样的组合整体实力很弱。","position_analysis":"我在位置3，属于中间位置，前面已经有人加注到20，这个位置拿着弱牌跟注不是好选择。","pot_odds":"底池有30，需要跟注20，底池赔率为1.5:1，但我的手牌胜率远低于这个数值，不值得跟注。","opponent_reads":["ai_2已经加注到20，显示出一定的强度","前面已经有一个玩家跟注，说明至少有两个对手可能拿着不错的牌"]},"table_talk":{"message":"这牌不适合战斗，留着火力下把再战。","tone":"轻松"}}
2025-03-10 23:16:30,101 - src.agents.llm - INFO - ==================================================

2025-03-10 23:16:30,101 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌不适合战斗，留着火力下把再战。', 'tone': '轻松'}
2025-03-10 23:16:30,102 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:16:30,102 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:16:30,102 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:16:30,102 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:16:30,102 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:16:30,103 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:16:30,103 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:16:30,103 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:30,103 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:16:30,103 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:16:30,104 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:16:30,104 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:30,104 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:16:30,104 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:30,104 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:16:30,105 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:16:30,105 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:16:30,105 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:16:30,105 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1750, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '3♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': True, 'cards': ('3♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌不适合战斗，留着火力下把再战。', 'tone': '轻松'}}
2025-03-10 23:16:30,106 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:30,106 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:16:30,106 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:30,106 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:16:30,107 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:16:30,107 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:16:30,108 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:16:30,108 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:16:30,108 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:16:30,108 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:16:30,108 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:16:30,108 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:16:45,905 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.5},"reasoning":{"hand_strength":"我的手牌是3♠, J♠，在没有公共牌的情况下，这并不是一个很强的组合。虽然有可能组成顺子或同花，但概率较低。","position_analysis":"我在桌上的位置相对靠后，这意味着我有更多的信息来做出决定，但也意味着如果我选择加注，后面的玩家可能基于我的行动调整他们的策略。","pot_odds":"当前底池为30，而最小加注需要达到40，考虑到我的手牌强度，这个投资回报率并不吸引人。","opponent_reads":["ai_2已经进行了加注，显示出一定的手牌信心；player_0和ai_1尚未表态，但根据他们剩余筹码量来看，都具备较强的反击能力。"]},"table_talk":{"message":"这次就让给你们了，祝好运！","tone":"友好"}}
2025-03-10 23:16:45,906 - src.agents.llm - INFO - ==================================================

2025-03-10 23:16:45,906 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次就让给你们了，祝好运！', 'tone': '友好'}
2025-03-10 23:16:45,906 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:16:45,907 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:16:45,907 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:16:45,907 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:16:45,907 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 23:16:45,907 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:16:45,908 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:16:45,908 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:45,908 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:16:45,908 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:16:45,909 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:16:45,910 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:45,911 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:16:45,912 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:45,912 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:16:45,912 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:16:45,913 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:16:45,913 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:16:45,913 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1750, 'current_bet': 0, 'is_active': True, 'cards': ('Q♦', '3♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次就让给你们了，祝好运！', 'tone': '友好'}}
2025-03-10 23:16:45,914 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:45,914 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:16:45,914 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:45,914 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:16:45,915 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:16:45,915 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:16:56,861 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:16:56,861 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:16:56.861816', 'table_talk': None}
2025-03-10 23:16:56,861 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:16:56,862 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:16:56,862 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:16:56,863 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:16:56,863 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:16:56,864 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:16:56,864 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:56,864 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:16:56,864 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:16:56,864 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:16:56,865 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:56,865 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:16:56,865 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:56,865 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:16:56,865 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:16:56,865 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:16:56,865 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:16:56,866 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:16:56,866 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1730, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '3♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 400, 'current_bet': 10, 'is_active': True, 'cards': ('7♥', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:16:56,866 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:16:56,866 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:16:56,867 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:16:56,867 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:16:56,867 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:16:56,867 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:16:56,867 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:00,954 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:17:00,955 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:17:00,955 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:17:00,955 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:17:00,955 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:17:00,956 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:17:21,789 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "7♥, 9♣在翻牌前属于较弱的起手牌，缺乏足够的潜力来支撑较大投入", "position_analysis": "处于早期位置，应更加谨慎，弃牌能避免后续较大风险", "pot_odds": "虽然底池50，对手下注20，但考虑到手牌赢率低，成本无法合理补偿风险", "opponent_reads": ["player_0可能持有更强的牌力", "ai_2状态活跃，可能准备继续跟注或加注"]}, "table_talk": {"message": "今晚的牌局我不打算冒险，看来运气不会站在我这边。", "tone": "冷静且果断"}}
2025-03-10 23:17:21,790 - src.agents.llm - INFO - ==================================================

2025-03-10 23:17:21,790 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今晚的牌局我不打算冒险，看来运气不会站在我这边。', 'tone': '冷静且果断'}
2025-03-10 23:17:21,791 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:17:21,791 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:17:21,791 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:17:21,791 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:17:21,791 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:17:21,792 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:17:21,792 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:17:21,792 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:21,792 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:17:21,792 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:17:21,792 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:17:21,792 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:21,793 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:17:21,793 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:21,793 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:17:21,793 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:17:21,793 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:17:21,793 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:21,794 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:17:21,794 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1730, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', '3♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': True, 'cards': ('K♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚的牌局我不打算冒险，看来运气不会站在我这边。', 'tone': '冷静且果断'}}
2025-03-10 23:17:21,794 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:21,795 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:17:21,795 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:21,795 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:17:21,795 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:17:21,796 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:17:21,796 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:21,797 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:17:21,797 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:17:21,799 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:17:21,799 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:17:21,799 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:17:21,799 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:17:27,223 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌K♦和6♠在PRE_FLOP阶段较弱，没有明显的优势","position_analysis":"位置2在早期行动，不利于获取更多信息","pot_odds":"底池赔率不高，不值得冒险跟注","opponent_reads":["player_0选择跟注，可能持有较强手牌或试图引诱对手加注"]},"table_talk":{"message":"看来你们这轮很活跃，我先观察一下","tone":"轻松"}}
2025-03-10 23:17:27,224 - src.agents.llm - INFO - ==================================================

2025-03-10 23:17:27,224 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们这轮很活跃，我先观察一下', 'tone': '轻松'}
2025-03-10 23:17:27,224 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:17:27,225 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:17:27,225 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:17:27,225 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:17:27,225 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:17:27,225 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:17:27,226 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:17:27,226 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:17:27,226 - src.engine.state - INFO - 玩家 player_0 获得底池 50 筹码，当前筹码: 1780
2025-03-10 23:17:27,226 - src.engine.game - INFO - 玩家 player_0 获得底池 50 筹码
2025-03-10 23:17:27,227 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:17:27,227 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', '3♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:17:27,227 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', '3♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1780, 'current_bet': 20, 'is_active': False, 'cards': ('Q♦', '3♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 980, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们这轮很活跃，我先观察一下', 'tone': '轻松'}}
2025-03-10 23:17:27,229 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:27,229 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:17:27,229 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:17:27,230 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:17:27,230 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:17:27,230 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:17:27,230 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', '3♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:17:27,231 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:17:31,154 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:17:31,154 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:17:31,155 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:17:31,155 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:17:31,156 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:17:31,156 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♣', 'A♥')
2025-03-10 23:17:31,156 - src.engine.game - INFO - 玩家 ai_1 手牌: ('K♣', '4♥')
2025-03-10 23:17:31,156 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♣', '7♥')
2025-03-10 23:17:31,157 - src.engine.game - INFO - 玩家 ai_3 手牌: ('8♣', '2♠')
2025-03-10 23:17:31,157 - src.engine.game - INFO - 玩家 ai_4 手牌: ('4♠', '9♠')
2025-03-10 23:17:31,157 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:17:31,157 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:17:31,157 - src.engine.state - INFO - 玩家 ai_3 下注 20 筹码
2025-03-10 23:17:31,157 - src.engine.game - INFO - 玩家 ai_3 下注大盲注 20
2025-03-10 23:17:31,159 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=ai_3(20)
2025-03-10 23:17:31,159 - src.engine.game - INFO - 当前玩家: ai_4
2025-03-10 23:17:31,159 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:17:31,159 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 23:17:32,240 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:17:32,241 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:17:32,241 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:17:32,241 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:17:32,241 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:17:32,242 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:17:45,823 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.75},"reasoning":{"hand_strength":"手牌4♠, 9♠在没有公共牌的情况下属于较弱的手牌，尤其是考虑到对手中有人已经进行了加注。","position_analysis":"处于中间位置，并非特别有利的位置来尝试控制底池大小或观察更多玩家的行为。","pot_odds":"当前的底池赔率并不支持用这样一手牌跟注或加注。","opponent_reads":["ai_3选择加注可能意味着他持有较好的起始手牌，而其他玩家尚未行动，表明他们可能也在等待更强的手牌。"]},"table_talk":{"message":"这把看起来不太适合我，让给你们了。","tone":"轻松"}}
2025-03-10 23:17:45,824 - src.agents.llm - INFO - ==================================================

2025-03-10 23:17:45,824 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这把看起来不太适合我，让给你们了。', 'tone': '轻松'}
2025-03-10 23:17:45,825 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:17:45,825 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:17:45,825 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:17:45,826 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:17:45,826 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 23:17:45,826 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:17:45,826 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:17:45,826 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:45,826 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:17:45,826 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:17:45,827 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:17:45,827 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:45,827 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 23:17:45,827 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:45,827 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:17:45,827 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:17:45,828 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:45,828 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:17:45,828 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1780, 'current_bet': 0, 'is_active': True, 'cards': ('7♣', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '4♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('5♣', '7♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '2♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这把看起来不太适合我，让给你们了。', 'tone': '轻松'}}
2025-03-10 23:17:45,828 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:45,829 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 23:17:45,829 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:45,829 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:17:45,829 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:17:45,830 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:50,867 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:17:50,867 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:17:50.867473', 'table_talk': None}
2025-03-10 23:17:50,869 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:17:50,869 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:17:50,869 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:17:50,870 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:17:50,870 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:17:50,870 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:17:50,870 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:50,870 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:17:50,871 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:17:50,871 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:17:50,871 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:50,871 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 23:17:50,871 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:50,871 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:17:50,871 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:17:50,871 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:17:50,872 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:50,872 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:17:50,872 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1760, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': True, 'cards': ('K♣', '4♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('5♣', '7♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '2♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:17:50,873 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:17:50,873 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3']
2025-03-10 23:17:50,874 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:17:50,874 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:17:50,875 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:17:50,875 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:17:50,875 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:17:55,839 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:17:55,840 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:17:55,840 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:17:55,841 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:17:55,841 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:17:55,842 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:18:10,562 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": 0, "confidence": 0.9}, "reasoning": {"hand_strength": "K♣和4♥组合较弱，缺乏足够的连贯性和高牌优势", "position_analysis": "作为第一个行动的玩家，处于不利位置，信息较少，且没有优势来冒险", "pot_odds": "底池50较小，加上跟注20后风险较大，不足以补偿投入的风险", "opponent_reads": ["player_0的CALL显示出一定稳健", "其他对手活跃，可能持有更强的牌"]}, "table_talk": {"message": "各位，这局我选择退出，期待下一局找机会反击。", "tone": "冷静且略带挑衅"}}
2025-03-10 23:18:10,563 - src.agents.llm - INFO - ==================================================

2025-03-10 23:18:10,564 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，这局我选择退出，期待下一局找机会反击。', 'tone': '冷静且略带挑衅'}
2025-03-10 23:18:10,564 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:18:10,564 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:18:10,565 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:18:10,565 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:18:10,565 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:18:10,565 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:18:10,566 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:18:10,566 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:10,566 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:18:10,566 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:18:10,567 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:18:10,567 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:10,567 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_3']
2025-03-10 23:18:10,567 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:10,567 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:18:10,567 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:18:10,568 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:18:10,568 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:10,568 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:18:10,568 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1760, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': True, 'cards': ('5♣', '7♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '2♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，这局我选择退出，期待下一局找机会反击。', 'tone': '冷静且略带挑衅'}}
2025-03-10 23:18:10,569 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:10,569 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_2', 'ai_3']
2025-03-10 23:18:10,569 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:10,570 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:18:10,570 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:18:10,570 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:18:10,570 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:10,571 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:18:10,572 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:18:10,572 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:18:10,572 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:18:10,573 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:18:10,573 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:18:18,973 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "FOLD",
    "amount": 0,
    "confidence": 0.9
  },
  "reasoning": {
    "hand_strength": "手牌5♣和7♥在PRE_FLOP阶段非常弱，缺乏成牌潜力",
    "position_analysis": "处于早期位置，不利于后续行动",
    "pot_odds": "当前底池50，需要跟注20，赔率不划算",
    "opponent_reads": ["player_0选择跟注，可能持有较强手牌"]
  },
  "table_talk": {
    "message": "看来这手牌不适合我，先弃牌了",
    "tone": "轻松"
  }
}
2025-03-10 23:18:18,975 - src.agents.llm - INFO - ==================================================

2025-03-10 23:18:18,975 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，先弃牌了', 'tone': '轻松'}
2025-03-10 23:18:18,976 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:18:18,976 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:18:18,976 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:18:18,976 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:18:18,977 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:18:18,977 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:18:18,977 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:18:18,978 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:18,978 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:18:18,978 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:18:18,978 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:18:18,978 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:18,979 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:18:18,979 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:18,979 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:18:18,979 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:18:18,979 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:18:18,980 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:18,980 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:18:18,980 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1760, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('8♣', '2♠'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，先弃牌了', 'tone': '轻松'}}
2025-03-10 23:18:18,981 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:18,981 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:18:18,981 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:18,981 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:18:18,981 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:18:18,982 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:18:18,982 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:18,985 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:18:18,986 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:18:18,986 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:18:18,986 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:18:18,986 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:18:18,986 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:18:26,542 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"8-2 off-suit是德州扑克中最差的起手牌之一，几乎没有对抗价值","position_analysis":"我在相对早的位置(位置3)，后面还有很多玩家可能会加注","pot_odds":"底池有50，需要下注20才能继续，底池赔率为2.5:1，但我的牌太弱，不值得跟注","opponent_reads":["player_0选择跟注而不是加注，可能手牌一般，但仍然比我的8-2强"]},"table_talk":{"message":"这手牌连狗都不玩，我弃了","tone":"轻松幽默"}}
2025-03-10 23:18:26,543 - src.agents.llm - INFO - ==================================================

2025-03-10 23:18:26,543 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌连狗都不玩，我弃了', 'tone': '轻松幽默'}
2025-03-10 23:18:26,543 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:18:26,543 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:18:26,544 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:18:26,544 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:18:26,544 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:18:26,544 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:18:26,544 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:18:26,544 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:18:26,545 - src.engine.state - INFO - 玩家 player_0 获得底池 50 筹码，当前筹码: 1810
2025-03-10 23:18:26,545 - src.engine.game - INFO - 玩家 player_0 获得底池 50 筹码
2025-03-10 23:18:26,545 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:18:26,545 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♣', 'A♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:18:26,545 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♣', 'A♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1810, 'current_bet': 20, 'is_active': False, 'cards': ('7♣', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 870, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌连狗都不玩，我弃了', 'tone': '轻松幽默'}}
2025-03-10 23:18:26,546 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:26,546 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:18:26,546 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:18:26,546 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:18:26,546 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:18:26,548 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:18:26,548 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♣', 'A♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:18:26,548 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:18:27,751 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:18:27,752 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:18:27,752 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:18:27,752 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:18:27,752 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:18:27,753 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♥', '5♥')
2025-03-10 23:18:27,753 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♠', '5♦')
2025-03-10 23:18:27,753 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♦', '8♠')
2025-03-10 23:18:27,753 - src.engine.game - INFO - 玩家 ai_3 手牌: ('Q♥', 'Q♣')
2025-03-10 23:18:27,754 - src.engine.game - INFO - 玩家 ai_4 手牌: ('2♠', 'J♠')
2025-03-10 23:18:27,754 - src.engine.state - INFO - 玩家 ai_3 下注 10 筹码
2025-03-10 23:18:27,754 - src.engine.game - INFO - 玩家 ai_3 下注小盲注 10
2025-03-10 23:18:27,754 - src.engine.state - INFO - 玩家 ai_4 下注 20 筹码
2025-03-10 23:18:27,754 - src.engine.game - INFO - 玩家 ai_4 下注大盲注 20
2025-03-10 23:18:27,754 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_3(10)，大盲注=ai_4(20)
2025-03-10 23:18:27,755 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:18:27,755 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:18:27,756 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:18:30,304 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:18:30,305 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:18:30.305184', 'table_talk': None}
2025-03-10 23:18:30,305 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:18:30,305 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:18:30,305 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:18:30,305 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:18:30,305 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:18:30,305 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:18:30,306 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:30,306 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:18:30,306 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:18:30,306 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:18:30,306 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:30,306 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:18:30,308 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:30,308 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:18:30,308 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:18:30,308 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:30,309 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:18:30,309 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1810, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '5♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('K♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 850, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:18:30,310 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:30,311 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:18:30,311 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:30,312 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:18:30,312 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:18:30,312 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:31,549 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:18:31,550 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:18:31,550 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:18:31,551 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:18:31,551 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:18:31,552 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:18:45,356 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "我的手牌10♠, 5♦在前翻牌阶段非常薄弱，无论从潜在组合还是对子可能性来看都缺乏竞争力。", "position_analysis": "在位置1作为先行动作的玩家，信息劣势明显，加上面对多个已经下注的对手，不利于继续冒险。", "pot_odds": "目前底池较小且已经混入不同下注水平的筹码，跟注的赔率不足以弥补劣势。", "opponent_reads": ["ai_3下注10表示试探，而ai_4下注20可能表明他们持有较强手牌或在施压，这都增加了游戏的不确定性。"]}, "table_talk": {"message": "各位抱歉，我今天不在状态，牌力不够，先行退出。", "tone": "冷静而坦诚"}}
2025-03-10 23:18:45,356 - src.agents.llm - INFO - ==================================================

2025-03-10 23:18:45,358 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位抱歉，我今天不在状态，牌力不够，先行退出。', 'tone': '冷静而坦诚'}
2025-03-10 23:18:45,358 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:18:45,358 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:18:45,358 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:18:45,358 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:18:45,358 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:18:45,358 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:18:45,358 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:18:45,359 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:45,359 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:18:45,359 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:18:45,359 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:18:45,360 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:45,360 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 23:18:45,360 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:45,360 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:18:45,360 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:18:45,361 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:45,361 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:18:45,361 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1810, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('K♦', '8♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 940, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 850, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位抱歉，我今天不在状态，牌力不够，先行退出。', 'tone': '冷静而坦诚'}}
2025-03-10 23:18:45,361 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:45,362 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['ai_2', 'ai_3', 'ai_4']
2025-03-10 23:18:45,362 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:45,362 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:18:45,363 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:18:45,363 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:45,364 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:18:45,364 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:18:45,364 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:18:45,365 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:18:45,365 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:18:45,366 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:18:53,725 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"K♦, 8♠在PRE_FLOP阶段属于中等偏弱的手牌，缺乏强对子或高牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，后续行动可能会受到对手的压制","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["ai_4已经加注到20，显示出一定的手牌强度，可能持有强牌"]},"table_talk":{"message":"看来你们这轮很有信心，我就不跟了。","tone":"轻松"}}
2025-03-10 23:18:53,725 - src.agents.llm - INFO - ==================================================

2025-03-10 23:18:53,726 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们这轮很有信心，我就不跟了。', 'tone': '轻松'}
2025-03-10 23:18:53,726 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:18:53,726 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:18:53,726 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:18:53,726 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:18:53,726 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:18:53,726 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:18:53,728 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:18:53,728 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:53,728 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:18:53,728 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:18:53,728 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:18:53,729 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:53,729 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 23:18:53,729 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:53,729 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:18:53,729 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:18:53,729 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:53,729 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:18:53,730 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1810, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 940, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 850, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们这轮很有信心，我就不跟了。', 'tone': '轻松'}}
2025-03-10 23:18:53,730 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:18:53,730 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 23:18:53,731 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:18:53,731 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:18:53,731 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:18:53,731 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:18:53,732 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:18:53,732 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:18:53,732 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:18:53,733 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:18:53,733 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:18:53,733 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:19:01,610 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":60,"confidence":0.85},"reasoning":{"hand_strength":"口袋对Q是一手非常强的起手牌，在德州扑克中排名前5的起手牌之一。","position_analysis":"我在靠后位置(位置3)，前面三位玩家都已弃牌，只剩下一位对手，这给了我位置优势。","pot_odds":"当前底池30，对手已下注20，我加注到60合理增加底池价值。","opponent_reads":["对手ai_4已下注20，表现出一定兴趣，但前面三位玩家都弃牌了，说明牌局整体可能较弱。"]},"table_talk":{"message":"看来今天大家都很谨慎啊，不过我对自己的牌还是有点信心的。","tone":"自信但不张扬"}}
2025-03-10 23:19:01,611 - src.agents.llm - INFO - ==================================================

2025-03-10 23:19:01,611 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来今天大家都很谨慎啊，不过我对自己的牌还是有点信心的。', 'tone': '自信但不张扬'}
2025-03-10 23:19:01,611 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 60
2025-03-10 23:19:01,612 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 23:19:01,612 - src.engine.state - INFO - 玩家 ai_3 加注到 60 筹码，已标记为已行动
2025-03-10 23:19:01,612 - src.engine.game - INFO - 玩家 ai_3 加注到 60
2025-03-10 23:19:01,612 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_3
2025-03-10 23:19:01,612 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:19:01,613 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:19:01,613 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:19:01,613 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:19:01,613 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:19:01,614 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:19:01,614 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:01,614 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 23:19:01,614 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:19:01,614 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:19:01,614 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:01,615 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 23:19:01,615 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:01,615 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:19:01,615 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1810, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 890, 'current_bet': 60, 'is_active': True, 'cards': ('Q♥', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_4', 'chips': 850, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'J♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天大家都很谨慎啊，不过我对自己的牌还是有点信心的。', 'tone': '自信但不张扬'}}
2025-03-10 23:19:01,616 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:01,616 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_3', 'ai_4']
2025-03-10 23:19:01,617 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:19:01,617 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:19:01,617 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:01,617 - src.engine.game - INFO - 玩家 ai_4 未行动，回合继续
2025-03-10 23:19:01,617 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:01,619 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:19:01,619 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:19:01,620 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:19:01,620 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:19:01,620 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:19:01,620 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:19:13,444 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"","confidence":0.5},"reasoning":{"hand_strength":"手牌2♠, J♠在没有公共牌的情况下属于较弱组合，缺乏直接成牌能力。","position_analysis":"处于中间位置，面对前位玩家的加注，采取保守策略较为合理。","pot_odds":"当前底池为80，需要投入至少80来跟注或加注，考虑到手牌强度，这样的投资回报率不高。","opponent_reads":["ai_3进行了加注，表明其可能持有较好的起始手牌或者是在尝试通过激进打法获取信息/筹码优势。"]},"table_talk":{"message":"这次我选择放弃，祝你好运！","tone":"友好"}}
2025-03-10 23:19:13,445 - src.agents.llm - INFO - ==================================================

2025-03-10 23:19:13,445 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我选择放弃，祝你好运！', 'tone': '友好'}
2025-03-10 23:19:13,445 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:19:13,445 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:19:13,445 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:19:13,445 - src.engine.state - INFO - 只剩一个活跃玩家: ai_3
2025-03-10 23:19:13,445 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:19:13,446 - src.engine.game - INFO - 只剩一个活跃玩家: ai_3
2025-03-10 23:19:13,446 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:19:13,447 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:19:13,447 - src.engine.state - INFO - 玩家 ai_3 获得底池 80 筹码，当前筹码: 970
2025-03-10 23:19:13,447 - src.engine.game - INFO - 玩家 ai_3 获得底池 80 筹码
2025-03-10 23:19:13,447 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:19:13,447 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_3', 'pot_amount': 80, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_3', 'hole_cards': ('Q♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:19:13,448 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_3', 'pot_amount': 80, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_3', 'hole_cards': ('Q♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1810, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 400, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 60, 'is_active': False, 'cards': ('Q♥', 'Q♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 850, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我选择放弃，祝你好运！', 'tone': '友好'}}
2025-03-10 23:19:13,448 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:13,448 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:19:13,448 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:19:13,449 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:19:13,449 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:19:13,449 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:19:13,449 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_3', 'pot_amount': 80, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_3', 'hole_cards': ('Q♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:19:13,450 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:19:15,166 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:19:15,167 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:19:15,167 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:19:15,168 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:19:15,168 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:19:15,168 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♥', '10♦')
2025-03-10 23:19:15,168 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♦', 'K♠')
2025-03-10 23:19:15,169 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♦', 'K♣')
2025-03-10 23:19:15,169 - src.engine.game - INFO - 玩家 ai_3 手牌: ('2♠', 'J♣')
2025-03-10 23:19:15,169 - src.engine.game - INFO - 玩家 ai_4 手牌: ('8♣', '4♠')
2025-03-10 23:19:15,169 - src.engine.state - INFO - 玩家 ai_4 下注 10 筹码
2025-03-10 23:19:15,169 - src.engine.game - INFO - 玩家 ai_4 下注小盲注 10
2025-03-10 23:19:15,169 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:19:15,169 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:19:15,170 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_4(10)，大盲注=player_0(20)
2025-03-10 23:19:15,170 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:19:15,170 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:19:15,170 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:19:18,466 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:19:18,466 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:19:18,466 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:19:18,467 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:19:18,467 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:19:18,467 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:19:36,502 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.7"}, "reasoning": {"hand_strength": "虽然9♦和K♠不是顶级起手牌，但它具备较强的高牌潜力和一定的改进空间。", "position_analysis": "身处早位，必须主动出击，通过加注来掌控局面，迫使对手提前表露弱点。", "pot_odds": "底池为30，加上当前需投入的40，虽然风险增加，但通过施加压力可争取对手弃牌，从长远角度看风险可控。", "opponent_reads": ["player_0的下注显示出主动性，但筹码充裕可能试图利用深筹码优势；", "ai_4的小额下注可能暗示手牌并不强；", "其他对手尚未投入，易受加注威慑。"]}, "table_talk": {"message": "来吧，看看你们有什么好牌，不敢轻松跟我一战！", "tone": "挑衅且自信"}}
2025-03-10 23:19:36,503 - src.agents.llm - INFO - ==================================================

2025-03-10 23:19:36,503 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 23:19:36,504 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '来吧，看看你们有什么好牌，不敢轻松跟我一战！', 'tone': '挑衅且自信'}
2025-03-10 23:19:36,504 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 23:19:36,504 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:19:36,504 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 23:19:36,505 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 23:19:36,505 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:19:36,505 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:19:36,505 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:19:36,506 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:36,506 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:19:36,506 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:19:36,506 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:19:36,506 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:36,507 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:19:36,507 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:36,507 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:36,507 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:19:36,507 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:36,507 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:19:36,508 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1790, 'current_bet': 20, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 40, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('6♦', 'K♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'J♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': True, 'cards': ('8♣', '4♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '来吧，看看你们有什么好牌，不敢轻松跟我一战！', 'tone': '挑衅且自信'}}
2025-03-10 23:19:36,508 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:36,509 - src.engine.game - INFO - 活跃玩家数量: 5, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:19:36,509 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:36,509 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:36,509 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:19:36,509 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:36,510 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:19:36,511 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:19:36,511 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:19:36,511 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:19:36,511 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:19:36,511 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:19:43,578 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌6♦和K♣在PRE_FLOP阶段相对较弱，缺乏潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，难以控制后续行动","pot_odds":"底池赔率较低，不值得冒险跟进","opponent_reads":["ai_1的加注行为表明其手牌较强，可能持有高对或强牌"]},"table_talk":{"message":"看来你们这次手气不错，我选择退出","tone":"轻松"}}
2025-03-10 23:19:43,579 - src.agents.llm - INFO - ==================================================

2025-03-10 23:19:43,579 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们这次手气不错，我选择退出', 'tone': '轻松'}
2025-03-10 23:19:43,579 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:19:43,580 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:19:43,580 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:19:43,580 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:19:43,580 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:19:43,580 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:19:43,581 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:19:43,581 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:43,581 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:19:43,581 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:19:43,582 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:19:43,582 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:43,582 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:19:43,582 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:43,582 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:43,582 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:19:43,583 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:43,583 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:19:43,583 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1790, 'current_bet': 20, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 40, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'J♣'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': True, 'cards': ('8♣', '4♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们这次手气不错，我选择退出', 'tone': '轻松'}}
2025-03-10 23:19:43,584 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:43,584 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:19:43,584 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:43,584 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:43,585 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:19:43,585 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:43,585 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:19:43,586 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:19:43,586 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:19:43,586 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:19:43,586 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:19:43,587 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:19:50,589 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"2♠, J♣是一手非常弱的起手牌，没有同花潜力，没有连牌潜力，只有一张J高牌","position_analysis":"我处于早期位置(位置3)，后面还有玩家要行动，位置不利","pot_odds":"当前底池70，我需要跟注40，底池赔率约为1.75:1，但我的手牌胜率预计低于这个数值","opponent_reads":["ai_1已经加注到40，显示出一定的强度","player_0只是跟注盲注，暂时看不出太多信息"]},"table_talk":{"message":"这手牌不值得战斗，留着火力打更好的牌。","tone":"冷静"}}
2025-03-10 23:19:50,590 - src.agents.llm - INFO - ==================================================

2025-03-10 23:19:50,590 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不值得战斗，留着火力打更好的牌。', 'tone': '冷静'}
2025-03-10 23:19:50,590 - server - INFO - AI玩家 ai_3 决定执行动作: FOLD, 金额: 0
2025-03-10 23:19:50,591 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.FOLD
2025-03-10 23:19:50,591 - src.engine.state - INFO - 玩家 ai_3 弃牌
2025-03-10 23:19:50,591 - src.engine.game - INFO - 玩家 ai_3 弃牌
2025-03-10 23:19:50,591 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_3
2025-03-10 23:19:50,591 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:19:50,591 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:19:50,592 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:50,592 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:19:50,592 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:19:50,592 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:19:50,592 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:50,593 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:19:50,593 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:50,593 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:50,593 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:19:50,594 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:50,594 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:19:50,594 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1790, 'current_bet': 20, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 40, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': True, 'cards': ('8♣', '4♠'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不值得战斗，留着火力打更好的牌。', 'tone': '冷静'}}
2025-03-10 23:19:50,595 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:19:50,595 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:19:50,595 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:19:50,595 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:19:50,595 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:19:50,596 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:19:50,596 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:19:50,596 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:19:50,597 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:19:50,597 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:19:50,597 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:19:50,597 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:20:05,885 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":"0","confidence":0.85},"reasoning":{"hand_strength":"我的手牌是8♣, 4♠，这是一对非常弱的手牌，在没有看到任何公共牌的情况下很难期待能组成强组合。","position_analysis":"我在中间位置行动，这意味着我之后还有玩家可能会采取行动，增加了不确定性。","pot_odds":"当前底池为70，而为了跟注或加注我至少需要投入60，考虑到我的手牌强度，这个赔率并不吸引人。","opponent_reads":["ai_1选择加注到40，显示出他们对自己手牌的信心；其他玩家选择了弃牌，表明他们可能也持有较弱的手牌。"]},"table_talk":{"message":"这次就先让给你们了，好运！","tone":"友好"}}
2025-03-10 23:20:05,886 - src.agents.llm - INFO - ==================================================

2025-03-10 23:20:05,887 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次就先让给你们了，好运！', 'tone': '友好'}
2025-03-10 23:20:05,887 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:20:05,887 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:20:05,888 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:20:05,888 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:20:05,888 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 23:20:05,888 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:20:05,888 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:20:05,889 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:20:05,889 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:20:05,889 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:20:05,889 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:20:05,889 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:05,889 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:05,890 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:20:05,890 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:20:05,890 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:20:05,890 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:20:05,890 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:20:05,891 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1790, 'current_bet': 20, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 40, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次就先让给你们了，好运！', 'tone': '友好'}}
2025-03-10 23:20:05,891 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:05,891 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:05,892 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:20:05,892 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:20:05,892 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:20:05,893 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:20:10,675 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:20:10,675 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:20:10.675575', 'table_talk': None}
2025-03-10 23:20:10,675 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:20:10,675 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:20:10,676 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:20:10,677 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:20:10,677 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:20:10,678 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:20:10,678 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:20:10,678 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:20:10,679 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:20:10,679 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:20:10,679 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:10,679 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:10,679 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:20:10,679 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:20:10,680 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:20:10,680 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:20:10,680 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:20:10,680 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:20:10,680 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:20:10,681 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:20:10,681 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:20:10,681 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:10,681 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:20:10,681 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:20:10,682 - src.engine.dealer - INFO - Dealt 3 community cards: ['5♦', 'J♦', 'A♣']
2025-03-10 23:20:10,682 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['5♦', 'J♦', 'A♣']
2025-03-10 23:20:10,682 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:20:10,682 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 23:20:10,682 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:20:10,683 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:20:10,683 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 90, 'community_cards': ['5♦', 'J♦', 'A♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1770, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:20:10,683 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:10,684 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:10,684 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:10,684 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:20:10,684 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:20:10,684 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:20:24,019 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:20:24,019 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:20:24.019035', 'table_talk': None}
2025-03-10 23:20:24,020 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:20:24,020 - src.engine.state - INFO - 玩家 player_0 跟注 0 筹码，已标记为已行动
2025-03-10 23:20:24,020 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:20:24,020 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:20:24,020 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:20:24,021 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:20:24,021 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:24,021 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:20:24,021 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:20:24,021 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:20:24,021 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:24,022 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:24,022 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:24,022 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:20:24,022 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:20:24,023 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:20:24,023 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:20:24,024 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:20:24,024 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 90, 'community_cards': ['5♦', 'J♦', 'A♣'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1770, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:20:24,025 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:24,025 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:24,026 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:24,026 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:20:24,026 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:20:24,027 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:20:24,028 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:20:25,915 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:20:25,916 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:20:25,917 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:20:25,917 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:20:25,917 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:20:25,917 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:20:51,318 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "40", "confidence": "0.75"}, "reasoning": {"hand_strength": "目前手牌只具备高牌和一定顺子抽牌的潜力，但整体牌力较弱，需要依靠后续牌来改善局面", "position_analysis": "处于早期位置，虽然主动权稍弱，但仍可保持稳健等待更好机会", "pot_odds": "底池较大而跟注成本适中，提供了合理的投入回报比", "opponent_reads": ["player_0选择跟注两次，显示出一定进攻意图但也可能在试探，暂时不宜冒然激进"]}, "table_talk": {"message": "各位，我今天只是先稳住阵脚，等待合适时机再发力！", "tone": "自信而冷静"}}
2025-03-10 23:20:51,319 - src.agents.llm - INFO - ==================================================

2025-03-10 23:20:51,320 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位，我今天只是先稳住阵脚，等待合适时机再发力！', 'tone': '自信而冷静'}
2025-03-10 23:20:51,320 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:20:51,320 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:20:51,320 - src.engine.state - INFO - 玩家 ai_1 跟注 0 筹码，已标记为已行动
2025-03-10 23:20:51,321 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:20:51,321 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:20:51,321 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:20:51,321 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:20:51,322 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:51,322 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:20:51,322 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:20:51,322 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:20:51,322 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:51,322 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:51,322 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:51,322 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:20:51,322 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:20:51,322 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:20:51,322 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:20:51,323 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:20:51,323 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:20:51,323 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:20:51,323 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:20:51,323 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:51,324 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:20:51,324 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:20:51,324 - src.engine.dealer - INFO - Dealt 1 community cards: ['6♥']
2025-03-10 23:20:51,324 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['5♦', 'J♦', 'A♣', '6♥']
2025-03-10 23:20:51,325 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:20:51,325 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 23:20:51,325 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:20:51,325 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:20:51,327 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 90, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1770, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，我今天只是先稳住阵脚，等待合适时机再发力！', 'tone': '自信而冷静'}}
2025-03-10 23:20:51,328 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:20:51,328 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:20:51,328 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:20:51,328 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:20:51,329 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:20:51,329 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:21:05,836 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:21:05,836 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:21:05.836863', 'table_talk': None}
2025-03-10 23:21:05,836 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:21:05,837 - src.engine.state - INFO - 玩家 player_0 跟注 0 筹码，已标记为已行动
2025-03-10 23:21:05,837 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:21:05,837 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:21:05,837 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:21:05,838 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:21:05,838 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:21:05,839 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:21:05,839 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:21:05,839 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:21:05,839 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:21:05,839 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:21:05,839 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:21:05,840 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:21:05,840 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:21:05,840 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:21:05,840 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:21:05,840 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:21:05,841 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 90, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1770, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:21:05,841 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:21:05,841 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:21:05,842 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:21:05,842 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:21:05,842 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:21:05,842 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:21:05,843 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:21:06,357 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:21:06,357 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:21:06,357 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:21:06,359 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:21:06,359 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:21:06,359 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:21:38,052 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CHECK", "amount": 0, "confidence": 0.7}, "reasoning": {"hand_strength": "我的手牌仅是K高，没有配对或其他成牌，整体牌力较弱，无法对抗牌面可能形成的大牌型", "position_analysis": "作为较早行动的位置，我倾向于用观察来避免过度暴露弱点，同时利用后续街道的牌面变化寻找反击机会", "pot_odds": "当前底池90而无需追加投入，CHECK风险较低，可利用后续河牌改善局势", "opponent_reads": ["对手player_0多次跟注显示出较中性的策略，可能持有边缘牌或战术性跟注，增加了我采取冒险加注的风险"]}, "table_talk": {"message": "各位，看清形势，真正的高手懂得等待时机，一步棋走好才是王道！", "tone": "自信且略带挑衅"}}
2025-03-10 23:21:38,053 - src.agents.llm - INFO - ==================================================

2025-03-10 23:21:38,053 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '各位，看清形势，真正的高手懂得等待时机，一步棋走好才是王道！', 'tone': '自信且略带挑衅'}
2025-03-10 23:21:38,053 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-03-10 23:21:38,055 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-03-10 23:21:38,055 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-03-10 23:21:38,055 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-03-10 23:21:38,055 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:21:38,056 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:21:38,056 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:21:38,056 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:21:38,056 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:21:38,056 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:21:38,056 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:21:38,056 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:21:38,057 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:21:38,057 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:21:38,057 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:21:38,057 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:21:38,057 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:21:38,057 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:21:38,058 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 23:21:38,058 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:21:38,058 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 23:21:38,058 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:21:38,058 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:21:38,058 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:21:38,059 - src.engine.dealer - INFO - Dealt 1 community cards: ['Q♥']
2025-03-10 23:21:38,059 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['5♦', 'J♦', 'A♣', '6♥', 'Q♥']
2025-03-10 23:21:38,059 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:21:38,059 - src.engine.game - INFO - 庄家位置: 3
2025-03-10 23:21:38,060 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:21:38,060 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:21:38,060 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 90, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥', 'Q♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1770, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，看清形势，真正的高手懂得等待时机，一步棋走好才是王道！', 'tone': '自信且略带挑衅'}}
2025-03-10 23:21:38,062 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:21:38,062 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:21:38,062 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:21:38,063 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:21:38,063 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:21:38,063 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:00,729 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 120}
2025-03-10 23:22:00,729 - server - INFO - 收到加注请求，金额: 120
2025-03-10 23:22:00,730 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 120, 'timestamp': '2025-03-10T23:22:00.730513', 'table_talk': None}
2025-03-10 23:22:00,730 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:22:00,730 - src.engine.state - INFO - 玩家 player_0 加注到 120 筹码，已标记为已行动
2025-03-10 23:22:00,731 - src.engine.game - INFO - 玩家 player_0 加注到 120
2025-03-10 23:22:00,731 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:22:00,731 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:22:00,731 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:22:00,732 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:22:00,732 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:22:00,732 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:22:00,733 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:22:00,733 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:00,733 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:22:00,733 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:22:00,733 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:22:00,733 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:22:00,735 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:22:00,735 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:00,735 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:22:00,736 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 210, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥', 'Q♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1650, 'current_bet': 120, 'is_active': True, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 120}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'K♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:22:00,737 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:00,738 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:22:00,738 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:22:00,739 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:22:00,739 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:22:00,739 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:22:00,740 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:03,091 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:22:03,092 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:22:03,092 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:22:03,092 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:22:03,093 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:22:03,093 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:22:24,772 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌只有K9，高牌只有A，没有对子、顺子或同花，牌力非常薄弱", "position_analysis": "位置为1，处于较为不利的位置，而且面对对手激进的加注，处境危险", "pot_odds": "底池210但必须跟注120，尽管赔率一般，但鉴于自身极弱的牌力，使得跟注风险过大", "opponent_reads": ["对手多次加注和跟注，表明其可能持有较强的牌，因此采取保守策略最为明智"]}, "table_talk": {"message": "抱歉，今晚运气不佳，我只能退出这一局。", "tone": "冷静且略显果断"}}
2025-03-10 23:22:24,773 - src.agents.llm - INFO - ==================================================

2025-03-10 23:22:24,773 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉，今晚运气不佳，我只能退出这一局。', 'tone': '冷静且略显果断'}
2025-03-10 23:22:24,773 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:22:24,773 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:22:24,774 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:22:24,774 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:22:24,774 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:22:24,774 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:22:24,774 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:22:24,774 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:22:24,775 - src.engine.state - INFO - 玩家 player_0 获得底池 210 筹码，当前筹码: 1860
2025-03-10 23:22:24,775 - src.engine.game - INFO - 玩家 player_0 获得底池 210 筹码
2025-03-10 23:22:24,775 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:22:24,775 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 210, 'winning_hand': None, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '10♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:22:24,775 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥', 'Q♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 210, 'winning_hand': None, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '10♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 1860, 'current_bet': 120, 'is_active': False, 'cards': ('K♥', '10♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 360, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉，今晚运气不佳，我只能退出这一局。', 'tone': '冷静且略显果断'}}
2025-03-10 23:22:24,776 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:24,776 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:22:24,776 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:22:24,777 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:22:24,777 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:22:24,778 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:22:24,778 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 210, 'winning_hand': None, 'community_cards': ['5♦', 'J♦', 'A♣', '6♥', 'Q♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '10♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:22:24,778 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:22:28,418 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:22:28,419 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:22:28,420 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:22:28,420 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_3', 'ai_4']
2025-03-10 23:22:28,421 - src.engine.dealer - INFO - Dealt hole cards to 5 players
2025-03-10 23:22:28,421 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♥', 'K♦')
2025-03-10 23:22:28,421 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♦', '10♣')
2025-03-10 23:22:28,421 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♣', '8♥')
2025-03-10 23:22:28,421 - src.engine.game - INFO - 玩家 ai_3 手牌: ('4♠', '4♥')
2025-03-10 23:22:28,421 - src.engine.game - INFO - 玩家 ai_4 手牌: ('10♥', '3♥')
2025-03-10 23:22:28,422 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:22:28,422 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:22:28,422 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:22:28,422 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:22:28,422 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:22:28,422 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:22:28,423 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:22:28,423 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:22:29,801 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:22:29,802 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:22:29,802 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:22:29,802 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:22:29,803 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:22:29,803 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:22:36,862 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌K♣和8♥在PRE_FLOP阶段相对较弱，缺乏成牌潜力","position_analysis":"处于中间位置，后续玩家可能加注，风险较高","pot_odds":"当前底池较小，不值得冒险跟注或加注","opponent_reads":["player_0下注10，可能持有中等强度手牌","ai_1加注到20，可能持有较强手牌或试图施压"]},"table_talk":{"message":"看来这手牌不太适合我，你们继续吧。","tone":"轻松"}}
2025-03-10 23:22:36,863 - src.agents.llm - INFO - ==================================================

2025-03-10 23:22:36,863 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，你们继续吧。', 'tone': '轻松'}
2025-03-10 23:22:36,864 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:22:36,864 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:22:36,865 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:22:36,865 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:22:36,865 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:22:36,865 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:22:36,866 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:22:36,866 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:22:36,866 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:22:36,866 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_3
2025-03-10 23:22:36,866 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:22:36,867 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:36,867 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:22:36,867 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:22:36,867 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:22:36,867 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:22:36,867 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:36,868 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:22:36,868 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1850, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 970, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('10♥', '3♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，你们继续吧。', 'tone': '轻松'}}
2025-03-10 23:22:36,868 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:36,869 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:22:36,869 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:22:36,869 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:22:36,869 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:22:36,870 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:36,872 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:22:36,872 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:22:36,872 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:22:36,873 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:22:36,873 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:22:36,873 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:22:46,235 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":40,"confidence":0.85},"reasoning":{"hand_strength":"口袋对4是一手中等偏强的起手牌，在9人桌中排名约前25%的起手牌。虽然不是顶级起手牌，但有一定的价值，特别是在没有人大幅加注的情况下。","position_analysis":"我处于相对早的位置(位置3)，这不是最理想的位置，但手上有一对，值得打一打。","pot_odds":"当前底池30，需要下注20才能继续游戏，底池赔率为1.5:1，考虑到我手上有一对，这个赔率足够支持我继续游戏。","opponent_reads":["ai_1已经加注到20，显示出一定的强度，但并不是大幅加注","player_0只是跟注盲注，没有表现出特别的强度","ai_4还未行动，需要谨防其后位加注"]},"table_talk":{"message":"小对子，值得看一看。","tone":"自信但谨慎"}}
2025-03-10 23:22:46,237 - src.agents.llm - INFO - ==================================================

2025-03-10 23:22:46,237 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '小对子，值得看一看。', 'tone': '自信但谨慎'}
2025-03-10 23:22:46,238 - server - INFO - AI玩家 ai_3 决定执行动作: RAISE, 金额: 40
2025-03-10 23:22:46,238 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.RAISE
2025-03-10 23:22:46,238 - src.engine.state - INFO - 玩家 ai_3 加注到 40 筹码，已标记为已行动
2025-03-10 23:22:46,238 - src.engine.game - INFO - 玩家 ai_3 加注到 40
2025-03-10 23:22:46,239 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_3
2025-03-10 23:22:46,239 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:22:46,239 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:22:46,240 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:22:46,240 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:22:46,240 - src.engine.game - INFO - 当前玩家从 ai_3 更新为 ai_4
2025-03-10 23:22:46,240 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:22:46,240 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:46,240 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:22:46,241 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:22:46,241 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:22:46,241 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:22:46,242 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:46,242 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:22:46,242 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1850, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('10♥', '3♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '小对子，值得看一看。', 'tone': '自信但谨慎'}}
2025-03-10 23:22:46,243 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:22:46,243 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_3', 'ai_4']
2025-03-10 23:22:46,243 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:22:46,244 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:22:46,244 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:22:46,244 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:22:46,244 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:22:46,244 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:22:46,245 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:22:46,245 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:22:46,245 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:22:46,245 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:23:06,157 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "FOLD",
    "amount": "",
    "confidence": 0.8
  },
  "reasoning": {
    "hand_strength": "我的手牌是10♥, 3♥，这是一对非常弱的手牌，在没有公共牌的情况下几乎没有任何胜算。",
    "position_analysis": "虽然我在中间位置，但鉴于当前手牌的力量不足，位置优势无法得到充分利用。",
    "pot_odds": "考虑到需要至少加注到60才能继续游戏，而底池只有70，加上我手中的牌力较弱，此时跟注或加注的潜在回报并不理想。",
    "opponent_reads": ["ai_3选择在此阶段加注至40，显示出他可能持有较好的起始手牌；其他玩家要么已经弃牌要么只是跟了小额下注。"]
  },
  "table_talk": {
    "message": "这次我就先放弃了，看看接下来几轮的情况再说吧。",
    "tone": "轻松"
  }
}
2025-03-10 23:23:06,158 - src.agents.llm - INFO - ==================================================

2025-03-10 23:23:06,159 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这次我就先放弃了，看看接下来几轮的情况再说吧。', 'tone': '轻松'}
2025-03-10 23:23:06,159 - server - INFO - AI玩家 ai_4 决定执行动作: FOLD, 金额: 0
2025-03-10 23:23:06,159 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.FOLD
2025-03-10 23:23:06,160 - src.engine.state - INFO - 玩家 ai_4 弃牌
2025-03-10 23:23:06,160 - src.engine.game - INFO - 玩家 ai_4 弃牌
2025-03-10 23:23:06,160 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_4
2025-03-10 23:23:06,160 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:23:06,160 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:23:06,160 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:06,160 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:23:06,161 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:23:06,161 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:23:06,161 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:06,161 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_3']
2025-03-10 23:23:06,161 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:06,161 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:23:06,162 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:23:06,162 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:06,162 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:23:06,162 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1850, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'FOLD', 'last_amount': 0}], 'table_talk': {'message': '这次我就先放弃了，看看接下来几轮的情况再说吧。', 'tone': '轻松'}}
2025-03-10 23:23:06,163 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:06,163 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_3']
2025-03-10 23:23:06,163 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:06,164 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:23:06,164 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:23:06,164 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:11,276 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:23:11,277 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:23:11.277279', 'table_talk': None}
2025-03-10 23:23:11,277 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:23:11,277 - src.engine.state - INFO - 玩家 player_0 跟注 30 筹码，已标记为已行动
2025-03-10 23:23:11,278 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:23:11,278 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:23:11,278 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:23:11,278 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:23:11,278 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:11,279 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:23:11,279 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:23:11,279 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:23:11,279 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:11,279 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_3']
2025-03-10 23:23:11,279 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:11,280 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:23:11,280 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:23:11,280 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:23:11,280 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:11,280 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:23:11,281 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 100, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1820, 'current_bet': 40, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 40, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:23:11,281 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:11,281 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_3']
2025-03-10 23:23:11,281 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:11,282 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:23:11,282 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:23:11,282 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:23:11,282 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:16,165 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:23:16,166 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:23:16,166 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:23:16,167 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:23:16,168 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:23:16,169 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:23:32,553 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "7♦,10♣在preflop阶段属于一手较弱的牌，缺乏足够的升值潜力", "position_analysis": "处于早期位置，需要谨慎行动，不愿在不利局面投入过多筹码", "pot_odds": "跟注40进入100的底池赔率并不足以弥补牌力劣势", "opponent_reads": ["对手展现出一定的激进性，很可能手牌范围较强", "player_0和ai_3的行动暗示他们愿意投入更多筹码"]}, "table_talk": {"message": "不好意思，各位，我这手牌不够硬，不跟你们玩这一局。", "tone": "冷静且略带嘲讽"}}
2025-03-10 23:23:32,553 - src.agents.llm - INFO - ==================================================

2025-03-10 23:23:32,555 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '不好意思，各位，我这手牌不够硬，不跟你们玩这一局。', 'tone': '冷静且略带嘲讽'}
2025-03-10 23:23:32,555 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:23:32,555 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:23:32,555 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:23:32,555 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:23:32,556 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:23:32,556 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:23:32,556 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:23:32,556 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:32,556 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:23:32,556 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:23:32,556 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:23:32,557 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:32,557 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:32,557 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:23:32,557 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:23:32,557 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:23:32,558 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:23:32,558 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:23:32,558 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:23:32,558 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:23:32,559 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:23:32,559 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:23:32,559 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:32,559 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:23:32,559 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 23:23:32,560 - src.engine.dealer - INFO - Dealt 3 community cards: ['Q♦', 'A♥', '2♦']
2025-03-10 23:23:32,560 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['Q♦', 'A♥', '2♦']
2025-03-10 23:23:32,560 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_3', 3)]
2025-03-10 23:23:32,560 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:23:32,560 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:23:32,561 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:23:32,561 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['Q♦', 'A♥', '2♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1820, 'current_bet': 0, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '不好意思，各位，我这手牌不够硬，不跟你们玩这一局。', 'tone': '冷静且略带嘲讽'}}
2025-03-10 23:23:32,561 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:32,562 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:32,562 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:23:32,562 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:23:32,562 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:23:32,562 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:43,297 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 240}
2025-03-10 23:23:43,297 - server - INFO - 收到加注请求，金额: 240
2025-03-10 23:23:43,297 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 240, 'timestamp': '2025-03-10T23:23:43.297457', 'table_talk': None}
2025-03-10 23:23:43,298 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:23:43,298 - src.engine.state - INFO - 玩家 player_0 加注到 240 筹码，已标记为已行动
2025-03-10 23:23:43,298 - src.engine.game - INFO - 玩家 player_0 加注到 240
2025-03-10 23:23:43,299 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:23:43,299 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:23:43,299 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:23:43,300 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:23:43,300 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:23:43,300 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_3
2025-03-10 23:23:43,301 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:23:43,301 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:43,301 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:43,301 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:23:43,301 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:23:43,303 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:23:43,303 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:23:43,303 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:43,304 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:23:43,304 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 340, 'community_cards': ['Q♦', 'A♥', '2♦'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1580, 'current_bet': 240, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 240}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 930, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:23:43,306 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:43,306 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:43,307 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:23:43,307 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:23:43,307 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:23:43,307 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:23:43,307 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:23:47,591 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:23:47,592 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:23:47,592 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:23:47,592 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:23:47,592 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:23:47,592 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:23:59,098 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":240,"confidence":0.75},"reasoning":{"hand_strength":"我手上有一对4，这是一个中等强度的起手牌。在翻牌圈出现Q♦, A♥, 2♦后，我仍然持有一对，但牌面上有A和Q这样的大牌，使得我的一对4相对较弱。","position_analysis":"我在位置3，属于中间位置，位置不是特别有利。player_0在我之后行动，他已经做出了加注，表明他可能有强牌。","pot_odds":"底池现在有340，我需要跟注240才能继续游戏。底池赔率约为1.4:1，考虑到我有一对，虽然不是很强，但值得跟注看转牌。","opponent_reads":["player_0在翻牌圈加注到240，这表明他可能有A或Q配合牌面，或者有更好的口袋对子。但也可能是他在尝试用纯诈唬抢池。","由于我有一对，虽然不强，但有一定改进空间，如果转牌给我发一张4，我将获得三条。"]},"table_talk":{"message":"嗯，有意思的翻牌。我来看看转牌会带来什么惊喜。","tone":"冷静沉着"}}
2025-03-10 23:23:59,099 - src.agents.llm - INFO - ==================================================

2025-03-10 23:23:59,099 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，有意思的翻牌。我来看看转牌会带来什么惊喜。', 'tone': '冷静沉着'}
2025-03-10 23:23:59,099 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 23:23:59,100 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 23:23:59,100 - src.engine.state - INFO - 玩家 ai_3 跟注 240 筹码，已标记为已行动
2025-03-10 23:23:59,100 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 23:23:59,100 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 23:23:59,100 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:23:59,101 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:23:59,101 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:23:59,101 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:23:59,101 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:23:59,101 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:23:59,101 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:59,101 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:59,101 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:23:59,101 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:23:59,103 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:23:59,103 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:23:59,103 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:23:59,103 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:23:59,103 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:23:59,103 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:23:59,103 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:23:59,104 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:59,104 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:23:59,105 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 23:23:59,105 - src.engine.dealer - INFO - Dealt 1 community cards: ['7♣']
2025-03-10 23:23:59,105 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['Q♦', 'A♥', '2♦', '7♣']
2025-03-10 23:23:59,105 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_3', 3)]
2025-03-10 23:23:59,105 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:23:59,106 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:23:59,106 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:23:59,106 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 580, 'community_cards': ['Q♦', 'A♥', '2♦', '7♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1580, 'current_bet': 0, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 690, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，有意思的翻牌。我来看看转牌会带来什么惊喜。', 'tone': '冷静沉着'}}
2025-03-10 23:23:59,107 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:23:59,107 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:23:59,107 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:23:59,107 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:23:59,108 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:23:59,108 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:24:11,178 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 240}
2025-03-10 23:24:11,179 - server - INFO - 收到加注请求，金额: 240
2025-03-10 23:24:11,179 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 240, 'timestamp': '2025-03-10T23:24:11.179334', 'table_talk': None}
2025-03-10 23:24:11,179 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:24:11,180 - src.engine.state - INFO - 玩家 player_0 加注到 240 筹码，已标记为已行动
2025-03-10 23:24:11,180 - src.engine.game - INFO - 玩家 player_0 加注到 240
2025-03-10 23:24:11,180 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:24:11,180 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:24:11,181 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:24:11,181 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:24:11,181 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:24:11,181 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_3
2025-03-10 23:24:11,181 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:24:11,181 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:11,181 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:11,182 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:24:11,182 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:24:11,182 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:24:11,182 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:24:11,182 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:24:11,183 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:24:11,183 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 820, 'community_cards': ['Q♦', 'A♥', '2♦', '7♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1340, 'current_bet': 240, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 240}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 690, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:24:11,183 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:11,183 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:11,183 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:24:11,183 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:24:11,185 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:24:11,185 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:24:11,185 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:24:14,145 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:24:14,146 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:24:14,146 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:24:14,146 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:24:14,146 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:24:14,146 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:24:24,106 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":240,"confidence":0.75},"reasoning":{"hand_strength":"我有一对4，这是一个中等偏弱的底牌对子。公共牌上有Q♦, A♥, 2♦, 7♣，没有形成更强的组合。目前我的手牌强度不高，但有一定的对抗价值。","position_analysis":"我在位置3，不是最有利的位置。player_0在我之后行动，已经展示了强势加注行为。","pot_odds":"底池已有820，我需要跟注240才能继续游戏。底池赔率约为3.4:1，虽然不是特别理想，但考虑到我有一对，值得跟注一次看河牌。","opponent_reads":["player_0在转牌圈连续加注，显示出很强的攻击性，可能有强牌如A配高踢脚或者超对，但也可能是在诈唬。","对手的连续加注表明他对自己的牌很有信心，或者在试图通过施压让我弃牌。"]},"table_talk":{"message":"嗯，你很自信啊。我很好奇河牌会带来什么。","tone":"沉思但略带挑战性"}}
2025-03-10 23:24:24,106 - src.agents.llm - INFO - ==================================================

2025-03-10 23:24:24,107 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '嗯，你很自信啊。我很好奇河牌会带来什么。', 'tone': '沉思但略带挑战性'}
2025-03-10 23:24:24,107 - server - INFO - AI玩家 ai_3 决定执行动作: CALL, 金额: 0
2025-03-10 23:24:24,107 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.CALL
2025-03-10 23:24:24,107 - src.engine.state - INFO - 玩家 ai_3 跟注 240 筹码，已标记为已行动
2025-03-10 23:24:24,107 - src.engine.game - INFO - 玩家 ai_3 跟注
2025-03-10 23:24:24,108 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_3
2025-03-10 23:24:24,108 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:24:24,108 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:24:24,108 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:24:24,109 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:24:24,109 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:24:24,109 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:24:24,109 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:24,109 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:24,109 - src.engine.game - INFO - 当前最大下注额: 240
2025-03-10 23:24:24,109 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:24:24,110 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=240, is_all_in=False
2025-03-10 23:24:24,110 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:24:24,110 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:24:24,110 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:24:24,110 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 23:24:24,111 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:24:24,111 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 23:24:24,111 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:24,111 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:24:24,111 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 23:24:24,112 - src.engine.dealer - INFO - Dealt 1 community cards: ['8♣']
2025-03-10 23:24:24,112 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['Q♦', 'A♥', '2♦', '7♣', '8♣']
2025-03-10 23:24:24,112 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_3', 3)]
2025-03-10 23:24:24,113 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:24:24,113 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:24:24,113 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:24:24,113 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 1060, 'community_cards': ['Q♦', 'A♥', '2♦', '7♣', '8♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 1340, 'current_bet': 0, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 450, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '嗯，你很自信啊。我很好奇河牌会带来什么。', 'tone': '沉思但略带挑战性'}}
2025-03-10 23:24:24,113 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:24,114 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:24,114 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:24:24,115 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:24:24,115 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:24:24,115 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:24:35,382 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 500}
2025-03-10 23:24:35,383 - server - INFO - 收到加注请求，金额: 500
2025-03-10 23:24:35,383 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 500, 'timestamp': '2025-03-10T23:24:35.383953', 'table_talk': None}
2025-03-10 23:24:35,383 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:24:35,383 - src.engine.state - INFO - 玩家 player_0 加注到 500 筹码，已标记为已行动
2025-03-10 23:24:35,384 - src.engine.game - INFO - 玩家 player_0 加注到 500
2025-03-10 23:24:35,384 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:24:35,384 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:24:35,384 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:24:35,385 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 23:24:35,385 - src.engine.game - INFO - 找到下一个玩家: ai_3, 位置: 3
2025-03-10 23:24:35,385 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_3
2025-03-10 23:24:35,385 - src.engine.game - INFO - 更新当前玩家为: ai_3
2025-03-10 23:24:35,386 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:35,386 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:35,386 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 23:24:35,387 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=500, is_all_in=False
2025-03-10 23:24:35,387 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:24:35,387 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:24:35,388 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:24:35,388 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:24:35,388 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 1560, 'community_cards': ['Q♦', 'A♥', '2♦', '7♣', '8♣'], 'current_player': 'ai_3', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 840, 'current_bet': 500, 'is_active': True, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 500}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 450, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', '4♥'), 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:24:35,389 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:35,389 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:35,389 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 23:24:35,389 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=500, is_all_in=False
2025-03-10 23:24:35,389 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:24:35,390 - src.engine.game - INFO - 玩家 ai_3 未行动，回合继续
2025-03-10 23:24:35,390 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:24:39,148 - server - INFO - 当前AI玩家: ai_3
2025-03-10 23:24:39,148 - server - INFO - AI玩家 ai_3 开始观察游戏状态
2025-03-10 23:24:39,150 - src.agents.llm - INFO - AI玩家 ai_3 观察到新的游戏状态
2025-03-10 23:24:39,150 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:24:39,151 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:24:39,151 - src.agents.llm - INFO - 使用模型: openrouter/anthropic/claude-3.7-sonnet
2025-03-10 23:24:48,894 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"ALL_IN","amount":450,"confidence":0.7},"reasoning":{"hand_strength":"我有一对4，但公共牌上没有配合，只是一对小口袋对子。公共牌Q♦, A♥, 2♦, 7♣, 8♣没有给我带来任何改善，没有同花或顺子的可能性。","position_analysis":"我处于不利位置，对手在我之后行动，已经多次加注表明手牌强势。","pot_odds":"底池已经1560，对手加注500，我需要跟注500才能继续游戏，但我只有450筹码。底池赔率约为3.12:1，但我的手牌胜率可能不到25%。","opponent_reads":["对手在河牌轮连续加注，表现出极强的攻击性，很可能拥有强牌如A配对、两对或更好的牌型。","对手的连续加注模式表明他对自己的牌非常有信心，可能是故意在河牌轮施压。"]},"table_talk":{"message":"看来你很确定你的牌是最好的，我只能全下了。让我们看看谁的牌更好吧！","tone":"挑战但友好"}}
2025-03-10 23:24:48,894 - src.agents.llm - INFO - ==================================================

2025-03-10 23:24:48,895 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 450 table_talk: {'message': '看来你很确定你的牌是最好的，我只能全下了。让我们看看谁的牌更好吧！', 'tone': '挑战但友好'}
2025-03-10 23:24:48,895 - server - INFO - AI玩家 ai_3 决定执行动作: ALL_IN, 金额: 450
2025-03-10 23:24:48,895 - src.engine.game - INFO - 处理玩家 ai_3 的行动: ActionType.ALL_IN
2025-03-10 23:24:48,895 - src.engine.state - INFO - 玩家 ai_3 全下 450 筹码，已标记为已行动
2025-03-10 23:24:48,896 - src.engine.game - INFO - 玩家 ai_3 全下
2025-03-10 23:24:48,896 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_3
2025-03-10 23:24:48,896 - src.engine.game - INFO - 已记录玩家 ai_3 的行动
2025-03-10 23:24:48,896 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_3
2025-03-10 23:24:48,897 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 23:24:48,897 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:24:48,897 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:24:48,897 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:24:48,897 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:48,898 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:48,898 - src.engine.game - INFO - 当前最大下注额: 500
2025-03-10 23:24:48,898 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=500, is_all_in=False
2025-03-10 23:24:48,898 - src.engine.game - INFO - 检查玩家 ai_3: has_acted=True, current_bet=450, is_all_in=True
2025-03-10 23:24:48,899 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:24:48,899 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:24:48,899 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:24:48,899 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.RIVER
2025-03-10 23:24:48,899 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:24:48,900 - src.engine.game - INFO - 从阶段 GameStage.RIVER 进入下一阶段
2025-03-10 23:24:48,900 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_3']
2025-03-10 23:24:48,900 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:24:48,900 - src.engine.game - INFO - 重置玩家 ai_3 状态: has_acted=False, current_bet=0
2025-03-10 23:24:48,900 - src.engine.game - INFO - 河牌阶段结束，进入摊牌阶段
2025-03-10 23:24:48,900 - src.engine.game - INFO - 游戏结束，执行结算
2025-03-10 23:24:48,901 - src.engine.game - INFO - 结算时活跃玩家数量: 2
2025-03-10 23:24:48,901 - src.engine.game - INFO - 需要比较牌面大小进行结算
2025-03-10 23:24:48,901 - src.engine.game - INFO - 玩家 player_0 赢得底池 2010
2025-03-10 23:24:48,901 - src.engine.game - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 2010, 'winning_hand': 'PAIR', 'community_cards': ['Q♦', 'A♥', '2♦', '7♣', '8♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♥', 'K♦'), 'hand_rank': 'PAIR', 'is_winner': True}, {'player_id': 'ai_3', 'hole_cards': ('4♠', '4♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}
2025-03-10 23:24:48,901 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:24:48,901 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['Q♦', 'A♥', '2♦', '7♣', '8♣'], 'current_player': None, 'min_raise': 450, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 2010, 'winning_hand': 'PAIR', 'community_cards': ['Q♦', 'A♥', '2♦', '7♣', '8♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♥', 'K♦'), 'hand_rank': 'PAIR', 'is_winner': True}, {'player_id': 'ai_3', 'hole_cards': ('4♠', '4♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}, 'players': [{'id': 'player_0', 'chips': 2850, 'current_bet': 0, 'is_active': False, 'cards': ('Q♥', 'K♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 340, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': ('4♠', '4♥'), 'is_all_in': True, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': 'ALL_IN', 'last_amount': 450}, {'id': 'ai_4', 'chips': 840, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你很确定你的牌是最好的，我只能全下了。让我们看看谁的牌更好吧！', 'tone': '挑战但友好'}}
2025-03-10 23:24:48,902 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:24:48,902 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:24:48,902 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:24:48,904 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:24:48,905 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:24:48,905 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:24:48,905 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 2010, 'winning_hand': 'PAIR', 'community_cards': ['Q♦', 'A♥', '2♦', '7♣', '8♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♥', 'K♦'), 'hand_rank': 'PAIR', 'is_winner': True}, {'player_id': 'ai_3', 'hole_cards': ('4♠', '4♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}
2025-03-10 23:24:48,906 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:24:54,740 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:24:54,740 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:24:54,742 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:24:54,742 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:24:54,742 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:24:54,742 - src.engine.dealer - INFO - Dealt hole cards to 4 players
2025-03-10 23:24:54,742 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♦', 'K♣')
2025-03-10 23:24:54,743 - src.engine.game - INFO - 玩家 ai_1 手牌: ('J♣', '9♣')
2025-03-10 23:24:54,743 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♣', '6♦')
2025-03-10 23:24:54,743 - src.engine.game - INFO - 玩家 ai_4 手牌: ('9♦', 'A♥')
2025-03-10 23:24:54,743 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:24:54,743 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:24:54,743 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:24:54,744 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:24:54,744 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:24:54,744 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:24:54,744 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:24:54,744 - src.engine.game - INFO - 第一个行动玩家: ai_4, 位置: 4
2025-03-10 23:24:58,922 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:24:58,923 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:24:58,923 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:24:58,923 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:24:58,924 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:24:58,924 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:25:14,641 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "RAISE",
    "amount": "100",
    "confidence": "0.8"
  },
  "reasoning": {
    "hand_strength": "持有A高牌，虽然不是最强的手牌但也有一定的竞争力，尤其是在前期。",
    "position_analysis": "处于中后位置，可以观察到其他玩家的动作后再做决定，有利于信息收集。",
    "pot_odds": "考虑到当前底池大小与加注后的回报比例，这样的投资是值得的。",
    "opponent_reads": ["ai_2已经进行了一个标准的加注，可能持有一手中等偏上的手牌。", "player_0尚未行动，可能是等待更多信息或准备反击。"]
  },
  "table_talk": {
    "message": "看来今天运气不错哦！",
    "tone": "轻松自信"
  }
}
2025-03-10 23:25:14,642 - src.agents.llm - INFO - ==================================================

2025-03-10 23:25:14,643 - src.agents.llm - INFO - 成功将字符串金额 100 转换为数字 100.0
2025-03-10 23:25:14,643 - src.agents.llm - INFO - 生成动作: RAISE 金额: 100 table_talk: {'message': '看来今天运气不错哦！', 'tone': '轻松自信'}
2025-03-10 23:25:14,643 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 100
2025-03-10 23:25:14,643 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 23:25:14,644 - src.engine.state - INFO - 玩家 ai_4 加注到 100 筹码，已标记为已行动
2025-03-10 23:25:14,644 - src.engine.game - INFO - 玩家 ai_4 加注到 100
2025-03-10 23:25:14,644 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 23:25:14,644 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:25:14,644 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:25:14,644 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:14,645 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:25:14,645 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:25:14,645 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:25:14,645 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:14,645 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:25:14,646 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:14,646 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:25:14,646 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:25:14,646 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:14,646 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:25:14,646 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 130, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2850, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 330, 'current_bet': 10, 'is_active': True, 'cards': ('J♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 740, 'current_bet': 100, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 100}], 'table_talk': {'message': '看来今天运气不错哦！', 'tone': '轻松自信'}}
2025-03-10 23:25:14,647 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:14,647 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:25:14,648 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:14,648 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:25:14,648 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:25:14,648 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:23,500 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:25:23,501 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:25:23.501939', 'table_talk': None}
2025-03-10 23:25:23,502 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:25:23,502 - src.engine.state - INFO - 玩家 player_0 跟注 100 筹码，已标记为已行动
2025-03-10 23:25:23,503 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:25:23,503 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:25:23,504 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:25:23,504 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:25:23,504 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:23,505 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:25:23,505 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:25:23,505 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:25:23,505 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:23,505 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:25:23,505 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:23,505 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:23,506 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:25:23,506 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:25:23,506 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:23,506 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:25:23,507 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 230, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2750, 'current_bet': 100, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 330, 'current_bet': 10, 'is_active': True, 'cards': ('J♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 740, 'current_bet': 100, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:25:23,507 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:23,507 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:25:23,508 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:23,508 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:23,508 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:25:23,508 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:25:23,508 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:24,656 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:25:24,657 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:25:24,657 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:25:24,657 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:25:24,657 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:25:24,658 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:25:46,346 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "100", "confidence": "0.7"}, "reasoning": {"hand_strength": "J♣, 9♣虽然并非顶级起手牌，但具备同花和顺子潜力，适合在局面较松时试探性跟注", "position_analysis": "位于早期位置，选择稳健策略，不宜在牌力一般时主动加注", "pot_odds": "当前底池较大，跟注成本相对较低，可以在翻牌后寻求盈利机会", "opponent_reads": ["player_0已有跟注迹象，可能持有较强牌", "ai_4的加注显示出一定的主动性和实力", "ai_2较弱的下注可能代表边缘牌或试探性行动"]}, "table_talk": {"message": "各位慢慢看热闹，静等翻牌决定后续动作！", "tone": "冷静且略带试探"} }
2025-03-10 23:25:46,347 - src.agents.llm - INFO - ==================================================

2025-03-10 23:25:46,348 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位慢慢看热闹，静等翻牌决定后续动作！', 'tone': '冷静且略带试探'}
2025-03-10 23:25:46,348 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:25:46,348 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:25:46,349 - src.engine.state - INFO - 玩家 ai_1 跟注 90 筹码，已标记为已行动
2025-03-10 23:25:46,349 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:25:46,350 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:25:46,350 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:25:46,350 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:25:46,350 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:46,350 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:25:46,350 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:25:46,350 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:25:46,350 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:46,351 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:25:46,351 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:46,351 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:46,351 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:46,351 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:25:46,353 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:25:46,354 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:46,354 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:25:46,355 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 320, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2750, 'current_bet': 100, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 240, 'current_bet': 100, 'is_active': True, 'cards': ('J♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 740, 'current_bet': 100, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位慢慢看热闹，静等翻牌决定后续动作！', 'tone': '冷静且略带试探'}}
2025-03-10 23:25:46,355 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:46,356 - src.engine.game - INFO - 活跃玩家数量: 4, 玩家ID: ['player_0', 'ai_1', 'ai_2', 'ai_4']
2025-03-10 23:25:46,356 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:46,356 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:46,356 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:46,356 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:25:46,356 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:25:46,357 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:46,357 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:25:46,358 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:25:46,358 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:25:46,358 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:25:46,358 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:25:46,359 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:25:55,294 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"A♣, 6♦在PRE_FLOP阶段属于中等偏弱的手牌，缺乏后续发展的潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，后续行动会受到限制","pot_odds":"底池赔率不高，投入100跟注的回报率有限","opponent_reads":["player_0筹码充足，可能持有强牌","ai_1筹码较少，可能试图通过跟注进行诈唬","ai_4进行了加注，可能持有较强的手牌或试图控制底池"]},"table_talk":{"message":"看起来你们都很自信，但我选择先观望一下","tone":"冷静"}}
2025-03-10 23:25:55,295 - src.agents.llm - INFO - ==================================================

2025-03-10 23:25:55,296 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看起来你们都很自信，但我选择先观望一下', 'tone': '冷静'}
2025-03-10 23:25:55,296 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:25:55,296 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:25:55,296 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:25:55,296 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:25:55,296 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:25:55,297 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:25:55,297 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:25:55,297 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:55,297 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:25:55,297 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:25:55,298 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:25:55,298 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:55,298 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:25:55,298 - src.engine.game - INFO - 当前最大下注额: 100
2025-03-10 23:25:55,298 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:55,298 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:55,298 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=100, is_all_in=False
2025-03-10 23:25:55,299 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:25:55,299 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:25:55,299 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:25:55,299 - src.engine.game - INFO - 活跃玩家数量: 3, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:25:55,299 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:25:55,300 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:25:55,300 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:25:55,300 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:25:55,300 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:25:55,301 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:25:55,301 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 23:25:55,301 - src.engine.dealer - INFO - Dealt 3 community cards: ['6♣', '8♥', 'Q♥']
2025-03-10 23:25:55,301 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['6♣', '8♥', 'Q♥']
2025-03-10 23:25:55,301 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_4', 4)]
2025-03-10 23:25:55,302 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:25:55,302 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 23:25:55,302 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:25:55,302 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 320, 'community_cards': ['6♣', '8♥', 'Q♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2750, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': True, 'cards': ('J♣', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 740, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来你们都很自信，但我选择先观望一下', 'tone': '冷静'}}
2025-03-10 23:25:55,303 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:25:55,303 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_4']
2025-03-10 23:25:55,303 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:25:55,304 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:25:55,304 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:25:55,304 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:25:55,305 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:25:55,305 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:25:55,305 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:25:55,306 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:25:55,306 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:25:55,306 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:26:20,239 - src.agents.llm - INFO - 
💭 决策结果:
{
"action": {
"type": "FOLD",
"amount": "0",
"confidence": "0.85"
},
"reasoning": {
"hand_strength": "手牌J♣, 9♣与公共牌6♣, 8♥, Q♥目前没有形成对子或明显的听牌，只依靠后续转牌河牌凑成顺子的可能性较低，属于投机性较高的弱边缘牌。",
"position_analysis": "身处较早位置且剩余筹码较少（240），在面对对手的激进下注后，承担风险可能会导致筹码进一步缩水。",
"pot_odds": "底池320已经不小，但需要跟注100才能继续参与，结合手牌实际成牌概率来看，投入成本不划算。",
"opponent_reads": ["ai_4的加注显示出一定的主动性，player_0和ai_1的跟注表明他们可能持有较强牌或至少不愿轻易放弃，整体战局倾向稳健或强牌"]
},
"table_talk": {
"message": "冒险可以令人眼花缭乱，但有时候明智的退出才是最佳选择。",
"tone": "冷静且略带讽刺"
}
}
2025-03-10 23:26:20,240 - src.agents.llm - INFO - ==================================================

2025-03-10 23:26:20,240 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '冒险可以令人眼花缭乱，但有时候明智的退出才是最佳选择。', 'tone': '冷静且略带讽刺'}
2025-03-10 23:26:20,240 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:26:20,241 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:26:20,241 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:26:20,241 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:26:20,241 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:26:20,242 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:26:20,242 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:26:20,242 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:26:20,242 - src.engine.game - INFO - 找到下一个玩家: ai_4, 位置: 4
2025-03-10 23:26:20,242 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_4
2025-03-10 23:26:20,243 - src.engine.game - INFO - 更新当前玩家为: ai_4
2025-03-10 23:26:20,243 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:26:20,243 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:20,243 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:26:20,243 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:26:20,243 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:26:20,243 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:26:20,244 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:26:20,244 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 320, 'community_cards': ['6♣', '8♥', 'Q♥'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2750, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 740, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '冒险可以令人眼花缭乱，但有时候明智的退出才是最佳选择。', 'tone': '冷静且略带讽刺'}}
2025-03-10 23:26:20,244 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:26:20,245 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:20,245 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:26:20,245 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:26:20,246 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:26:20,246 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:26:20,247 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:26:20,247 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:26:20,247 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:26:20,248 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:26:20,248 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:26:20,249 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:26:35,979 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":200,"confidence":0.75},"reasoning":{"hand_strength":"持有一张A，虽然不是特别强的手牌，但有一定的潜力。考虑到公共牌面没有明显的成对或顺子迹象，我的A可能还是领先的。","position_analysis":"处于中后位置，这给了我观察对手行动的机会，并据此做出反应。","pot_odds":"底池为320，通过加注至200可以增加底池大小，同时测试对手手牌强度。如果他们跟注，那么进入转牌圈时我将有更多的信息来决定下一步动作。","opponent_reads":["player_0之前选择跟注100的加注，显示出他/她可能是持有不错的手牌或者在尝试看接下来的牌。"]},"table_talk":{"message":"看来大家都挺有信心啊，那我也得展示一下我的实力了。","tone":"自信"}}
2025-03-10 23:26:35,979 - src.agents.llm - INFO - ==================================================

2025-03-10 23:26:35,979 - src.agents.llm - INFO - 生成动作: RAISE 金额: 200 table_talk: {'message': '看来大家都挺有信心啊，那我也得展示一下我的实力了。', 'tone': '自信'}
2025-03-10 23:26:35,980 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 200
2025-03-10 23:26:35,980 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 23:26:35,980 - src.engine.state - INFO - 玩家 ai_4 加注到 200 筹码，已标记为已行动
2025-03-10 23:26:35,980 - src.engine.game - INFO - 玩家 ai_4 加注到 200
2025-03-10 23:26:35,980 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 23:26:35,981 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:26:35,981 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:26:35,981 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:26:35,981 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:26:35,981 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:26:35,982 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:26:35,982 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:26:35,982 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:35,982 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:26:35,982 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:26:35,983 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:26:35,983 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:26:35,983 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:26:35,983 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 520, 'community_cards': ['6♣', '8♥', 'Q♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2750, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 540, 'current_bet': 200, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 200}], 'table_talk': {'message': '看来大家都挺有信心啊，那我也得展示一下我的实力了。', 'tone': '自信'}}
2025-03-10 23:26:35,984 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:26:35,984 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:35,984 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:26:35,984 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:26:35,985 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:26:35,985 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:26:42,790 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:26:42,792 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:26:42.792279', 'table_talk': None}
2025-03-10 23:26:42,792 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:26:42,792 - src.engine.state - INFO - 玩家 player_0 跟注 200 筹码，已标记为已行动
2025-03-10 23:26:42,792 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:26:42,793 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:26:42,793 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:26:42,793 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:26:42,793 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:26:42,794 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:26:42,794 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:26:42,794 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:26:42,794 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:26:42,794 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:42,795 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:26:42,795 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 23:26:42,795 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 23:26:42,795 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:26:42,795 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:26:42,795 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:26:42,795 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:26:42,796 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:26:42,796 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:26:42,796 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:26:42,796 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:42,796 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:26:42,797 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 23:26:42,797 - src.engine.dealer - INFO - Dealt 1 community cards: ['10♣']
2025-03-10 23:26:42,797 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['6♣', '8♥', 'Q♥', '10♣']
2025-03-10 23:26:42,797 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_4', 4)]
2025-03-10 23:26:42,797 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:26:42,797 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 23:26:42,797 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 23:26:42,799 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 720, 'community_cards': ['6♣', '8♥', 'Q♥', '10♣'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2550, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 540, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:26:42,799 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:26:42,799 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:26:42,799 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:26:42,800 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:26:42,800 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:26:42,800 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:26:46,012 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:26:46,013 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:26:46,013 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:26:46,014 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:26:46,014 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:26:46,014 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:27:00,111 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":400,"confidence":0.75},"reasoning":{"hand_strength":"持有A高牌，虽然不是特别强的手牌，但在当前阶段有一定的潜在价值，尤其是考虑到可能的顺子听牌或同花听牌。","position_analysis":"处于较晚位置，可以利用这个优势来观察对手的行为后再做决定，同时也可以通过加注来控制底池大小和给对手施压。","pot_odds":"目前底池赔率相对有利，即使面对后续的跟注也有一定的回报潜力。","opponent_reads":["对手之前对我的加注进行了跟注，显示出他们手上有一定强度的手牌或者也在追逐听牌，但尚未表现出极强的攻击性。"]},"table_talk":{"message":"看来大家都挺有信心的嘛，那我也来增加点乐趣吧！","tone":"轻松挑衅"}}
2025-03-10 23:27:00,112 - src.agents.llm - INFO - ==================================================

2025-03-10 23:27:00,112 - src.agents.llm - INFO - 生成动作: RAISE 金额: 400 table_talk: {'message': '看来大家都挺有信心的嘛，那我也来增加点乐趣吧！', 'tone': '轻松挑衅'}
2025-03-10 23:27:00,112 - server - INFO - AI玩家 ai_4 决定执行动作: RAISE, 金额: 400
2025-03-10 23:27:00,112 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.RAISE
2025-03-10 23:27:00,113 - src.engine.state - INFO - 玩家 ai_4 加注到 400 筹码，已标记为已行动
2025-03-10 23:27:00,113 - src.engine.game - INFO - 玩家 ai_4 加注到 400
2025-03-10 23:27:00,113 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_4
2025-03-10 23:27:00,113 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:27:00,113 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:27:00,113 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 23:27:00,114 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:27:00,114 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:27:00,114 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:27:00,114 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:00,114 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:00,114 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 23:27:00,115 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:27:00,115 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:27:00,115 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:27:00,115 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:27:00,115 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 1120, 'community_cards': ['6♣', '8♥', 'Q♥', '10♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2550, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 140, 'current_bet': 400, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'RAISE', 'last_amount': 400}], 'table_talk': {'message': '看来大家都挺有信心的嘛，那我也来增加点乐趣吧！', 'tone': '轻松挑衅'}}
2025-03-10 23:27:00,116 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:00,116 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:00,116 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 23:27:00,117 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:27:00,117 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:27:00,117 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:27:05,962 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:27:05,963 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:27:05.963818', 'table_talk': None}
2025-03-10 23:27:05,963 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:27:05,964 - src.engine.state - INFO - 玩家 player_0 跟注 400 筹码，已标记为已行动
2025-03-10 23:27:05,964 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:27:05,965 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:27:05,965 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:27:05,966 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:27:05,966 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 23:27:05,966 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:27:05,966 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:27:05,966 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:27:05,967 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:05,967 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:05,967 - src.engine.game - INFO - 当前最大下注额: 400
2025-03-10 23:27:05,968 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=400, is_all_in=False
2025-03-10 23:27:05,968 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=400, is_all_in=False
2025-03-10 23:27:05,968 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:27:05,968 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:27:05,970 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:27:05,970 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 23:27:05,970 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:27:05,971 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 23:27:05,971 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:27:05,971 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:05,972 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:27:05,972 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 23:27:05,972 - src.engine.dealer - INFO - Dealt 1 community cards: ['10♦']
2025-03-10 23:27:05,972 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['6♣', '8♥', 'Q♥', '10♣', '10♦']
2025-03-10 23:27:05,972 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_4', 4)]
2025-03-10 23:27:05,972 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:27:05,973 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_4, 位置: 4
2025-03-10 23:27:05,973 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_4, 位置: 4
2025-03-10 23:27:05,973 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 1520, 'community_cards': ['6♣', '8♥', 'Q♥', '10♣', '10♦'], 'current_player': 'ai_4', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2150, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 140, 'current_bet': 0, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:27:05,973 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:05,973 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:05,974 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:27:05,974 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:27:05,974 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:27:05,974 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:27:10,145 - server - INFO - 当前AI玩家: ai_4
2025-03-10 23:27:10,146 - server - INFO - AI玩家 ai_4 开始观察游戏状态
2025-03-10 23:27:10,146 - src.agents.llm - INFO - AI玩家 ai_4 观察到新的游戏状态
2025-03-10 23:27:10,147 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:27:10,147 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:27:10,147 - src.agents.llm - INFO - 使用模型: openai/qwen-max
2025-03-10 23:27:30,280 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"ALL_IN","amount":"140","confidence":"0.85"},"reasoning":{"hand_strength":"拥有A高牌，但没有成对。考虑到公共牌面有两张10，如果对手持有任何一张10，则我的胜率较低。不过，鉴于目前底池大小与所需投入相比，全下可以尝试通过施加压力迫使对手犯错或直接赢得底池。","position_analysis":"位于较晚位置行动，能够基于其他玩家的动作做出反应。但由于只剩我与player_0对决，位置优势相对减弱。","pot_odds":"面对的底池赔率为1520:140，即大约10.86:1，这意味着只需要约9%的机会赢取底池就能保证长期盈利，而我的手牌至少能提供这样的机会。","opponent_reads":["player_0一直跟注表明他可能持有一手中等强度的手牌，既不是特别强也不是很弱，可能是在寻找价值或是设陷阱。"]},"table_talk":{"message":"看来我们得看看谁更勇敢了！","tone":"挑衅"}}
2025-03-10 23:27:30,282 - src.agents.llm - INFO - ==================================================

2025-03-10 23:27:30,282 - src.agents.llm - INFO - 成功将字符串金额 140 转换为数字 140.0
2025-03-10 23:27:30,283 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 140 table_talk: {'message': '看来我们得看看谁更勇敢了！', 'tone': '挑衅'}
2025-03-10 23:27:30,283 - server - INFO - AI玩家 ai_4 决定执行动作: ALL_IN, 金额: 140
2025-03-10 23:27:30,283 - src.engine.game - INFO - 处理玩家 ai_4 的行动: ActionType.ALL_IN
2025-03-10 23:27:30,283 - src.engine.state - INFO - 玩家 ai_4 全下 140 筹码，已标记为已行动
2025-03-10 23:27:30,283 - src.engine.game - INFO - 玩家 ai_4 全下
2025-03-10 23:27:30,284 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_4
2025-03-10 23:27:30,284 - src.engine.game - INFO - 已记录玩家 ai_4 的行动
2025-03-10 23:27:30,284 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_4
2025-03-10 23:27:30,284 - src.engine.game - INFO - 当前最大下注额: 140
2025-03-10 23:27:30,284 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:27:30,284 - src.engine.game - INFO - 当前玩家从 ai_4 更新为 player_0
2025-03-10 23:27:30,285 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:27:30,285 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:30,285 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:30,285 - src.engine.game - INFO - 当前最大下注额: 140
2025-03-10 23:27:30,285 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:27:30,285 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:27:30,286 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:27:30,286 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:27:30,286 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 1660, 'community_cards': ['6♣', '8♥', 'Q♥', '10♣', '10♦'], 'current_player': 'player_0', 'min_raise': 140, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2150, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 140, 'is_active': True, 'cards': ('9♦', 'A♥'), 'is_all_in': True, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': 'ALL_IN', 'last_amount': 140}], 'table_talk': {'message': '看来我们得看看谁更勇敢了！', 'tone': '挑衅'}}
2025-03-10 23:27:30,287 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:30,287 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:30,287 - src.engine.game - INFO - 当前最大下注额: 140
2025-03-10 23:27:30,288 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:27:30,288 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:27:30,288 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:27:35,702 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:27:35,702 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:27:35.702114', 'table_talk': None}
2025-03-10 23:27:35,703 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:27:35,703 - src.engine.state - INFO - 玩家 player_0 跟注 140 筹码，已标记为已行动
2025-03-10 23:27:35,703 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:27:35,703 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:27:35,703 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:27:35,704 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:27:35,704 - src.engine.game - INFO - 当前最大下注额: 140
2025-03-10 23:27:35,704 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:27:35,704 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:27:35,705 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:27:35,705 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:35,706 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:35,706 - src.engine.game - INFO - 当前最大下注额: 140
2025-03-10 23:27:35,706 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=140, is_all_in=False
2025-03-10 23:27:35,706 - src.engine.game - INFO - 检查玩家 ai_4: has_acted=True, current_bet=140, is_all_in=True
2025-03-10 23:27:35,707 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:27:35,707 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:27:35,707 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:27:35,707 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.RIVER
2025-03-10 23:27:35,708 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:27:35,708 - src.engine.game - INFO - 从阶段 GameStage.RIVER 进入下一阶段
2025-03-10 23:27:35,708 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:27:35,708 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_4']
2025-03-10 23:27:35,708 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:27:35,709 - src.engine.game - INFO - 重置玩家 ai_4 状态: has_acted=False, current_bet=0
2025-03-10 23:27:35,709 - src.engine.game - INFO - 河牌阶段结束，进入摊牌阶段
2025-03-10 23:27:35,709 - src.engine.game - INFO - 游戏结束，执行结算
2025-03-10 23:27:35,709 - src.engine.game - INFO - 结算时活跃玩家数量: 2
2025-03-10 23:27:35,710 - src.engine.game - INFO - 需要比较牌面大小进行结算
2025-03-10 23:27:35,710 - src.engine.game - INFO - 玩家 player_0 赢得底池 1800
2025-03-10 23:27:35,711 - src.engine.game - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 1800, 'winning_hand': 'PAIR', 'community_cards': ['6♣', '8♥', 'Q♥', '10♣', '10♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♦', 'K♣'), 'hand_rank': 'PAIR', 'is_winner': True}, {'player_id': 'ai_4', 'hole_cards': ('9♦', 'A♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}
2025-03-10 23:27:35,712 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:27:35,713 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['6♣', '8♥', 'Q♥', '10♣', '10♦'], 'current_player': None, 'min_raise': 140, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 1800, 'winning_hand': 'PAIR', 'community_cards': ['6♣', '8♥', 'Q♥', '10♣', '10♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♦', 'K♣'), 'hand_rank': 'PAIR', 'is_winner': True}, {'player_id': 'ai_4', 'hole_cards': ('9♦', 'A♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}, 'players': [{'id': 'player_0', 'chips': 3810, 'current_bet': 0, 'is_active': False, 'cards': ('A♦', 'K♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': ('9♦', 'A♥'), 'is_all_in': True, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:27:35,715 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:27:35,715 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:27:35,716 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:27:35,716 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:27:35,717 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:27:35,717 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:27:35,717 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 1800, 'winning_hand': 'PAIR', 'community_cards': ['6♣', '8♥', 'Q♥', '10♣', '10♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♦', 'K♣'), 'hand_rank': 'PAIR', 'is_winner': True}, {'player_id': 'ai_4', 'hole_cards': ('9♦', 'A♥'), 'hand_rank': 'PAIR', 'is_winner': False}]}
2025-03-10 23:27:35,718 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:27:38,278 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:27:38,278 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:27:38,278 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:27:38,279 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:27:38,279 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:27:38,280 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:27:38,280 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:27:38,280 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♥', '9♣')
2025-03-10 23:27:38,281 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♠', '8♣')
2025-03-10 23:27:38,281 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♣', '7♦')
2025-03-10 23:27:38,281 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:27:38,281 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:27:38,282 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:27:38,282 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:27:38,282 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:27:38,282 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:27:38,282 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:27:38,283 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:27:40,303 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:27:40,303 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:27:40,304 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:27:40,304 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:27:40,304 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:27:40,304 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:28:00,070 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.7"}, "reasoning": {"hand_strength": "虽然 9♠ 和 8♣ 不是顶级起手牌，但作为连张牌有潜力打出顺子甚至隐蔽的组合，因此具有一定的隐蔽力。", "position_analysis": "在早期位置行动意味着后续操作可能受限，故谨慎跟注能控制底池大小。", "pot_odds": "当前底池为30，跟注20能以合理底池赔率看到翻牌，风险相对较低。", "opponent_reads": ["player_0的主动下注显示出一定攻击性，可能在试探对手反应", "ai_2较低的下注可能代表手牌较弱或试探行为"]}, "table_talk": {"message": "各位坐好，好戏马上开始。", "tone": "自信且带点挑衅"}}
2025-03-10 23:28:00,070 - src.agents.llm - INFO - ==================================================

2025-03-10 23:28:00,071 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位坐好，好戏马上开始。', 'tone': '自信且带点挑衅'}
2025-03-10 23:28:00,071 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:28:00,071 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:28:00,071 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 23:28:00,071 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:28:00,072 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:28:00,072 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:28:00,072 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:28:00,072 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:00,072 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:28:00,072 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:28:00,073 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:28:00,073 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:00,073 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:28:00,073 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:00,074 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:28:00,074 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:28:00,074 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:00,074 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:28:00,075 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3790, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 220, 'current_bet': 20, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': True, 'cards': ('4♣', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位坐好，好戏马上开始。', 'tone': '自信且带点挑衅'}}
2025-03-10 23:28:00,075 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:00,075 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:28:00,076 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:00,076 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:28:00,076 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:28:00,076 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:00,077 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:28:00,077 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:28:00,078 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:28:00,078 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:28:00,078 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:28:00,078 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:28:06,586 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌4♣, 7♦在PRE_FLOP阶段非常弱，几乎没有形成强牌的可能。","position_analysis":"处于中间位置，没有明显的位置优势。","pot_odds":"当前底池50，需要跟注20，赔率较低，不值得冒险。","opponent_reads":["ai_1已经跟注，表明其手牌可能较强，继续跟注风险较大。"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌。","tone":"冷静"}}
2025-03-10 23:28:06,588 - src.agents.llm - INFO - ==================================================

2025-03-10 23:28:06,588 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌。', 'tone': '冷静'}
2025-03-10 23:28:06,588 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:28:06,589 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:28:06,589 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:28:06,589 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:28:06,589 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:28:06,589 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:28:06,590 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:28:06,590 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:06,590 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:28:06,591 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:28:06,591 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:28:06,591 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:06,591 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:06,592 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:06,592 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:28:06,592 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:28:06,592 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:06,592 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:28:06,593 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3790, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 220, 'current_bet': 20, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌。', 'tone': '冷静'}}
2025-03-10 23:28:06,593 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:06,593 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:06,594 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:06,594 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:28:06,594 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:28:06,594 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:16,351 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-10 23:28:16,352 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-10T23:28:16.352753', 'table_talk': None}
2025-03-10 23:28:16,352 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-10 23:28:16,353 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-10 23:28:16,353 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-10 23:28:16,353 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:28:16,353 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:28:16,353 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:16,353 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:28:16,354 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:28:16,354 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:28:16,354 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:16,354 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:16,354 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:16,354 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:28:16,354 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:28:16,355 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:28:16,355 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:28:16,355 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:28:16,355 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:28:16,355 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:28:16,356 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:28:16,356 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:28:16,356 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:28:16,356 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:16,356 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:28:16,357 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:28:16,357 - src.engine.dealer - INFO - Dealt 3 community cards: ['8♦', 'J♣', '5♥']
2025-03-10 23:28:16,357 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['8♦', 'J♣', '5♥']
2025-03-10 23:28:16,357 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:28:16,357 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 23:28:16,357 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:28:16,359 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:28:16,359 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['8♦', 'J♣', '5♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3790, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 220, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:28:16,359 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:16,359 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:16,359 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:28:16,360 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:28:16,360 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:28:16,360 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:28,092 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:28:28,093 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:28:28.093698', 'table_talk': None}
2025-03-10 23:28:28,094 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:28:28,094 - src.engine.state - INFO - 玩家 player_0 跟注 0 筹码，已标记为已行动
2025-03-10 23:28:28,095 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:28:28,095 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:28:28,095 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:28:28,095 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:28:28,096 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:28:28,096 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:28:28,096 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:28:28,096 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:28:28,096 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:28,097 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:28,097 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:28:28,097 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:28:28,097 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:28:28,097 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:28:28,097 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:28,097 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:28:28,097 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['8♦', 'J♣', '5♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3790, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 220, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:28:28,099 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:28,099 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:28,099 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:28:28,099 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:28:28,099 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:28:28,100 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:28:28,100 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:28:31,633 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:28:31,634 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:28:31,634 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:28:31,634 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:28:31,634 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:28:31,635 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:28:50,475 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "20", "confidence": "0.8"}, "reasoning": {"hand_strength": "持有中等对子（8s），虽然不是顶对，但在这个翻牌局面上仍有一定竞争力。", "position_analysis": "位置较靠前，采用主动策略可以掌控局面，利用加注塑造形象。", "pot_odds": "底池为50，加注20后能利用较好的赔率争取主动权。", "opponent_reads": ["对手表现出谨慎（CHECK, CALL），暗示手牌可能并不非常强。"]}, "table_talk": {"message": "来吧，让这局牌更有趣点！", "tone": "自信且略带挑衅"}}
2025-03-10 23:28:50,475 - src.agents.llm - INFO - ==================================================

2025-03-10 23:28:50,476 - src.agents.llm - INFO - 成功将字符串金额 20 转换为数字 20.0
2025-03-10 23:28:50,476 - src.agents.llm - INFO - 生成动作: RAISE 金额: 20 table_talk: {'message': '来吧，让这局牌更有趣点！', 'tone': '自信且略带挑衅'}
2025-03-10 23:28:50,476 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 20
2025-03-10 23:28:50,477 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:28:50,477 - src.engine.state - INFO - 玩家 ai_1 加注到 20 筹码，已标记为已行动
2025-03-10 23:28:50,477 - src.engine.game - INFO - 玩家 ai_1 加注到 20
2025-03-10 23:28:50,477 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:28:50,477 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:28:50,477 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:28:50,478 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:50,478 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:28:50,480 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:28:50,480 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:28:50,480 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:50,480 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:50,480 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:50,481 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:28:50,482 - src.engine.game - INFO - 玩家 player_0 下注额(0)不等于最大下注额(20)，回合继续
2025-03-10 23:28:50,482 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:28:50,483 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:28:50,484 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 70, 'community_cards': ['8♦', 'J♣', '5♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3790, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 20, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 20}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '来吧，让这局牌更有趣点！', 'tone': '自信且略带挑衅'}}
2025-03-10 23:28:50,485 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:50,486 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:50,486 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:50,487 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:28:50,487 - src.engine.game - INFO - 玩家 player_0 下注额(0)不等于最大下注额(20)，回合继续
2025-03-10 23:28:50,487 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:28:58,373 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:28:58,374 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:28:58.374736', 'table_talk': None}
2025-03-10 23:28:58,374 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:28:58,374 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:28:58,374 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:28:58,375 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:28:58,375 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:28:58,375 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:28:58,375 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:58,376 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:28:58,376 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:28:58,376 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:28:58,376 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:58,377 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:58,377 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:28:58,377 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:28:58,379 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:28:58,380 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:28:58,380 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:28:58,381 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:28:58,382 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:28:58,382 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:28:58,383 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:28:58,384 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:28:58,384 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:28:58,384 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:58,385 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:28:58,385 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:28:58,385 - src.engine.dealer - INFO - Dealt 1 community cards: ['K♣']
2025-03-10 23:28:58,386 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['8♦', 'J♣', '5♥', 'K♣']
2025-03-10 23:28:58,386 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:28:58,386 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 23:28:58,386 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:28:58,387 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:28:58,387 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 90, 'community_cards': ['8♦', 'J♣', '5♥', 'K♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3770, 'current_bet': 0, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:28:58,387 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:28:58,388 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:28:58,388 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:28:58,388 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:28:58,389 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:28:58,389 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:16,748 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 80}
2025-03-10 23:29:16,748 - server - INFO - 收到加注请求，金额: 80
2025-03-10 23:29:16,749 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 80, 'timestamp': '2025-03-10T23:29:16.748710', 'table_talk': None}
2025-03-10 23:29:16,749 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:29:16,750 - src.engine.state - INFO - 玩家 player_0 加注到 80 筹码，已标记为已行动
2025-03-10 23:29:16,750 - src.engine.game - INFO - 玩家 player_0 加注到 80
2025-03-10 23:29:16,751 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:29:16,751 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:29:16,752 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:29:16,752 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:29:16,752 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:29:16,752 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:29:16,753 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:29:16,753 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:16,753 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:29:16,753 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:29:16,754 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:29:16,754 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:29:16,754 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:29:16,754 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:16,754 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:29:16,755 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 170, 'community_cards': ['8♦', 'J♣', '5♥', 'K♣'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3690, 'current_bet': 80, 'is_active': True, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 80}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': True, 'cards': ('9♠', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:29:16,755 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:16,755 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:29:16,756 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:29:16,756 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:29:16,756 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:29:16,756 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:29:16,756 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:20,574 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:29:20,575 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:29:20,575 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:29:20,576 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:29:20,576 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:29:20,576 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:29:40,044 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "我的手牌仅是9♠和8♣，加上公共牌后仅能凑成一对8，牌力较弱且缺乏实质性补充", "position_analysis": "处于位置1，信息有限，对手近期激进行动使局势更为危险", "pot_odds": "底池170需要跟注80，但考虑到后续可能更大投入，底池赔率并不足以弥补牌力弱的劣势", "opponent_reads": ["对手多次加注和跟注显示出一定的侵略性，可能持有较强牌型或在进行策略诈唬"]}, "table_talk": {"message": "看来对手在试探加强攻势，我绝不会为了微弱优势陷入危险境地。", "tone": "冷静且果断"}}
2025-03-10 23:29:40,045 - src.agents.llm - INFO - ==================================================

2025-03-10 23:29:40,045 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来对手在试探加强攻势，我绝不会为了微弱优势陷入危险境地。', 'tone': '冷静且果断'}
2025-03-10 23:29:40,046 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:29:40,046 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:29:40,046 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:29:40,046 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:29:40,046 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:29:40,046 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:29:40,046 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:29:40,048 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:29:40,048 - src.engine.state - INFO - 玩家 player_0 获得底池 170 筹码，当前筹码: 3860
2025-03-10 23:29:40,048 - src.engine.game - INFO - 玩家 player_0 获得底池 170 筹码
2025-03-10 23:29:40,048 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:29:40,048 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 170, 'winning_hand': None, 'community_cards': ['8♦', 'J♣', '5♥', 'K♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♥', '9♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:29:40,048 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['8♦', 'J♣', '5♥', 'K♣'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 170, 'winning_hand': None, 'community_cards': ['8♦', 'J♣', '5♥', 'K♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♥', '9♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3860, 'current_bet': 80, 'is_active': False, 'cards': ('A♥', '9♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来对手在试探加强攻势，我绝不会为了微弱优势陷入危险境地。', 'tone': '冷静且果断'}}
2025-03-10 23:29:40,049 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:40,050 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:29:40,050 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:29:40,050 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:29:40,050 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:29:40,051 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:29:40,051 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 170, 'winning_hand': None, 'community_cards': ['8♦', 'J♣', '5♥', 'K♣'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♥', '9♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:29:40,051 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:29:43,490 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:29:43,491 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:29:43,491 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:29:43,492 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:29:43,492 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:29:43,492 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:29:43,493 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:29:43,493 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♥', 'A♦')
2025-03-10 23:29:43,493 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♥', '2♥')
2025-03-10 23:29:43,493 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', '6♣')
2025-03-10 23:29:43,493 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:29:43,494 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:29:43,494 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:29:43,494 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:29:43,494 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:29:43,494 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:29:43,495 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:29:43,495 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:29:45,044 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:29:45,045 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:29:45,045 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:29:45,045 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:29:45,045 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:29:45,046 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:29:51,573 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌Q♣, 6♣在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2处于早期位置，不利于后续行动","pot_odds":"底池赔率较低，不值得冒险跟注","opponent_reads":["对手player_0下注10，筹码较多，可能持有较强手牌","对手ai_1加注到20，筹码较少，可能试图通过加注施压"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:29:51,573 - src.agents.llm - INFO - ==================================================

2025-03-10 23:29:51,573 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:29:51,574 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:29:51,574 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:29:51,574 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:29:51,574 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:29:51,575 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:29:51,575 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:29:51,575 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:29:51,575 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:29:51,576 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:29:51,576 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:29:51,576 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:29:51,578 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:51,579 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:29:51,580 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:29:51,580 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:29:51,581 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:29:51,582 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:51,582 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:29:51,582 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 10, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 180, 'current_bet': 20, 'is_active': True, 'cards': ('3♥', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:29:51,583 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:51,583 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:29:51,584 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:29:51,584 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:29:51,584 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:29:51,584 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:54,591 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:29:54,592 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:29:54.592121', 'table_talk': None}
2025-03-10 23:29:54,592 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:29:54,592 - src.engine.state - INFO - 玩家 player_0 跟注 10 筹码，已标记为已行动
2025-03-10 23:29:54,592 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:29:54,593 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:29:54,593 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:29:54,593 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:29:54,593 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:29:54,593 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:29:54,594 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:29:54,594 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:29:54,594 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:54,595 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:29:54,595 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:29:54,595 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:29:54,595 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:29:54,596 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:29:54,596 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:54,596 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:29:54,596 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3840, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 180, 'current_bet': 20, 'is_active': True, 'cards': ('3♥', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:29:54,597 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:29:54,597 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:29:54,597 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:29:54,598 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:29:54,598 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:29:54,598 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:29:54,598 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:29:56,592 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:29:56,593 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:29:56,593 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:29:56,593 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:29:56,593 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:29:56,594 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:30:15,795 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌3♥,2♥极其弱，没有竞争力，几乎没有组合潜力", "position_analysis": "在PRE_FLOP阶段且处于位置1，没有信息和位置优势", "pot_odds": "底池40，对手已下注20，但跟注风险收益比极低", "opponent_reads": ["对手仅跟注，显示出中等或较好牌型，没有欠缺明显弱点，故不宜冒险"]}, "table_talk": {"message": "这牌实在太垃圾，跟它过不去，我直接弃掉！", "tone": "冷静而略带讽刺"}}
2025-03-10 23:30:15,796 - src.agents.llm - INFO - ==================================================

2025-03-10 23:30:15,796 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌实在太垃圾，跟它过不去，我直接弃掉！', 'tone': '冷静而略带讽刺'}
2025-03-10 23:30:15,796 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:30:15,796 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:30:15,797 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:30:15,797 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:30:15,797 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:30:15,797 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:30:15,797 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:30:15,797 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:30:15,798 - src.engine.state - INFO - 玩家 player_0 获得底池 40 筹码，当前筹码: 3880
2025-03-10 23:30:15,798 - src.engine.game - INFO - 玩家 player_0 获得底池 40 筹码
2025-03-10 23:30:15,798 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:30:15,798 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('9♥', 'A♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:30:15,798 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('9♥', 'A♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3880, 'current_bet': 20, 'is_active': False, 'cards': ('9♥', 'A♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 180, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 940, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌实在太垃圾，跟它过不去，我直接弃掉！', 'tone': '冷静而略带讽刺'}}
2025-03-10 23:30:15,799 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:30:15,800 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:30:15,800 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:30:15,800 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:30:15,800 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:30:15,801 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:30:15,801 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('9♥', 'A♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:30:15,801 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:30:17,600 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:30:17,601 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:30:17,601 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:30:17,601 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:30:17,601 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:30:17,602 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:30:17,602 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:30:17,602 - src.engine.game - INFO - 玩家 player_0 手牌: ('J♣', '9♥')
2025-03-10 23:30:17,602 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♠', '2♣')
2025-03-10 23:30:17,602 - src.engine.game - INFO - 玩家 ai_2 手牌: ('8♠', '7♦')
2025-03-10 23:30:17,602 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:30:17,603 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:30:17,603 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:30:17,603 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:30:17,603 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:30:17,603 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:30:17,604 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:30:17,604 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:30:22,096 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:30:22,097 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:30:22.097164', 'table_talk': None}
2025-03-10 23:30:22,097 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:30:22,098 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:30:22,098 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:30:22,099 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:30:22,099 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:30:22,099 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:30:22,100 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:30:22,100 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:30:22,100 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:30:22,101 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:30:22,101 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:30:22,102 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:30:22,102 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:30:22,102 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:30:22,103 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:30:22,104 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:30:22,104 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:30:22,104 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 170, 'current_bet': 10, 'is_active': True, 'cards': ('4♠', '2♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('8♠', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:30:22,105 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:30:22,106 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:30:22,106 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:30:22,106 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:30:22,107 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:30:22,107 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:30:25,812 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:30:25,813 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:30:25,813 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:30:25,814 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:30:25,815 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:30:25,815 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:30:36,843 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌4♠,2♣极弱，在德州扑克中通常被认为是最不值得玩的手牌之一。", "position_analysis": "处于前位，没有位置优势，后续行动可能处于劣势。", "pot_odds": "底池已有30，当前最大注20，但投入与回报不成正比，跟注或加注风险过高。", "opponent_reads": ["对手表现激活且已下注20，可能持有更强的起手牌或在利用位置优势。"]}, "table_talk": {"message": "今晚不打算冒险，大家好运！", "tone": "冷静且略带讽刺"}}
2025-03-10 23:30:36,843 - src.agents.llm - INFO - ==================================================

2025-03-10 23:30:36,844 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今晚不打算冒险，大家好运！', 'tone': '冷静且略带讽刺'}
2025-03-10 23:30:36,845 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:30:36,845 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:30:36,846 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:30:36,847 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:30:36,847 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:30:36,848 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:30:36,848 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:30:36,849 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:30:36,849 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 950
2025-03-10 23:30:36,850 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-10 23:30:36,851 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:30:36,851 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('8♠', '7♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:30:36,852 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('8♠', '7♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3880, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 950, 'current_bet': 20, 'is_active': False, 'cards': ('8♠', '7♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚不打算冒险，大家好运！', 'tone': '冷静且略带讽刺'}}
2025-03-10 23:30:36,854 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:30:36,854 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:30:36,855 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:30:36,855 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:30:36,855 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:30:36,856 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:30:36,856 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('8♠', '7♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:30:36,856 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:31:00,488 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:31:00,489 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:31:00,489 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:31:00,490 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:31:00,490 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:31:00,490 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:31:00,492 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:31:00,492 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♠', '2♣')
2025-03-10 23:31:00,492 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♣', '3♥')
2025-03-10 23:31:00,493 - src.engine.game - INFO - 玩家 ai_2 手牌: ('J♦', '4♦')
2025-03-10 23:31:00,493 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:31:00,493 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:31:00,494 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:31:00,494 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:31:00,494 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:31:00,495 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:31:00,495 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:31:00,496 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:31:01,892 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:31:01,894 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:31:01,894 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:31:01,895 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:31:01,895 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:31:01,895 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:31:21,719 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "Q♣, 3♥ is a very weak starting hand with minimal potential for post-flop improvement.", "position_analysis": "Being in position 1 means you'll have to act early, so playing such a marginal hand is extremely risky.", "pot_odds": "The pot odds aren't favorable when risking chips with a hand that is unlikely to hit strong combinations.", "opponent_reads": ["player_0 has a deep stack and shows aggression, which could indicate strong hands or a well-timed bluff.", "ai_2's lower bet doesn't provide enough incentive to continue with an inferior hand."]}, "table_talk": {"message": "今晚我只跟得上真正值得玩的牌，抱歉各位，让你们慢慢享受这场游戏吧！", "tone": "轻蔑而自信"}}
2025-03-10 23:31:21,721 - src.agents.llm - INFO - ==================================================

2025-03-10 23:31:21,721 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今晚我只跟得上真正值得玩的牌，抱歉各位，让你们慢慢享受这场游戏吧！', 'tone': '轻蔑而自信'}
2025-03-10 23:31:21,722 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:31:21,722 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:31:21,724 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:31:21,724 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:31:21,725 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:31:21,725 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:31:21,726 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:31:21,726 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:31:21,727 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:31:21,727 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:31:21,728 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:31:21,728 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:31:21,729 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:31:21,729 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:31:21,730 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:31:21,730 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:31:21,730 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:31:21,731 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:31:21,731 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3860, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', '2♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': True, 'cards': ('J♦', '4♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚我只跟得上真正值得玩的牌，抱歉各位，让你们慢慢享受这场游戏吧！', 'tone': '轻蔑而自信'}}
2025-03-10 23:31:21,733 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:31:21,733 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:31:21,734 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:31:21,735 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:31:21,735 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:31:21,736 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:31:21,737 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:31:21,737 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:31:21,738 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:31:21,738 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:31:21,738 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:31:21,739 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:31:28,236 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌J♦, 4♦在PRE_FLOP阶段较弱，缺乏形成强牌的基础","position_analysis":"位置2在PRE_FLOP阶段较为不利，缺乏信息优势","pot_odds":"底池赔率不足以支持跟注或加注","opponent_reads":["player_0下注20，显示出一定的侵略性，可能持有较强的手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:31:28,237 - src.agents.llm - INFO - ==================================================

2025-03-10 23:31:28,237 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:31:28,237 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:31:28,239 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:31:28,239 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:31:28,240 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:31:28,240 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:31:28,240 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:31:28,241 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:31:28,241 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:31:28,242 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3890
2025-03-10 23:31:28,242 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:31:28,242 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:31:28,243 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('2♠', '2♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:31:28,243 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('2♠', '2♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 20, 'is_active': False, 'cards': ('2♠', '2♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:31:28,245 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:31:28,245 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:31:28,246 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:31:28,246 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:31:28,246 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:31:28,246 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:31:28,247 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('2♠', '2♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:31:28,247 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:31:30,338 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:31:30,339 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:31:30,340 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:31:30,340 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:31:30,340 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:31:30,341 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:31:30,341 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:31:30,342 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♠', 'A♥')
2025-03-10 23:31:30,342 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♠', 'J♦')
2025-03-10 23:31:30,342 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♣', '5♣')
2025-03-10 23:31:30,343 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:31:30,343 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:31:30,344 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:31:30,344 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:31:30,344 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:31:30,345 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:31:30,345 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:31:30,345 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:31:45,385 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:31:45,387 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:31:45.387387', 'table_talk': None}
2025-03-10 23:31:45,387 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:31:45,388 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:31:45,389 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:31:45,389 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:31:45,390 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:31:45,390 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:31:45,390 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:31:45,391 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:31:45,391 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:31:45,391 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:31:45,392 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:31:45,392 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:31:45,392 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:31:45,393 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:31:45,393 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:31:45,393 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:31:45,394 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:31:45,394 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:31:45,394 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 160, 'current_bet': 10, 'is_active': True, 'cards': ('8♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', '5♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:31:45,395 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:31:45,396 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:31:45,396 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:31:45,396 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:31:45,397 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:31:45,397 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:31:45,399 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:31:48,307 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:31:48,309 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:31:48,309 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:31:48,310 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:31:48,310 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:31:48,311 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:32:18,846 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.7"}, "reasoning": {"hand_strength": "虽然8♠, J♦并非顶级手牌，但在前翻阶段具有一定潜力，并可通过翻牌后的灵活操作获得牌局主动权", "position_analysis": "处于较早位置，加注可以主动定义底池结构，迫使对手做出抉择", "pot_odds": "底池50已具诱惑，加上当前最大注20，适当加注可利用较低的跟注成本施加压力", "opponent_reads": ["player_0选择跟注可能暗示手牌边缘或者试图诱导对抗", "ai_2目前尚未行动，可能持观望态度"]}, "table_talk": {"message": "各位，看仔细了，我今天准备让这个底池热起来，敢不敢接招？", "tone": "挑衅且自信"}}
2025-03-10 23:32:18,847 - src.agents.llm - INFO - ==================================================

2025-03-10 23:32:18,847 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 23:32:18,847 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '各位，看仔细了，我今天准备让这个底池热起来，敢不敢接招？', 'tone': '挑衅且自信'}
2025-03-10 23:32:18,847 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 23:32:18,847 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:32:18,848 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 23:32:18,848 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 23:32:18,848 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:32:18,849 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:32:18,849 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:32:18,850 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:18,850 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:32:18,851 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:32:18,851 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:32:18,852 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:18,852 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:32:18,852 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:18,853 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:32:18,853 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 23:32:18,854 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:32:18,854 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:32:18,855 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 130, 'current_bet': 40, 'is_active': True, 'cards': ('8♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', '5♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，看仔细了，我今天准备让这个底池热起来，敢不敢接招？', 'tone': '挑衅且自信'}}
2025-03-10 23:32:18,856 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:18,856 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:32:18,857 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:18,857 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:32:18,858 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 23:32:18,858 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:32:18,859 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:32:18,860 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:32:18,860 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:32:18,861 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:32:18,861 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:32:18,862 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:32:27,130 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"手牌9♣, 5♣在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"处于中间位置，后续玩家可能会加注，进一步增加风险","pot_odds":"当前底池80，需要跟注40，赔率不佳","opponent_reads":["player_0选择跟注，可能持有中等强度手牌","ai_1加注到40，显示出一定的牌力，可能持有强牌或进行诈唬"]},"table_talk":{"message":"看来这手牌不适合我，我先退出","tone":"轻松"}}
2025-03-10 23:32:27,134 - src.agents.llm - INFO - ==================================================

2025-03-10 23:32:27,136 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我先退出', 'tone': '轻松'}
2025-03-10 23:32:27,136 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:32:27,136 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:32:27,138 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:32:27,138 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:32:27,139 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:32:27,139 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:32:27,139 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:32:27,140 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:27,140 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:32:27,141 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:32:27,141 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:32:27,142 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:27,142 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:27,143 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:27,143 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:32:27,144 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 23:32:27,144 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:32:27,145 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:32:27,145 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 80, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('2♠', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 130, 'current_bet': 40, 'is_active': True, 'cards': ('8♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我先退出', 'tone': '轻松'}}
2025-03-10 23:32:27,146 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:27,146 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:27,147 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:27,147 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:32:27,147 - src.engine.game - INFO - 玩家 player_0 下注额(20)不等于最大下注额(40)，回合继续
2025-03-10 23:32:27,148 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:32:31,172 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:32:31,173 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:32:31.173601', 'table_talk': None}
2025-03-10 23:32:31,173 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:32:31,174 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:32:31,174 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:32:31,175 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:32:31,175 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:32:31,175 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:32:31,176 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:31,176 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:32:31,176 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:32:31,177 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:32:31,177 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:31,177 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:31,178 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:32:31,178 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:32:31,178 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:32:31,179 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:32:31,179 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:32:31,179 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:32:31,180 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:32:31,180 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:32:31,180 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:32:31,181 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:32:31,181 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:32:31,181 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:31,182 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:32:31,182 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:32:31,182 - src.engine.dealer - INFO - Dealt 3 community cards: ['5♦', '8♦', 'Q♥']
2025-03-10 23:32:31,183 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['5♦', '8♦', 'Q♥']
2025-03-10 23:32:31,183 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:32:31,183 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:32:31,184 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 23:32:31,184 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:32:31,184 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 100, 'community_cards': ['5♦', '8♦', 'Q♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 130, 'current_bet': 0, 'is_active': True, 'cards': ('8♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:32:31,185 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:31,186 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:31,187 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:32:31,187 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:32:31,187 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:32:31,188 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:32:32,160 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:32:32,161 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:32:32,162 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:32:32,162 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:32:32,162 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:32:32,163 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:32:56,925 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": 80, "confidence": 0.9}, "reasoning": {"hand_strength": "虽然手牌看起来平凡，但在翻牌后得到了三条8，加上J的踢脚，这使得手牌在当前局面中非常有竞争力", "position_analysis": "位置靠前，能够率先发起进攻，通过主动加注来掌控局面", "pot_odds": "底池已有100，加注可以进一步提高底池价值，同时迫使对手支付不合理的价格继续留局", "opponent_reads": ["对手在前面的CALL显示其可能手牌范围较宽，或者在追求抽牌机会", "通过加注可使对手面临更大压力，从而测试其真实牌力"]}, "table_talk": {"message": "准备迎接挑战吧，我可不会手软！", "tone": "自信且带有挑衅"}}
2025-03-10 23:32:56,927 - src.agents.llm - INFO - ==================================================

2025-03-10 23:32:56,927 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '准备迎接挑战吧，我可不会手软！', 'tone': '自信且带有挑衅'}
2025-03-10 23:32:56,928 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 80
2025-03-10 23:32:56,928 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:32:56,929 - src.engine.state - INFO - 玩家 ai_1 加注到 80 筹码，已标记为已行动
2025-03-10 23:32:56,929 - src.engine.game - INFO - 玩家 ai_1 加注到 80
2025-03-10 23:32:56,929 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:32:56,930 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:32:56,931 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:32:56,931 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:32:56,933 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:32:56,933 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:32:56,934 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:32:56,934 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:56,934 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:56,935 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:32:56,935 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:32:56,936 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:32:56,936 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:32:56,936 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:32:56,937 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 180, 'community_cards': ['5♦', '8♦', 'Q♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': True, 'cards': ('2♠', 'A♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 50, 'current_bet': 80, 'is_active': True, 'cards': ('8♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 80}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '准备迎接挑战吧，我可不会手软！', 'tone': '自信且带有挑衅'}}
2025-03-10 23:32:56,938 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:32:56,938 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:32:56,939 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:32:56,939 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:32:56,940 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:32:56,940 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:33:04,345 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:33:04,345 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:33:04.345021', 'table_talk': None}
2025-03-10 23:33:04,346 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:33:04,347 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:33:04,347 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:33:04,347 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:33:04,348 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:33:04,348 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:33:04,349 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:33:04,349 - src.engine.state - INFO - 玩家 ai_1 获得底池 180 筹码，当前筹码: 230
2025-03-10 23:33:04,349 - src.engine.game - INFO - 玩家 ai_1 获得底池 180 筹码
2025-03-10 23:33:04,350 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:33:04,350 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 180, 'winning_hand': None, 'community_cards': ['5♦', '8♦', 'Q♥'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('8♠', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:33:04,351 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['5♦', '8♦', 'Q♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 180, 'winning_hand': None, 'community_cards': ['5♦', '8♦', 'Q♥'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('8♠', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 230, 'current_bet': 80, 'is_active': False, 'cards': ('8♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 920, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:33:04,352 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:33:04,352 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:33:04,352 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:33:04,354 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:33:04,354 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:33:04,355 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:33:04,355 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 180, 'winning_hand': None, 'community_cards': ['5♦', '8♦', 'Q♥'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('8♠', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:33:04,355 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:33:05,260 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:33:05,261 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:33:05,262 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:33:05,262 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:33:05,263 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:33:05,263 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:33:05,264 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:33:05,264 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♦', '7♣')
2025-03-10 23:33:05,265 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♠', 'Q♥')
2025-03-10 23:33:05,266 - src.engine.game - INFO - 玩家 ai_2 手牌: ('10♣', '4♥')
2025-03-10 23:33:05,266 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:33:05,266 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:33:05,267 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:33:05,267 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:33:05,267 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:33:05,268 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:33:05,268 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:33:05,269 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:33:06,943 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:33:06,943 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:33:06,944 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:33:06,944 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:33:06,945 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:33:06,946 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:33:30,529 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.75"}, "reasoning": {"hand_strength": "手牌只有一张高牌而另一张配置较弱，整体实力一般，不适合冒险加注", "position_analysis": "处于较前的位置，信息有限，选择保守跟注以观察后续行动", "pot_odds": "底池已有30，加跟20后底池赔率尚可，跟注风险较低", "opponent_reads": ["player_0状态激活，可能采用宽松策略", "ai_2筹码较少，策略可能更为谨慎"]}, "table_talk": {"message": "保持冷静，跟注看看牌面，再做进一步的策略调整", "tone": "冷静"}}
2025-03-10 23:33:30,531 - src.agents.llm - INFO - ==================================================

2025-03-10 23:33:30,532 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '保持冷静，跟注看看牌面，再做进一步的策略调整', 'tone': '冷静'}
2025-03-10 23:33:30,533 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:33:30,533 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:33:30,534 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 23:33:30,534 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:33:30,536 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:33:30,537 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:33:30,537 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:33:30,538 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:33:30,538 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:33:30,539 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:33:30,539 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:33:30,540 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:33:30,540 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:33:30,540 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:33:30,541 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:33:30,541 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:33:30,542 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:33:30,542 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:33:30,542 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3830, 'current_bet': 20, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 210, 'current_bet': 20, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': True, 'cards': ('10♣', '4♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '保持冷静，跟注看看牌面，再做进一步的策略调整', 'tone': '冷静'}}
2025-03-10 23:33:30,544 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:33:30,545 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:33:30,545 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:33:30,546 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:33:30,546 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:33:30,546 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:33:30,548 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:33:30,548 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:33:30,548 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:33:30,549 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:33:30,549 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:33:30,549 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:33:37,766 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌10♣和4♥在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，难以在后手行动中获得信息优势","pot_odds":"底池赔率不理想，跟注20筹码的回报率较低","opponent_reads":["对手ai_1选择跟注，可能持有中等强度的牌或试图进行偷盲"]},"table_talk":{"message":"看来这把牌不太适合我，先弃牌观察一下","tone":"轻松"}}
2025-03-10 23:33:37,767 - src.agents.llm - INFO - ==================================================

2025-03-10 23:33:37,767 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这把牌不太适合我，先弃牌观察一下', 'tone': '轻松'}
2025-03-10 23:33:37,767 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:33:37,767 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:33:37,767 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:33:37,768 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:33:37,768 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:33:37,769 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:33:37,769 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:33:37,770 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:33:37,770 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:33:37,770 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:33:37,771 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:33:37,771 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:33:37,772 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:33:37,772 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:33:37,773 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:33:37,773 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:33:37,773 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:33:37,774 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:33:37,774 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3830, 'current_bet': 20, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 210, 'current_bet': 20, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这把牌不太适合我，先弃牌观察一下', 'tone': '轻松'}}
2025-03-10 23:33:37,776 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:33:37,777 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:33:37,778 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:33:37,779 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:33:37,779 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:33:37,780 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:00,023 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-10 23:34:00,024 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-10T23:34:00.024988', 'table_talk': None}
2025-03-10 23:34:00,025 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-10 23:34:00,025 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-10 23:34:00,025 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-10 23:34:00,027 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:34:00,027 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:34:00,027 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:00,028 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:34:00,028 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:34:00,029 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:34:00,029 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:00,029 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:00,030 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:00,030 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:34:00,031 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:34:00,031 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:34:00,031 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:34:00,032 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:34:00,032 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:34:00,032 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:34:00,033 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:34:00,033 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:34:00,033 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:34:00,034 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:00,034 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:34:00,034 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:34:00,035 - src.engine.dealer - INFO - Dealt 3 community cards: ['9♣', '2♠', 'Q♦']
2025-03-10 23:34:00,035 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['9♣', '2♠', 'Q♦']
2025-03-10 23:34:00,035 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:34:00,036 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 23:34:00,036 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:34:00,036 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:34:00,037 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['9♣', '2♠', 'Q♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3830, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 210, 'current_bet': 0, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:34:00,038 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:00,038 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:00,038 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:34:00,039 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:34:00,039 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:34:00,040 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:08,332 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:34:08,333 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:34:08.333827', 'table_talk': None}
2025-03-10 23:34:08,333 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:34:08,334 - src.engine.state - INFO - 玩家 player_0 跟注 0 筹码，已标记为已行动
2025-03-10 23:34:08,334 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:34:08,335 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:34:08,336 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:34:08,336 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:34:08,337 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:34:08,337 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:34:08,337 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:34:08,338 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:34:08,338 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:08,339 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:08,339 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:34:08,339 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:34:08,340 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:34:08,340 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:34:08,340 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:08,341 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:34:08,341 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['9♣', '2♠', 'Q♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3830, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 210, 'current_bet': 0, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:34:08,342 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:08,343 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:08,343 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:34:08,343 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:34:08,344 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:34:08,344 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:34:08,345 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:12,823 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:34:12,824 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:34:12,824 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:34:12,824 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:34:12,825 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:34:12,825 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:34:35,329 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "20", "confidence": "0.8"}, "reasoning": {"hand_strength": "手握顶对，但踢脚较弱，需要主动出击保护手牌并争取价值", "position_analysis": "虽然位置在前，但利用主动加注可以主导局面并干扰对手的战略布局", "pot_odds": "底池50，加注后可提升底池赔率，迫使对手投入更多筹码，从而保护自己的领先优势", "opponent_reads": ["对手跟注显示可能手牌中等或在追听牌", "对手目前表现出一定保守性，容易受到压力"]}, "table_talk": {"message": "来点挑战吧，我的顶对可不是你能轻易撼动的！", "tone": "挑衅且坚决"}}
2025-03-10 23:34:35,330 - src.agents.llm - INFO - ==================================================

2025-03-10 23:34:35,331 - src.agents.llm - INFO - 成功将字符串金额 20 转换为数字 20.0
2025-03-10 23:34:35,332 - src.agents.llm - INFO - 生成动作: RAISE 金额: 20 table_talk: {'message': '来点挑战吧，我的顶对可不是你能轻易撼动的！', 'tone': '挑衅且坚决'}
2025-03-10 23:34:35,333 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 20
2025-03-10 23:34:35,333 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:34:35,334 - src.engine.state - INFO - 玩家 ai_1 加注到 20 筹码，已标记为已行动
2025-03-10 23:34:35,334 - src.engine.game - INFO - 玩家 ai_1 加注到 20
2025-03-10 23:34:35,335 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:34:35,335 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:34:35,335 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:34:35,336 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:35,336 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:34:35,337 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:34:35,337 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:34:35,338 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:35,338 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:35,338 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:35,339 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:34:35,340 - src.engine.game - INFO - 玩家 player_0 下注额(0)不等于最大下注额(20)，回合继续
2025-03-10 23:34:35,340 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:34:35,341 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:34:35,341 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 70, 'community_cards': ['9♣', '2♠', 'Q♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3830, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 190, 'current_bet': 20, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 20}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '来点挑战吧，我的顶对可不是你能轻易撼动的！', 'tone': '挑衅且坚决'}}
2025-03-10 23:34:35,342 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:35,343 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:35,343 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:35,343 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:34:35,343 - src.engine.game - INFO - 玩家 player_0 下注额(0)不等于最大下注额(20)，回合继续
2025-03-10 23:34:35,345 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:34:41,726 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:34:41,726 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:34:41.726102', 'table_talk': None}
2025-03-10 23:34:41,727 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:34:41,727 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:34:41,728 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:34:41,728 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:34:41,729 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:34:41,729 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:34:41,730 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:41,730 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:34:41,731 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:34:41,731 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:34:41,731 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:41,732 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:41,732 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:34:41,733 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:34:41,733 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:34:41,733 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:34:41,734 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:34:41,734 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:34:41,734 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:34:41,735 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:34:41,735 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:34:41,735 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:34:41,735 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:34:41,737 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:41,737 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:34:41,737 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:34:41,738 - src.engine.dealer - INFO - Dealt 1 community cards: ['A♠']
2025-03-10 23:34:41,738 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['9♣', '2♠', 'Q♦', 'A♠']
2025-03-10 23:34:41,739 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:34:41,739 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 23:34:41,739 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:34:41,740 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:34:41,740 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 90, 'community_cards': ['9♣', '2♠', 'Q♦', 'A♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3810, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 190, 'current_bet': 0, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:34:41,741 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:41,741 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:41,742 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:34:41,742 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:34:41,743 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:34:41,743 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:53,667 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 120}
2025-03-10 23:34:53,667 - server - INFO - 收到加注请求，金额: 120
2025-03-10 23:34:53,668 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 120, 'timestamp': '2025-03-10T23:34:53.668927', 'table_talk': None}
2025-03-10 23:34:53,670 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:34:53,670 - src.engine.state - INFO - 玩家 player_0 加注到 120 筹码，已标记为已行动
2025-03-10 23:34:53,671 - src.engine.game - INFO - 玩家 player_0 加注到 120
2025-03-10 23:34:53,671 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:34:53,672 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:34:53,672 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:34:53,672 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:34:53,673 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:34:53,673 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:34:53,674 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:34:53,674 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:53,674 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:53,676 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:34:53,676 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:34:53,676 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:34:53,677 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:34:53,677 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:53,677 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:34:53,678 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 210, 'community_cards': ['9♣', '2♠', 'Q♦', 'A♠'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3690, 'current_bet': 120, 'is_active': True, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 120}, {'id': 'ai_1', 'chips': 190, 'current_bet': 0, 'is_active': True, 'cards': ('5♠', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:34:53,679 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:34:53,679 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:34:53,680 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:34:53,680 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:34:53,680 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:34:53,681 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:34:53,681 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:34:55,412 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:34:55,413 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:34:55,414 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:34:55,414 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:34:55,415 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:34:55,415 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:35:26,692 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌只有一对Q，虽然有成牌潜力，但在公共牌中出现A和额外的高张后显得不够稳固，很容易被对手持有的A或更好牌型超越", "position_analysis": "处于先行动作的位置，而底池已较大，且对手多次表现出攻击性，逆风操作风险较高", "pot_odds": "底池210，对手已投入120，继续跟注或全压风险过大，而回报不足以弥补潜在损失", "opponent_reads": ["对手多次加注和回调显示出较强的进攻意图或强牌，可能在利用形象迫使对手退场"]}, "table_talk": {"message": "对手气势汹汹，我得学会适时退让，不必对每一局都硬拼。", "tone": "冷静且略带挑衅"}}
2025-03-10 23:35:26,694 - src.agents.llm - INFO - ==================================================

2025-03-10 23:35:26,694 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '对手气势汹汹，我得学会适时退让，不必对每一局都硬拼。', 'tone': '冷静且略带挑衅'}
2025-03-10 23:35:26,694 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:35:26,696 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:35:26,696 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:35:26,697 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:35:26,697 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:35:26,698 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:35:26,698 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:35:26,699 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:35:26,699 - src.engine.state - INFO - 玩家 player_0 获得底池 210 筹码，当前筹码: 3900
2025-03-10 23:35:26,699 - src.engine.game - INFO - 玩家 player_0 获得底池 210 筹码
2025-03-10 23:35:26,700 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:35:26,700 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 210, 'winning_hand': None, 'community_cards': ['9♣', '2♠', 'Q♦', 'A♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♦', '7♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:35:26,701 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['9♣', '2♠', 'Q♦', 'A♠'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 210, 'winning_hand': None, 'community_cards': ['9♣', '2♠', 'Q♦', 'A♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♦', '7♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3900, 'current_bet': 120, 'is_active': False, 'cards': ('A♦', '7♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 190, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '对手气势汹汹，我得学会适时退让，不必对每一局都硬拼。', 'tone': '冷静且略带挑衅'}}
2025-03-10 23:35:26,702 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:35:26,703 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:35:26,703 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:35:26,703 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:35:26,703 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:35:26,704 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:35:26,704 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 210, 'winning_hand': None, 'community_cards': ['9♣', '2♠', 'Q♦', 'A♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♦', '7♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:35:26,705 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:35:42,067 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:35:42,068 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:35:42,068 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:35:42,069 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:35:42,069 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:35:42,070 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:35:42,071 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:35:42,071 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', '4♠')
2025-03-10 23:35:42,072 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♠', '4♣')
2025-03-10 23:35:42,072 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♦', 'J♣')
2025-03-10 23:35:42,072 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:35:42,073 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:35:42,073 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:35:42,074 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:35:42,074 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:35:42,074 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:35:42,074 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:35:42,075 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:35:46,721 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:35:46,722 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:35:46,722 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:35:46,722 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:35:46,722 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:35:46,724 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:35:54,110 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌4♦和J♣在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，后续行动受限","pot_odds":"底池赔率不理想，投入20筹码去赢得30底池不值得","opponent_reads":["player_0下注10，可能持有中等强度手牌，ai_1加注到20，可能持有较强手牌"]},"table_talk":{"message":"这手牌不太行，我选择弃牌","tone":"轻松"}}
2025-03-10 23:35:54,111 - src.agents.llm - INFO - ==================================================

2025-03-10 23:35:54,111 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太行，我选择弃牌', 'tone': '轻松'}
2025-03-10 23:35:54,112 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:35:54,112 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:35:54,112 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:35:54,113 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:35:54,113 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:35:54,113 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:35:54,115 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:35:54,115 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:35:54,116 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:35:54,116 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:35:54,117 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:35:54,117 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:35:54,118 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:35:54,118 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:35:54,119 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:35:54,119 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:35:54,120 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:35:54,120 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:35:54,121 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 10, 'is_active': True, 'cards': ('10♠', '4♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 20, 'is_active': True, 'cards': ('9♠', '4♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太行，我选择弃牌', 'tone': '轻松'}}
2025-03-10 23:35:54,122 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:35:54,124 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:35:54,124 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:35:54,124 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:35:54,125 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:35:54,125 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:36:00,911 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:36:00,911 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:36:00.911917', 'table_talk': None}
2025-03-10 23:36:00,912 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:36:00,912 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:36:00,913 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:36:00,913 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:36:00,914 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:36:00,914 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:36:00,914 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:36:00,915 - src.engine.state - INFO - 玩家 ai_1 获得底池 30 筹码，当前筹码: 200
2025-03-10 23:36:00,915 - src.engine.game - INFO - 玩家 ai_1 获得底池 30 筹码
2025-03-10 23:36:00,915 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:36:00,916 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('9♠', '4♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:36:00,916 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('9♠', '4♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 200, 'current_bet': 20, 'is_active': False, 'cards': ('9♠', '4♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:36:00,917 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:36:00,918 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:36:00,918 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:36:00,918 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:36:00,919 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:36:00,919 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:36:00,920 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('9♠', '4♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:36:00,920 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:36:01,905 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:36:01,907 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:36:01,907 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:36:01,907 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:36:01,907 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:36:01,907 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:36:01,909 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:36:01,909 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♠', '7♦')
2025-03-10 23:36:01,909 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♣', '6♣')
2025-03-10 23:36:01,910 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♥', '2♦')
2025-03-10 23:36:01,910 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:36:01,910 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:36:01,911 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:36:01,911 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:36:01,912 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:36:01,912 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:36:01,913 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:36:01,913 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:36:04,621 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:36:04,621 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:36:04.621460', 'table_talk': None}
2025-03-10 23:36:04,622 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:36:04,622 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:36:04,622 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:36:04,623 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:36:04,623 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:36:04,623 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:36:04,624 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:36:04,624 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:36:04,625 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:36:04,625 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:36:04,625 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:36:04,626 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:36:04,626 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:36:04,627 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:36:04,627 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:36:04,628 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:36:04,628 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:36:04,628 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 190, 'current_bet': 10, 'is_active': True, 'cards': ('Q♣', '6♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 890, 'current_bet': 20, 'is_active': True, 'cards': ('7♥', '2♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:36:04,629 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:36:04,630 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:36:04,630 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:36:04,630 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:36:04,631 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:36:04,631 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:36:09,168 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:36:09,169 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:36:09,169 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:36:09,170 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:36:09,170 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:36:09,171 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:36:31,985 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.8"}, "reasoning": {"hand_strength": "Q♣,6♣虽然同花有一定潜力，但整体手牌实力偏边缘，预示着进攻空间有限。", "position_analysis": "作为当前第一个行动者，处于较早位置，需要谨慎控制底池以免后续局面失控。", "pot_odds": "底池30、跟注20的成本比提供了合理的赔率，但依然需要后续牌面改善才能获利。", "opponent_reads": ["对手筹码丰厚且表现积极，可能采用侵略性策略，因此保持谨慎为上。"]}, "table_talk": {"message": "冷静观察对手，等待更好的时机反击。", "tone": "沉稳"}}
2025-03-10 23:36:31,986 - src.agents.llm - INFO - ==================================================

2025-03-10 23:36:31,987 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '冷静观察对手，等待更好的时机反击。', 'tone': '沉稳'}
2025-03-10 23:36:31,987 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:36:31,988 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:36:31,988 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-10 23:36:31,989 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:36:31,989 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:36:31,990 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:36:31,990 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:36:31,991 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:36:31,991 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:36:31,991 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:36:31,992 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:36:31,992 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:36:31,993 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:36:31,993 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:36:31,993 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:36:31,994 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:36:31,995 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:36:31,995 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:36:31,996 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:36:31,996 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 180, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', '6♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 890, 'current_bet': 20, 'is_active': True, 'cards': ('7♥', '2♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '冷静观察对手，等待更好的时机反击。', 'tone': '沉稳'}}
2025-03-10 23:36:31,997 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:36:31,998 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:36:31,998 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:36:31,999 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:36:31,999 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:36:31,999 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:36:32,000 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:36:32,001 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:36:32,001 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:36:32,003 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:36:32,003 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:36:32,004 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:36:32,004 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:36:37,839 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"手牌7♥, 2♦非常弱，几乎没有成牌潜力","position_analysis":"位置2在PRE_FLOP阶段并不有利，后续行动可能会受到限制","pot_odds":"底池赔率不划算，不值得投入更多筹码","opponent_reads":["ai_1选择了CALL，可能持有中等强度的牌或试图进行诈唬"]},"table_talk":{"message":"看来这把运气不在我这边，先撤了","tone":"轻松"}}
2025-03-10 23:36:37,840 - src.agents.llm - INFO - ==================================================

2025-03-10 23:36:37,841 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这把运气不在我这边，先撤了', 'tone': '轻松'}
2025-03-10 23:36:37,841 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:36:37,841 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:36:37,841 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:36:37,842 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:36:37,843 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:36:37,843 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:36:37,843 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:36:37,843 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:36:37,844 - src.engine.state - INFO - 玩家 ai_1 获得底池 40 筹码，当前筹码: 220
2025-03-10 23:36:37,844 - src.engine.game - INFO - 玩家 ai_1 获得底池 40 筹码
2025-03-10 23:36:37,845 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:36:37,845 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♣', '6♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:36:37,846 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♣', '6♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 220, 'current_bet': 20, 'is_active': False, 'cards': ('Q♣', '6♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 890, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这把运气不在我这边，先撤了', 'tone': '轻松'}}
2025-03-10 23:36:37,848 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:36:37,849 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:36:37,849 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:36:37,850 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:36:37,850 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:36:37,851 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:36:37,851 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♣', '6♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:36:37,851 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:36:49,323 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:36:49,323 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:36:49,324 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:36:49,324 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:36:49,325 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:36:49,325 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:36:49,326 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:36:49,326 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♥', '8♥')
2025-03-10 23:36:49,327 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♣', 'Q♣')
2025-03-10 23:36:49,327 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♦', 'J♦')
2025-03-10 23:36:49,328 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:36:49,328 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:36:49,329 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:36:49,329 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:36:49,330 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:36:49,330 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:36:49,330 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:36:49,330 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:36:52,849 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:36:52,850 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:36:52,851 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:36:52,851 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:36:52,852 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:36:52,852 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:37:13,230 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.7"}, "reasoning": {"hand_strength": "手中的10♣和Q♣属于中等牌力，适合在合适的时机利用顺子和同花潜力发挥优势。", "position_analysis": "位置1虽然处于较早位置，但利用我的激进风格可以掌控局面，通过加注施压对手。", "pot_odds": "底池30，对跟注20来说赔率并不算诱人，加注能控制底池规模和对手范围。", "opponent_reads": ["player_0目前下注20，可能握有较强牌型或想制造压力", "ai_2下注较少，显示出防守倾向或弱牌，可能在面对加注时弃牌"]}, "table_talk": {"message": "各位，牌虽不算顶尖，但敢打敢拼才有趣，加注试探一下，看谁能挡住我！", "tone": "自信且挑衅"}}
2025-03-10 23:37:13,231 - src.agents.llm - INFO - ==================================================

2025-03-10 23:37:13,231 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 23:37:13,231 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '各位，牌虽不算顶尖，但敢打敢拼才有趣，加注试探一下，看谁能挡住我！', 'tone': '自信且挑衅'}
2025-03-10 23:37:13,233 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 23:37:13,233 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:37:13,233 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 23:37:13,234 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 23:37:13,234 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:37:13,235 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:37:13,235 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:37:13,236 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:37:13,236 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:37:13,237 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:37:13,237 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:37:13,238 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:13,238 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:37:13,239 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:37:13,239 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:37:13,240 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:37:13,240 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:37:13,241 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:37:13,241 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '8♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 180, 'current_bet': 40, 'is_active': True, 'cards': ('10♣', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 880, 'current_bet': 10, 'is_active': True, 'cards': ('A♦', 'J♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，牌虽不算顶尖，但敢打敢拼才有趣，加注试探一下，看谁能挡住我！', 'tone': '自信且挑衅'}}
2025-03-10 23:37:13,243 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:13,243 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:37:13,244 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:37:13,244 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:37:13,245 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:37:13,245 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:37:13,246 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:37:13,247 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:37:13,247 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:37:13,248 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:37:13,248 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:37:13,249 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:37:20,859 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":80,"confidence":0.85},"reasoning":{"hand_strength":"A♦和J♦是较强的起手牌，尤其是同花潜力大，适合在PRE_FLOP阶段积极行动。","position_analysis":"位置2是早期位置，适合通过加注来获取主动权，避免被对手压制。","pot_odds":"底池70，当前最大注40，加注到80可以迫使对手做出更大的决策，增加底池价值。","opponent_reads":["ai_1加注到40，显示出一定的牌力，但筹码较少，可能不愿意冒险跟注更大的加注。"]},"table_talk":{"message":"看来有人想早点结束游戏，那我就再加把劲吧。","tone":"自信且略带挑衅"}}
2025-03-10 23:37:20,859 - src.agents.llm - INFO - ==================================================

2025-03-10 23:37:20,860 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '看来有人想早点结束游戏，那我就再加把劲吧。', 'tone': '自信且略带挑衅'}
2025-03-10 23:37:20,860 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 80
2025-03-10 23:37:20,860 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 23:37:20,860 - src.engine.state - INFO - 玩家 ai_2 加注到 80 筹码，已标记为已行动
2025-03-10 23:37:20,860 - src.engine.game - INFO - 玩家 ai_2 加注到 80
2025-03-10 23:37:20,861 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 23:37:20,861 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:37:20,861 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:37:20,861 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:20,861 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:37:20,861 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:37:20,862 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:37:20,862 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:20,862 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:37:20,862 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:20,862 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:37:20,862 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:37:20,863 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:37:20,863 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:37:20,863 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 140, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', '8♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 180, 'current_bet': 40, 'is_active': True, 'cards': ('10♣', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 810, 'current_bet': 80, 'is_active': True, 'cards': ('A♦', 'J♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 80}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想早点结束游戏，那我就再加把劲吧。', 'tone': '自信且略带挑衅'}}
2025-03-10 23:37:20,866 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:20,866 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:37:20,867 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:20,867 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:37:20,868 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:37:20,868 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:37:34,461 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:37:34,461 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:37:34.461415', 'table_talk': None}
2025-03-10 23:37:34,462 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:37:34,462 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:37:34,462 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:37:34,462 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:37:34,464 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:37:34,464 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:37:34,465 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:34,465 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:37:34,466 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:37:34,466 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:37:34,466 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:34,467 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:37:34,467 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:34,468 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:37:34,468 - src.engine.game - INFO - 玩家 ai_1 下注额(40)不等于最大下注额(80)，回合继续
2025-03-10 23:37:34,468 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:37:34,469 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:37:34,469 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 140, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 180, 'current_bet': 40, 'is_active': True, 'cards': ('10♣', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 810, 'current_bet': 80, 'is_active': True, 'cards': ('A♦', 'J♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:37:34,470 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:34,471 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:37:34,471 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:34,471 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:37:34,471 - src.engine.game - INFO - 玩家 ai_1 下注额(40)不等于最大下注额(80)，回合继续
2025-03-10 23:37:34,472 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:37:35,891 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:37:35,891 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:37:35,892 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:37:35,892 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:37:35,894 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:37:35,895 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:37:59,951 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": 80, "confidence": 0.7}, "reasoning": {"hand_strength": "手牌10♣, Q♣虽然不是顶级起手牌，但同花连子牌有潜力出现顺子或同花，具备隐含赢利性", "position_analysis": "在前位，虽然信息较少，但可以通过后续策略和翻牌判断调整决策", "pot_odds": "底池为140，跟注80后总底池为220，投入与潜在回报的比例尚可", "opponent_reads": ["对手ai_2筹码充裕且以激进风格出现，其加注可能表明强牌，也可能带有一定的诈唬成分"]}, "table_talk": {"message": "我就跟一把，看看翻牌会不会给我一点惊喜。", "tone": "自信而略带挑衅"}}
2025-03-10 23:37:59,953 - src.agents.llm - INFO - ==================================================

2025-03-10 23:37:59,953 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我就跟一把，看看翻牌会不会给我一点惊喜。', 'tone': '自信而略带挑衅'}
2025-03-10 23:37:59,954 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:37:59,954 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:37:59,954 - src.engine.state - INFO - 玩家 ai_1 跟注 40 筹码，已标记为已行动
2025-03-10 23:37:59,954 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:37:59,955 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:37:59,955 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:37:59,955 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:37:59,956 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:59,957 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:37:59,957 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:37:59,958 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:37:59,958 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:59,959 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:37:59,959 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:37:59,960 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:37:59,960 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:37:59,961 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:37:59,962 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:37:59,962 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:37:59,963 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:37:59,963 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:37:59,963 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:37:59,964 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:37:59,964 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:37:59,965 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:37:59,965 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:37:59,966 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 23:37:59,966 - src.engine.dealer - INFO - Dealt 3 community cards: ['2♠', '2♥', 'A♥']
2025-03-10 23:37:59,967 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['2♠', '2♥', 'A♥']
2025-03-10 23:37:59,967 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('ai_1', 1), ('ai_2', 2)]
2025-03-10 23:37:59,968 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:37:59,968 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: ai_1, 位置: 1
2025-03-10 23:37:59,969 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:37:59,969 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 180, 'community_cards': ['2♠', '2♥', 'A♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 0, 'is_active': True, 'cards': ('10♣', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 810, 'current_bet': 0, 'is_active': True, 'cards': ('A♦', 'J♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我就跟一把，看看翻牌会不会给我一点惊喜。', 'tone': '自信而略带挑衅'}}
2025-03-10 23:37:59,970 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:37:59,971 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:37:59,971 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:37:59,971 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:37:59,972 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:37:59,972 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:37:59,974 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:37:59,974 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:37:59,974 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:37:59,975 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:37:59,975 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:37:59,976 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:38:18,587 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌仅有10♣和Q♣，与公共牌2♠,2♥,A♥组合后仅形成高牌，没有配对或顺子、同花等潜力，整体手牌较弱", "position_analysis": "身处早位，面对两位展现激进动作的对手，处境不利", "pot_odds": "底池180，需投入80即可跟注，但考虑到牌力较弱且投资回报不确定，不具优势", "opponent_reads": ["ai_2和ai_1均已激进加注和跟注，暗示对手可能握有较强牌力"]}, "table_talk": {"message": "今天牌运不佳，我不愿在这里送人情，祝各位好运。", "tone": "冷静且带有挑衅"} }
2025-03-10 23:38:18,588 - src.agents.llm - INFO - ==================================================

2025-03-10 23:38:18,589 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今天牌运不佳，我不愿在这里送人情，祝各位好运。', 'tone': '冷静且带有挑衅'}
2025-03-10 23:38:18,589 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:38:18,589 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:38:18,590 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:38:18,590 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:38:18,590 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:38:18,590 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:38:18,591 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:38:18,591 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:38:18,591 - src.engine.state - INFO - 玩家 ai_2 获得底池 180 筹码，当前筹码: 990
2025-03-10 23:38:18,591 - src.engine.game - INFO - 玩家 ai_2 获得底池 180 筹码
2025-03-10 23:38:18,592 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:38:18,592 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 180, 'winning_hand': None, 'community_cards': ['2♠', '2♥', 'A♥'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♦', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:38:18,593 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['2♠', '2♥', 'A♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 180, 'winning_hand': None, 'community_cards': ['2♠', '2♥', 'A♥'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♦', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 990, 'current_bet': 0, 'is_active': False, 'cards': ('A♦', 'J♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天牌运不佳，我不愿在这里送人情，祝各位好运。', 'tone': '冷静且带有挑衅'}}
2025-03-10 23:38:18,595 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:38:18,595 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:38:18,596 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:38:18,596 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:38:18,596 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:38:18,597 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:38:18,597 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 180, 'winning_hand': None, 'community_cards': ['2♠', '2♥', 'A♥'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♦', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:38:18,598 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:38:24,225 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:38:24,226 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:38:24,226 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:38:24,227 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:38:24,228 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:38:24,228 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:38:24,229 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:38:24,229 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♥', '7♥')
2025-03-10 23:38:24,229 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♠', 'K♦')
2025-03-10 23:38:24,230 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♥', '8♦')
2025-03-10 23:38:24,230 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:38:24,231 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:38:24,231 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:38:24,232 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:38:24,232 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:38:24,232 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:38:24,232 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:38:24,233 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:38:31,199 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:38:31,200 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:38:31.200337', 'table_talk': None}
2025-03-10 23:38:31,200 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:38:31,201 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:38:31,201 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:38:31,202 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:38:31,202 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:38:31,203 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:38:31,204 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:38:31,204 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:38:31,204 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:38:31,205 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:38:31,205 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:38:31,206 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:38:31,206 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:38:31,207 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:38:31,207 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:38:31,207 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:38:31,208 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:38:31,208 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:38:31,209 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 20, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 130, 'current_bet': 10, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:38:31,209 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:38:31,210 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:38:31,210 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:38:31,210 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:38:31,210 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:38:31,211 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:38:31,211 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:38:33,640 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:38:33,642 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:38:33,642 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:38:33,643 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:38:33,644 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:38:33,644 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:38:51,871 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.7"}, "reasoning": {"hand_strength": "K♠与4♦组合没有明显优势，国王虽有潜力但4较弱导致整体牌力处于中下水平", "position_analysis": "目前处于较早位置，信息有限，保持谨慎的跟注以观察后续行动", "pot_odds": "目前底池为50，跟注20筹码，赔率合理，风险较低", "opponent_reads": ["player_0选择CALL可能暗示较宽的起手范围", "ai_2处于活跃状态，可能持有多种牌型"]}, "table_talk": {"message": "先跟注看看翻牌如何，机会来了再让他们多付点代价。", "tone": "自信且略带试探"}}
2025-03-10 23:38:51,872 - src.agents.llm - INFO - ==================================================

2025-03-10 23:38:51,872 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '先跟注看看翻牌如何，机会来了再让他们多付点代价。', 'tone': '自信且略带试探'}
2025-03-10 23:38:51,873 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:38:51,873 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:38:51,874 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-10 23:38:51,874 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:38:51,875 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:38:51,875 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:38:51,876 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:38:51,876 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:38:51,877 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:38:51,878 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:38:51,879 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:38:51,879 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:38:51,879 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:38:51,881 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:38:51,882 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:38:51,882 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:38:51,882 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:38:51,883 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:38:51,883 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:38:51,884 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:38:51,884 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 20, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 20, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '先跟注看看翻牌如何，机会来了再让他们多付点代价。', 'tone': '自信且略带试探'}}
2025-03-10 23:38:51,885 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:38:51,886 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:38:51,886 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:38:51,887 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:38:51,887 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:38:51,887 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:38:51,888 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:38:51,888 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:38:51,889 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:38:51,890 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:38:51,890 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:38:51,891 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:38:51,891 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:38:51,891 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:39:00,026 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌5♥和8♦在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位于2号位，行动顺序较早，不利于观察对手行为","pot_odds":"当前底池60，跟注20的赔率较低，不值得冒险","opponent_reads":["player_0和ai_1都选择了跟注，表明他们可能有较强的手牌或策略"]},"table_talk":{"message":"看来我的手牌不够强，这次我先退出","tone":"轻松"}}
2025-03-10 23:39:00,028 - src.agents.llm - INFO - ==================================================

2025-03-10 23:39:00,028 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我的手牌不够强，这次我先退出', 'tone': '轻松'}
2025-03-10 23:39:00,029 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:39:00,029 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:39:00,029 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:39:00,029 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:39:00,031 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:39:00,031 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:39:00,032 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:39:00,032 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:39:00,032 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:39:00,033 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:39:00,033 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:39:00,034 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:39:00,034 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:39:00,035 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:39:00,035 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:39:00,035 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:39:00,036 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:39:00,036 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:39:00,037 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:39:00,037 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:39:00,037 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:39:00,038 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:39:00,038 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:39:00,039 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:39:00,039 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:39:00,040 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:39:00,040 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:39:00,040 - src.engine.dealer - INFO - Dealt 3 community cards: ['Q♥', '8♥', '10♦']
2025-03-10 23:39:00,041 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['Q♥', '8♥', '10♦']
2025-03-10 23:39:00,041 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:39:00,041 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:39:00,042 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 23:39:00,042 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:39:00,043 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 60, 'community_cards': ['Q♥', '8♥', '10♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我的手牌不够强，这次我先退出', 'tone': '轻松'}}
2025-03-10 23:39:00,044 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:39:00,044 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:39:00,045 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:39:00,045 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:39:00,045 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:39:00,046 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:39:00,047 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:39:00,047 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:39:00,047 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:39:00,047 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:39:00,048 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:39:00,048 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:39:27,808 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CHECK", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "目前只有K高，没有对子或明显的顺子/同花听牌，手牌整体较弱", "position_analysis": "处于较前位置，先行动需要谨慎，不容易控制局面", "pot_odds": "底池60筹码，不需要投入额外资金，应利用这一点观察对手反应", "opponent_reads": ["对手之前的CALL可能表明他们具有中等范围的牌，激进加注风险较大"]}, "table_talk": {"message": "我今天选择观察一下，看看接下来的牌会带来什么惊喜。", "tone": "冷静而略带调侃"}}
2025-03-10 23:39:27,809 - src.agents.llm - INFO - ==================================================

2025-03-10 23:39:27,809 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '我今天选择观察一下，看看接下来的牌会带来什么惊喜。', 'tone': '冷静而略带调侃'}
2025-03-10 23:39:27,809 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-03-10 23:39:27,811 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-03-10 23:39:27,811 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-03-10 23:39:27,811 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-03-10 23:39:27,811 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:39:27,811 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:39:27,811 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:39:27,811 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:39:27,811 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:39:27,812 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:39:27,812 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:39:27,812 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:39:27,812 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:39:27,812 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:39:27,812 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:39:27,813 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:39:27,813 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:39:27,814 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 60, 'community_cards': ['Q♥', '8♥', '10♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我今天选择观察一下，看看接下来的牌会带来什么惊喜。', 'tone': '冷静而略带调侃'}}
2025-03-10 23:39:27,815 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:39:27,815 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:39:27,816 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:39:27,816 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:39:27,817 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:39:27,817 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:40:02,868 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:40:02,868 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:40:02.868118', 'table_talk': None}
2025-03-10 23:40:02,869 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:40:02,869 - src.engine.state - INFO - 玩家 player_0 跟注 0 筹码，已标记为已行动
2025-03-10 23:40:02,869 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:40:02,870 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:40:02,870 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:40:02,870 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:40:02,871 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:40:02,871 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:40:02,871 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:40:02,872 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:40:02,872 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:40:02,873 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:02,873 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:40:02,873 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:40:02,874 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:40:02,874 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:40:02,875 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:40:02,875 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:40:02,875 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:40:02,876 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:40:02,876 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:40:02,877 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:40:02,877 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:40:02,877 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:02,878 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:40:02,878 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:40:02,879 - src.engine.dealer - INFO - Dealt 1 community cards: ['Q♦']
2025-03-10 23:40:02,879 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['Q♥', '8♥', '10♦', 'Q♦']
2025-03-10 23:40:02,880 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:40:02,880 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:40:02,880 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_1, 位置: 1
2025-03-10 23:40:02,881 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:40:02,881 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 60, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:40:02,882 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:40:02,882 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:02,883 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:40:02,883 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:40:02,883 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:40:02,884 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:40:07,837 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:40:07,837 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:40:07,838 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:40:07,838 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:40:07,839 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:40:07,839 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:40:30,100 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CHECK", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "手牌为K高牌，与公共牌组合后没有形成有效的顺子或同花，且公共牌已经形成对子，让整体牌面偏弱。", "position_analysis": "处于有利位置，能观察对手反应，但目前手上牌力不足以主动攻击。", "pot_odds": "底池60已经较小，CHECK可以免费看到河牌以寻找转机或诱发对手行动。", "opponent_reads": ["对手多次跟注，暗示可能持有中等或较强牌力，不容易被轻易吓退"]}, "table_talk": {"message": "大家似乎都有所保留，先静观其变，再决定下一步行动。", "tone": "冷静"}}
2025-03-10 23:40:30,102 - src.agents.llm - INFO - ==================================================

2025-03-10 23:40:30,104 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '大家似乎都有所保留，先静观其变，再决定下一步行动。', 'tone': '冷静'}
2025-03-10 23:40:30,104 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-03-10 23:40:30,105 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-03-10 23:40:30,107 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-03-10 23:40:30,108 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-03-10 23:40:30,108 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:40:30,109 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:40:30,109 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:40:30,110 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:40:30,110 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 player_0
2025-03-10 23:40:30,110 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:40:30,110 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:40:30,112 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:30,112 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:40:30,113 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:40:30,113 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:40:30,114 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:40:30,114 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:40:30,115 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 60, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3850, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '大家似乎都有所保留，先静观其变，再决定下一步行动。', 'tone': '冷静'}}
2025-03-10 23:40:30,116 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:40:30,116 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:30,116 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:40:30,117 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:40:30,117 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:40:30,118 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:40:35,233 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 40}
2025-03-10 23:40:35,234 - server - INFO - 收到加注请求，金额: 40
2025-03-10 23:40:35,234 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 40, 'timestamp': '2025-03-10T23:40:35.234223', 'table_talk': None}
2025-03-10 23:40:35,235 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:40:35,235 - src.engine.state - INFO - 玩家 player_0 加注到 40 筹码，已标记为已行动
2025-03-10 23:40:35,236 - src.engine.game - INFO - 玩家 player_0 加注到 40
2025-03-10 23:40:35,237 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:40:35,238 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:40:35,238 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:40:35,239 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:40:35,239 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:40:35,240 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:40:35,240 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:40:35,240 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:40:35,240 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:35,242 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:40:35,243 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:40:35,243 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:40:35,243 - src.engine.game - INFO - 玩家 ai_1 下注额(0)不等于最大下注额(40)，回合继续
2025-03-10 23:40:35,244 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:40:35,244 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:40:35,244 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 100, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3810, 'current_bet': 40, 'is_active': True, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('4♠', 'K♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:40:35,245 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:40:35,246 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:40:35,246 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:40:35,246 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:40:35,247 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:40:35,247 - src.engine.game - INFO - 玩家 ai_1 下注额(0)不等于最大下注额(40)，回合继续
2025-03-10 23:40:35,247 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:40:40,138 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:40:40,139 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:40:40,140 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:40:40,140 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:40:40,140 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:40:40,142 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:41:01,579 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.85"}, "reasoning": {"hand_strength": "手牌K♦和4♠未能改善公共牌，只有高牌，整体牌力较弱", "position_analysis": "虽然位置不错，但遇到对手激进的加注，风险明显增大", "pot_odds": "底池100需跟40筹码，赔率不足以补偿在弱牌情况下的投入风险", "opponent_reads": ["对手近期行动积极，加注可能代表坚实牌型", "历史行动显示对手愿意主动施压，可能在用实力占优"]}, "table_talk": {"message": "你的激进我看得出来，今天我不跟你玩儿这一手。", "tone": "冷静且略带讽刺"}}
2025-03-10 23:41:01,580 - src.agents.llm - INFO - ==================================================

2025-03-10 23:41:01,580 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '你的激进我看得出来，今天我不跟你玩儿这一手。', 'tone': '冷静且略带讽刺'}
2025-03-10 23:41:01,580 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:41:01,580 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:41:01,581 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:41:01,581 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:41:01,582 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:41:01,582 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:41:01,583 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:41:01,583 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:41:01,583 - src.engine.state - INFO - 玩家 player_0 获得底池 100 筹码，当前筹码: 3910
2025-03-10 23:41:01,584 - src.engine.game - INFO - 玩家 player_0 获得底池 100 筹码
2025-03-10 23:41:01,584 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:41:01,585 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 100, 'winning_hand': None, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '7♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:41:01,585 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 100, 'winning_hand': None, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '7♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3910, 'current_bet': 40, 'is_active': False, 'cards': ('K♥', '7♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 970, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你的激进我看得出来，今天我不跟你玩儿这一手。', 'tone': '冷静且略带讽刺'}}
2025-03-10 23:41:01,587 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:01,587 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:41:01,588 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:41:01,588 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:41:01,589 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:41:01,589 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:41:01,589 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 100, 'winning_hand': None, 'community_cards': ['Q♥', '8♥', '10♦', 'Q♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '7♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:41:01,591 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:41:04,156 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:41:04,157 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:41:04,157 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:41:04,158 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:41:04,158 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:41:04,159 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:41:04,159 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:41:04,159 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♥', '6♥')
2025-03-10 23:41:04,160 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♣', '10♠')
2025-03-10 23:41:04,160 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♠', '7♥')
2025-03-10 23:41:04,161 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:41:04,161 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:41:04,162 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:41:04,162 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:41:04,162 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:41:04,164 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:41:04,164 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:41:04,164 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:41:06,578 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:41:06,580 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:41:06,580 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:41:06,581 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:41:06,581 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:41:06,582 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:41:18,561 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "起手牌4♣和10♠在德州扑克中较弱，没有足够潜力形成强牌", "position_analysis": "处于较早的位置，加上手牌较低，不适合在多方加注的局面中冒险", "pot_odds": "底池仅30，对跟注20的赔率不足以弥补手牌劣势", "opponent_reads": ["player_0表现激进，加注显示有较强投入", "ai_2虽下注较低但依然在活跃状态"]}, "table_talk": {"message": "这手牌真不给力，我选择保住筹码再找机会", "tone": "冷静且坚定"}}
2025-03-10 23:41:18,562 - src.agents.llm - INFO - ==================================================

2025-03-10 23:41:18,562 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌真不给力，我选择保住筹码再找机会', 'tone': '冷静且坚定'}
2025-03-10 23:41:18,563 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:41:18,563 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:41:18,564 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:41:18,564 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:41:18,564 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:41:18,565 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:41:18,565 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:41:18,567 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:18,567 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:41:18,567 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:41:18,568 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:41:18,568 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:18,569 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:41:18,569 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:18,570 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:41:18,570 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:41:18,570 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:41:18,571 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:41:18,571 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 20, 'is_active': True, 'cards': ('3♥', '6♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 960, 'current_bet': 10, 'is_active': True, 'cards': ('5♠', '7♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌真不给力，我选择保住筹码再找机会', 'tone': '冷静且坚定'}}
2025-03-10 23:41:18,572 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:18,573 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:41:18,573 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:18,574 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:41:18,574 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:41:18,574 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:41:18,576 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:41:18,576 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:41:18,577 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:41:18,577 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:41:18,578 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:41:18,578 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:41:25,659 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌5♠,7♥在PRE_FLOP阶段非常弱，几乎没有成牌的潜力","position_analysis":"位于2号位，行动较早，缺乏信息优势","pot_odds":"底池赔率不理想，跟注或加注的风险远高于潜在收益","opponent_reads":["对手player_0下注20，可能是试探性下注，但手牌5♠,7♥不足以应对潜在的风险"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静且自信"}}
2025-03-10 23:41:25,660 - src.agents.llm - INFO - ==================================================

2025-03-10 23:41:25,660 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静且自信'}
2025-03-10 23:41:25,660 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:41:25,661 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:41:25,661 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:41:25,662 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:41:25,662 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:41:25,663 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:41:25,663 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:41:25,664 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:41:25,664 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3920
2025-03-10 23:41:25,665 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:41:25,665 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:41:25,666 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♥', '6♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:41:25,666 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♥', '6♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3920, 'current_bet': 20, 'is_active': False, 'cards': ('3♥', '6♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静且自信'}}
2025-03-10 23:41:25,667 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:25,667 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:41:25,669 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:41:25,669 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:41:25,669 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:41:25,670 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:41:25,670 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♥', '6♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:41:25,671 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:41:27,585 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:41:27,586 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:41:27,587 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:41:27,587 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:41:27,588 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:41:27,588 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:41:27,589 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:41:27,589 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', 'Q♣')
2025-03-10 23:41:27,589 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♠', '9♠')
2025-03-10 23:41:27,590 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♦', '3♣')
2025-03-10 23:41:27,590 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:41:27,590 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:41:27,591 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:41:27,591 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:41:27,592 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:41:27,592 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:41:27,592 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:41:27,593 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:41:30,655 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:41:30,656 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:41:30,657 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:41:30,658 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:41:30,658 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:41:30,659 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:41:36,414 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌K♦, 3♣在PRE_FLOP阶段较弱，缺乏潜在的牌型发展空间","position_analysis":"位置2在早期行动，缺乏信息优势","pot_odds":"底池赔率不理想，不值得冒险跟注或加注","opponent_reads":["对手player_0筹码较多，可能采取激进策略","对手ai_1筹码较少，可能采取保守策略"]},"table_talk":{"message":"看来这手牌不太适合我，我选择退出","tone":"冷静"}}
2025-03-10 23:41:36,416 - src.agents.llm - INFO - ==================================================

2025-03-10 23:41:36,416 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择退出', 'tone': '冷静'}
2025-03-10 23:41:36,417 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:41:36,417 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:41:36,419 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:41:36,419 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:41:36,420 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:41:36,420 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:41:36,421 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:41:36,421 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:36,422 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:41:36,422 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:41:36,423 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:41:36,423 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:36,424 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:41:36,424 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:36,424 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:41:36,425 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:41:36,425 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:41:36,425 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:41:36,426 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3910, 'current_bet': 10, 'is_active': True, 'cards': ('10♠', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 100, 'current_bet': 20, 'is_active': True, 'cards': ('Q♠', '9♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择退出', 'tone': '冷静'}}
2025-03-10 23:41:36,427 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:36,427 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:41:36,427 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:36,428 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:41:36,428 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:41:36,429 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:41:56,700 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:41:56,701 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:41:56.701830', 'table_talk': None}
2025-03-10 23:41:56,702 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:41:56,702 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:41:56,703 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:41:56,703 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:41:56,705 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:41:56,706 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:41:56,706 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:41:56,707 - src.engine.state - INFO - 玩家 ai_1 获得底池 30 筹码，当前筹码: 130
2025-03-10 23:41:56,707 - src.engine.game - INFO - 玩家 ai_1 获得底池 30 筹码
2025-03-10 23:41:56,707 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:41:56,708 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♠', '9♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:41:56,708 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♠', '9♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3910, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 130, 'current_bet': 20, 'is_active': False, 'cards': ('Q♠', '9♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 960, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:41:56,709 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:56,710 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:41:56,710 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:41:56,711 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:41:56,711 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:41:56,712 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:41:56,713 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♠', '9♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:41:56,713 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:41:57,815 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:41:57,816 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:41:57,817 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:41:57,817 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:41:57,819 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:41:57,819 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:41:57,820 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:41:57,820 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♠', '7♥')
2025-03-10 23:41:57,821 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♦', 'A♠')
2025-03-10 23:41:57,821 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♥', 'K♠')
2025-03-10 23:41:57,822 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:41:57,822 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:41:57,823 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:41:57,823 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:41:57,823 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:41:57,824 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:41:57,824 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:41:57,824 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:41:59,731 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:41:59,731 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:41:59.731776', 'table_talk': None}
2025-03-10 23:41:59,732 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:41:59,732 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:41:59,733 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:41:59,733 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:41:59,734 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:41:59,735 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:41:59,735 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:59,736 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:41:59,736 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:41:59,736 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:41:59,737 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:59,737 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:41:59,738 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:59,739 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:41:59,739 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:41:59,739 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:41:59,739 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:41:59,740 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3910, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 120, 'current_bet': 10, 'is_active': True, 'cards': ('3♦', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:41:59,740 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:41:59,741 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:41:59,741 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:41:59,741 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:41:59,742 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:41:59,742 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:42:01,486 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:42:01,487 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:42:01,487 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:42:01,487 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:42:01,488 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:42:01,488 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:42:41,575 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"20","confidence":"0.7"},"reasoning":{"hand_strength":"手牌为3♦和A♠，虽然拥有顶级高牌A，但3作为搭档显得较弱，缺乏良好的连牌或对子潜力，因此整体手牌实力中等偏下。","position_analysis":"处于较前位置，虽然不占有明显优势，但跟注可以控制底池规模，为翻牌后观察对手行为赢得机会。","pot_odds":"底池当前30，加上对手已下注20，总底池50，对跟注20的投入来看赔率合理。","opponent_reads":["对手状态激活且拥有较大筹码，可能采取激进策略试图偷池，需要谨慎应对。"]},"table_talk":{"message":"跟注吧，让我们看看翻牌后局势如何发展！","tone":"轻松自信"}}
2025-03-10 23:42:41,576 - src.agents.llm - INFO - ==================================================

2025-03-10 23:42:41,578 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '跟注吧，让我们看看翻牌后局势如何发展！', 'tone': '轻松自信'}
2025-03-10 23:42:41,578 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:42:41,579 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:42:41,580 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-10 23:42:41,581 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:42:41,582 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:42:41,582 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:42:41,583 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:42:41,583 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:42:41,584 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:42:41,584 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:42:41,585 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:42:41,585 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:42:41,586 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:42:41,586 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:42:41,587 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:42:41,587 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:42:41,588 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:42:41,588 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:42:41,588 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:42:41,588 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3910, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 940, 'current_bet': 20, 'is_active': True, 'cards': ('9♥', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '跟注吧，让我们看看翻牌后局势如何发展！', 'tone': '轻松自信'}}
2025-03-10 23:42:41,590 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:42:41,590 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:42:41,591 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:42:41,592 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:42:41,592 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:42:41,593 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:42:41,593 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:42:41,594 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:42:41,595 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:42:41,595 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:42:41,596 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:42:41,596 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:42:41,596 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:42:47,239 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌9♥, K♠在PRE_FLOP阶段较弱，没有明显的优势","position_analysis":"位置2在早期位置，不利于后续行动","pot_odds":"底池赔率不高，不值得冒险","opponent_reads":["对手ai_1选择跟注，可能持有较强手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:42:47,240 - src.agents.llm - INFO - ==================================================

2025-03-10 23:42:47,240 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:42:47,240 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:42:47,240 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:42:47,240 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:42:47,241 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:42:47,241 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:42:47,241 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:42:47,241 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:42:47,241 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:42:47,242 - src.engine.state - INFO - 玩家 ai_1 获得底池 40 筹码，当前筹码: 150
2025-03-10 23:42:47,242 - src.engine.game - INFO - 玩家 ai_1 获得底池 40 筹码
2025-03-10 23:42:47,243 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:42:47,243 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('3♦', 'A♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:42:47,244 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('3♦', 'A♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3910, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 150, 'current_bet': 20, 'is_active': False, 'cards': ('3♦', 'A♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 940, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:42:47,245 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:42:47,246 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:42:47,246 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:42:47,247 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:42:47,247 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:42:47,248 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:42:47,248 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('3♦', 'A♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:42:47,248 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:42:49,040 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:42:49,041 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:42:49,041 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:42:49,041 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:42:49,042 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:42:49,042 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:42:49,043 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:42:49,043 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♣', '4♠')
2025-03-10 23:42:49,043 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♠', 'J♦')
2025-03-10 23:42:49,044 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♦', '2♠')
2025-03-10 23:42:49,044 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:42:49,044 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:42:49,045 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:42:49,045 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:42:49,046 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:42:49,046 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:42:49,046 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:42:49,046 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:42:52,272 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:42:52,272 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:42:52,273 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:42:52,274 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:42:52,274 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:42:52,275 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:43:15,036 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.7"}, "reasoning": {"hand_strength": "手牌10♠, J♦虽非顶级，但有一定的连牌潜力，适合观察翻牌情况", "position_analysis": "处于第一位置，需谨慎行动，在前面的玩家已下注的情况下选择跟注较为保守", "pot_odds": "底池30对20的跟注金额，赔率尚可，适合以较低成本看翻牌", "opponent_reads": ["player_0已经下了20注，可能持有较强牌型或试图利用位置优势", "ai_2下注较少，显示出较为保守的风格"]}, "table_talk": {"message": "我只想稳健观望，看看你们接下来的动作", "tone": "平静而自信"}}
2025-03-10 23:43:15,037 - src.agents.llm - INFO - ==================================================

2025-03-10 23:43:15,038 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我只想稳健观望，看看你们接下来的动作', 'tone': '平静而自信'}
2025-03-10 23:43:15,039 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:43:15,039 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:43:15,040 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 23:43:15,040 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:43:15,041 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:43:15,041 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:43:15,042 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:43:15,042 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:15,043 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:43:15,043 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:43:15,044 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:43:15,044 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:15,045 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:43:15,045 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:15,045 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:43:15,046 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:43:15,046 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:15,047 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:43:15,047 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '4♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 130, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 930, 'current_bet': 10, 'is_active': True, 'cards': ('K♦', '2♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我只想稳健观望，看看你们接下来的动作', 'tone': '平静而自信'}}
2025-03-10 23:43:15,049 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:15,050 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:43:15,050 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:15,051 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:43:15,051 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:43:15,052 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:15,053 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:43:15,054 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:43:15,054 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:43:15,054 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:43:15,055 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:43:15,055 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:43:20,816 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌K♦和2♠在PRE_FLOP阶段较弱，缺乏潜力","position_analysis":"位置2在早期行动，不利于观察对手行为","pot_odds":"底池赔率较低，不值得冒险","opponent_reads":["ai_1选择了CALL，可能持有中等强度的手牌"]},"table_talk":{"message":"看来我得放弃这一手了，祝你们好运！","tone":"轻松"}}
2025-03-10 23:43:20,817 - src.agents.llm - INFO - ==================================================

2025-03-10 23:43:20,817 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来我得放弃这一手了，祝你们好运！', 'tone': '轻松'}
2025-03-10 23:43:20,818 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:43:20,818 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:43:20,818 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:43:20,819 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:43:20,819 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:43:20,820 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:43:20,820 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:43:20,821 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:20,821 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:43:20,822 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:43:20,823 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:43:20,823 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:20,823 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:43:20,824 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:20,825 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:43:20,826 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:43:20,827 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:20,827 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:43:20,828 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', '4♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 130, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来我得放弃这一手了，祝你们好运！', 'tone': '轻松'}}
2025-03-10 23:43:20,829 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:20,829 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:43:20,830 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:20,830 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:43:20,831 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:43:20,831 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:35,262 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-10 23:43:35,262 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-10T23:43:35.262575', 'table_talk': None}
2025-03-10 23:43:35,263 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-10 23:43:35,263 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-10 23:43:35,264 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-10 23:43:35,264 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:43:35,264 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:43:35,265 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:35,265 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:43:35,266 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:43:35,266 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:43:35,266 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:35,267 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:43:35,268 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:35,268 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:43:35,269 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:43:35,269 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:43:35,269 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:43:35,270 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:43:35,270 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:43:35,270 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:43:35,271 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:43:35,271 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:43:35,272 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:43:35,272 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:43:35,272 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:43:35,273 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:43:35,273 - src.engine.dealer - INFO - Dealt 3 community cards: ['K♥', '6♠', '10♦']
2025-03-10 23:43:35,273 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['K♥', '6♠', '10♦']
2025-03-10 23:43:35,274 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:43:35,274 - src.engine.game - INFO - 庄家位置: 4
2025-03-10 23:43:35,274 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:43:35,275 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:43:35,275 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['K♥', '6♠', '10♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': True, 'cards': ('2♣', '4♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 130, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:43:35,277 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:35,277 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:43:35,277 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:43:35,278 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:43:35,278 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:43:35,278 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:39,355 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:43:39,356 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:43:39.356018', 'table_talk': None}
2025-03-10 23:43:39,356 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:43:39,357 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:43:39,358 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:43:39,358 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:43:39,359 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:43:39,359 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:43:39,360 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:43:39,360 - src.engine.state - INFO - 玩家 ai_1 获得底池 50 筹码，当前筹码: 180
2025-03-10 23:43:39,360 - src.engine.game - INFO - 玩家 ai_1 获得底池 50 筹码
2025-03-10 23:43:39,360 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:43:39,361 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 50, 'winning_hand': None, 'community_cards': ['K♥', '6♠', '10♦'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('10♠', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:43:39,361 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['K♥', '6♠', '10♦'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 50, 'winning_hand': None, 'community_cards': ['K♥', '6♠', '10♦'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('10♠', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 180, 'current_bet': 0, 'is_active': False, 'cards': ('10♠', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 930, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:43:39,362 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:39,363 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:43:39,363 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:43:39,363 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:43:39,364 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:43:39,364 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:43:39,364 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 50, 'winning_hand': None, 'community_cards': ['K♥', '6♠', '10♦'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('10♠', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:43:39,365 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:43:40,270 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:43:40,272 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:43:40,273 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:43:40,273 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:43:40,274 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:43:40,275 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:43:40,276 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:43:40,276 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♠', '2♣')
2025-03-10 23:43:40,277 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♥', '10♣')
2025-03-10 23:43:40,278 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♦', 'K♠')
2025-03-10 23:43:40,279 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:43:40,280 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:43:40,280 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:43:40,281 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:43:40,281 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:43:40,282 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:43:40,282 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:43:40,283 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:43:44,833 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:43:44,834 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:43:44.834181', 'table_talk': None}
2025-03-10 23:43:44,835 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:43:44,835 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:43:44,836 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:43:44,836 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:43:44,837 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:43:44,837 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:43:44,838 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:44,839 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:43:44,839 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:43:44,840 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:43:44,840 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:44,840 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:43:44,841 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:44,841 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:43:44,842 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:43:44,842 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:44,842 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:43:44,843 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 170, 'current_bet': 10, 'is_active': True, 'cards': ('Q♥', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:43:44,843 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:43:44,844 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:43:44,844 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:43:44,845 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:43:44,845 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:43:44,846 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:43:45,899 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:43:45,900 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:43:45,900 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:43:45,902 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:43:45,902 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:43:45,902 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:44:05,381 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.7"}, "reasoning": {"hand_strength": "虽然Q♥和10♣不是顶级起手牌，但具备顺子和同花的潜力，可转化为中等以上的牌型", "position_analysis": "处在较早位置，利用先发制人的加注来施加压力，同时借此隐藏手牌弱点", "pot_odds": "当前底池30，对20的跟注风险相对合理，加注可以有效争夺底池", "opponent_reads": ["对手ai_2积极且筹码充裕，但可能在面对突然加注时感到心理压力"]}, "table_talk": {"message": "今晚的牌局得看我如何让对手出错，准备好迎接挑战了吗？", "tone": "自信而挑衅"}}
2025-03-10 23:44:05,382 - src.agents.llm - INFO - ==================================================

2025-03-10 23:44:05,383 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 23:44:05,384 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '今晚的牌局得看我如何让对手出错，准备好迎接挑战了吗？', 'tone': '自信而挑衅'}
2025-03-10 23:44:05,384 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 23:44:05,385 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:44:05,385 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 23:44:05,387 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 23:44:05,387 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:44:05,388 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:44:05,389 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:44:05,389 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:44:05,390 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:44:05,391 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:44:05,391 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:44:05,392 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:05,392 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:44:05,393 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:44:05,393 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:44:05,394 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:44:05,394 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:44:05,395 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:44:05,395 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:44:05,396 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 40, 'is_active': True, 'cards': ('Q♥', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 910, 'current_bet': 20, 'is_active': True, 'cards': ('2♦', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚的牌局得看我如何让对手出错，准备好迎接挑战了吗？', 'tone': '自信而挑衅'}}
2025-03-10 23:44:05,397 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:05,398 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:44:05,398 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:44:05,399 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:44:05,399 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:44:05,400 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:44:05,400 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:44:05,402 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:44:05,402 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:44:05,403 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:44:05,403 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:44:05,403 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:44:05,404 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:44:11,728 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌2♦和K♠在PRE_FLOP阶段较弱，缺乏配合和潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，难以获得信息优势","pot_odds":"底池赔率不理想，不值得冒险跟注","opponent_reads":["对手ai_1进行了加注，显示出一定的牌力或策略性"]},"table_talk":{"message":"看来这手牌不适合继续，我选择弃牌","tone":"冷静"}}
2025-03-10 23:44:11,730 - src.agents.llm - INFO - ==================================================

2025-03-10 23:44:11,731 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合继续，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:44:11,731 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:44:11,732 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:44:11,733 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:44:11,733 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:44:11,734 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:44:11,734 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:44:11,735 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:44:11,735 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:44:11,736 - src.engine.state - INFO - 玩家 ai_1 获得底池 60 筹码，当前筹码: 200
2025-03-10 23:44:11,736 - src.engine.game - INFO - 玩家 ai_1 获得底池 60 筹码
2025-03-10 23:44:11,737 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:44:11,737 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♥', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:44:11,738 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♥', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 40, 'is_active': False, 'cards': ('Q♥', '10♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 910, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合继续，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:44:11,739 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:11,740 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:44:11,740 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:44:11,741 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:44:11,741 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:44:11,741 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:44:11,741 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('Q♥', '10♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:44:11,743 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:44:17,299 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:44:17,300 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:44:17,300 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:44:17,301 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:44:17,301 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:44:17,301 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:44:17,303 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:44:17,303 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♦', 'A♠')
2025-03-10 23:44:17,304 - src.engine.game - INFO - 玩家 ai_1 手牌: ('2♦', '4♥')
2025-03-10 23:44:17,305 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♠', '8♥')
2025-03-10 23:44:17,306 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:44:17,307 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:44:17,307 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:44:17,308 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:44:17,308 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:44:17,309 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:44:17,309 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:44:17,309 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:44:21,771 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:44:21,772 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:44:21,772 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:44:21,773 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:44:21,774 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:44:21,774 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:44:31,380 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌2♦, 4♥极其弱，几乎没有赢牌的潜力", "position_analysis": "在早期位置，而且牌力弱，不适合冒险", "pot_odds": "底池较小且必须面对加注，风险明显高于可能的收益", "opponent_reads": ["对手状态活跃，筹码充裕，可能利用我们的犹豫进行压制"]}, "table_talk": {"message": "抱歉各位，我今天今晚不打这手烂牌。", "tone": "冷静且果断"}}
2025-03-10 23:44:31,381 - src.agents.llm - INFO - ==================================================

2025-03-10 23:44:31,382 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉各位，我今天今晚不打这手烂牌。', 'tone': '冷静且果断'}
2025-03-10 23:44:31,382 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:44:31,382 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:44:31,382 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:44:31,383 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:44:31,383 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:44:31,383 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:44:31,383 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:44:31,383 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:44:31,383 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:44:31,384 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:44:31,384 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:44:31,384 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:31,384 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:44:31,384 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:44:31,384 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:44:31,385 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:44:31,385 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:44:31,385 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:44:31,385 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('5♦', 'A♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 900, 'current_bet': 10, 'is_active': True, 'cards': ('3♠', '8♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉各位，我今天今晚不打这手烂牌。', 'tone': '冷静且果断'}}
2025-03-10 23:44:31,385 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:31,385 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:44:31,385 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:44:31,386 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:44:31,386 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:44:31,387 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:44:31,388 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:44:31,388 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:44:31,389 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:44:31,389 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:44:31,389 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:44:31,389 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:44:37,771 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"手牌3♠和8♥在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"位置2在早期位置，不利于后续行动，容易被对手压制","pot_odds":"底池赔率不理想，跟注20的风险远高于潜在收益","opponent_reads":["对手player_0下注20，显示出一定的攻击性，可能持有较强的手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:44:37,772 - src.agents.llm - INFO - ==================================================

2025-03-10 23:44:37,773 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:44:37,773 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:44:37,773 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:44:37,773 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:44:37,773 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:44:37,774 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:44:37,774 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:44:37,774 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:44:37,774 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:44:37,775 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3900
2025-03-10 23:44:37,775 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:44:37,775 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:44:37,776 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♦', 'A♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:44:37,776 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♦', 'A♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3900, 'current_bet': 20, 'is_active': False, 'cards': ('5♦', 'A♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 900, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:44:37,778 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:37,778 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:44:37,778 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:44:37,779 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:44:37,779 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:44:37,780 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:44:37,780 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♦', 'A♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:44:37,781 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:44:42,703 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:44:42,704 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:44:42,704 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:44:42,704 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:44:42,706 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:44:42,706 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:44:42,707 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:44:42,707 - src.engine.game - INFO - 玩家 player_0 手牌: ('2♠', '8♥')
2025-03-10 23:44:42,707 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♥', '3♣')
2025-03-10 23:44:42,708 - src.engine.game - INFO - 玩家 ai_2 手牌: ('10♥', 'Q♦')
2025-03-10 23:44:42,708 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:44:42,708 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:44:42,709 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:44:42,709 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:44:42,710 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:44:42,710 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:44:42,711 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:44:42,711 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:44:42,798 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:44:42,798 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:44:42,799 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:44:42,800 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:44:42,801 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:44:42,801 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:44:49,720 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌10♥和Q♦在PRE_FLOP阶段相对较弱，缺乏成牌潜力","position_analysis":"位置2处于早期位置，不利于观察对手行动","pot_odds":"底池30与当前最大注20的赔率较低，不值得冒险跟注","opponent_reads":["player_0下注10，筹码充足，可能持有强牌","ai_1加注到20，筹码较少，可能试图利用筹码优势"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:44:49,721 - src.agents.llm - INFO - ==================================================

2025-03-10 23:44:49,722 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:44:49,722 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:44:49,723 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:44:49,723 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:44:49,724 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:44:49,724 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:44:49,724 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:44:49,726 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:44:49,726 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:44:49,727 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:44:49,728 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:44:49,728 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:44:49,729 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:49,730 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:44:49,730 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:44:49,731 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:44:49,731 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:44:49,731 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:44:49,732 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:44:49,732 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 10, 'is_active': True, 'cards': ('2♠', '8♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 180, 'current_bet': 20, 'is_active': True, 'cards': ('6♥', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 900, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:44:49,733 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:44:49,734 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:44:49,734 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:44:49,735 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:44:49,735 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:44:49,735 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:45:00,899 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:45:00,900 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:45:00.900973', 'table_talk': None}
2025-03-10 23:45:00,900 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:45:00,901 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:45:00,901 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:45:00,902 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:45:00,902 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:45:00,902 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:45:00,903 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:45:00,903 - src.engine.state - INFO - 玩家 ai_1 获得底池 30 筹码，当前筹码: 210
2025-03-10 23:45:00,903 - src.engine.game - INFO - 玩家 ai_1 获得底池 30 筹码
2025-03-10 23:45:00,904 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:45:00,904 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('6♥', '3♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:45:00,905 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('6♥', '3♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 210, 'current_bet': 20, 'is_active': False, 'cards': ('6♥', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 900, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:45:00,905 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:00,905 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:45:00,907 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:45:00,907 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:45:00,907 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:45:00,908 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:45:00,908 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('6♥', '3♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:45:00,909 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:45:01,815 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:45:01,815 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:45:01,816 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:45:01,816 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:45:01,816 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:45:01,817 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:45:01,817 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:45:01,818 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', '6♥')
2025-03-10 23:45:01,818 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♥', '8♣')
2025-03-10 23:45:01,818 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♣', '5♠')
2025-03-10 23:45:01,819 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:45:01,819 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:45:01,820 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:45:01,820 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:45:01,820 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:45:01,821 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:45:01,821 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:45:01,822 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:45:04,474 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:45:04,475 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:45:04.475907', 'table_talk': None}
2025-03-10 23:45:04,475 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:45:04,476 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:45:04,476 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:45:04,478 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:45:04,478 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:45:04,479 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:45:04,479 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:45:04,479 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:45:04,481 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:45:04,481 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:45:04,482 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:04,482 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:45:04,483 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:45:04,483 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:45:04,484 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:45:04,486 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:45:04,486 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:45:04,487 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 200, 'current_bet': 10, 'is_active': True, 'cards': ('4♥', '8♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:45:04,488 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:04,488 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:45:04,489 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:45:04,489 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:45:04,489 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:45:04,490 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:45:04,747 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:45:04,748 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:45:04,748 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:45:04,748 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:45:04,749 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:45:04,749 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:45:21,029 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌4♥和8♣在预翻牌阶段非常弱，缺乏形成有力组合的潜力", "position_analysis": "处于早期位置，信息不足，风险较大", "pot_odds": "目前底池较小，跟注或加注的投入与牌面实力不匹配", "opponent_reads": ["对手状态积极且筹码充裕，可能在后续加大攻势"]}, "table_talk": {"message": "今天不想浪费筹码，留着实力应对更有趣的局面。", "tone": "镇定且略带冷静的嘲讽"}}
2025-03-10 23:45:21,031 - src.agents.llm - INFO - ==================================================

2025-03-10 23:45:21,031 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今天不想浪费筹码，留着实力应对更有趣的局面。', 'tone': '镇定且略带冷静的嘲讽'}
2025-03-10 23:45:21,032 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:45:21,032 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:45:21,033 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:45:21,033 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:45:21,034 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:45:21,034 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:45:21,034 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:45:21,035 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:45:21,036 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 910
2025-03-10 23:45:21,036 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-10 23:45:21,036 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:45:21,037 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('7♣', '5♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:45:21,037 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('7♣', '5♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3890, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 910, 'current_bet': 20, 'is_active': False, 'cards': ('7♣', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天不想浪费筹码，留着实力应对更有趣的局面。', 'tone': '镇定且略带冷静的嘲讽'}}
2025-03-10 23:45:21,039 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:21,039 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:45:21,039 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:45:21,040 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:45:21,040 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:45:21,041 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:45:21,041 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('7♣', '5♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:45:21,042 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:45:25,851 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:45:25,852 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:45:25,853 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:45:25,853 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:45:25,855 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:45:25,855 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:45:25,855 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:45:25,856 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♦', '10♥')
2025-03-10 23:45:25,856 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♠', '10♠')
2025-03-10 23:45:25,856 - src.engine.game - INFO - 玩家 ai_2 手牌: ('8♠', '2♥')
2025-03-10 23:45:25,856 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:45:25,857 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:45:25,857 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:45:25,858 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:45:25,858 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:45:25,858 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:45:25,859 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:45:25,859 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:45:26,065 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:45:26,066 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:45:26,066 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:45:26,067 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:45:26,067 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:45:26,068 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:45:42,384 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "我的手牌5♠和10♠虽然同花，但缺少顺连性和高牌支持，整体实力较弱。", "position_analysis": "目前处于早位，容易被后位优势利用，对手的加注行为和丰富筹码显示他们可能拥有更强手牌。", "pot_odds": "底池30需投入20，赔率相对有限，无法弥补弱牌可能带来的风险。", "opponent_reads": ["玩家player_0筹码丰厚且已下注20，可能在积极施压；ai_2虽处于较低下注状态，但整体策略仍不容乐观。"]}, "table_talk": {"message": "抱歉，这手牌不在我的计划中，让你们享受这一局吧。", "tone": "冷静且果断"}}
2025-03-10 23:45:42,385 - src.agents.llm - INFO - ==================================================

2025-03-10 23:45:42,385 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '抱歉，这手牌不在我的计划中，让你们享受这一局吧。', 'tone': '冷静且果断'}
2025-03-10 23:45:42,386 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:45:42,386 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:45:42,387 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:45:42,387 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:45:42,388 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:45:42,388 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:45:42,389 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:45:42,389 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:45:42,390 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:45:42,390 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:45:42,390 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:45:42,392 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:42,392 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:45:42,392 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:45:42,393 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:45:42,393 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:45:42,394 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:45:42,394 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:45:42,394 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3870, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '10♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 900, 'current_bet': 10, 'is_active': True, 'cards': ('8♠', '2♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '抱歉，这手牌不在我的计划中，让你们享受这一局吧。', 'tone': '冷静且果断'}}
2025-03-10 23:45:42,395 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:42,396 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:45:42,396 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:45:42,396 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:45:42,397 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:45:42,397 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:45:42,398 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:45:42,399 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:45:42,399 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:45:42,400 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:45:42,400 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:45:42,401 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:45:48,993 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"手牌8♠和2♥非常弱，几乎没有形成强牌的可能性","position_analysis":"处于早期位置，缺乏信息优势","pot_odds":"底池赔率不划算，不值得冒险","opponent_reads":["对手player_0下注20，可能是试探性下注，但手牌8♠和2♥无法与之抗衡"]},"table_talk":{"message":"这手牌不太行，我弃牌","tone":"冷静"}}
2025-03-10 23:45:48,993 - src.agents.llm - INFO - ==================================================

2025-03-10 23:45:48,994 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌不太行，我弃牌', 'tone': '冷静'}
2025-03-10 23:45:48,994 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:45:48,994 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:45:48,995 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:45:48,995 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:45:48,995 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:45:48,995 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:45:48,995 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:45:48,996 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:45:48,996 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3900
2025-03-10 23:45:48,996 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:45:48,997 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:45:48,997 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♦', '10♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:45:48,998 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♦', '10♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3900, 'current_bet': 20, 'is_active': False, 'cards': ('8♦', '10♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 200, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 900, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌不太行，我弃牌', 'tone': '冷静'}}
2025-03-10 23:45:48,999 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:45:48,999 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:45:49,000 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:45:49,000 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:45:49,001 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:45:49,001 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:45:49,002 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♦', '10♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:45:49,002 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:46:10,989 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:46:10,990 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:46:10,990 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:46:10,991 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:46:10,992 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:46:10,992 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:10,993 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:46:10,993 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', 'Q♠')
2025-03-10 23:46:10,993 - src.engine.game - INFO - 玩家 ai_1 手牌: ('9♠', 'J♣')
2025-03-10 23:46:10,994 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', 'A♣')
2025-03-10 23:46:10,994 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:46:10,995 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:46:10,995 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:46:10,996 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:46:10,996 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:46:10,996 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:46:10,997 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:46:10,997 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:46:17,747 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 40}
2025-03-10 23:46:17,748 - server - INFO - 收到加注请求，金额: 40
2025-03-10 23:46:17,748 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 40, 'timestamp': '2025-03-10T23:46:17.748370', 'table_talk': None}
2025-03-10 23:46:17,749 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:46:17,750 - src.engine.state - INFO - 玩家 player_0 加注到 40 筹码，已标记为已行动
2025-03-10 23:46:17,750 - src.engine.game - INFO - 玩家 player_0 加注到 40
2025-03-10 23:46:17,752 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:46:17,753 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:46:17,753 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:46:17,753 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:46:17,754 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:46:17,754 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:46:17,754 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:46:17,755 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:17,755 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:17,756 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:46:17,756 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:17,757 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:46:17,757 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:46:17,758 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:46:17,758 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:46:17,759 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3860, 'current_bet': 40, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_1', 'chips': 190, 'current_bet': 10, 'is_active': True, 'cards': ('9♠', 'J♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 880, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:46:17,760 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:17,760 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:17,761 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:46:17,761 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:17,762 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:46:17,762 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:46:17,763 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:46:19,074 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:46:19,076 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:46:19,077 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:46:19,077 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:46:19,078 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:46:19,078 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:46:42,835 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "40", "confidence": "0.7"}, "reasoning": {"hand_strength": "持有9♠、J♣虽不算顶级起手牌，但在多玩家底池中仍有一定的潜力，尤其如果能在翻牌后找到合适的配合", "position_analysis": "处于早位，后续行动可能受限，所以需要保持谨慎，避免过度冒险", "pot_odds": "当前底池为70，跟注40的投入比例合理，可待翻牌后评估局面", "opponent_reads": ["player_0已提前加注，显示出一定积极性，可能在试图掌控局面"]}, "table_talk": {"message": "我跟这手牌来试探到底，看看你们怎么打！", "tone": "自信而略带挑衅"}}
2025-03-10 23:46:42,837 - src.agents.llm - INFO - ==================================================

2025-03-10 23:46:42,837 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我跟这手牌来试探到底，看看你们怎么打！', 'tone': '自信而略带挑衅'}
2025-03-10 23:46:42,838 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:46:42,838 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:46:42,839 - src.engine.state - INFO - 玩家 ai_1 跟注 30 筹码，已标记为已行动
2025-03-10 23:46:42,839 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:46:42,839 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:46:42,840 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:46:42,840 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:46:42,841 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:46:42,841 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:46:42,842 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:46:42,842 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:46:42,842 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:42,844 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:42,844 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:46:42,844 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:42,845 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:42,845 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:46:42,846 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:46:42,846 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:46:42,846 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:46:42,847 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 100, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3860, 'current_bet': 40, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': True, 'cards': ('9♠', 'J♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 880, 'current_bet': 20, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我跟这手牌来试探到底，看看你们怎么打！', 'tone': '自信而略带挑衅'}}
2025-03-10 23:46:42,848 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:42,849 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:42,849 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:46:42,849 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:42,850 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:42,850 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:46:42,851 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:46:42,851 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:46:42,852 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:46:42,852 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:46:42,853 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:46:42,853 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:46:42,854 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:46:42,854 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:46:50,455 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"60","confidence":0.85},"reasoning":{"hand_strength":"手牌Q♣, A♣是强起手牌，尤其是同花潜力，适合激进打法","position_analysis":"位置2在PRE_FLOP阶段较为有利，可以观察后续玩家行动","pot_odds":"底池赔率较好，加注可以增加潜在回报","opponent_reads":["player_0的加注表明他可能有较强手牌，但筹码较多，可能试图通过加注施加压力","ai_1的跟注表明他可能持中等强度手牌，筹码较少，可能倾向于保守打法"]},"table_talk":{"message":"看来有人想挑战我，让我们看看谁的手牌更强","tone":"自信"}}
2025-03-10 23:46:50,456 - src.agents.llm - INFO - ==================================================

2025-03-10 23:46:50,457 - src.agents.llm - INFO - 成功将字符串金额 60 转换为数字 60.0
2025-03-10 23:46:50,457 - src.agents.llm - INFO - 生成动作: RAISE 金额: 60 table_talk: {'message': '看来有人想挑战我，让我们看看谁的手牌更强', 'tone': '自信'}
2025-03-10 23:46:50,458 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 60
2025-03-10 23:46:50,458 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 23:46:50,459 - src.engine.state - INFO - 玩家 ai_2 加注到 60 筹码，已标记为已行动
2025-03-10 23:46:50,460 - src.engine.game - INFO - 玩家 ai_2 加注到 60
2025-03-10 23:46:50,460 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 23:46:50,461 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:46:50,461 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:46:50,462 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:46:50,463 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:46:50,463 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:46:50,464 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:46:50,464 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:50,464 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:50,465 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:46:50,466 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:50,466 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:46:50,467 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:46:50,467 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:46:50,468 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 140, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3860, 'current_bet': 40, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': True, 'cards': ('9♠', 'J♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 840, 'current_bet': 60, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 60}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想挑战我，让我们看看谁的手牌更强', 'tone': '自信'}}
2025-03-10 23:46:50,470 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:50,470 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:50,471 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:46:50,471 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:50,472 - src.engine.game - INFO - 玩家 player_0 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:46:50,472 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:46:52,674 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:46:52,674 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:46:52.674937', 'table_talk': None}
2025-03-10 23:46:52,675 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:46:52,675 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:46:52,675 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:46:52,676 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:46:52,676 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:46:52,677 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:46:52,677 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:46:52,678 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:46:52,678 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:46:52,679 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:46:52,679 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:52,679 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:52,680 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:46:52,680 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:46:52,681 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:52,681 - src.engine.game - INFO - 玩家 ai_1 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:46:52,682 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:46:52,682 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:46:52,682 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 160, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3840, 'current_bet': 60, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': True, 'cards': ('9♠', 'J♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 840, 'current_bet': 60, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:46:52,684 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:46:52,685 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:46:52,685 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:46:52,685 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:46:52,686 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:46:52,687 - src.engine.game - INFO - 玩家 ai_1 下注额(40)不等于最大下注额(60)，回合继续
2025-03-10 23:46:52,687 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:46:55,483 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:46:55,483 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:46:55,484 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:46:55,484 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:46:55,485 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:46:55,485 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:47:13,782 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.85"}, "reasoning": {"hand_strength": "9♠, J♣在Pre-flop阶段属于边缘手牌，无法应对已经有两次加注的局面", "position_analysis": "位置1较为不利，加上本轮已有多次行动，处于压力之下", "pot_odds": "虽然底池较大，但跟注成本占比过高，对边缘手牌来说风险较大", "opponent_reads": ["对手连续加注和跟注表明他们可能持有较强牌型，诈唬机会较低"]}, "table_talk": {"message": "各位慢慢玩，我可不是来送人头的。", "tone": "冷静且带有讽刺"}}
2025-03-10 23:47:13,784 - src.agents.llm - INFO - ==================================================

2025-03-10 23:47:13,785 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位慢慢玩，我可不是来送人头的。', 'tone': '冷静且带有讽刺'}
2025-03-10 23:47:13,785 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:47:13,785 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:47:13,786 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:47:13,786 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:47:13,787 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:47:13,788 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:47:13,788 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:47:13,789 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:47:13,789 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:47:13,790 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:47:13,790 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:47:13,791 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:13,791 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:13,791 - src.engine.game - INFO - 当前最大下注额: 60
2025-03-10 23:47:13,792 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:47:13,792 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=60, is_all_in=False
2025-03-10 23:47:13,793 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:47:13,793 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:47:13,794 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:47:13,795 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:47:13,796 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:47:13,796 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:47:13,797 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:47:13,797 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:47:13,797 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:13,798 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:47:13,798 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 23:47:13,799 - src.engine.dealer - INFO - Dealt 3 community cards: ['5♠', '6♦', '9♥']
2025-03-10 23:47:13,799 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['5♠', '6♦', '9♥']
2025-03-10 23:47:13,799 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_2', 2)]
2025-03-10 23:47:13,800 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:47:13,800 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_2, 位置: 2
2025-03-10 23:47:13,801 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:47:13,801 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 160, 'community_cards': ['5♠', '6♦', '9♥'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3840, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位慢慢玩，我可不是来送人头的。', 'tone': '冷静且带有讽刺'}}
2025-03-10 23:47:13,802 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:13,803 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:13,803 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:13,803 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:13,804 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:13,804 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:13,805 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:47:13,805 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:47:13,806 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:47:13,806 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:47:13,807 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:47:13,807 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:47:21,510 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌Q♣, A♣在当前公共牌5♠, 6♦, 9♥下有一定的潜力，尤其是同花和顺子的可能性","position_analysis":"位于第2位，可以观察后续玩家的行动，做出更明智的决策","pot_odds":"底池160，当前最大注0，跟注40的底池赔率合理","opponent_reads":["player_0在上一轮进行了加注，显示出一定的牌力，但后续跟注60，可能牌力中等"]},"table_talk":{"message":"看来你有些自信，但我的牌也不弱","tone":"冷静自信"}}
2025-03-10 23:47:21,511 - src.agents.llm - INFO - ==================================================

2025-03-10 23:47:21,512 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看来你有些自信，但我的牌也不弱', 'tone': '冷静自信'}
2025-03-10 23:47:21,512 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-03-10 23:47:21,513 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-03-10 23:47:21,514 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-03-10 23:47:21,514 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-03-10 23:47:21,515 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-03-10 23:47:21,515 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:47:21,517 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:47:21,517 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:21,518 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:47:21,519 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:47:21,519 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:47:21,520 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:21,520 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:21,521 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:21,522 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:21,522 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:21,522 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:21,522 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:47:21,524 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 160, 'community_cards': ['5♠', '6♦', '9♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3840, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你有些自信，但我的牌也不弱', 'tone': '冷静自信'}}
2025-03-10 23:47:21,525 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:21,525 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:21,526 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:21,526 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:21,527 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:21,527 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:29,669 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:47:29,669 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:47:29.669324', 'table_talk': None}
2025-03-10 23:47:29,670 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:47:29,670 - src.engine.state - INFO - 玩家 player_0 跟注 0 筹码，已标记为已行动
2025-03-10 23:47:29,670 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:47:29,671 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:47:29,672 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:47:29,672 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:47:29,673 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:29,673 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:47:29,673 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:47:29,675 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:47:29,675 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:29,675 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:29,676 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:29,676 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:47:29,677 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:47:29,677 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:47:29,677 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:47:29,678 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:47:29,678 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:47:29,678 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:47:29,679 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:47:29,679 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:47:29,680 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:47:29,680 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:29,680 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:47:29,681 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 23:47:29,681 - src.engine.dealer - INFO - Dealt 1 community cards: ['K♦']
2025-03-10 23:47:29,682 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['5♠', '6♦', '9♥', 'K♦']
2025-03-10 23:47:29,682 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_2', 2)]
2025-03-10 23:47:29,682 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:47:29,682 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_2, 位置: 2
2025-03-10 23:47:29,683 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:47:29,683 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 160, 'community_cards': ['5♠', '6♦', '9♥', 'K♦'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3840, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 840, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:47:29,684 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:29,684 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:29,684 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:29,685 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:29,685 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:29,686 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:31,549 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:47:31,549 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:47:31,550 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:47:31,550 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:47:31,551 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:47:31,552 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:47:40,026 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"80","confidence":0.85},"reasoning":{"hand_strength":"手牌Q♣, A♣在当前公共牌5♠, 6♦, 9♥, K♦下有一定潜力，尤其是A高牌和同花听牌的可能性。","position_analysis":"位于2号位置，可以在后续行动中观察对手反应，具有一定的位置优势。","pot_odds":"底池160，加注80，底池赔率为2:1，值得冒险。","opponent_reads":["player_0在本轮多次跟注，可能持有中等强度的牌，但未表现出明显强牌信号。"]},"table_talk":{"message":"看来大家都挺谨慎的，我来加点压力吧。","tone":"自信且挑衅"}}
2025-03-10 23:47:40,028 - src.agents.llm - INFO - ==================================================

2025-03-10 23:47:40,028 - src.agents.llm - INFO - 成功将字符串金额 80 转换为数字 80.0
2025-03-10 23:47:40,028 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '看来大家都挺谨慎的，我来加点压力吧。', 'tone': '自信且挑衅'}
2025-03-10 23:47:40,029 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 80
2025-03-10 23:47:40,030 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 23:47:40,030 - src.engine.state - INFO - 玩家 ai_2 加注到 80 筹码，已标记为已行动
2025-03-10 23:47:40,031 - src.engine.game - INFO - 玩家 ai_2 加注到 80
2025-03-10 23:47:40,031 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 23:47:40,031 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:47:40,032 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:47:40,032 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:47:40,033 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:47:40,033 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:47:40,034 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:47:40,034 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:40,035 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:40,035 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:47:40,036 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:40,036 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:40,037 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:40,037 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:47:40,038 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 240, 'community_cards': ['5♠', '6♦', '9♥', 'K♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3840, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 760, 'current_bet': 80, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 80}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来大家都挺谨慎的，我来加点压力吧。', 'tone': '自信且挑衅'}}
2025-03-10 23:47:40,039 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:40,040 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:40,040 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:47:40,040 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:40,040 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:40,041 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:43,737 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:47:43,738 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:47:43.738301', 'table_talk': None}
2025-03-10 23:47:43,739 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:47:43,739 - src.engine.state - INFO - 玩家 player_0 跟注 80 筹码，已标记为已行动
2025-03-10 23:47:43,739 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:47:43,740 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:47:43,740 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:47:43,741 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:47:43,741 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:47:43,741 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:47:43,742 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:47:43,742 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:47:43,743 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:43,743 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:43,743 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-10 23:47:43,743 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:47:43,743 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=80, is_all_in=False
2025-03-10 23:47:43,745 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:47:43,745 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:47:43,745 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:47:43,746 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 23:47:43,746 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:47:43,747 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 23:47:43,747 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:47:43,747 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:47:43,748 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:43,748 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:47:43,749 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 23:47:43,749 - src.engine.dealer - INFO - Dealt 1 community cards: ['3♠']
2025-03-10 23:47:43,750 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['5♠', '6♦', '9♥', 'K♦', '3♠']
2025-03-10 23:47:43,750 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_2', 2)]
2025-03-10 23:47:43,750 - src.engine.game - INFO - 庄家位置: 0
2025-03-10 23:47:43,751 - src.engine.game - INFO - 找到庄家后的第一个活跃玩家: ai_2, 位置: 2
2025-03-10 23:47:43,751 - src.engine.game - INFO - 新阶段第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:47:43,751 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 320, 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3760, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 760, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:47:43,752 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:43,752 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:43,752 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:43,753 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:43,753 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:43,754 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:45,046 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:47:45,047 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:47:45,048 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:47:45,048 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:47:45,049 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:47:45,049 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:47:52,186 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌A♣Q♣在河牌阶段形成了一对A，虽然不算强牌，但有一定的价值。","position_analysis":"处于中间位置，可以观察到前位玩家的行动，做出相对稳妥的决策。","pot_odds":"底池为320，跟注成本为0，底池赔率较高，适合跟注。","opponent_reads":["对手player_0在本轮多次跟注，显示出一定的牌力，但并未表现出极强的攻击性，可能持有中等强度的牌。"]},"table_talk":{"message":"看起来大家都挺谨慎的，我跟一下看看。","tone":"轻松"}}
2025-03-10 23:47:52,188 - src.agents.llm - INFO - ==================================================

2025-03-10 23:47:52,189 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '看起来大家都挺谨慎的，我跟一下看看。', 'tone': '轻松'}
2025-03-10 23:47:52,190 - server - INFO - AI玩家 ai_2 决定执行动作: CALL, 金额: 0
2025-03-10 23:47:52,190 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.CALL
2025-03-10 23:47:52,191 - src.engine.state - INFO - 玩家 ai_2 跟注 0 筹码，已标记为已行动
2025-03-10 23:47:52,192 - src.engine.game - INFO - 玩家 ai_2 跟注
2025-03-10 23:47:52,193 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_2
2025-03-10 23:47:52,193 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:47:52,194 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:47:52,195 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:52,195 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:47:52,196 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:47:52,196 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:47:52,197 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:52,197 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:52,198 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:52,198 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:52,199 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:52,200 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:47:52,200 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:47:52,200 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 320, 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3760, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 760, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来大家都挺谨慎的，我跟一下看看。', 'tone': '轻松'}}
2025-03-10 23:47:52,201 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:47:52,201 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:47:52,203 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:47:52,203 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:47:52,204 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:47:52,204 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:48:03,399 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 760}
2025-03-10 23:48:03,400 - server - INFO - 收到加注请求，金额: 760
2025-03-10 23:48:03,401 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 760, 'timestamp': '2025-03-10T23:48:03.401366', 'table_talk': None}
2025-03-10 23:48:03,402 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:48:03,403 - src.engine.state - INFO - 玩家 player_0 加注到 760 筹码，已标记为已行动
2025-03-10 23:48:03,403 - src.engine.game - INFO - 玩家 player_0 加注到 760
2025-03-10 23:48:03,403 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:48:03,404 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:48:03,404 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:48:03,404 - src.engine.game - INFO - 当前最大下注额: 760
2025-03-10 23:48:03,405 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:48:03,405 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_2
2025-03-10 23:48:03,406 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:48:03,406 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:03,407 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:48:03,407 - src.engine.game - INFO - 当前最大下注额: 760
2025-03-10 23:48:03,408 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=760, is_all_in=False
2025-03-10 23:48:03,408 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:48:03,409 - src.engine.game - INFO - 玩家 ai_2 下注额(0)不等于最大下注额(760)，回合继续
2025-03-10 23:48:03,409 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:48:03,409 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:48:03,410 - server - INFO - 发送更新后的游戏状态: {'phase': 'RIVER', 'pot_size': 1080, 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3000, 'current_bet': 760, 'is_active': True, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 760}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 760, 'current_bet': 0, 'is_active': True, 'cards': ('Q♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:48:03,411 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:03,411 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:48:03,411 - src.engine.game - INFO - 当前最大下注额: 760
2025-03-10 23:48:03,411 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=760, is_all_in=False
2025-03-10 23:48:03,413 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:48:03,413 - src.engine.game - INFO - 玩家 ai_2 下注额(0)不等于最大下注额(760)，回合继续
2025-03-10 23:48:03,414 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-10 23:48:07,257 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:48:07,258 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:48:07,259 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:48:07,259 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:48:07,260 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:48:07,261 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:48:18,666 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"ALL_IN","amount":760,"confidence":0.85},"reasoning":{"hand_strength":"手牌为Q♣, A♣，虽然未能形成强牌，但A高牌有一定的价值，尤其是在对手可能没有强牌的情况下。","position_analysis":"位置2，处于中间位置，可以观察到对手的行动，但无法完全控制局面。","pot_odds":"底池为1080，当前最大注为760，跟注的赔率较高，值得一试。","opponent_reads":["对手player_0在本轮多次加注，显示出较强的攻击性，可能持有强牌或试图通过加注逼迫对手弃牌。"]},"table_talk":{"message":"看来你很有信心，但我也不打算轻易放弃。","tone":"冷静而坚定"}}
2025-03-10 23:48:18,666 - src.agents.llm - INFO - ==================================================

2025-03-10 23:48:18,667 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 760 table_talk: {'message': '看来你很有信心，但我也不打算轻易放弃。', 'tone': '冷静而坚定'}
2025-03-10 23:48:18,667 - server - INFO - AI玩家 ai_2 决定执行动作: ALL_IN, 金额: 760
2025-03-10 23:48:18,667 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.ALL_IN
2025-03-10 23:48:18,667 - src.engine.state - INFO - 玩家 ai_2 全下 760 筹码，已标记为已行动
2025-03-10 23:48:18,667 - src.engine.game - INFO - 玩家 ai_2 全下
2025-03-10 23:48:18,668 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_2
2025-03-10 23:48:18,668 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:48:18,668 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:48:18,668 - src.engine.game - INFO - 当前最大下注额: 760
2025-03-10 23:48:18,668 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:48:18,668 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:48:18,669 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:48:18,669 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:18,670 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:48:18,670 - src.engine.game - INFO - 当前最大下注额: 760
2025-03-10 23:48:18,671 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=760, is_all_in=False
2025-03-10 23:48:18,671 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=760, is_all_in=True
2025-03-10 23:48:18,672 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:48:18,672 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:48:18,673 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:48:18,673 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.RIVER
2025-03-10 23:48:18,674 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:48:18,674 - src.engine.game - INFO - 从阶段 GameStage.RIVER 进入下一阶段
2025-03-10 23:48:18,674 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:48:18,675 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:48:18,675 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:48:18,676 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:48:18,676 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 23:48:18,677 - src.engine.game - INFO - 河牌阶段结束，进入摊牌阶段
2025-03-10 23:48:18,677 - src.engine.game - INFO - 游戏结束，执行结算
2025-03-10 23:48:18,677 - src.engine.game - INFO - 结算时活跃玩家数量: 2
2025-03-10 23:48:18,678 - src.engine.game - INFO - 需要比较牌面大小进行结算
2025-03-10 23:48:18,678 - src.engine.game - INFO - 玩家 ai_2 赢得底池 1840
2025-03-10 23:48:18,679 - src.engine.game - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 1840, 'winning_hand': 'HIGH_CARD', 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('10♠', 'Q♠'), 'hand_rank': 'HIGH_CARD', 'is_winner': False}, {'player_id': 'ai_2', 'hole_cards': ('Q♣', 'A♣'), 'hand_rank': 'HIGH_CARD', 'is_winner': True}]}
2025-03-10 23:48:18,679 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:48:18,680 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'current_player': None, 'min_raise': 760, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 1840, 'winning_hand': 'HIGH_CARD', 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('10♠', 'Q♠'), 'hand_rank': 'HIGH_CARD', 'is_winner': False}, {'player_id': 'ai_2', 'hole_cards': ('Q♣', 'A♣'), 'hand_rank': 'HIGH_CARD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3000, 'current_bet': 0, 'is_active': False, 'cards': ('10♠', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 40, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1840, 'current_bet': 0, 'is_active': False, 'cards': ('Q♣', 'A♣'), 'is_all_in': True, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'ALL_IN', 'last_amount': 760}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你很有信心，但我也不打算轻易放弃。', 'tone': '冷静而坚定'}}
2025-03-10 23:48:18,681 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:18,681 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:48:18,682 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:48:18,682 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:48:18,683 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:48:18,683 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:48:18,683 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 1840, 'winning_hand': 'HIGH_CARD', 'community_cards': ['5♠', '6♦', '9♥', 'K♦', '3♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('10♠', 'Q♠'), 'hand_rank': 'HIGH_CARD', 'is_winner': False}, {'player_id': 'ai_2', 'hole_cards': ('Q♣', 'A♣'), 'hand_rank': 'HIGH_CARD', 'is_winner': True}]}
2025-03-10 23:48:18,684 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:48:24,921 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:48:24,922 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:48:24,922 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:48:24,923 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:48:24,923 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:48:24,924 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:48:24,924 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:48:24,925 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♦', 'K♠')
2025-03-10 23:48:24,925 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♥', 'Q♥')
2025-03-10 23:48:24,925 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♥', '2♣')
2025-03-10 23:48:24,926 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:48:24,926 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:48:24,927 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:48:24,927 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:48:24,928 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:48:24,928 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:48:24,929 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:48:24,929 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:48:28,715 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:48:28,716 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:48:28,717 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:48:28,717 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:48:28,718 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:48:28,719 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:48:48,767 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": 0.7}, "reasoning": {"hand_strength": "我的牌 Q♥,5♥ 虽然同花潜力存在，但整体牌力较弱，不适合大额加注", "position_analysis": "处于较早位置，采取保守策略以便更好地观察后续对手行为", "pot_odds": "底池30对跟注20提供了合理的赔率，风险相对可控", "opponent_reads": ["对手资金雄厚且表现积极，可能抱有强牌或通过试探进入局中"]}, "table_talk": {"message": "跟注看看牌面，稳扎稳打，不轻易暴露底牌信息。", "tone": "自信且冷静"}}
2025-03-10 23:48:48,767 - src.agents.llm - INFO - ==================================================

2025-03-10 23:48:48,768 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '跟注看看牌面，稳扎稳打，不轻易暴露底牌信息。', 'tone': '自信且冷静'}
2025-03-10 23:48:48,768 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:48:48,768 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:48:48,769 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 23:48:48,769 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:48:48,770 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:48:48,770 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:48:48,771 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:48:48,771 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:48:48,771 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:48:48,772 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:48:48,772 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:48:48,772 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:48,773 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:48:48,773 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:48:48,774 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:48:48,774 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:48:48,775 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:48:48,775 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:48:48,776 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2980, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 10, 'is_active': True, 'cards': ('3♥', '2♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '跟注看看牌面，稳扎稳打，不轻易暴露底牌信息。', 'tone': '自信且冷静'}}
2025-03-10 23:48:48,777 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:48,777 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:48:48,778 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:48:48,778 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:48:48,779 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:48:48,779 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:48:48,781 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:48:48,781 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:48:48,781 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:48:48,782 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:48:48,782 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:48:48,783 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:48:56,122 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.95},"reasoning":{"hand_strength":"手牌3♥, 2♣在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，无法有效观察对手行为","pot_odds":"底池赔率不理想，投入20筹码去追逐50底池不划算","opponent_reads":["ai_1选择跟注，可能持有中等强度手牌，但不足以构成威胁"]},"table_talk":{"message":"看来这手牌不值得冒险，我选择弃牌","tone":"冷静"}}
2025-03-10 23:48:56,122 - src.agents.llm - INFO - ==================================================

2025-03-10 23:48:56,123 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不值得冒险，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:48:56,123 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:48:56,124 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:48:56,124 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:48:56,124 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:48:56,125 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:48:56,125 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:48:56,126 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:48:56,126 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:48:56,127 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:48:56,127 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:48:56,127 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:48:56,128 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:56,128 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:48:56,129 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:48:56,129 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:48:56,130 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:48:56,130 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:48:56,130 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:48:56,131 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2980, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 20, 'is_active': True, 'cards': ('5♥', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不值得冒险，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:48:56,132 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:48:56,132 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:48:56,132 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:48:56,134 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:48:56,134 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:48:56,135 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:49:34,558 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-10 23:49:34,558 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-10T23:49:34.558674', 'table_talk': None}
2025-03-10 23:49:34,559 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-10 23:49:34,559 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-10 23:49:34,560 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-10 23:49:34,560 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:49:34,560 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:49:34,562 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:49:34,562 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:49:34,563 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:49:34,563 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:49:34,564 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:49:34,564 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:49:34,565 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:49:34,565 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:49:34,566 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:49:34,566 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:49:34,567 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:49:34,567 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:49:34,568 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:49:34,568 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:49:34,568 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:49:34,569 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:49:34,569 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:49:34,570 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:49:34,570 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:49:34,570 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:49:34,570 - src.engine.dealer - INFO - Dealt 3 community cards: ['7♣', '7♠', '10♥']
2025-03-10 23:49:34,571 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['7♣', '7♠', '10♥']
2025-03-10 23:49:34,571 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:49:34,572 - src.engine.game - INFO - 庄家位置: 1
2025-03-10 23:49:34,572 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:49:34,572 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:49:34,573 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['7♣', '7♠', '10♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2980, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 140, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:49:34,574 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:49:34,574 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:49:34,575 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:49:34,575 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:49:34,575 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:49:34,576 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:49:57,944 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 120}
2025-03-10 23:49:57,945 - server - INFO - 收到加注请求，金额: 120
2025-03-10 23:49:57,946 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 120, 'timestamp': '2025-03-10T23:49:57.946717', 'table_talk': None}
2025-03-10 23:49:57,946 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:49:57,947 - src.engine.state - INFO - 玩家 player_0 加注到 120 筹码，已标记为已行动
2025-03-10 23:49:57,947 - src.engine.game - INFO - 玩家 player_0 加注到 120
2025-03-10 23:49:57,947 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:49:57,948 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:49:57,948 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:49:57,949 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:49:57,949 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:49:57,949 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:49:57,950 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:49:57,950 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:49:57,951 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:49:57,951 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:49:57,951 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:49:57,951 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:49:57,953 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:49:57,953 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:49:57,953 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:49:57,954 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 170, 'community_cards': ['7♣', '7♠', '10♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2860, 'current_bet': 120, 'is_active': True, 'cards': ('8♦', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 120}, {'id': 'ai_1', 'chips': 140, 'current_bet': 0, 'is_active': True, 'cards': ('5♥', 'Q♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:49:57,955 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:49:57,955 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:49:57,956 - src.engine.game - INFO - 当前最大下注额: 120
2025-03-10 23:49:57,956 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=120, is_all_in=False
2025-03-10 23:49:57,956 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:49:57,957 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:49:57,957 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:50:01,293 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:50:01,294 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:50:01,295 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:50:01,296 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:50:01,297 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:50:01,297 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:50:31,691 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌仅为5♥和Q♥，与公共牌7♣, 7♠, 10♥组合后没有形成对子或其他强力牌型，仅依靠Q高非常薄弱", "position_analysis": "处于较早的位置，信息量有限，且在面对对手激进动作时更难发挥心理战优势", "pot_odds": "底池170面对120的下注，虽然投入比例看似诱人，但风险相对较高且回报不明确", "opponent_reads": ["对手先CHECK后RAISE，显示出极可能拥有较强牌型或在进行心理诈唬，但考虑到筹码优势及其策略，更可能构成威胁"]}, "table_talk": {"message": "你的牌今天看来不够硬气，我还是退出这一局，等有更好的机会再上场。", "tone": "冷静且带有自信的蔑视"}}
2025-03-10 23:50:31,693 - src.agents.llm - INFO - ==================================================

2025-03-10 23:50:31,694 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '你的牌今天看来不够硬气，我还是退出这一局，等有更好的机会再上场。', 'tone': '冷静且带有自信的蔑视'}
2025-03-10 23:50:31,694 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:50:31,694 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:50:31,695 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:50:31,695 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:50:31,695 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:50:31,696 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:50:31,696 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:50:31,697 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:50:31,697 - src.engine.state - INFO - 玩家 player_0 获得底池 170 筹码，当前筹码: 3030
2025-03-10 23:50:31,697 - src.engine.game - INFO - 玩家 player_0 获得底池 170 筹码
2025-03-10 23:50:31,698 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:50:31,698 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 170, 'winning_hand': None, 'community_cards': ['7♣', '7♠', '10♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♦', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:50:31,699 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['7♣', '7♠', '10♥'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 170, 'winning_hand': None, 'community_cards': ['7♣', '7♠', '10♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♦', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3030, 'current_bet': 120, 'is_active': False, 'cards': ('8♦', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你的牌今天看来不够硬气，我还是退出这一局，等有更好的机会再上场。', 'tone': '冷静且带有自信的蔑视'}}
2025-03-10 23:50:31,701 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:50:31,702 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:50:31,704 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:50:31,704 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:50:31,705 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:50:31,705 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:50:31,706 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 170, 'winning_hand': None, 'community_cards': ['7♣', '7♠', '10♥'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♦', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:50:31,706 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:50:34,068 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:50:34,068 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:50:34,069 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:50:34,070 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:50:34,070 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:50:34,070 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:50:34,071 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:50:34,071 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♣', '4♥')
2025-03-10 23:50:34,071 - src.engine.game - INFO - 玩家 ai_1 手牌: ('7♣', 'J♦')
2025-03-10 23:50:34,072 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♦', '10♣')
2025-03-10 23:50:34,072 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:50:34,072 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:50:34,073 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:50:34,073 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:50:34,074 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:50:34,074 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:50:34,075 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:50:34,075 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:50:36,718 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:50:36,719 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:50:36,719 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:50:36,720 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:50:36,721 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:50:36,721 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:50:43,207 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌4♦和10♣在PRE_FLOP阶段强度较低，缺乏成牌潜力","position_analysis":"处于中间位置，缺乏信息优势","pot_odds":"底池赔率不理想，不值得冒险跟注或加注","opponent_reads":["对手player_0下注10，筹码较多，可能持有较强手牌","对手ai_1加注到20，筹码较少，可能试图通过加注施压"]},"table_talk":{"message":"看来这手牌不太适合我，让给你们吧","tone":"轻松"}}
2025-03-10 23:50:43,208 - src.agents.llm - INFO - ==================================================

2025-03-10 23:50:43,208 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，让给你们吧', 'tone': '轻松'}
2025-03-10 23:50:43,208 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:50:43,209 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:50:43,209 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:50:43,209 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:50:43,209 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:50:43,209 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:50:43,210 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:50:43,210 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:50:43,210 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:50:43,210 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:50:43,212 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:50:43,212 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:50:43,213 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:50:43,213 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:50:43,214 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:50:43,214 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:50:43,214 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:50:43,214 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:50:43,215 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3020, 'current_bet': 10, 'is_active': True, 'cards': ('3♣', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，让给你们吧', 'tone': '轻松'}}
2025-03-10 23:50:43,216 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:50:43,216 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:50:43,217 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:50:43,217 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:50:43,218 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:50:43,219 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:50:49,865 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:50:49,867 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:50:49.866826', 'table_talk': None}
2025-03-10 23:50:49,868 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:50:49,868 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:50:49,869 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:50:49,869 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:50:49,870 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:50:49,871 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:50:49,871 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:50:49,871 - src.engine.state - INFO - 玩家 ai_1 获得底池 30 筹码，当前筹码: 150
2025-03-10 23:50:49,872 - src.engine.game - INFO - 玩家 ai_1 获得底池 30 筹码
2025-03-10 23:50:49,873 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:50:49,873 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('7♣', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:50:49,874 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('7♣', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3020, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 150, 'current_bet': 20, 'is_active': False, 'cards': ('7♣', 'J♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1830, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:50:49,875 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:50:49,875 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:50:49,876 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:50:49,876 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:50:49,876 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:50:49,877 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:50:49,877 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('7♣', 'J♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:50:49,878 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:50:50,721 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:50:50,722 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:50:50,722 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:50:50,723 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:50:50,723 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:50:50,723 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:50:50,724 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:50:50,724 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♣', '6♣')
2025-03-10 23:50:50,724 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♥', 'Q♣')
2025-03-10 23:50:50,725 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♦', '2♥')
2025-03-10 23:50:50,725 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:50:50,726 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:50:50,726 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:50:50,726 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:50:50,727 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:50:50,728 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:50:50,728 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:50:50,729 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:50:52,846 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:50:52,847 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:50:52.847937', 'table_talk': None}
2025-03-10 23:50:52,848 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:50:52,848 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:50:52,849 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:50:52,849 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:50:52,850 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:50:52,851 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:50:52,851 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:50:52,851 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:50:52,852 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:50:52,852 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:50:52,852 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:50:52,853 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:50:52,853 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:50:52,853 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:50:52,854 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:50:52,854 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:50:52,855 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:50:52,855 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3020, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 140, 'current_bet': 10, 'is_active': True, 'cards': ('A♥', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1810, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', '2♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:50:52,856 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:50:52,856 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:50:52,857 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:50:52,857 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:50:52,858 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:50:52,858 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:50:53,259 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:50:53,260 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:50:53,260 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:50:53,261 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:50:53,261 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:50:53,262 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:51:13,734 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "RAISE", "amount": "40", "confidence": "0.8"}, "reasoning": {"hand_strength": "A♥, Q♣作为起手牌具有较强的竞争力，适合在翻牌前采取主动攻击策略", "position_analysis": "处于有利位置，可以利用先发制人的优势控制底池", "pot_odds": "底池虽小，但加注能够提高赔率，让对手面临更大的抉择", "opponent_reads": ["对手目前下注较低，可能并不具备极强手牌，加注有望迫使其弃牌或暴露弱点"]}, "table_talk": {"message": "今晚我就是要掌控局面，让你感受真正的压迫！", "tone": "自信且挑衅"}}
2025-03-10 23:51:13,736 - src.agents.llm - INFO - ==================================================

2025-03-10 23:51:13,737 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-10 23:51:13,737 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '今晚我就是要掌控局面，让你感受真正的压迫！', 'tone': '自信且挑衅'}
2025-03-10 23:51:13,737 - server - INFO - AI玩家 ai_1 决定执行动作: RAISE, 金额: 40
2025-03-10 23:51:13,738 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.RAISE
2025-03-10 23:51:13,738 - src.engine.state - INFO - 玩家 ai_1 加注到 40 筹码，已标记为已行动
2025-03-10 23:51:13,739 - src.engine.game - INFO - 玩家 ai_1 加注到 40
2025-03-10 23:51:13,739 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_1
2025-03-10 23:51:13,740 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:51:13,740 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:51:13,741 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:51:13,741 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:51:13,742 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:51:13,743 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:51:13,743 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:51:13,744 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:51:13,744 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:51:13,745 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:51:13,745 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:51:13,745 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:51:13,746 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:51:13,746 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:51:13,747 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3020, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 40, 'is_active': True, 'cards': ('A♥', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_2', 'chips': 1810, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', '2♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今晚我就是要掌控局面，让你感受真正的压迫！', 'tone': '自信且挑衅'}}
2025-03-10 23:51:13,748 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:51:13,749 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:51:13,749 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:51:13,750 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:51:13,750 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:51:13,750 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:51:13,750 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:51:13,751 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:51:13,752 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:51:13,752 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:51:13,753 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:51:13,753 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:51:13,753 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:51:19,170 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌3♦, 2♥非常弱，几乎没有成牌的潜力","position_analysis":"位置2在PRE_FLOP阶段没有明显优势","pot_odds":"底池赔率不理想，不值得冒险","opponent_reads":["对手ai_1进行了加注，显示出一定的牌力或诈唬意图"]},"table_talk":{"message":"看来这手牌不适合我，你们继续吧","tone":"轻松"}}
2025-03-10 23:51:19,171 - src.agents.llm - INFO - ==================================================

2025-03-10 23:51:19,172 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，你们继续吧', 'tone': '轻松'}
2025-03-10 23:51:19,172 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:51:19,173 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:51:19,173 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:51:19,174 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:51:19,175 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:51:19,175 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-10 23:51:19,176 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:51:19,176 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:51:19,176 - src.engine.state - INFO - 玩家 ai_1 获得底池 60 筹码，当前筹码: 170
2025-03-10 23:51:19,177 - src.engine.game - INFO - 玩家 ai_1 获得底池 60 筹码
2025-03-10 23:51:19,177 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:51:19,178 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('A♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:51:19,178 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('A♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3020, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 40, 'is_active': False, 'cards': ('A♥', 'Q♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1810, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，你们继续吧', 'tone': '轻松'}}
2025-03-10 23:51:19,179 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:51:19,180 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:51:19,180 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:51:19,180 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:51:19,181 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:51:19,181 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:51:19,181 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('A♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:51:19,182 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:51:20,141 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:51:20,142 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:51:20,142 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:51:20,143 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:51:20,143 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:51:20,144 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:51:20,144 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:51:20,145 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♦', 'J♣')
2025-03-10 23:51:20,145 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♠', '6♦')
2025-03-10 23:51:20,145 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♠', '8♦')
2025-03-10 23:51:20,146 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:51:20,146 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:51:20,146 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:51:20,147 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:51:20,147 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:51:20,148 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:51:20,148 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:51:20,148 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:51:24,160 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:51:24,161 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:51:24,162 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:51:24,162 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:51:24,163 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:51:24,163 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:51:40,666 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌10♠和6♦缺乏连贯性和高牌优势，在翻牌前整体实力较弱", "position_analysis": "处于早位，需要手握强牌才能投入较大风险，弱牌不宜在此位置激进", "pot_odds": "当前底池与跟注成本比例不利于牵涉一手垃圾牌", "opponent_reads": ["对手已经展现出较强或试图施压的行为，可能拥有较高牌力"]}, "table_talk": {"message": "看你们这么拼，我就先保存实力，不跟这局硬拼！", "tone": "冷静且略带挑衅"}}
2025-03-10 23:51:40,668 - src.agents.llm - INFO - ==================================================

2025-03-10 23:51:40,668 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看你们这么拼，我就先保存实力，不跟这局硬拼！', 'tone': '冷静且略带挑衅'}
2025-03-10 23:51:40,669 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:51:40,669 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:51:40,670 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:51:40,670 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:51:40,670 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:51:40,672 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:51:40,672 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:51:40,673 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:51:40,673 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:51:40,674 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:51:40,674 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:51:40,675 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:51:40,675 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:51:40,675 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:51:40,675 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:51:40,676 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:51:40,676 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:51:40,677 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:51:40,677 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3000, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', 'J♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': True, 'cards': ('Q♠', '8♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看你们这么拼，我就先保存实力，不跟这局硬拼！', 'tone': '冷静且略带挑衅'}}
2025-03-10 23:51:40,678 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:51:40,678 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:51:40,678 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:51:40,680 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:51:40,680 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:51:40,680 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:51:40,682 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:51:40,682 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:51:40,683 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:51:40,683 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:51:40,685 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:51:40,686 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:52:51,535 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"Q♠, 8♦是一手较弱的手牌，特别是在PRE_FLOP阶段，很难在后续的公共牌中获得强牌组合","position_analysis":"位置2在PRE_FLOP阶段处于早期位置，不利于观察其他玩家的行动，增加了决策的难度","pot_odds":"底池赔率较低，当前底池为30，而需要跟注20，赔率不足以支持继续参与","opponent_reads":["player_0已经下注20，表明他有一定的信心，可能持有较强的手牌"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌。","tone":"冷静"}}
2025-03-10 23:52:51,536 - src.agents.llm - INFO - ==================================================

2025-03-10 23:52:51,537 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌。', 'tone': '冷静'}
2025-03-10 23:52:51,537 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:52:51,537 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:52:51,537 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:52:51,539 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:52:51,539 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:52:51,540 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:52:51,540 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:52:51,540 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:52:51,541 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3030
2025-03-10 23:52:51,541 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:52:51,542 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:52:51,542 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♦', 'J♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:52:51,543 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♦', 'J♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3030, 'current_bet': 20, 'is_active': False, 'cards': ('3♦', 'J♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 170, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌。', 'tone': '冷静'}}
2025-03-10 23:52:51,544 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:52:51,545 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:52:51,545 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:52:51,545 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:52:51,546 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:52:51,546 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:52:51,547 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♦', 'J♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:52:51,547 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:52:53,507 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:52:53,509 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:52:53,510 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:52:53,511 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:52:53,511 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:52:53,512 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:52:53,512 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:52:53,513 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♥', '3♠')
2025-03-10 23:52:53,513 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♣', '4♠')
2025-03-10 23:52:53,513 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♥', '10♥')
2025-03-10 23:52:53,514 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:52:53,514 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:52:53,515 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:52:53,515 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:52:53,516 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:52:53,516 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:52:53,516 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:52:53,517 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:53:00,751 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:53:00,752 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:53:00.752044', 'table_talk': None}
2025-03-10 23:53:00,753 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:53:00,753 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:53:00,753 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:53:00,754 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:53:00,754 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:53:00,754 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:53:00,755 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:53:00,755 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:53:00,756 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:53:00,757 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:53:00,757 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:53:00,758 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:53:00,758 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:53:00,759 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:53:00,759 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:53:00,759 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:53:00,760 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:53:00,760 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3030, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 160, 'current_bet': 10, 'is_active': True, 'cards': ('6♣', '4♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1780, 'current_bet': 20, 'is_active': True, 'cards': ('Q♥', '10♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:53:00,761 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:53:00,761 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:53:00,762 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:53:00,762 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:53:00,762 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:53:00,763 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:53:01,571 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:53:01,572 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:53:01,572 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:53:01,574 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:53:01,575 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:53:01,576 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:53:19,141 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌6♣,4♠非常弱，缺乏成牌潜力和连贯性，不适合在pre-flop投入太多筹码", "position_analysis": "处于早期位置，没有利用位置优势，风险较高", "pot_odds": "虽然底池较小，但跟注投入与获胜概率严重不匹配", "opponent_reads": ["对手ai_2处于激活状态，可能更倾向于利用积极的策略攻击"]}, "table_talk": {"message": "不好意思，各位，我不愿意在这副劣势手牌上冒险", "tone": "冷静而果断"}}
2025-03-10 23:53:19,142 - src.agents.llm - INFO - ==================================================

2025-03-10 23:53:19,144 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '不好意思，各位，我不愿意在这副劣势手牌上冒险', 'tone': '冷静而果断'}
2025-03-10 23:53:19,144 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:53:19,145 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:53:19,145 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:53:19,146 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:53:19,146 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:53:19,146 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:53:19,147 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:53:19,147 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:53:19,148 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 1810
2025-03-10 23:53:19,148 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-10 23:53:19,148 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:53:19,149 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♥', '10♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:53:19,149 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♥', '10♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3030, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1810, 'current_bet': 20, 'is_active': False, 'cards': ('Q♥', '10♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '不好意思，各位，我不愿意在这副劣势手牌上冒险', 'tone': '冷静而果断'}}
2025-03-10 23:53:19,151 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:53:19,151 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:53:19,151 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:53:19,152 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:53:19,152 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:53:19,153 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:53:19,153 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♥', '10♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:53:19,154 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:53:20,988 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:53:20,989 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:53:20,989 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:53:20,990 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:53:20,990 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:53:20,991 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:53:20,991 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:53:20,992 - src.engine.game - INFO - 玩家 player_0 手牌: ('6♦', '8♠')
2025-03-10 23:53:20,992 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♥', 'Q♣')
2025-03-10 23:53:20,993 - src.engine.game - INFO - 玩家 ai_2 手牌: ('J♣', '2♠')
2025-03-10 23:53:20,993 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:53:20,994 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:53:20,994 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:53:20,995 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:53:20,995 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:53:20,996 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:53:20,996 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:53:20,996 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:53:24,178 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:53:24,179 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:53:24,179 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:53:24,180 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:53:24,180 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:53:24,181 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:53:44,128 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "Q♣和3♥组成的手牌在Pre-Flop阶段较弱，缺乏足够的实力和潜力", "position_analysis": "处于第一个行动的位置，信息不足，同时手牌并不理想，不适合冒险", "pot_odds": "需要跟注20以争取30的底池补偿，但考虑到手牌质量，风险较高", "opponent_reads": ["对手保持激活状态，筹码量较大且已投入较高注额，可能持有更强的牌"]}, "table_talk": {"message": "看来你们今天运气不错，我就不打扰你们了。", "tone": "轻松且略带讽刺"}}
2025-03-10 23:53:44,128 - src.agents.llm - INFO - ==================================================

2025-03-10 23:53:44,130 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你们今天运气不错，我就不打扰你们了。', 'tone': '轻松且略带讽刺'}
2025-03-10 23:53:44,130 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:53:44,130 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:53:44,131 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:53:44,132 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:53:44,132 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:53:44,133 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:53:44,133 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:53:44,134 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:53:44,134 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:53:44,134 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:53:44,135 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:53:44,135 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:53:44,136 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:53:44,136 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:53:44,137 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:53:44,137 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:53:44,137 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:53:44,138 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:53:44,138 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3010, 'current_bet': 20, 'is_active': True, 'cards': ('6♦', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': True, 'cards': ('J♣', '2♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们今天运气不错，我就不打扰你们了。', 'tone': '轻松且略带讽刺'}}
2025-03-10 23:53:44,139 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:53:44,140 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:53:44,140 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:53:44,141 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:53:44,141 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:53:44,141 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:53:44,143 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:53:44,144 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:53:44,144 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:53:44,145 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:53:44,145 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:53:44,146 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:53:50,740 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌J♣, 2♠在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"位置2在PRE_FLOP阶段相对不利，无法有效观察对手行为","pot_odds":"底池赔率不利于继续跟注或加注","opponent_reads":["对手player_0在当前轮下注20，可能是试探性下注，但手牌J♣, 2♠不值得冒险"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:53:50,742 - src.agents.llm - INFO - ==================================================

2025-03-10 23:53:50,743 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:53:50,744 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:53:50,745 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:53:50,746 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:53:50,746 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:53:50,747 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:53:50,748 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:53:50,748 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:53:50,748 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:53:50,749 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3040
2025-03-10 23:53:50,749 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:53:50,750 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:53:50,750 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('6♦', '8♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:53:50,751 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('6♦', '8♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3040, 'current_bet': 20, 'is_active': False, 'cards': ('6♦', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 160, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:53:50,752 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:53:50,753 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:53:50,753 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:53:50,753 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:53:50,753 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:53:50,755 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:53:50,755 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('6♦', '8♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:53:50,756 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:53:54,402 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:53:54,403 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:53:54,404 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:53:54,404 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:53:54,404 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:53:54,405 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:53:54,405 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:53:54,406 - src.engine.game - INFO - 玩家 player_0 手牌: ('K♥', '4♥')
2025-03-10 23:53:54,406 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♦', '9♣')
2025-03-10 23:53:54,406 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♦', '6♠')
2025-03-10 23:53:54,406 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:53:54,406 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:53:54,408 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:53:54,408 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:53:54,409 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:53:54,409 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:53:54,409 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:53:54,410 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:53:55,770 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:53:55,771 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:53:55,772 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:53:55,772 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:53:55,773 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:53:55,773 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:54:07,714 - src.agents.llm - INFO - 
💭 决策结果:
{
  "action": {
    "type": "RAISE",
    "amount": 40,
    "confidence": 0.8
  },
  "reasoning": {
    "hand_strength": "手牌6♦, 6♠在PRE_FLOP阶段属于中等强度，有潜力在翻牌后形成三条或更好的牌型。",
    "position_analysis": "位置2是早期位置，需要谨慎行动，但通过加注可以控制对手的行动范围。",
    "pot_odds": "底池30，当前最大注20，加注到40的底池赔率合理，有利于后续行动。",
    "opponent_reads": ["player_0下注10，显示较弱的手牌或试探性下注；ai_1下注20，可能是中等强度手牌或试图控制底池。"]
  },
  "table_talk": {
    "message": "看来有人想试探一下，那我就加点注，看看你们敢不敢跟。",
    "tone": "自信且挑衅"
  }
}
2025-03-10 23:54:07,717 - src.agents.llm - INFO - ==================================================

2025-03-10 23:54:07,718 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来有人想试探一下，那我就加点注，看看你们敢不敢跟。', 'tone': '自信且挑衅'}
2025-03-10 23:54:07,719 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-10 23:54:07,720 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-10 23:54:07,720 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-10 23:54:07,721 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-10 23:54:07,722 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-10 23:54:07,723 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:54:07,723 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:54:07,724 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:07,725 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:54:07,726 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:54:07,726 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:54:07,727 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:07,727 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:07,728 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:07,728 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:54:07,728 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:54:07,730 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:07,730 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:54:07,731 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3030, 'current_bet': 10, 'is_active': True, 'cards': ('K♥', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 140, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 40, 'is_active': True, 'cards': ('6♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想试探一下，那我就加点注，看看你们敢不敢跟。', 'tone': '自信且挑衅'}}
2025-03-10 23:54:07,732 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:07,732 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:07,733 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:07,733 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:54:07,734 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:54:07,734 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:09,842 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:54:09,843 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:54:09.843411', 'table_talk': None}
2025-03-10 23:54:09,844 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:54:09,845 - src.engine.state - INFO - 玩家 player_0 跟注 30 筹码，已标记为已行动
2025-03-10 23:54:09,846 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:54:09,846 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:54:09,846 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:54:09,846 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:54:09,847 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:09,847 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:54:09,847 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:54:09,848 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:54:09,848 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:09,850 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:09,850 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:09,851 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:54:09,851 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:54:09,851 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:54:09,852 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:09,852 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:54:09,853 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 100, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3000, 'current_bet': 40, 'is_active': True, 'cards': ('K♥', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 140, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 40, 'is_active': True, 'cards': ('6♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:54:09,854 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:09,854 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:09,855 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:09,855 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:54:09,855 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:54:09,856 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:54:09,856 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:12,753 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:54:12,754 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:54:12,756 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:54:12,757 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:54:12,757 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:54:12,758 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:54:40,785 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"CALL","amount":"40","confidence":"0.7"},"reasoning":{"hand_strength":"8♦,9♣虽不属于顶级起手牌，但作为连牌具有一定的成牌潜力，容易形成顺子机会。","position_analysis":"处于早位，加上面对两位对手的参与，建议不要过度冒险。","pot_odds":"底池100，对手下注40，跟注成本相对较低，可看到翻牌后再决定后续策略。","opponent_reads":["ai_2展现出激进倾向，player_0则表现得较为温和，可能持有中等甚至偏强牌型"]},"table_talk":{"message":"各位，先冷静观望翻牌，别急着露出底牌，看谁先现虚实！","tone":"自信且略带挑衅"}}
2025-03-10 23:54:40,786 - src.agents.llm - INFO - ==================================================

2025-03-10 23:54:40,786 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '各位，先冷静观望翻牌，别急着露出底牌，看谁先现虚实！', 'tone': '自信且略带挑衅'}
2025-03-10 23:54:40,786 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:54:40,787 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:54:40,788 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-10 23:54:40,788 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:54:40,789 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:54:40,790 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:54:40,790 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:54:40,791 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:40,792 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:54:40,792 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:54:40,793 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:54:40,794 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:40,794 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:40,795 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-10 23:54:40,795 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:54:40,796 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:54:40,796 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-10 23:54:40,797 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:54:40,797 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:54:40,798 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:54:40,798 - src.engine.game - INFO - 活跃玩家数量: 3, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:54:40,798 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:54:40,799 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:54:40,799 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:54:40,799 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:54:40,800 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:40,800 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:54:40,801 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:54:40,801 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-10 23:54:40,802 - src.engine.dealer - INFO - Dealt 3 community cards: ['K♣', '3♦', 'A♠']
2025-03-10 23:54:40,802 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['K♣', '3♦', 'A♠']
2025-03-10 23:54:40,802 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1), ('ai_2', 2)]
2025-03-10 23:54:40,803 - src.engine.game - INFO - 庄家位置: 2
2025-03-10 23:54:40,803 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:54:40,804 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:54:40,804 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 120, 'community_cards': ['K♣', '3♦', 'A♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3000, 'current_bet': 0, 'is_active': True, 'cards': ('K♥', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 0, 'is_active': True, 'cards': ('6♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，先冷静观望翻牌，别急着露出底牌，看谁先现虚实！', 'tone': '自信且略带挑衅'}}
2025-03-10 23:54:40,806 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:40,806 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:40,806 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:54:40,807 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:54:40,807 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:54:40,807 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:48,340 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 200}
2025-03-10 23:54:48,341 - server - INFO - 收到加注请求，金额: 200
2025-03-10 23:54:48,341 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 200, 'timestamp': '2025-03-10T23:54:48.341899', 'table_talk': None}
2025-03-10 23:54:48,342 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-10 23:54:48,343 - src.engine.state - INFO - 玩家 player_0 加注到 200 筹码，已标记为已行动
2025-03-10 23:54:48,343 - src.engine.game - INFO - 玩家 player_0 加注到 200
2025-03-10 23:54:48,344 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-10 23:54:48,344 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:54:48,345 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:54:48,345 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:54:48,345 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:54:48,346 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:54:48,346 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:54:48,347 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:48,348 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:48,348 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:54:48,348 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 23:54:48,348 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:54:48,349 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:54:48,349 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:48,349 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:54:48,350 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 320, 'community_cards': ['K♣', '3♦', 'A♠'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2800, 'current_bet': 200, 'is_active': True, 'cards': ('K♥', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 200}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', '9♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 0, 'is_active': True, 'cards': ('6♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:54:48,350 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:54:48,351 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:54:48,351 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:54:48,352 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 23:54:48,352 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:54:48,352 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:54:48,353 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:54:50,835 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:54:50,837 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:54:50,838 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:54:50,839 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:54:50,840 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:54:50,840 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:55:04,549 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "在翻牌中，8♦, 9♣没有形成任何有利的组合，既没有顺子也没有同花的潜力，加上公共牌中有K、A，对方可能持有高牌或成牌的机会较大", "position_analysis": "作为早期位置玩家，信息有限且对手已表现出激进行为，加上自己筹码不足，采取保守策略更为明智", "pot_odds": "底池320与投入高额注码相比，风险收益比不合理，投入不足以补偿潜在损失", "opponent_reads": ["对手频繁加注，显示出较强牌面或利用心理战制造压力"]}, "table_talk": {"message": "你们这么激进，我看今天不上道，我就认输吧", "tone": "冷静且略带鄙夷"}}
2025-03-10 23:55:04,550 - src.agents.llm - INFO - ==================================================

2025-03-10 23:55:04,551 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '你们这么激进，我看今天不上道，我就认输吧', 'tone': '冷静且略带鄙夷'}
2025-03-10 23:55:04,551 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:55:04,552 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:55:04,552 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:55:04,553 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:55:04,555 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:55:04,555 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:55:04,556 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:55:04,556 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:55:04,556 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:55:04,557 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:55:04,557 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:55:04,557 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:55:04,558 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:55:04,558 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:55:04,559 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 23:55:04,559 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:55:04,560 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:55:04,560 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:55:04,560 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:55:04,561 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 320, 'community_cards': ['K♣', '3♦', 'A♠'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 2800, 'current_bet': 200, 'is_active': True, 'cards': ('K♥', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 0, 'is_active': True, 'cards': ('6♦', '6♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你们这么激进，我看今天不上道，我就认输吧', 'tone': '冷静且略带鄙夷'}}
2025-03-10 23:55:04,562 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:55:04,562 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:55:04,563 - src.engine.game - INFO - 当前最大下注额: 200
2025-03-10 23:55:04,563 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=200, is_all_in=False
2025-03-10 23:55:04,563 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:55:04,564 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:55:04,564 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:55:04,566 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:55:04,566 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:55:04,566 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:55:04,567 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:55:04,567 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:55:04,567 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:55:17,972 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌是6♦和6♠，公共牌有K♣, 3♦, A♠，手牌强度较弱，没有明显的成牌机会。","position_analysis":"位置是2，处于中位，前面有玩家已经加注，后面还有玩家可能行动，位置不利。","pot_odds":"底池为320，当前最大注为200，需要投入200才能继续，底池赔率较低，不值得冒险。","opponent_reads":["player_0在上一轮进行了加注，显示出较强的牌力，可能持有高牌或成牌。"]},"table_talk":{"message":"看来这次运气不在我这边，我选择弃牌。","tone":"冷静"}}
2025-03-10 23:55:17,973 - src.agents.llm - INFO - ==================================================

2025-03-10 23:55:17,974 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这次运气不在我这边，我选择弃牌。', 'tone': '冷静'}
2025-03-10 23:55:17,975 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:55:17,977 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:55:17,977 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:55:17,978 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:55:17,979 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:55:17,979 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:55:17,980 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:55:17,980 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:55:17,981 - src.engine.state - INFO - 玩家 player_0 获得底池 320 筹码，当前筹码: 3120
2025-03-10 23:55:17,981 - src.engine.game - INFO - 玩家 player_0 获得底池 320 筹码
2025-03-10 23:55:17,982 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:55:17,983 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 320, 'winning_hand': None, 'community_cards': ['K♣', '3♦', 'A♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '4♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:55:17,983 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['K♣', '3♦', 'A♠'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 320, 'winning_hand': None, 'community_cards': ['K♣', '3♦', 'A♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '4♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3120, 'current_bet': 200, 'is_active': False, 'cards': ('K♥', '4♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这次运气不在我这边，我选择弃牌。', 'tone': '冷静'}}
2025-03-10 23:55:17,984 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:55:17,984 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:55:17,986 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:55:17,986 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:55:17,987 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:55:17,987 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:55:17,987 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 320, 'winning_hand': None, 'community_cards': ['K♣', '3♦', 'A♠'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('K♥', '4♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:55:17,988 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:55:21,429 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:55:21,429 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:55:21,430 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:55:21,430 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:55:21,431 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-10 23:55:21,431 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:55:21,432 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:55:21,432 - src.engine.game - INFO - 玩家 player_0 手牌: ('6♠', '7♦')
2025-03-10 23:55:21,432 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♥', '2♦')
2025-03-10 23:55:21,433 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♠', '3♣')
2025-03-10 23:55:21,433 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:55:21,434 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:55:21,434 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:55:21,434 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:55:21,435 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:55:21,435 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:55:21,436 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:55:21,436 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:55:25,988 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-10 23:55:25,989 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-10T23:55:25.989272', 'table_talk': None}
2025-03-10 23:55:25,990 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-10 23:55:25,990 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-10 23:55:25,991 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-10 23:55:25,991 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-10 23:55:25,991 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:55:25,992 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:55:25,992 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:55:25,992 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:55:25,993 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:55:25,993 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:55:25,994 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:55:25,994 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:55:25,995 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:55:25,995 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:55:25,995 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:55:25,996 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:55:25,996 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:55:25,996 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 110, 'current_bet': 10, 'is_active': True, 'cards': ('8♥', '2♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 20, 'is_active': True, 'cards': ('Q♠', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:55:25,997 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:55:25,997 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-10 23:55:25,997 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:55:25,999 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:55:25,999 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:55:26,000 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:55:28,004 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:55:28,005 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:55:28,005 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:55:28,007 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:55:28,008 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:55:28,008 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:55:42,175 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "8♥, 2♦ is one of the weakest hands in Texas Hold'em and lacks potential to improve.", "position_analysis": "在PRE_FLOP阶段且位置靠前，没有足够信息支持冒险玩这样的手牌。", "pot_odds": "底池仅有30，加上对手已经下注20，投入风险与回报不成正比。", "opponent_reads": ["对手的激进行为暗示了较强手牌或至少在伺机抢占主动权"]}, "table_talk": {"message": "这手牌真不忍直视，我就让它溜回去吧。", "tone": "轻松调侃"}}
2025-03-10 23:55:42,177 - src.agents.llm - INFO - ==================================================

2025-03-10 23:55:42,177 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌真不忍直视，我就让它溜回去吧。', 'tone': '轻松调侃'}
2025-03-10 23:55:42,178 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:55:42,178 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:55:42,179 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:55:42,179 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:55:42,180 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:55:42,180 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-10 23:55:42,181 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:55:42,182 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:55:42,183 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 1770
2025-03-10 23:55:42,183 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-10 23:55:42,184 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:55:42,184 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♠', '3♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:55:42,185 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♠', '3♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3120, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 20, 'is_active': False, 'cards': ('Q♠', '3♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌真不忍直视，我就让它溜回去吧。', 'tone': '轻松调侃'}}
2025-03-10 23:55:42,186 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:55:42,187 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:55:42,187 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:55:42,188 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:55:42,188 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:55:42,188 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:55:42,188 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♠', '3♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:55:42,189 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:56:09,193 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:56:09,193 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:56:09,194 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:56:09,194 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:56:09,195 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-10 23:56:09,195 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:56:09,196 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:56:09,196 - src.engine.game - INFO - 玩家 player_0 手牌: ('4♦', 'Q♠')
2025-03-10 23:56:09,197 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♥', '2♣')
2025-03-10 23:56:09,197 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♦', 'Q♣')
2025-03-10 23:56:09,198 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:56:09,198 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:56:09,198 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:56:09,198 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:56:09,198 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:56:09,199 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:56:09,199 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:56:09,200 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:56:12,260 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:56:12,261 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:56:12,261 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:56:12,262 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:56:12,263 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:56:12,264 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:56:32,563 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "6♥, 2♣ 是德州扑克中最弱的起手牌之一，基本没有获胜潜力。", "position_analysis": "处于前位且在两位对手之后行动，加之对手筹码充裕，意味着面临更大压力。", "pot_odds": "当前底池30和需要跟注20的赔率不足以补偿牌面质量的劣势。", "opponent_reads": ["player_0 显示出激进风格且筹码优势明显，ai_2 亦为活跃状态，对局势构成更大威胁。"]}, "table_talk": {"message": "今天真是运气不佳，这局就省省力气，等下一局走运！", "tone": "冷静且略带轻松" }}
2025-03-10 23:56:32,564 - src.agents.llm - INFO - ==================================================

2025-03-10 23:56:32,564 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今天真是运气不佳，这局就省省力气，等下一局走运！', 'tone': '冷静且略带轻松'}
2025-03-10 23:56:32,565 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:56:32,565 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:56:32,566 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:56:32,566 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:56:32,566 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:56:32,567 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:56:32,568 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:56:32,568 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:56:32,569 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:56:32,569 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:56:32,570 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:56:32,570 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:56:32,570 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:56:32,571 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:56:32,571 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:56:32,572 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:56:32,572 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:56:32,573 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:56:32,573 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3100, 'current_bet': 20, 'is_active': True, 'cards': ('4♦', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 10, 'is_active': True, 'cards': ('3♦', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天真是运气不佳，这局就省省力气，等下一局走运！', 'tone': '冷静且略带轻松'}}
2025-03-10 23:56:32,574 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:56:32,575 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:56:32,575 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:56:32,575 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:56:32,576 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:56:32,576 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:56:32,576 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:56:32,578 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:56:32,578 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:56:32,579 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:56:32,579 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:56:32,579 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:56:39,177 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌3♦, Q♣在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2处于早期位置，缺乏信息优势","pot_odds":"底池30相对于当前最大注20的赔率较低，不值得冒险","opponent_reads":["player_0当前下注20，显示出一定的积极性，可能持有较强手牌"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:56:39,177 - src.agents.llm - INFO - ==================================================

2025-03-10 23:56:39,178 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:56:39,178 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:56:39,178 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:56:39,178 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:56:39,178 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:56:39,179 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:56:39,179 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:56:39,179 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:56:39,180 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:56:39,180 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3130
2025-03-10 23:56:39,181 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:56:39,181 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:56:39,182 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('4♦', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:56:39,182 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('4♦', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3130, 'current_bet': 20, 'is_active': False, 'cards': ('4♦', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:56:39,183 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:56:39,183 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:56:39,184 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:56:39,185 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:56:39,185 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:56:39,185 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:56:39,186 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('4♦', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:56:39,186 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:56:41,086 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:56:41,087 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:56:41,088 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:56:41,088 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:56:41,089 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-10 23:56:41,089 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:56:41,090 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:56:41,090 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♦', 'Q♣')
2025-03-10 23:56:41,091 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♥', '4♦')
2025-03-10 23:56:41,091 - src.engine.game - INFO - 玩家 ai_2 手牌: ('K♣', '7♠')
2025-03-10 23:56:41,092 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-10 23:56:41,092 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-10 23:56:41,093 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-10 23:56:41,093 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-10 23:56:41,094 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-10 23:56:41,094 - src.engine.game - INFO - 当前玩家: player_0
2025-03-10 23:56:41,095 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:56:41,095 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-10 23:56:46,437 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:56:46,438 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:56:46.438274', 'table_talk': None}
2025-03-10 23:56:46,439 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:56:46,440 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-10 23:56:46,440 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:56:46,441 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:56:46,441 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:56:46,441 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:56:46,442 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:56:46,442 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:56:46,442 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:56:46,443 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:56:46,444 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:56:46,444 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:56:46,445 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:56:46,445 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:56:46,445 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:56:46,446 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:56:46,446 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:56:46,446 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:56:46,447 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 100, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', '4♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 20, 'is_active': True, 'cards': ('K♣', '7♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:56:46,447 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:56:46,448 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:56:46,448 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:56:46,449 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:56:46,449 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:56:46,449 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:56:46,450 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:56:49,223 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:56:49,223 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:56:49,224 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:56:49,226 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:56:49,227 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:56:49,228 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:57:07,185 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "6♥, 4♦这手牌非常弱，几乎没有提高成有利组合的潜力", "position_analysis": "处在较早位置，加上手牌不佳，不适合冒险", "pot_odds": "底池虽小，但投入的风险远大于潜在收益", "opponent_reads": ["对手仅是跟注，可能隐藏了更强的牌型，增加了追逐风险"]}, "table_talk": {"message": "这手牌看起来太糟糕了，今天我就不参与这局了", "tone": "冷静且果断"}}
2025-03-10 23:57:07,188 - src.agents.llm - INFO - ==================================================

2025-03-10 23:57:07,189 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌看起来太糟糕了，今天我就不参与这局了', 'tone': '冷静且果断'}
2025-03-10 23:57:07,190 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:57:07,190 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:57:07,190 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:57:07,190 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:57:07,191 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:57:07,192 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:57:07,192 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:57:07,193 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:57:07,193 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:57:07,193 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:57:07,194 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:57:07,194 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:57:07,194 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:57:07,194 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:57:07,196 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:57:07,196 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:57:07,197 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:57:07,198 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:57:07,198 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:57:07,199 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 100, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 20, 'is_active': True, 'cards': ('K♣', '7♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌看起来太糟糕了，今天我就不参与这局了', 'tone': '冷静且果断'}}
2025-03-10 23:57:07,200 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:57:07,200 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:57:07,201 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:57:07,201 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:57:07,202 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:57:07,202 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-10 23:57:07,202 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:57:07,204 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:57:07,204 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:57:07,205 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:57:07,205 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:57:07,206 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:57:07,206 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:57:14,111 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"K♣, 7♠ 是一手较弱的手牌，缺乏同花或顺子的潜力，在当前阶段难以形成强力组合","position_analysis":"处于中间位置，缺乏信息优势，无法有效利用位置进行策略调整","pot_odds":"底池赔率较低，投入20筹码换取50底池的回报率不高，不值得冒险","opponent_reads":["player_0选择跟注，显示出一定的牌力或策略意图，可能持有较强手牌或试图施加压力"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:57:14,113 - src.agents.llm - INFO - ==================================================

2025-03-10 23:57:14,114 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:57:14,115 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:57:14,115 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:57:14,116 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:57:14,116 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:57:14,117 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:57:14,117 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:57:14,118 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:57:14,118 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:57:14,119 - src.engine.state - INFO - 玩家 player_0 获得底池 50 筹码，当前筹码: 3160
2025-03-10 23:57:14,120 - src.engine.game - INFO - 玩家 player_0 获得底池 50 筹码
2025-03-10 23:57:14,120 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:57:14,121 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♦', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:57:14,122 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♦', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3160, 'current_bet': 20, 'is_active': False, 'cards': ('7♦', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 100, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:57:14,123 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:57:14,123 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:57:14,124 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:57:14,124 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:57:14,125 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:57:14,125 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:57:14,125 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♦', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:57:14,126 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:57:18,045 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:57:18,046 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:57:18,046 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:57:18,047 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:57:18,047 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-10 23:57:18,048 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:57:18,048 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:57:18,048 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♥', 'Q♣')
2025-03-10 23:57:18,049 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♦', '4♣')
2025-03-10 23:57:18,049 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♣', 'A♠')
2025-03-10 23:57:18,050 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-10 23:57:18,050 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-10 23:57:18,050 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-10 23:57:18,051 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-10 23:57:18,051 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-10 23:57:18,052 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-10 23:57:18,052 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:57:18,053 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-10 23:57:19,147 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:57:19,148 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:57:19,149 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:57:19,149 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:57:19,150 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:57:19,150 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:57:38,711 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌3♦, 4♣很弱，缺乏成牌潜力，不适合在PRE_FLOP阶段投入过多筹码", "position_analysis": "当前位置处于较早位置，面对对手主动下注压力，风险更高", "pot_odds": "虽然底池有30，但跟注20与手牌质量不成正比，底池赔率不足以补偿潜在风险", "opponent_reads": ["player_0筹码丰厚且活跃，倾向于积极进攻", "ai_2当前下注较少，但整体状态依然活跃，可能采取观望或试探策略"]}, "table_talk": {"message": "看来今天的牌运不佳，还是保留实力，下次再战！", "tone": "轻松调侃"}}
2025-03-10 23:57:38,712 - src.agents.llm - INFO - ==================================================

2025-03-10 23:57:38,713 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天的牌运不佳，还是保留实力，下次再战！', 'tone': '轻松调侃'}
2025-03-10 23:57:38,714 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-10 23:57:38,714 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-10 23:57:38,714 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-10 23:57:38,715 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-10 23:57:38,715 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-10 23:57:38,715 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:57:38,717 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:57:38,717 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:57:38,718 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-10 23:57:38,718 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-10 23:57:38,719 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-10 23:57:38,719 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:57:38,719 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:57:38,719 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:57:38,719 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:57:38,720 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:57:38,720 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:57:38,721 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:57:38,721 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3140, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 100, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 10, 'is_active': True, 'cards': ('5♣', 'A♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天的牌运不佳，还是保留实力，下次再战！', 'tone': '轻松调侃'}}
2025-03-10 23:57:38,722 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:57:38,723 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-10 23:57:38,723 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:57:38,723 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:57:38,723 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:57:38,725 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:57:38,726 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:57:38,727 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:57:38,727 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:57:38,728 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:57:38,728 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:57:38,729 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:57:47,077 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌5♣, A♠在PRE_FLOP阶段较弱，A♠虽有一定价值，但5♣的配合不佳，整体强度不足","position_analysis":"位置2在PRE_FLOP阶段相对靠前，不利于观察后续玩家的行动，增加了决策的不确定性","pot_odds":"底池30，当前最大注20，跟注需要投入20，底池赔率较低，不值得冒险","opponent_reads":["对手player_0当前下注20，显示出一定的攻击性，可能持有较强手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-10 23:57:47,078 - src.agents.llm - INFO - ==================================================

2025-03-10 23:57:47,079 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-10 23:57:47,079 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:57:47,080 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:57:47,080 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:57:47,080 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:57:47,081 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:57:47,081 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-10 23:57:47,082 - src.engine.game - INFO - 开始游戏结算
2025-03-10 23:57:47,082 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-10 23:57:47,083 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3170
2025-03-10 23:57:47,083 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-10 23:57:47,084 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-10 23:57:47,084 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:57:47,085 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3170, 'current_bet': 20, 'is_active': False, 'cards': ('8♥', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 100, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-10 23:57:47,086 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:57:47,086 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-10 23:57:47,087 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-10 23:57:47,087 - server - INFO - 回合结束，进入下一阶段
2025-03-10 23:57:47,088 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-10 23:57:47,088 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-10 23:57:47,089 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-10 23:57:47,089 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-10 23:57:58,764 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-10 23:57:58,765 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-10 23:57:58,765 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-10 23:57:58,766 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-10 23:57:58,766 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-10 23:57:58,767 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-10 23:57:58,767 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-10 23:57:58,768 - src.engine.game - INFO - 玩家 player_0 手牌: ('10♠', '9♥')
2025-03-10 23:57:58,768 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♦', 'J♥')
2025-03-10 23:57:58,768 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♠', 'J♣')
2025-03-10 23:57:58,769 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-10 23:57:58,769 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-10 23:57:58,770 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-10 23:57:58,770 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-10 23:57:58,771 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-10 23:57:58,771 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-10 23:57:58,771 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-10 23:57:58,772 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-10 23:58:02,140 - server - INFO - 当前AI玩家: ai_2
2025-03-10 23:58:02,141 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-10 23:58:02,142 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-10 23:58:02,142 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:58:02,143 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:58:02,143 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-10 23:58:09,110 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌5♠和J♣在PRE_FLOP阶段强度较低，缺乏成牌潜力","position_analysis":"位置2处于中间位置，缺乏信息优势","pot_odds":"底池赔率不理想，不值得冒险跟注或加注","opponent_reads":["player_0下注10，可能持有中等强度手牌","ai_1下注20，可能持有较强手牌或试图施加压力"]},"table_talk":{"message":"看来这手牌不适合我，我弃牌","tone":"冷静"}}
2025-03-10 23:58:09,112 - src.agents.llm - INFO - ==================================================

2025-03-10 23:58:09,112 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我弃牌', 'tone': '冷静'}
2025-03-10 23:58:09,113 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-10 23:58:09,113 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-10 23:58:09,113 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-10 23:58:09,114 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-10 23:58:09,114 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-10 23:58:09,115 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-10 23:58:09,115 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-10 23:58:09,117 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:09,117 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-10 23:58:09,118 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-10 23:58:09,118 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-10 23:58:09,119 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:09,119 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:09,120 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:09,120 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:58:09,121 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:58:09,121 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:09,121 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:58:09,122 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3160, 'current_bet': 10, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我弃牌', 'tone': '冷静'}}
2025-03-10 23:58:09,123 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:09,124 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:09,124 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:09,124 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-10 23:58:09,125 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:58:09,125 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:12,501 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-10 23:58:12,502 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-10T23:58:12.502723', 'table_talk': None}
2025-03-10 23:58:12,503 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-10 23:58:12,503 - src.engine.state - INFO - 玩家 player_0 跟注 10 筹码，已标记为已行动
2025-03-10 23:58:12,503 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-10 23:58:12,505 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-10 23:58:12,505 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:58:12,505 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:58:12,505 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:12,506 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:58:12,506 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:58:12,506 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:58:12,507 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:12,507 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:12,508 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:12,508 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:58:12,508 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:58:12,509 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:58:12,509 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:12,510 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:58:12,510 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 20, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 80, 'current_bet': 20, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:58:12,511 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:12,511 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:12,512 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:12,512 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:58:12,512 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-10 23:58:12,513 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:58:12,513 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:14,137 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:58:14,138 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:58:14,138 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:58:14,139 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:58:14,139 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:58:14,140 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:58:29,008 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.6"}, "reasoning": {"hand_strength": "8♦和J♥属于中等偏下水平，不足以进行强势加注，风险较大", "position_analysis": "处于位置1，信息较少，风险增加；稳妥策略为控制底池规模", "pot_odds": "底池40，对手已下注20，调用成本低于底池的价值", "opponent_reads": ["对手跟注表明可能手牌范围较宽，筹码充裕但不一定有强牌"]}, "table_talk": {"message": "先稳住阵脚，观察对手的后续动作，看清楚他的企图再出手", "tone": "冷静且充满策略感"}}
2025-03-10 23:58:29,009 - src.agents.llm - INFO - ==================================================

2025-03-10 23:58:29,009 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '先稳住阵脚，观察对手的后续动作，看清楚他的企图再出手', 'tone': '冷静且充满策略感'}
2025-03-10 23:58:29,010 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-10 23:58:29,010 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-10 23:58:29,010 - src.engine.state - INFO - 玩家 ai_1 跟注 0 筹码，已标记为已行动
2025-03-10 23:58:29,010 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-10 23:58:29,010 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-10 23:58:29,011 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:58:29,011 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:58:29,011 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:29,012 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:58:29,012 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:58:29,013 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:58:29,013 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:29,013 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:29,013 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-10 23:58:29,014 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:58:29,014 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-10 23:58:29,015 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:58:29,015 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:58:29,016 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:58:29,017 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-10 23:58:29,017 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:58:29,018 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-10 23:58:29,019 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:58:29,020 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:58:29,020 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:29,021 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:58:29,021 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:58:29,021 - src.engine.dealer - INFO - Dealt 3 community cards: ['K♣', '7♣', '7♥']
2025-03-10 23:58:29,022 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['K♣', '7♣', '7♥']
2025-03-10 23:58:29,022 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:58:29,023 - src.engine.game - INFO - 庄家位置: 2
2025-03-10 23:58:29,023 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:58:29,024 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:58:29,024 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 40, 'community_cards': ['K♣', '7♣', '7♥'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '先稳住阵脚，观察对手的后续动作，看清楚他的企图再出手', 'tone': '冷静且充满策略感'}}
2025-03-10 23:58:29,025 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:29,025 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:29,026 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:58:29,026 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:58:29,026 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:58:29,027 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:41,844 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-10 23:58:41,845 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-10T23:58:41.845891', 'table_talk': None}
2025-03-10 23:58:41,846 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-10 23:58:41,846 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-10 23:58:41,847 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-10 23:58:41,847 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:58:41,848 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:58:41,848 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:58:41,849 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:58:41,849 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:58:41,849 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:58:41,850 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:41,850 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:41,851 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:58:41,851 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:58:41,851 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:58:41,851 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:58:41,853 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:41,853 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:58:41,854 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 40, 'community_cards': ['K♣', '7♣', '7♥'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 80, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:58:41,855 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:58:41,855 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:58:41,856 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:58:41,856 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:58:41,857 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:58:41,857 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:58:41,858 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:58:44,072 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:58:44,073 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:58:44,075 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:58:44,075 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:58:44,076 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:58:44,077 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:59:08,384 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CHECK", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "手牌8♦, J♥在该公共牌(K♣, 7♣, 7♥)面前没有形成有效组合，整体实力较弱", "position_analysis": "处于较早位置，加上对手表现得较为被动，此时选择保守以待后续行动更为明智", "pot_odds": "当前底池为40且无人加注，检查可以控制底池大小，保留筹码以便利用后续机会", "opponent_reads": ["player_0当前采用消极玩法，可能在等待更好的机会或隐藏强牌"]}, "table_talk": {"message": "我选择保持冷静，观望局势，等待对手露出破绽再伺机出击。", "tone": "镇定且策略性"}}
2025-03-10 23:59:08,384 - src.agents.llm - INFO - ==================================================

2025-03-10 23:59:08,386 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '我选择保持冷静，观望局势，等待对手露出破绽再伺机出击。', 'tone': '镇定且策略性'}
2025-03-10 23:59:08,386 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-03-10 23:59:08,386 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-03-10 23:59:08,387 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-03-10 23:59:08,387 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-03-10 23:59:08,387 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:59:08,387 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:59:08,388 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:08,388 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:59:08,389 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:59:08,389 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:59:08,390 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:59:08,390 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:08,391 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:08,391 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:59:08,392 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:59:08,392 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:59:08,392 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:59:08,394 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:59:08,394 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.FLOP
2025-03-10 23:59:08,395 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:59:08,396 - src.engine.game - INFO - 从阶段 GameStage.FLOP 进入下一阶段
2025-03-10 23:59:08,396 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:59:08,397 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:59:08,397 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:08,398 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:59:08,398 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:59:08,398 - src.engine.dealer - INFO - Dealt 1 community cards: ['3♣']
2025-03-10 23:59:08,399 - src.engine.game - INFO - 进入转牌阶段，公共牌: ['K♣', '7♣', '7♥', '3♣']
2025-03-10 23:59:08,399 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:59:08,400 - src.engine.game - INFO - 庄家位置: 2
2025-03-10 23:59:08,400 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:59:08,400 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:59:08,401 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'TURN', 'pot_size': 40, 'community_cards': ['K♣', '7♣', '7♥', '3♣'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我选择保持冷静，观望局势，等待对手露出破绽再伺机出击。', 'tone': '镇定且策略性'}}
2025-03-10 23:59:08,402 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:59:08,403 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:08,403 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:08,403 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:59:08,404 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:59:08,404 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:59:23,642 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-10 23:59:23,643 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-10T23:59:23.643024', 'table_talk': None}
2025-03-10 23:59:23,644 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-10 23:59:23,644 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-10 23:59:23,644 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-10 23:59:23,645 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-10 23:59:23,645 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-10 23:59:23,646 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:23,646 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-10 23:59:23,647 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-10 23:59:23,648 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-10 23:59:23,649 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:59:23,649 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:23,650 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:23,650 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:59:23,651 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:59:23,651 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:59:23,651 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:59:23,652 - src.engine.game - INFO - 回合是否完成: False
2025-03-10 23:59:23,652 - server - INFO - 发送更新后的游戏状态: {'phase': 'TURN', 'pot_size': 40, 'community_cards': ['K♣', '7♣', '7♥', '3♣'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 80, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-10 23:59:23,653 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:59:23,653 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:23,654 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:23,654 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:59:23,654 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:59:23,655 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-10 23:59:23,655 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-10 23:59:28,454 - server - INFO - 当前AI玩家: ai_1
2025-03-10 23:59:28,455 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-10 23:59:28,456 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-10 23:59:28,457 - src.agents.llm - INFO - 
==================================================
2025-03-10 23:59:28,458 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-10 23:59:28,459 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-10 23:59:54,112 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CHECK", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "目前手牌为8♦, J♥与公共牌K♣,7♣,7♥,3♣相比毫无提升，面对成对的7s，自己的牌力较弱，容易被更强的对子或满堂红击败", "position_analysis": "处于第一位置，但当前局面主动权不大，检查可以控制底池，避免在牌力不佳时过度投入", "pot_odds": "底池为40且无人下注，选择免费看河牌，风险较低", "opponent_reads": ["对手多次选择CHECK，可能在等待更好的建池机会或试图诱导对手下注，显示出谨慎或设陷阱的策略"]}, "table_talk": {"message": "我现在不着急，先稳住阵脚再看好机会出手。", "tone": "沉稳自信"}}
2025-03-10 23:59:54,113 - src.agents.llm - INFO - ==================================================

2025-03-10 23:59:54,113 - src.agents.llm - INFO - 生成动作: CHECK 金额: 0 table_talk: {'message': '我现在不着急，先稳住阵脚再看好机会出手。', 'tone': '沉稳自信'}
2025-03-10 23:59:54,113 - server - INFO - AI玩家 ai_1 决定执行动作: CHECK, 金额: 0
2025-03-10 23:59:54,113 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CHECK
2025-03-10 23:59:54,113 - src.engine.game - INFO - 玩家 ai_1 过牌，已标记为已行动
2025-03-10 23:59:54,115 - src.engine.state - INFO - 添加动作到历史记录: CHECK by ai_1
2025-03-10 23:59:54,115 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-10 23:59:54,115 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-10 23:59:54,116 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:54,116 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-10 23:59:54,117 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-10 23:59:54,117 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-10 23:59:54,117 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:59:54,118 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:54,118 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:54,119 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:59:54,119 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=0, is_all_in=False
2025-03-10 23:59:54,120 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-10 23:59:54,120 - src.engine.game - INFO - 回合是否完成: True
2025-03-10 23:59:54,121 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-10 23:59:54,121 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.TURN
2025-03-10 23:59:54,122 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-10 23:59:54,122 - src.engine.game - INFO - 从阶段 GameStage.TURN 进入下一阶段
2025-03-10 23:59:54,122 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-10 23:59:54,122 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-10 23:59:54,123 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:54,123 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-10 23:59:54,124 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-10 23:59:54,124 - src.engine.dealer - INFO - Dealt 1 community cards: ['4♠']
2025-03-10 23:59:54,125 - src.engine.game - INFO - 进入河牌阶段，公共牌: ['K♣', '7♣', '7♥', '3♣', '4♠']
2025-03-10 23:59:54,125 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-10 23:59:54,125 - src.engine.game - INFO - 庄家位置: 2
2025-03-10 23:59:54,126 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-10 23:59:54,126 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-10 23:59:54,127 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'RIVER', 'pot_size': 40, 'community_cards': ['K♣', '7♣', '7♥', '3♣', '4♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': True, 'cards': ('10♠', '9♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 0, 'is_active': True, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我现在不着急，先稳住阵脚再看好机会出手。', 'tone': '沉稳自信'}}
2025-03-10 23:59:54,128 - src.engine.game - INFO - 检查回合是否完成
2025-03-10 23:59:54,128 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-10 23:59:54,129 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-10 23:59:54,129 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-10 23:59:54,130 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-10 23:59:54,130 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:00:10,726 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:00:10,727 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:00:10.727278', 'table_talk': None}
2025-03-11 00:00:10,727 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:00:10,728 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:00:10,729 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-11 00:00:10,729 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:00:10,730 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-11 00:00:10,730 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:00:10,730 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:00:10,730 - src.engine.state - INFO - 玩家 ai_1 获得底池 40 筹码，当前筹码: 120
2025-03-11 00:00:10,731 - src.engine.game - INFO - 玩家 ai_1 获得底池 40 筹码
2025-03-11 00:00:10,731 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:00:10,731 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': ['K♣', '7♣', '7♥', '3♣', '4♠'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('8♦', 'J♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:00:10,733 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['K♣', '7♣', '7♥', '3♣', '4♠'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': ['K♣', '7♣', '7♥', '3♣', '4♠'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('8♦', 'J♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 120, 'current_bet': 0, 'is_active': False, 'cards': ('8♦', 'J♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:00:10,733 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:00:10,733 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:00:10,734 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:00:10,734 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:00:10,735 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:00:10,735 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:00:10,735 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': ['K♣', '7♣', '7♥', '3♣', '4♠'], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('8♦', 'J♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:00:10,736 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:00:11,926 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:00:11,927 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:00:11,928 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:00:11,928 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:00:11,928 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-11 00:00:11,929 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:00:11,929 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:00:11,930 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♠', '5♣')
2025-03-11 00:00:11,930 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♥', '4♣')
2025-03-11 00:00:11,930 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♥', '4♠')
2025-03-11 00:00:11,931 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:00:11,931 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:00:11,932 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:00:11,932 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:00:11,933 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:00:11,933 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:00:11,933 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:00:11,934 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:00:43,955 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:00:43,956 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:00:43.956892', 'table_talk': None}
2025-03-11 00:00:43,956 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:00:43,957 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:00:43,957 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:00:43,958 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:00:43,958 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:00:43,959 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:00:43,959 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:00:43,960 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:00:43,960 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:00:43,961 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:00:43,961 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:00:43,961 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:00:43,963 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:00:43,963 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:00:43,964 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:00:43,964 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:00:43,964 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:00:43,965 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 110, 'current_bet': 10, 'is_active': True, 'cards': ('10♥', '4♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1710, 'current_bet': 20, 'is_active': True, 'cards': ('2♥', '4♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:00:43,966 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:00:43,966 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:00:43,967 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:00:43,967 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:00:43,968 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:00:43,968 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:00:44,274 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:00:44,275 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:00:44,275 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:00:44,276 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:00:44,276 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:00:44,277 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:01:05,520 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "10♥, 4♣是一手极弱的牌，缺乏任何实质上的竞争力", "position_analysis": "处于早位，加上前面已有玩家加注，信息有限", "pot_odds": "跟注20到30底池的赔率不足以弥补手牌的劣势", "opponent_reads": ["对手筹码雄厚且积极下注，可能不会轻易被吓退"]}, "table_talk": {"message": "看起来今天的牌运不佳，让我们下一局再争个好彩头！", "tone": "轻松且自信"}}
2025-03-11 00:01:05,521 - src.agents.llm - INFO - ==================================================

2025-03-11 00:01:05,522 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看起来今天的牌运不佳，让我们下一局再争个好彩头！', 'tone': '轻松且自信'}
2025-03-11 00:01:05,522 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:01:05,523 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:01:05,523 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:01:05,524 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:01:05,524 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:01:05,525 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:01:05,525 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:01:05,526 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:01:05,526 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 1740
2025-03-11 00:01:05,527 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-11 00:01:05,527 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:01:05,528 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('2♥', '4♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:01:05,528 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('2♥', '4♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 20, 'is_active': False, 'cards': ('2♥', '4♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来今天的牌运不佳，让我们下一局再争个好彩头！', 'tone': '轻松且自信'}}
2025-03-11 00:01:05,529 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:05,530 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:01:05,530 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:01:05,530 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:01:05,530 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:01:05,532 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:01:05,532 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('2♥', '4♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:01:05,533 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:01:08,429 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:01:08,429 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:01:08,430 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:01:08,430 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:01:08,431 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-11 00:01:08,431 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:01:08,432 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:01:08,432 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♣', '6♦')
2025-03-11 00:01:08,432 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♠', '2♦')
2025-03-11 00:01:08,433 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♠', '10♠')
2025-03-11 00:01:08,433 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:01:08,434 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:01:08,434 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:01:08,435 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:01:08,435 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:01:08,435 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:01:08,436 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:01:08,436 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:01:10,546 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:01:10,547 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:01:10,548 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:01:10,549 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:01:10,549 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:01:10,550 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:01:36,100 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.9"}, "reasoning": {"hand_strength": "A♠,2♦在Pre-flop中属于弱牌，进攻性不足，难以在多人底池中脱颖而出", "position_analysis": "处于较早位置，缺乏信息优势，面对对手积极的下注，更适合保守打法", "pot_odds": "底池仅30且需投入20，风险收益比在手牌较弱的情况下不划算", "opponent_reads": ["对手筹码充裕且已下注，显示出较强的进攻意图"]}, "table_talk": {"message": "今天不想冒险，把这局留给敢挑战的人吧", "tone": "冷静且略带挑衅"}}
2025-03-11 00:01:36,102 - src.agents.llm - INFO - ==================================================

2025-03-11 00:01:36,102 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今天不想冒险，把这局留给敢挑战的人吧', 'tone': '冷静且略带挑衅'}
2025-03-11 00:01:36,103 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:01:36,103 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:01:36,104 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:01:36,104 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:01:36,104 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:01:36,105 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:01:36,105 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:01:36,106 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:01:36,106 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:01:36,107 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:01:36,107 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:01:36,108 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:36,108 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:36,109 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:01:36,109 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:01:36,110 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:01:36,110 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:36,110 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:01:36,112 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3130, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1730, 'current_bet': 10, 'is_active': True, 'cards': ('Q♠', '10♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天不想冒险，把这局留给敢挑战的人吧', 'tone': '冷静且略带挑衅'}}
2025-03-11 00:01:36,113 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:36,113 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:36,114 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:01:36,115 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:01:36,115 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:01:36,116 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:36,117 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:01:36,117 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:01:36,118 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:01:36,118 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:01:36,119 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:01:36,119 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:01:42,692 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"40","confidence":"0.7"},"reasoning":{"hand_strength":"Q♠, 10♠是中等偏上的同花连牌，有潜力在翻牌后形成同花或顺子","position_analysis":"处于中间位置，可以观察后续玩家的行动，适合采取积极策略","pot_odds":"底池30，当前最大注20，加注到40，底池赔率合理","opponent_reads":["player_0下注20，可能持有中等强度的手牌，加注可以试探其手牌强度"]},"table_talk":{"message":"看来有人想试探我，那我就加点筹码吧","tone":"自信"}}
2025-03-11 00:01:42,693 - src.agents.llm - INFO - ==================================================

2025-03-11 00:01:42,693 - src.agents.llm - INFO - 成功将字符串金额 40 转换为数字 40.0
2025-03-11 00:01:42,694 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来有人想试探我，那我就加点筹码吧', 'tone': '自信'}
2025-03-11 00:01:42,694 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-11 00:01:42,695 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-11 00:01:42,695 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-11 00:01:42,696 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-11 00:01:42,696 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-11 00:01:42,697 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:01:42,697 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:01:42,698 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:01:42,698 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-11 00:01:42,699 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-11 00:01:42,699 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-11 00:01:42,700 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:42,700 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:42,701 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:01:42,702 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:01:42,702 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:01:42,703 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:42,703 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:01:42,704 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3130, 'current_bet': 20, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1700, 'current_bet': 40, 'is_active': True, 'cards': ('Q♠', '10♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来有人想试探我，那我就加点筹码吧', 'tone': '自信'}}
2025-03-11 00:01:42,705 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:42,705 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:42,706 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:01:42,706 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:01:42,706 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:01:42,707 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:50,254 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-11 00:01:50,255 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-11T00:01:50.255789', 'table_talk': None}
2025-03-11 00:01:50,256 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-11 00:01:50,256 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-11 00:01:50,257 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-11 00:01:50,257 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-11 00:01:50,257 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:01:50,258 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:01:50,258 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:01:50,259 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-11 00:01:50,259 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-11 00:01:50,261 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-11 00:01:50,262 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:50,263 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:50,264 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:01:50,265 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=40, is_all_in=False
2025-03-11 00:01:50,266 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=True, current_bet=40, is_all_in=False
2025-03-11 00:01:50,266 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-11 00:01:50,267 - src.engine.game - INFO - 回合是否完成: True
2025-03-11 00:01:50,267 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-11 00:01:50,268 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-11 00:01:50,268 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-11 00:01:50,269 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-11 00:01:50,269 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-11 00:01:50,270 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-11 00:01:50,270 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:50,270 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-11 00:01:50,271 - src.engine.game - INFO - 重置玩家 ai_2 状态: has_acted=False, current_bet=0
2025-03-11 00:01:50,271 - src.engine.dealer - INFO - Dealt 3 community cards: ['3♥', '10♦', '3♠']
2025-03-11 00:01:50,271 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['3♥', '10♦', '3♠']
2025-03-11 00:01:50,272 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_2', 2)]
2025-03-11 00:01:50,272 - src.engine.game - INFO - 庄家位置: 4
2025-03-11 00:01:50,273 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-11 00:01:50,273 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-11 00:01:50,274 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 80, 'community_cards': ['3♥', '10♦', '3♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1700, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', '10♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:01:50,275 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:50,275 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:50,276 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-11 00:01:50,277 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-11 00:01:50,277 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:01:50,277 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:55,885 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-11 00:01:55,886 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-11T00:01:55.886827', 'table_talk': None}
2025-03-11 00:01:55,887 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-11 00:01:55,887 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-11 00:01:55,888 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-11 00:01:55,888 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:01:55,889 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:01:55,889 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-11 00:01:55,889 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:01:55,890 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_2
2025-03-11 00:01:55,890 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:01:55,890 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:55,891 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:55,892 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-11 00:01:55,892 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-11 00:01:55,892 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-11 00:01:55,893 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:01:55,893 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:55,894 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:01:55,894 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 80, 'community_cards': ['3♥', '10♦', '3♠'], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1700, 'current_bet': 0, 'is_active': True, 'cards': ('Q♠', '10♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:01:55,895 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:01:55,895 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:01:55,896 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-11 00:01:55,896 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-11 00:01:55,896 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=0, is_all_in=False
2025-03-11 00:01:55,897 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:01:55,897 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:01:57,720 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:01:57,721 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:01:57,722 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:01:57,723 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:01:57,724 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:01:57,725 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:02:05,473 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":"80","confidence":"0.8"},"reasoning":{"hand_strength":"手牌Q♠和10♠在FLOP阶段已经形成了一对10，有一定的强度，且有机会发展成顺子或同花。","position_analysis":"位于第二位置，可以在后续行动中观察对手的反应，做出更有利的决策。","pot_odds":"底池目前为80，加注80后底池将增加到160，投入与回报比为1:2，较为合理。","opponent_reads":["player_0在前一轮选择了CHECK，可能手牌较弱或处于观望状态，加注可以施加压力。"]},"table_talk":{"message":"看来大家都比较谨慎，我来加点热度。","tone":"轻松自信"}}
2025-03-11 00:02:05,474 - src.agents.llm - INFO - ==================================================

2025-03-11 00:02:05,474 - src.agents.llm - INFO - 成功将字符串金额 80 转换为数字 80.0
2025-03-11 00:02:05,474 - src.agents.llm - INFO - 生成动作: RAISE 金额: 80 table_talk: {'message': '看来大家都比较谨慎，我来加点热度。', 'tone': '轻松自信'}
2025-03-11 00:02:05,475 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 80
2025-03-11 00:02:05,475 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-11 00:02:05,475 - src.engine.state - INFO - 玩家 ai_2 加注到 80 筹码，已标记为已行动
2025-03-11 00:02:05,475 - src.engine.game - INFO - 玩家 ai_2 加注到 80
2025-03-11 00:02:05,475 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-11 00:02:05,476 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:02:05,476 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:02:05,476 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-11 00:02:05,477 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-11 00:02:05,477 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-11 00:02:05,478 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-11 00:02:05,478 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:05,478 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:02:05,479 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-11 00:02:05,479 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-11 00:02:05,480 - src.engine.game - INFO - 玩家 player_0 下注额(0)不等于最大下注额(80)，回合继续
2025-03-11 00:02:05,480 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-11 00:02:05,480 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:02:05,481 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FLOP', 'pot_size': 160, 'community_cards': ['3♥', '10♦', '3♠'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': True, 'cards': ('9♣', '6♦'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1620, 'current_bet': 80, 'is_active': True, 'cards': ('Q♠', '10♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 80}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来大家都比较谨慎，我来加点热度。', 'tone': '轻松自信'}}
2025-03-11 00:02:05,482 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:05,483 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:02:05,483 - src.engine.game - INFO - 当前最大下注额: 80
2025-03-11 00:02:05,484 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=0, is_all_in=False
2025-03-11 00:02:05,484 - src.engine.game - INFO - 玩家 player_0 下注额(0)不等于最大下注额(80)，回合继续
2025-03-11 00:02:05,484 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-11 00:02:14,321 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:02:14,324 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:02:14.324287', 'table_talk': None}
2025-03-11 00:02:14,325 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:02:14,326 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:02:14,327 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:02:14,328 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:02:14,329 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:02:14,330 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:02:14,331 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:02:14,331 - src.engine.state - INFO - 玩家 ai_2 获得底池 160 筹码，当前筹码: 1780
2025-03-11 00:02:14,332 - src.engine.game - INFO - 玩家 ai_2 获得底池 160 筹码
2025-03-11 00:02:14,332 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:02:14,332 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 160, 'winning_hand': None, 'community_cards': ['3♥', '10♦', '3♠'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♠', '10♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:02:14,333 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['3♥', '10♦', '3♠'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 160, 'winning_hand': None, 'community_cards': ['3♥', '10♦', '3♠'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♠', '10♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1780, 'current_bet': 80, 'is_active': False, 'cards': ('Q♠', '10♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:02:14,334 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:14,334 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:02:14,334 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:02:14,335 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:02:14,335 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:02:14,336 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:02:14,336 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 160, 'winning_hand': None, 'community_cards': ['3♥', '10♦', '3♠'], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('Q♠', '10♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:02:14,336 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:02:15,389 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:02:15,389 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:02:15,391 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:02:15,392 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:02:15,392 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-11 00:02:15,393 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:02:15,393 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:02:15,394 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♠', '2♣')
2025-03-11 00:02:15,394 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♣', '6♠')
2025-03-11 00:02:15,394 - src.engine.game - INFO - 玩家 ai_2 手牌: ('10♦', 'A♦')
2025-03-11 00:02:15,395 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:02:15,396 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:02:15,396 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:02:15,397 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:02:15,397 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:02:15,397 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:02:15,398 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:02:15,398 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:02:18,833 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:02:18,834 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:02:18.834496', 'table_talk': None}
2025-03-11 00:02:18,835 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:02:18,835 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:02:18,836 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:02:18,836 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:02:18,837 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:02:18,838 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:02:18,838 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:02:18,838 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:02:18,839 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:02:18,839 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:02:18,840 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:18,840 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:02:18,840 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:02:18,841 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:02:18,842 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:02:18,842 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:02:18,842 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:02:18,843 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 100, 'current_bet': 10, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 20, 'is_active': True, 'cards': ('10♦', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:02:18,843 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:18,844 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:02:18,844 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:02:18,845 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:02:18,845 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:02:18,846 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:02:20,537 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:02:20,538 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:02:20,539 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:02:20,540 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:02:20,541 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:02:20,542 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:02:41,713 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.7"}, "reasoning": {"hand_strength": "虽然A♣和6♠包含了一张A，但A6 offsuit在预翻牌阶段属于边缘手牌，赢牌潜力有限，仅依靠运气和后续公共牌的改善", "position_analysis": "作为首位行动者，能先发制人但同时需警惕对手的反击，保持谨慎以便观察对手策略", "pot_odds": "底池30对20的跟注要求使得风险相对适中，跟注投入的筹码不算太高", "opponent_reads": ["对手处于激活状态，筹码雄厚，可能采用宽松策略，跟注或加注后会利用优势攻击"]}, "table_talk": {"message": "今天就先稳住，看看牌面如何再作决定", "tone": "轻松且带点自信"}}
2025-03-11 00:02:41,714 - src.agents.llm - INFO - ==================================================

2025-03-11 00:02:41,714 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '今天就先稳住，看看牌面如何再作决定', 'tone': '轻松且带点自信'}
2025-03-11 00:02:41,714 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-11 00:02:41,715 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-11 00:02:41,715 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-11 00:02:41,715 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-11 00:02:41,715 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-11 00:02:41,715 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:02:41,716 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:02:41,716 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:02:41,717 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:02:41,717 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:02:41,718 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:02:41,718 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:41,719 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:02:41,719 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:02:41,719 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:02:41,720 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:02:41,720 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:02:41,721 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:02:41,721 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:02:41,723 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 90, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1760, 'current_bet': 20, 'is_active': True, 'cards': ('10♦', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天就先稳住，看看牌面如何再作决定', 'tone': '轻松且带点自信'}}
2025-03-11 00:02:41,724 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:41,725 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:02:41,725 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:02:41,725 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:02:41,726 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:02:41,726 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:02:41,727 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:02:41,729 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:02:41,730 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:02:41,730 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:02:41,730 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:02:41,730 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:02:41,731 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:02:48,937 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":40,"confidence":0.8},"reasoning":{"hand_strength":"手牌A♦10♦在PRE_FLOP阶段有较好的潜力，尤其是同花和顺子的可能性","position_analysis":"位于第2位，有机会观察后续玩家的行动，适合采取积极策略","pot_odds":"底池40，当前最大注20，加注到40的赔率合理，有利于后续行动","opponent_reads":["对手ai_1选择了CALL，可能持有中等强度的手牌，加注可以迫使其做出进一步决策"]},"table_talk":{"message":"看来你有点犹豫，我来加点压力","tone":"自信且挑衅"}}
2025-03-11 00:02:48,938 - src.agents.llm - INFO - ==================================================

2025-03-11 00:02:48,938 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来你有点犹豫，我来加点压力', 'tone': '自信且挑衅'}
2025-03-11 00:02:48,938 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-11 00:02:48,938 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-11 00:02:48,938 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-11 00:02:48,939 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-11 00:02:48,939 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-11 00:02:48,939 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:02:48,939 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:02:48,940 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:02:48,940 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-11 00:02:48,940 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_1
2025-03-11 00:02:48,941 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:02:48,941 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:48,941 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:02:48,942 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:02:48,942 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:02:48,943 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(40)，回合继续
2025-03-11 00:02:48,943 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-11 00:02:48,944 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:02:48,944 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 90, 'current_bet': 20, 'is_active': True, 'cards': ('A♣', '6♠'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 40, 'is_active': True, 'cards': ('10♦', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你有点犹豫，我来加点压力', 'tone': '自信且挑衅'}}
2025-03-11 00:02:48,946 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:02:48,946 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:02:48,948 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:02:48,948 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:02:48,948 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(40)，回合继续
2025-03-11 00:02:48,949 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-11 00:02:48,949 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:02:48,949 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:02:48,951 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:02:48,951 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:02:48,951 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:02:48,951 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:03:08,791 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.8"}, "reasoning": {"hand_strength": "A♣,6♠在翻牌前属于边缘手牌，面对多名对手及激进加注，其胜率较低", "position_analysis": "当前位置不利，加上手牌不够强大，在多人底池中风险较大", "pot_odds": "需跟注40却可能面临更大的赌注，底池赔率无法补偿潜在风险", "opponent_reads": ["ai_2表现激进，可能手握强牌或在利用位置优势施压", "ai_1跟注表明其范围较宽，但整体局面不利于薄弱手牌"]}, "table_talk": {"message": "我看这局牌不值得冒险，先保留实力等更有利的机会。", "tone": "冷静且果断"}}
2025-03-11 00:03:08,793 - src.agents.llm - INFO - ==================================================

2025-03-11 00:03:08,793 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '我看这局牌不值得冒险，先保留实力等更有利的机会。', 'tone': '冷静且果断'}
2025-03-11 00:03:08,795 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:03:08,795 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:03:08,796 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:03:08,796 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:03:08,796 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:03:08,797 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:03:08,797 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:03:08,797 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:03:08,798 - src.engine.state - INFO - 玩家 ai_2 获得底池 60 筹码，当前筹码: 1800
2025-03-11 00:03:08,798 - src.engine.game - INFO - 玩家 ai_2 获得底池 60 筹码
2025-03-11 00:03:08,799 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:03:08,799 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('10♦', 'A♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:03:08,799 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('10♦', 'A♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 90, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 40, 'is_active': False, 'cards': ('10♦', 'A♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我看这局牌不值得冒险，先保留实力等更有利的机会。', 'tone': '冷静且果断'}}
2025-03-11 00:03:08,800 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:03:08,801 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:03:08,801 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:03:08,802 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:03:08,802 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:03:08,803 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:03:08,803 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('10♦', 'A♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:03:08,803 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:03:25,257 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:03:25,258 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:03:25,259 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:03:25,259 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:03:25,260 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-11 00:03:25,260 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:03:25,261 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:03:25,261 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♠', 'K♥')
2025-03-11 00:03:25,262 - src.engine.game - INFO - 玩家 ai_1 手牌: ('8♠', '4♥')
2025-03-11 00:03:25,262 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♣', '10♥')
2025-03-11 00:03:25,262 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:03:25,263 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:03:25,263 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:03:25,263 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:03:25,264 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:03:25,264 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:03:25,265 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:03:25,265 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:03:28,819 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:03:28,819 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:03:28,820 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:03:28,820 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:03:28,820 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:03:28,820 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:03:42,002 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌 (8♠, 4♥) 非常弱，没有足够潜力构成可玩性", "position_analysis": "处于早期位置且面对已经加注的对手，不适合用弱牌冒险", "pot_odds": "底池赔率不够理想，不足以补偿跟注风险", "opponent_reads": ["对手处于激进状态，可能利用弱牌获利"]}, "table_talk": {"message": "你们这些冒险者只会把筹码浪费在这里，我才不会浪费一点血汗钱跟你们捞这烂牌玩呢。", "tone": "冷静且讽刺"}}
2025-03-11 00:03:42,003 - src.agents.llm - INFO - ==================================================

2025-03-11 00:03:42,004 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '你们这些冒险者只会把筹码浪费在这里，我才不会浪费一点血汗钱跟你们捞这烂牌玩呢。', 'tone': '冷静且讽刺'}
2025-03-11 00:03:42,004 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:03:42,005 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:03:42,005 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:03:42,006 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:03:42,006 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:03:42,007 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:03:42,007 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:03:42,008 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:03:42,008 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:03:42,009 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:03:42,009 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:03:42,010 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:03:42,010 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:03:42,011 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:03:42,011 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:03:42,012 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:03:42,012 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:03:42,013 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:03:42,013 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3090, 'current_bet': 20, 'is_active': True, 'cards': ('5♠', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 90, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1790, 'current_bet': 10, 'is_active': True, 'cards': ('7♣', '10♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '你们这些冒险者只会把筹码浪费在这里，我才不会浪费一点血汗钱跟你们捞这烂牌玩呢。', 'tone': '冷静且讽刺'}}
2025-03-11 00:03:42,015 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:03:42,015 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:03:42,016 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:03:42,017 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:03:42,017 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:03:42,018 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:03:42,018 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:03:42,019 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:03:42,019 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:03:42,020 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:03:42,020 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:03:42,020 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:03:47,788 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌7♣和10♥在Pre-flop阶段较弱，缺乏成牌潜力","position_analysis":"位于2号位，早期行动位置不利于观察对手行为","pot_odds":"底池赔率不理想，不值得冒险跟注","opponent_reads":["对手player_0下注20，显示其可能持有较强手牌或试图施加压力"]},"table_talk":{"message":"看起来你们更想玩，我这次就不参与了","tone":"轻松"}}
2025-03-11 00:03:47,788 - src.agents.llm - INFO - ==================================================

2025-03-11 00:03:47,790 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看起来你们更想玩，我这次就不参与了', 'tone': '轻松'}
2025-03-11 00:03:47,790 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:03:47,791 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:03:47,791 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:03:47,792 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:03:47,793 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:03:47,793 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:03:47,794 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:03:47,795 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:03:47,795 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3120
2025-03-11 00:03:47,796 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-11 00:03:47,796 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:03:47,797 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♠', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:03:47,798 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♠', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3120, 'current_bet': 20, 'is_active': False, 'cards': ('5♠', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 90, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1790, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来你们更想玩，我这次就不参与了', 'tone': '轻松'}}
2025-03-11 00:03:47,800 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:03:47,800 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:03:47,801 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:03:47,801 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:03:47,802 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:03:47,802 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:03:47,802 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♠', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:03:47,803 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:03:49,882 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:03:49,883 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:03:49,884 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:03:49,884 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:03:49,884 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-11 00:03:49,885 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:03:49,885 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:03:49,886 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♦', 'J♠')
2025-03-11 00:03:49,886 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♥', '4♦')
2025-03-11 00:03:49,887 - src.engine.game - INFO - 玩家 ai_2 手牌: ('10♦', '6♣')
2025-03-11 00:03:49,888 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-11 00:03:49,888 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-11 00:03:49,888 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-11 00:03:49,889 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-11 00:03:49,889 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-11 00:03:49,890 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-11 00:03:49,890 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:03:49,890 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-11 00:03:52,805 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:03:52,805 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:03:52,806 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:03:52,806 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:03:52,807 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:03:52,807 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:04:00,582 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌10♦和6♣在PRE_FLOP阶段属于较弱的手牌，缺乏成牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，难以控制后续行动","pot_odds":"当前底池为30，跟注需要20，赔率不划算","opponent_reads":["player_0下注10，显示其手牌可能较强，ai_1下注20，可能试图压制对手"]},"table_talk":{"message":"看来这手牌不太适合我，你们继续玩吧","tone":"轻松"}}
2025-03-11 00:04:00,582 - src.agents.llm - INFO - ==================================================

2025-03-11 00:04:00,583 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，你们继续玩吧', 'tone': '轻松'}
2025-03-11 00:04:00,584 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:04:00,584 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:04:00,585 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:04:00,585 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:04:00,586 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-11 00:04:00,586 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:04:00,587 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:04:00,587 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:04:00,588 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-11 00:04:00,588 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-11 00:04:00,589 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-11 00:04:00,589 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:04:00,589 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:04:00,591 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:04:00,591 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:04:00,592 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:04:00,592 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:04:00,592 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:04:00,593 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 10, 'is_active': True, 'cards': ('3♦', 'J♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 70, 'current_bet': 20, 'is_active': True, 'cards': ('4♥', '4♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1790, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，你们继续玩吧', 'tone': '轻松'}}
2025-03-11 00:04:00,594 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:04:00,594 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:04:00,595 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:04:00,595 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:04:00,596 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:04:00,596 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:04:05,940 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:04:05,942 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:04:05.942115', 'table_talk': None}
2025-03-11 00:04:05,943 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:04:05,943 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:04:05,943 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-11 00:04:05,944 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:04:05,944 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-11 00:04:05,945 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:04:05,945 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:04:05,945 - src.engine.state - INFO - 玩家 ai_1 获得底池 30 筹码，当前筹码: 100
2025-03-11 00:04:05,946 - src.engine.game - INFO - 玩家 ai_1 获得底池 30 筹码
2025-03-11 00:04:05,946 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:04:05,947 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('4♥', '4♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:04:05,948 - server - INFO - 发送更新后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('4♥', '4♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 100, 'current_bet': 20, 'is_active': False, 'cards': ('4♥', '4♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1790, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:04:05,948 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:04:05,949 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:04:05,949 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:04:05,949 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:04:05,950 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:04:05,950 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:04:05,950 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('4♥', '4♦'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:04:05,951 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:04:06,891 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:04:06,892 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:04:06,893 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:04:06,894 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:04:06,894 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-11 00:04:06,894 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:04:06,895 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:04:06,895 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♣', '6♠')
2025-03-11 00:04:06,896 - src.engine.game - INFO - 玩家 ai_1 手牌: ('4♥', 'K♣')
2025-03-11 00:04:06,896 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♠', '5♠')
2025-03-11 00:04:06,897 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:04:06,897 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:04:06,898 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:04:06,898 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:04:06,899 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:04:06,899 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:04:06,899 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:04:06,899 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:04:35,840 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:04:35,841 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:04:35.841722', 'table_talk': None}
2025-03-11 00:04:35,842 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:04:35,842 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:04:35,843 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:04:35,844 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:04:35,844 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:04:35,845 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:04:35,846 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:04:35,846 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:04:35,846 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:04:35,847 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:04:35,847 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:04:35,848 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:04:35,848 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:04:35,848 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:04:35,849 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:04:35,849 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:04:35,849 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:04:35,849 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 90, 'current_bet': 10, 'is_active': True, 'cards': ('4♥', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:04:35,850 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:04:35,851 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:04:35,851 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:04:35,851 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:04:35,852 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:04:35,852 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:04:40,656 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:04:40,657 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:04:40,657 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:04:40,657 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:04:40,659 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:04:40,659 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:05:05,214 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "CALL", "amount": "20", "confidence": "0.65"}, "reasoning": {"hand_strength": "手牌K♣和4♥整体较为边缘，虽然K具有一定的价值，但4容易拖后腿，整体并非强牌", "position_analysis": "处于前位，信息有限，使用保守策略以观察对手反应", "pot_odds": "底池30，对手下注20，投入成本较低，可在翻牌后寻找改进机会", "opponent_reads": ["对手筹码充裕且状态活跃，可能采取攻击性策略，观察其后续行动有助于判断"]}, "table_talk": {"message": "我选择跟注，静观其变，寻找更有利的局势", "tone": "冷静自信"}}
2025-03-11 00:05:05,216 - src.agents.llm - INFO - ==================================================

2025-03-11 00:05:05,216 - src.agents.llm - INFO - 生成动作: CALL 金额: 0 table_talk: {'message': '我选择跟注，静观其变，寻找更有利的局势', 'tone': '冷静自信'}
2025-03-11 00:05:05,217 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-11 00:05:05,217 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-11 00:05:05,218 - src.engine.state - INFO - 玩家 ai_1 跟注 10 筹码，已标记为已行动
2025-03-11 00:05:05,218 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-11 00:05:05,218 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-11 00:05:05,220 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:05:05,220 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:05:05,221 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:05:05,221 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:05:05,221 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:05:05,222 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:05:05,222 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:05:05,223 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:05:05,223 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:05:05,223 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:05:05,224 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:05:05,224 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:05:05,225 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:05:05,225 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:05:05,226 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 20, 'is_active': True, 'cards': ('4♥', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '我选择跟注，静观其变，寻找更有利的局势', 'tone': '冷静自信'}}
2025-03-11 00:05:05,227 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:05:05,227 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:05:05,227 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:05:05,228 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:05:05,228 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:05:05,229 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:05:05,229 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:05:05,231 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:05:05,231 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:05:05,231 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:05:05,232 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:05:05,232 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:05:05,233 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:05:12,633 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":40,"confidence":0.85},"reasoning":{"hand_strength":"A♠, 5♠是一手中等偏下的起手牌，但具有一定的同花潜力","position_analysis":"位于中间位置，可以观察后面玩家的行动","pot_odds":"底池赔率为2:1，适合加注以增加底池","opponent_reads":["ai_1选择跟注，可能持有中等强度的牌或试图观察后续行动"]},"table_talk":{"message":"看来你有点犹豫，我来加点压力吧","tone":"自信"}}
2025-03-11 00:05:12,635 - src.agents.llm - INFO - ==================================================

2025-03-11 00:05:12,636 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来你有点犹豫，我来加点压力吧', 'tone': '自信'}
2025-03-11 00:05:12,636 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-11 00:05:12,637 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-11 00:05:12,637 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-11 00:05:12,638 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-11 00:05:12,638 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-11 00:05:12,638 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:05:12,639 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:05:12,639 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:05:12,640 - src.engine.game - INFO - 找到下一个玩家(从头开始): ai_1, 位置: 1
2025-03-11 00:05:12,640 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 ai_1
2025-03-11 00:05:12,641 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:05:12,641 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:05:12,642 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:05:12,642 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:05:12,642 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:05:12,643 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(40)，回合继续
2025-03-11 00:05:12,643 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-11 00:05:12,644 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:05:12,644 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 60, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 20, 'is_active': True, 'cards': ('4♥', 'K♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1750, 'current_bet': 40, 'is_active': True, 'cards': ('A♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你有点犹豫，我来加点压力吧', 'tone': '自信'}}
2025-03-11 00:05:12,645 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:05:12,646 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:05:12,646 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:05:12,646 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:05:12,647 - src.engine.game - INFO - 玩家 ai_1 下注额(20)不等于最大下注额(40)，回合继续
2025-03-11 00:05:12,647 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=False, 回合完成=False
2025-03-11 00:05:12,649 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:05:12,649 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:05:12,650 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:05:12,650 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:05:12,651 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:05:12,651 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:05:45,365 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "虽然持有K牌，但4的搭配太弱，整体起手牌较差", "position_analysis": "在位置1处行动，处于信息劣势且面对对手激进加注显得尴尬", "pot_odds": "底池60需跟注40，投入产出比不理想，加之后续可能遭遇更大压力", "opponent_reads": ["对手ai_2表现激进，可能持有较强牌面或采用策略施压"]}, "table_talk": {"message": "看来对手今天气势颇足，我就不跟他硬拼了。", "tone": "轻松且带挑衅"}}
2025-03-11 00:05:45,366 - src.agents.llm - INFO - ==================================================

2025-03-11 00:05:45,366 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来对手今天气势颇足，我就不跟他硬拼了。', 'tone': '轻松且带挑衅'}
2025-03-11 00:05:45,366 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:05:45,366 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:05:45,368 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:05:45,368 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:05:45,368 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:05:45,369 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:05:45,369 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:05:45,370 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:05:45,371 - src.engine.state - INFO - 玩家 ai_2 获得底池 60 筹码，当前筹码: 1810
2025-03-11 00:05:45,371 - src.engine.game - INFO - 玩家 ai_2 获得底池 60 筹码
2025-03-11 00:05:45,372 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:05:45,372 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♠', '5♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:05:45,373 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♠', '5♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3110, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 80, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1810, 'current_bet': 40, 'is_active': False, 'cards': ('A♠', '5♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来对手今天气势颇足，我就不跟他硬拼了。', 'tone': '轻松且带挑衅'}}
2025-03-11 00:05:45,375 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:05:45,375 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:05:45,376 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:05:45,376 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:05:45,377 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:05:45,377 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:05:45,378 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 60, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♠', '5♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:05:45,378 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:05:48,439 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:05:48,440 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:05:48,441 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:05:48,441 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:05:48,442 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-11 00:05:48,442 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:05:48,442 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:05:48,443 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♣', 'A♣')
2025-03-11 00:05:48,443 - src.engine.game - INFO - 玩家 ai_1 手牌: ('K♠', '3♣')
2025-03-11 00:05:48,444 - src.engine.game - INFO - 玩家 ai_2 手牌: ('Q♣', '6♦')
2025-03-11 00:05:48,445 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:05:48,446 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:05:48,447 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:05:48,448 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:05:48,449 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:05:48,449 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:05:48,449 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:05:48,450 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:05:50,395 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:05:50,396 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:05:50,396 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:05:50,398 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:05:50,398 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:05:50,399 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:06:13,736 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.9"}, "reasoning": {"hand_strength": "K♠与3♣构成的手牌整体较弱，缺乏足够的连贯性和潜力", "position_analysis": "虽然处于较前位置，但面对对手的积极下注，这个位置并不能弥补手牌本身的缺陷", "pot_odds": "底池30对投入20的比例并不足以弥补牌力上的劣势", "opponent_reads": ["player_0筹码充裕且当前下注较高，可能持有更强的牌", "ai_2虽然下注较低，但整体局势显示对手处于主动状态"]}, "table_talk": {"message": "这局牌注定不在我的优势区，果断放弃，下一局再战！

", "tone": "冷静且坚定"}}
2025-03-11 00:06:13,737 - src.agents.llm - INFO - ==================================================

2025-03-11 00:06:13,737 - src.agents.llm - ERROR - JSON解析失败: Invalid control character at: line 1 column 362 (char 361)
2025-03-11 00:06:13,738 - src.agents.llm - ERROR - 解析LLM响应时出错: Invalid control character at: line 1 column 362 (char 361)
2025-03-11 00:06:13,738 - src.agents.llm - WARNING - 决策生成失败 (尝试 1/1): Invalid control character at: line 1 column 362 (char 361)
2025-03-11 00:06:14,747 - src.agents.llm - ERROR - 达到最大重试次数，选择弃牌。最后一次错误: Invalid control character at: line 1 column 362 (char 361)
2025-03-11 00:06:14,747 - server - INFO - AI玩家 ai_1 决定执行动作: CALL, 金额: 0
2025-03-11 00:06:14,748 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.CALL
2025-03-11 00:06:14,749 - src.engine.state - INFO - 玩家 ai_1 跟注 20 筹码，已标记为已行动
2025-03-11 00:06:14,749 - src.engine.game - INFO - 玩家 ai_1 跟注
2025-03-11 00:06:14,750 - src.engine.state - INFO - 添加动作到历史记录: CALL by ai_1
2025-03-11 00:06:14,750 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:06:14,751 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:06:14,751 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:14,752 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:06:14,753 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:06:14,753 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:06:14,754 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:14,754 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:06:14,755 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:14,755 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:06:14,756 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:06:14,756 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:14,757 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:06:14,757 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3090, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'A♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 60, 'current_bet': 20, 'is_active': True, 'cards': ('K♠', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': True, 'cards': ('Q♣', '6♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:06:14,758 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:14,759 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:06:14,759 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:14,761 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:06:14,761 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:06:14,762 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:14,764 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:06:14,765 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:06:14,765 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:06:14,766 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:06:14,766 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:06:14,767 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:06:22,005 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌Q♣和6♦的组合在PRE_FLOP阶段非常弱，很难在当前局势下获胜","position_analysis":"处于2号位置，意味着在后续轮次中需要较早行动，增加了不确定性","pot_odds":"底池赔率较低，不值得冒险跟注","opponent_reads":["player_0筹码充足，可能采取激进策略；ai_1筹码较少，可能采取保守策略"]},"table_talk":{"message":"这手牌太差了，我选择弃牌","tone":"冷静"}}
2025-03-11 00:06:22,006 - src.agents.llm - INFO - ==================================================

2025-03-11 00:06:22,006 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这手牌太差了，我选择弃牌', 'tone': '冷静'}
2025-03-11 00:06:22,006 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:06:22,006 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:06:22,006 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:06:22,007 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:06:22,007 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-11 00:06:22,007 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:06:22,007 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:06:22,007 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:22,007 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-11 00:06:22,008 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-11 00:06:22,008 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-11 00:06:22,009 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:22,009 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:22,009 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:22,010 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:06:22,010 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:06:22,011 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:22,012 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:06:22,012 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3090, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'A♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 60, 'current_bet': 20, 'is_active': True, 'cards': ('K♠', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这手牌太差了，我选择弃牌', 'tone': '冷静'}}
2025-03-11 00:06:22,012 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:22,014 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:22,014 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:22,015 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:06:22,015 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:06:22,016 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:33,391 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0}
2025-03-11 00:06:33,392 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CHECK', 'amount': 0, 'timestamp': '2025-03-11T00:06:33.392482', 'table_talk': None}
2025-03-11 00:06:33,393 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CHECK
2025-03-11 00:06:33,394 - src.engine.game - INFO - 玩家 player_0 过牌，已标记为已行动
2025-03-11 00:06:33,395 - src.engine.state - INFO - 添加动作到历史记录: CHECK by player_0
2025-03-11 00:06:33,395 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:06:33,396 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:06:33,396 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:33,397 - src.engine.game - INFO - 没有找到需要行动的玩家，回合已结束
2025-03-11 00:06:33,397 - src.engine.game - INFO - 所有玩家都已行动，当前玩家设为None
2025-03-11 00:06:33,397 - src.engine.game - INFO - 更新当前玩家为: None
2025-03-11 00:06:33,398 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:33,399 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:33,399 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:33,399 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:06:33,400 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:06:33,401 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=True, 所有下注相等=True, 回合完成=True
2025-03-11 00:06:33,401 - src.engine.game - INFO - 回合是否完成: True
2025-03-11 00:06:33,402 - src.engine.game - INFO - 回合完成，准备进入下一阶段
2025-03-11 00:06:33,402 - src.engine.game - INFO - 活跃玩家数量: 2, 当前游戏阶段: GameStage.PRE_FLOP
2025-03-11 00:06:33,403 - src.engine.game - INFO - 调用next_phase()进入下一阶段
2025-03-11 00:06:33,403 - src.engine.game - INFO - 从阶段 GameStage.PRE_FLOP 进入下一阶段
2025-03-11 00:06:33,403 - src.engine.game - INFO - 玩家 ai_3 筹码为0，设置为不活跃状态
2025-03-11 00:06:33,404 - src.engine.game - INFO - 玩家 ai_4 筹码为0，设置为不活跃状态
2025-03-11 00:06:33,404 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:33,405 - src.engine.game - INFO - 重置玩家 player_0 状态: has_acted=False, current_bet=0
2025-03-11 00:06:33,405 - src.engine.game - INFO - 重置玩家 ai_1 状态: has_acted=False, current_bet=0
2025-03-11 00:06:33,406 - src.engine.dealer - INFO - Dealt 3 community cards: ['4♥', 'Q♠', 'Q♦']
2025-03-11 00:06:33,406 - src.engine.game - INFO - 进入翻牌阶段，公共牌: ['4♥', 'Q♠', 'Q♦']
2025-03-11 00:06:33,408 - src.engine.game - INFO - 按位置排序后的活跃玩家: [('player_0', 0), ('ai_1', 1)]
2025-03-11 00:06:33,408 - src.engine.game - INFO - 庄家位置: 4
2025-03-11 00:06:33,408 - src.engine.game - INFO - 庄家是最后一个位置，从第一个位置开始: player_0, 位置: 0
2025-03-11 00:06:33,409 - src.engine.game - INFO - 新阶段第一个行动玩家: player_0, 位置: 0
2025-03-11 00:06:33,410 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 50, 'community_cards': ['4♥', 'Q♠', 'Q♦'], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3090, 'current_bet': 0, 'is_active': True, 'cards': ('7♣', 'A♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CHECK', 'last_amount': 0}, {'id': 'ai_1', 'chips': 60, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:06:33,411 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:33,412 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:33,412 - src.engine.game - INFO - 当前最大下注额: 0
2025-03-11 00:06:33,412 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=0, is_all_in=False
2025-03-11 00:06:33,412 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:06:33,414 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:45,331 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 20}
2025-03-11 00:06:45,332 - server - INFO - 收到加注请求，金额: 20
2025-03-11 00:06:45,332 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'RAISE', 'amount': 20, 'timestamp': '2025-03-11T00:06:45.332548', 'table_talk': None}
2025-03-11 00:06:45,333 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.RAISE
2025-03-11 00:06:45,333 - src.engine.state - INFO - 玩家 player_0 加注到 20 筹码，已标记为已行动
2025-03-11 00:06:45,334 - src.engine.game - INFO - 玩家 player_0 加注到 20
2025-03-11 00:06:45,334 - src.engine.state - INFO - 添加动作到历史记录: RAISE by player_0
2025-03-11 00:06:45,335 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:06:45,335 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:06:45,336 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:45,336 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:06:45,337 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:06:45,338 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:06:45,338 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:45,338 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:45,339 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:45,339 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:06:45,340 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-11 00:06:45,340 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:06:45,341 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:45,341 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:06:45,341 - server - INFO - 发送更新后的游戏状态: {'phase': 'FLOP', 'pot_size': 70, 'community_cards': ['4♥', 'Q♠', 'Q♦'], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3070, 'current_bet': 20, 'is_active': True, 'cards': ('7♣', 'A♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'RAISE', 'last_amount': 20}, {'id': 'ai_1', 'chips': 60, 'current_bet': 0, 'is_active': True, 'cards': ('K♠', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:06:45,343 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:06:45,343 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:06:45,343 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:06:45,344 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:06:45,345 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=0, is_all_in=False
2025-03-11 00:06:45,345 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:06:45,346 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:06:47,066 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:06:47,067 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:06:47,067 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:06:47,068 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:06:47,068 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:06:47,069 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:07:10,735 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌K♠,3♣在翻牌后只有较弱的K高牌，与牌面4♥, Q♠, Q♦结合并无实质性增益，难以击败可能的两对或更强牌型", "position_analysis": "处于位置1，信息有限，同时面对对手激进行动，局势对我不利", "pot_odds": "底池70，需额外投入20，赔率投入回报不匹配，加上自身较弱的牌力风险较大", "opponent_reads": ["对手先CHECK再RAISE 20，可能借小注试探，或以较强牌型做诱饵，整体倾向激进策略"]}, "table_talk": {"message": "局势对我不利，我不会与强势对手做无谓的挣扎，这牌我就此退场", "tone": "冷静坚定"}}
2025-03-11 00:07:10,737 - src.agents.llm - INFO - ==================================================

2025-03-11 00:07:10,738 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '局势对我不利，我不会与强势对手做无谓的挣扎，这牌我就此退场', 'tone': '冷静坚定'}
2025-03-11 00:07:10,738 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:07:10,739 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:07:10,739 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:07:10,740 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:07:10,740 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:07:10,741 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:07:10,741 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:07:10,742 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:07:10,742 - src.engine.state - INFO - 玩家 player_0 获得底池 70 筹码，当前筹码: 3140
2025-03-11 00:07:10,743 - src.engine.game - INFO - 玩家 player_0 获得底池 70 筹码
2025-03-11 00:07:10,743 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:07:10,744 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 70, 'winning_hand': None, 'community_cards': ['4♥', 'Q♠', 'Q♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♣', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:07:10,744 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': ['4♥', 'Q♠', 'Q♦'], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 70, 'winning_hand': None, 'community_cards': ['4♥', 'Q♠', 'Q♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♣', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3140, 'current_bet': 20, 'is_active': False, 'cards': ('7♣', 'A♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 60, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1800, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '局势对我不利，我不会与强势对手做无谓的挣扎，这牌我就此退场', 'tone': '冷静坚定'}}
2025-03-11 00:07:10,745 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:07:10,745 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:07:10,746 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:07:10,746 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:07:10,747 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:07:10,747 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:07:10,748 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 70, 'winning_hand': None, 'community_cards': ['4♥', 'Q♠', 'Q♦'], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♣', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:07:10,748 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:07:12,826 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:07:12,827 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:07:12,828 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:07:12,828 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:07:12,829 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-11 00:07:12,829 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:07:12,829 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:07:12,830 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♠', 'K♥')
2025-03-11 00:07:12,830 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♥', '4♥')
2025-03-11 00:07:12,830 - src.engine.game - INFO - 玩家 ai_2 手牌: ('7♠', '5♦')
2025-03-11 00:07:12,831 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:07:12,831 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:07:12,832 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:07:12,832 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:07:12,833 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:07:12,833 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:07:12,833 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:07:12,834 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:07:15,609 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-11 00:07:15,610 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-11T00:07:15.610979', 'table_talk': None}
2025-03-11 00:07:15,611 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-11 00:07:15,611 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-11 00:07:15,612 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-11 00:07:15,612 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-11 00:07:15,612 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:07:15,613 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:07:15,613 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:07:15,613 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:07:15,614 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:07:15,614 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:07:15,614 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:07:15,615 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:07:15,615 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:07:15,616 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:07:15,616 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:07:15,616 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:07:15,618 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:07:15,618 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:07:15,618 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3120, 'current_bet': 20, 'is_active': True, 'cards': ('Q♠', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 50, 'current_bet': 10, 'is_active': True, 'cards': ('10♥', '4♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1780, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:07:15,619 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:07:15,620 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:07:15,620 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:07:15,620 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:07:15,620 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:07:15,621 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:07:15,622 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:07:15,774 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:07:15,775 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:07:15,776 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:07:15,777 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:07:15,777 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:07:15,777 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:07:43,663 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.95"}, "reasoning": {"hand_strength": "我的手牌10♥, 4♥非常弱，缺乏足够的竞争力，即便是同花潜力也微不足道。", "position_analysis": "在早位行动，加上筹码相对较少，使得冒险加注风险更高。", "pot_odds": "虽然底池有一定吸引力，但投入20筹码换取胜率明显不足的情况不具吸引力。", "opponent_reads": ["player_0表现得较为保守，显示可能持有更强手牌，令我陷入不利局面。"]}, "table_talk": {"message": "各位，我今天不想和你们硬碰硬，选择退出这一局更符合我的长远策略。", "tone": "沉着且略带不屑"}}
2025-03-11 00:07:43,664 - src.agents.llm - INFO - ==================================================

2025-03-11 00:07:43,665 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，我今天不想和你们硬碰硬，选择退出这一局更符合我的长远策略。', 'tone': '沉着且略带不屑'}
2025-03-11 00:07:43,665 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:07:43,666 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:07:43,666 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:07:43,667 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:07:43,667 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:07:43,667 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:07:43,667 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:07:43,668 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:07:43,668 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:07:43,669 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:07:43,669 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:07:43,670 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:07:43,670 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:07:43,670 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:07:43,671 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:07:43,671 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:07:43,672 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:07:43,672 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:07:43,672 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:07:43,673 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3120, 'current_bet': 20, 'is_active': True, 'cards': ('Q♠', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 50, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1780, 'current_bet': 20, 'is_active': True, 'cards': ('7♠', '5♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，我今天不想和你们硬碰硬，选择退出这一局更符合我的长远策略。', 'tone': '沉着且略带不屑'}}
2025-03-11 00:07:43,674 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:07:43,674 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:07:43,676 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:07:43,676 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:07:43,676 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:07:43,677 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:07:43,677 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:07:43,678 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:07:43,678 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:07:43,679 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:07:43,679 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:07:43,680 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:07:43,680 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:07:50,846 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌7♠和5♦在PRE_FLOP阶段非常弱，几乎没有形成强牌的潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，无法有效利用位置优势","pot_odds":"底池赔率不利于投入更多筹码，尤其是在手牌如此弱的情况下","opponent_reads":["player_0选择了CALL，表明他可能持有中等强度的牌或试图观察后续行动"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-11 00:07:50,847 - src.agents.llm - INFO - ==================================================

2025-03-11 00:07:50,848 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-11 00:07:50,848 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:07:50,849 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:07:50,849 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:07:50,850 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:07:50,850 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:07:50,850 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:07:50,851 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:07:50,851 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:07:50,852 - src.engine.state - INFO - 玩家 player_0 获得底池 50 筹码，当前筹码: 3170
2025-03-11 00:07:50,852 - src.engine.game - INFO - 玩家 player_0 获得底池 50 筹码
2025-03-11 00:07:50,853 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:07:50,853 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♠', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:07:50,854 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♠', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3170, 'current_bet': 20, 'is_active': False, 'cards': ('Q♠', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 50, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1780, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-11 00:07:50,854 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:07:50,856 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:07:50,856 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:07:50,857 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:07:50,857 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:07:50,857 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:07:50,858 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♠', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:07:50,858 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:07:53,818 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:07:53,819 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:07:53,819 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:07:53,819 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:07:53,820 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-11 00:07:53,820 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:07:53,821 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:07:53,821 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♦', 'Q♠')
2025-03-11 00:07:53,821 - src.engine.game - INFO - 玩家 ai_1 手牌: ('3♣', '5♠')
2025-03-11 00:07:53,823 - src.engine.game - INFO - 玩家 ai_2 手牌: ('6♠', '3♠')
2025-03-11 00:07:53,823 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:07:53,823 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:07:53,823 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:07:53,824 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:07:53,824 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:07:53,824 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:07:53,825 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:07:53,825 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:07:55,882 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:07:55,882 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:07:55,883 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:07:55,883 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:07:55,884 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:07:55,884 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:08:13,652 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "手牌[3♣, 5♠]极为微弱，没有形成强牌的潜力", "position_analysis": "处在不利位置，又面对对手的进攻下注，风险较大", "pot_odds": "底池30，对手已下注20，跟注风险较高且回报不足", "opponent_reads": ["player_0表现出较强的攻击性", "ai_2下注较低但可能试图利用位置优势"]}, "table_talk": {"message": "这牌实在太烂了，不值得冒险，我弃牌保住筹码。", "tone": "冷静而果断"}}
2025-03-11 00:08:13,654 - src.agents.llm - INFO - ==================================================

2025-03-11 00:08:13,654 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '这牌实在太烂了，不值得冒险，我弃牌保住筹码。', 'tone': '冷静而果断'}
2025-03-11 00:08:13,654 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:08:13,657 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:08:13,657 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:08:13,657 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:08:13,657 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:08:13,657 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:08:13,659 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:08:13,659 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:08:13,659 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:08:13,659 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:08:13,660 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:08:13,660 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:08:13,660 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:08:13,661 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:08:13,661 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:08:13,662 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:08:13,662 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:08:13,662 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:08:13,663 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3150, 'current_bet': 20, 'is_active': True, 'cards': ('7♦', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 50, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 10, 'is_active': True, 'cards': ('6♠', '3♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '这牌实在太烂了，不值得冒险，我弃牌保住筹码。', 'tone': '冷静而果断'}}
2025-03-11 00:08:13,664 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:08:13,664 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:08:13,665 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:08:13,665 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:08:13,667 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:08:13,667 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:08:13,668 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:08:13,669 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:08:13,669 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:08:13,669 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:08:13,669 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:08:13,670 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:08:20,121 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌6♠和3♠在PRE_FLOP阶段非常弱，几乎没有任何潜力","position_analysis":"位置2在PRE_FLOP阶段并不具备优势，尤其是手牌较弱时","pot_odds":"底池赔率并不足以支持跟注或加注，尤其是手牌如此弱的情况下","opponent_reads":["对手player_0已经下注20，显示出一定的进攻性，可能持有较强的手牌"]},"table_talk":{"message":"看起来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-11 00:08:20,122 - src.agents.llm - INFO - ==================================================

2025-03-11 00:08:20,123 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看起来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-11 00:08:20,124 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:08:20,124 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:08:20,124 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:08:20,125 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:08:20,126 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:08:20,126 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:08:20,126 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:08:20,128 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:08:20,129 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3180
2025-03-11 00:08:20,129 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-11 00:08:20,130 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:08:20,131 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♦', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:08:20,131 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♦', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3180, 'current_bet': 20, 'is_active': False, 'cards': ('7♦', 'Q♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 50, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-11 00:08:20,133 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:08:20,134 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:08:20,134 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:08:20,135 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:08:20,135 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:08:20,136 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:08:20,136 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('7♦', 'Q♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:08:20,136 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:08:32,226 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:08:32,227 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:08:32,227 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:08:32,227 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:08:32,228 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-11 00:08:32,228 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:08:32,229 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:08:32,229 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♥', 'Q♣')
2025-03-11 00:08:32,229 - src.engine.game - INFO - 玩家 ai_1 手牌: ('A♥', '3♣')
2025-03-11 00:08:32,230 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♥', 'Q♠')
2025-03-11 00:08:32,230 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-11 00:08:32,230 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-11 00:08:32,231 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-11 00:08:32,231 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-11 00:08:32,232 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-11 00:08:32,232 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-11 00:08:32,232 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:08:32,233 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-11 00:08:35,170 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:08:35,171 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:08:35,172 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:08:35,172 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:08:35,173 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:08:35,173 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:08:41,691 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌9♥, Q♠在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2在PRE_FLOP阶段较为不利，容易被后续玩家加注","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["player_0下注10，显示其可能有较强的起手牌","ai_1下注20，可能试图通过加注来施压"]},"table_talk":{"message":"看起来你们对这把牌很有信心，我选择退出","tone":"轻松"}}
2025-03-11 00:08:41,692 - src.agents.llm - INFO - ==================================================

2025-03-11 00:08:41,692 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看起来你们对这把牌很有信心，我选择退出', 'tone': '轻松'}
2025-03-11 00:08:41,693 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:08:41,693 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:08:41,693 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:08:41,694 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:08:41,695 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_2
2025-03-11 00:08:41,695 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:08:41,695 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:08:41,697 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:08:41,697 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-11 00:08:41,698 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-11 00:08:41,698 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-11 00:08:41,698 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:08:41,699 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:08:41,699 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:08:41,700 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:08:41,701 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:08:41,702 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:08:41,703 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:08:41,703 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3170, 'current_bet': 10, 'is_active': True, 'cards': ('3♥', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 30, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看起来你们对这把牌很有信心，我选择退出', 'tone': '轻松'}}
2025-03-11 00:08:41,704 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:08:41,705 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:08:41,705 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:08:41,706 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:08:41,706 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:08:41,707 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:09:16,776 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-11 00:09:16,777 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-11T00:09:16.777458', 'table_talk': None}
2025-03-11 00:09:16,778 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-11 00:09:16,778 - src.engine.state - INFO - 玩家 player_0 跟注 10 筹码，已标记为已行动
2025-03-11 00:09:16,779 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-11 00:09:16,779 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-11 00:09:16,780 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:09:16,780 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:09:16,780 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:09:16,781 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:09:16,781 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:09:16,782 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:09:16,782 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:09:16,783 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:09:16,783 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:09:16,783 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:09:16,784 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:09:16,784 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:09:16,784 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:09:16,785 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:09:16,785 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3160, 'current_bet': 20, 'is_active': True, 'cards': ('3♥', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 30, 'current_bet': 20, 'is_active': True, 'cards': ('A♥', '3♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:09:16,787 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:09:16,788 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_1']
2025-03-11 00:09:16,788 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:09:16,788 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:09:16,789 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:09:16,789 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:09:16,790 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:09:16,791 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:09:16,792 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:09:16,792 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:09:16,793 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:09:16,793 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:09:16,793 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:10:15,285 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "A♥和3♣的组合整体较弱，虽然包含A但搭档3缺乏足够支援，无法形成强牌", "position_analysis": "位于第1位置，处在早期行动位置，信息和主动权不足", "pot_odds": "虽然跟注成本为20，底池为40看似诱人，但风险与收益并不匹配", "opponent_reads": ["对手选择CALL显示可能持有较可靠的范围", "对手筹码充裕，后续空间优势明显"]}, "table_talk": {"message": "各位，下局我必定卷土重来，现在就让对手先尝甜头吧！", "tone": "冷静且略带自信"}}
2025-03-11 00:10:15,285 - src.agents.llm - INFO - ==================================================

2025-03-11 00:10:15,286 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，下局我必定卷土重来，现在就让对手先尝甜头吧！', 'tone': '冷静且略带自信'}
2025-03-11 00:10:15,286 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:10:15,287 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:10:15,287 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:10:15,288 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:10:15,288 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:10:15,288 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:10:15,289 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:10:15,289 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:10:15,290 - src.engine.state - INFO - 玩家 player_0 获得底池 40 筹码，当前筹码: 3200
2025-03-11 00:10:15,290 - src.engine.game - INFO - 玩家 player_0 获得底池 40 筹码
2025-03-11 00:10:15,291 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:10:15,291 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:10:15,292 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3200, 'current_bet': 20, 'is_active': False, 'cards': ('3♥', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 30, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1770, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，下局我必定卷土重来，现在就让对手先尝甜头吧！', 'tone': '冷静且略带自信'}}
2025-03-11 00:10:15,294 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:10:15,294 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:10:15,295 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:10:15,295 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:10:15,296 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:10:15,296 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:10:15,296 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♥', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:10:15,297 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:10:27,569 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:10:27,570 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:10:27,571 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:10:27,571 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:10:27,572 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-11 00:10:27,572 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:10:27,572 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:10:27,574 - src.engine.game - INFO - 玩家 player_0 手牌: ('8♥', 'K♥')
2025-03-11 00:10:27,574 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♣', '8♦')
2025-03-11 00:10:27,575 - src.engine.game - INFO - 玩家 ai_2 手牌: ('5♠', '4♣')
2025-03-11 00:10:27,575 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:10:27,575 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:10:27,576 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:10:27,576 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:10:27,577 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:10:27,577 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:10:27,578 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:10:27,578 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:10:32,011 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0}
2025-03-11 00:10:32,012 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'CALL', 'amount': 0, 'timestamp': '2025-03-11T00:10:32.012985', 'table_talk': None}
2025-03-11 00:10:32,012 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.CALL
2025-03-11 00:10:32,013 - src.engine.state - INFO - 玩家 player_0 跟注 20 筹码，已标记为已行动
2025-03-11 00:10:32,013 - src.engine.game - INFO - 玩家 player_0 跟注
2025-03-11 00:10:32,013 - src.engine.state - INFO - 添加动作到历史记录: CALL by player_0
2025-03-11 00:10:32,013 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:10:32,015 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:10:32,015 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:10:32,016 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:10:32,016 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:10:32,017 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:10:32,017 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:10:32,018 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:10:32,018 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:10:32,018 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:10:32,019 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:10:32,019 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:10:32,020 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:10:32,020 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:10:32,021 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3180, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'CALL', 'last_amount': 0}, {'id': 'ai_1', 'chips': 20, 'current_bet': 10, 'is_active': True, 'cards': ('5♣', '8♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1750, 'current_bet': 20, 'is_active': True, 'cards': ('5♠', '4♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:10:32,021 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:10:32,022 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:10:32,022 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:10:32,022 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:10:32,022 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:10:32,023 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:10:32,023 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:10:35,347 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:10:35,349 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:10:35,349 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:10:35,350 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:10:35,351 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:10:35,352 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:10:48,658 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌5♣和8♦非常弱，既没有连牌也没有同花潜力，预示没有翻牌后优势", "position_analysis": "处于前位且筹码仅剩20，承担全下风险过高", "pot_odds": "底池50对比跟注20的风险，在当前手牌情况下赔率不划算", "opponent_reads": ["player_0选择跟注可能暗示手牌中规中矩或稍有优势", "对手筹码丰厚，可承受更大风险，从而有更多主动权"]}, "table_talk": {"message": "各位，我今天牌运欠佳，还是观望为好，下次再战！", "tone": "冷静且坦率"}}
2025-03-11 00:10:48,660 - src.agents.llm - INFO - ==================================================

2025-03-11 00:10:48,661 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，我今天牌运欠佳，还是观望为好，下次再战！', 'tone': '冷静且坦率'}
2025-03-11 00:10:48,662 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:10:48,662 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:10:48,663 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:10:48,663 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:10:48,663 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:10:48,665 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:10:48,665 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:10:48,665 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:10:48,666 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:10:48,666 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:10:48,667 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:10:48,667 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:10:48,667 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:10:48,668 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:10:48,668 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:10:48,669 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:10:48,669 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:10:48,669 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:10:48,669 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:10:48,670 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 50, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3180, 'current_bet': 20, 'is_active': True, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 20, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1750, 'current_bet': 20, 'is_active': True, 'cards': ('5♠', '4♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，我今天牌运欠佳，还是观望为好，下次再战！', 'tone': '冷静且坦率'}}
2025-03-11 00:10:48,672 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:10:48,672 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:10:48,672 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:10:48,673 - src.engine.game - INFO - 检查玩家 player_0: has_acted=True, current_bet=20, is_all_in=False
2025-03-11 00:10:48,673 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:10:48,673 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:10:48,675 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:10:48,676 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:10:48,676 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:10:48,677 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:10:48,677 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:10:48,677 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:10:48,678 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:10:57,320 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌5♠, 4♣在PRE_FLOP阶段非常弱，几乎没有成牌潜力","position_analysis":"位置2在PRE_FLOP阶段较为不利，后续行动受限","pot_odds":"底池赔率不理想，跟注风险较高","opponent_reads":["player_0选择CALL，可能持有中等强度的手牌，但不足以构成威胁"]},"table_talk":{"message":"看来这手牌不太适合我，你们继续吧。","tone":"轻松"}}
2025-03-11 00:10:57,321 - src.agents.llm - INFO - ==================================================

2025-03-11 00:10:57,322 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，你们继续吧。', 'tone': '轻松'}
2025-03-11 00:10:57,322 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:10:57,323 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:10:57,323 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:10:57,324 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:10:57,324 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:10:57,324 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:10:57,324 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:10:57,325 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:10:57,325 - src.engine.state - INFO - 玩家 player_0 获得底池 50 筹码，当前筹码: 3230
2025-03-11 00:10:57,326 - src.engine.game - INFO - 玩家 player_0 获得底池 50 筹码
2025-03-11 00:10:57,326 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:10:57,327 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♥', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:10:57,327 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♥', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3230, 'current_bet': 20, 'is_active': False, 'cards': ('8♥', 'K♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 20, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1750, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，你们继续吧。', 'tone': '轻松'}}
2025-03-11 00:10:57,328 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:10:57,329 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:10:57,329 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:10:57,330 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:10:57,330 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:10:57,331 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:10:57,331 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 50, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('8♥', 'K♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:10:57,331 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:11:10,493 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:11:10,493 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:11:10,495 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:11:10,495 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:11:10,496 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-11 00:11:10,496 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:11:10,497 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:11:10,497 - src.engine.game - INFO - 玩家 player_0 手牌: ('3♦', '5♣')
2025-03-11 00:11:10,497 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♦', '2♥')
2025-03-11 00:11:10,498 - src.engine.game - INFO - 玩家 ai_2 手牌: ('10♥', '6♦')
2025-03-11 00:11:10,498 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:11:10,499 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:11:10,499 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:11:10,500 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:11:10,500 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:11:10,500 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:11:10,501 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:11:10,501 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:11:12,352 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:11:12,353 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:11:12,354 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:11:12,354 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:11:12,355 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:11:12,355 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:11:25,691 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "0.95"}, "reasoning": {"hand_strength": "手牌很弱，5♦和2♥在翻牌前获胜概率极低", "position_analysis": "作为第1个行动者，没有位置优势，加上手牌差，不适合冒险", "pot_odds": "底池已有30，但我仅有20筹码，且需面对至少20的下注投入，不划算", "opponent_reads": ["对手已下注较大筹码，表明他们可能有更强的手牌或策略上的优势"]}, "table_talk": {"message": "各位，好戏还在后头，我现在就退出这一局，等你们放松警惕再见！", "tone": "挑衅而自信"}}
2025-03-11 00:11:25,692 - src.agents.llm - INFO - ==================================================

2025-03-11 00:11:25,693 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '各位，好戏还在后头，我现在就退出这一局，等你们放松警惕再见！', 'tone': '挑衅而自信'}
2025-03-11 00:11:25,693 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:11:25,695 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:11:25,696 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:11:25,696 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:11:25,697 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:11:25,698 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:11:25,699 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:11:25,699 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:11:25,700 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:11:25,700 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:11:25,701 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:11:25,702 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:11:25,702 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:11:25,703 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:11:25,703 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:11:25,704 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:11:25,704 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:11:25,705 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:11:25,705 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3210, 'current_bet': 20, 'is_active': True, 'cards': ('3♦', '5♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 20, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 10, 'is_active': True, 'cards': ('10♥', '6♦'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '各位，好戏还在后头，我现在就退出这一局，等你们放松警惕再见！', 'tone': '挑衅而自信'}}
2025-03-11 00:11:25,706 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:11:25,706 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:11:25,707 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:11:25,708 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:11:25,708 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:11:25,709 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:11:25,710 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:11:25,710 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:11:25,711 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:11:25,711 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:11:25,711 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:11:25,712 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:11:33,267 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌10♥, 6♦在PRE_FLOP阶段较弱，缺乏潜在的高牌或同花顺的可能性","position_analysis":"位置2在早期行动，不利于观察对手行为","pot_odds":"底池30，当前最大注20，跟注需20，赔率较低","opponent_reads":["对手player_0下注20，可能持有较强手牌或试图施压"]},"table_talk":{"message":"看来这手牌不太适合继续，我选择弃牌","tone":"冷静"}}
2025-03-11 00:11:33,267 - src.agents.llm - INFO - ==================================================

2025-03-11 00:11:33,268 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合继续，我选择弃牌', 'tone': '冷静'}
2025-03-11 00:11:33,268 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:11:33,268 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:11:33,268 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:11:33,268 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:11:33,269 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:11:33,269 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:11:33,270 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:11:33,270 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:11:33,270 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3240
2025-03-11 00:11:33,271 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-11 00:11:33,271 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:11:33,271 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♦', '5♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:11:33,273 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♦', '5♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 20, 'is_active': False, 'cards': ('3♦', '5♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 20, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合继续，我选择弃牌', 'tone': '冷静'}}
2025-03-11 00:11:33,274 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:11:33,275 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:11:33,275 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:11:33,276 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:11:33,276 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:11:33,276 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:11:33,276 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('3♦', '5♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:11:33,277 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:11:34,404 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:11:34,405 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:11:34,405 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:11:34,406 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:11:34,406 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-11 00:11:34,407 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:11:34,407 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:11:34,408 - src.engine.game - INFO - 玩家 player_0 手牌: ('9♦', '3♠')
2025-03-11 00:11:34,408 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♣', '9♥')
2025-03-11 00:11:34,408 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♣', 'K♠')
2025-03-11 00:11:34,409 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:11:34,409 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:11:34,409 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:11:34,410 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:11:34,410 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:11:34,411 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:11:34,411 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:11:34,411 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:11:38,774 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:11:38,775 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:11:38.775634', 'table_talk': None}
2025-03-11 00:11:38,776 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:11:38,776 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:11:38,776 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:11:38,777 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:11:38,777 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:11:38,778 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:11:38,778 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:11:38,778 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:11:38,779 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:11:38,779 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:11:38,780 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:11:38,780 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:11:38,781 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:11:38,781 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:11:38,781 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:11:38,783 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:11:38,783 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:11:38,784 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 10, 'current_bet': 10, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1720, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:11:38,784 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:11:38,785 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:11:38,785 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:11:38,785 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:11:38,786 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:11:38,786 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:11:43,306 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:11:43,307 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:11:43,309 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:11:43,309 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:11:43,310 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:11:43,311 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:12:00,439 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "ALL_IN", "amount": "10", "confidence": "1"}, "reasoning": {"hand_strength": "虽然手牌10♣, 9♥在连牌上具有一定潜力，但总体来说并不算强牌；在这种筹码不足的情况下，风险成本极低", "position_analysis": "在预先投入不多的情况下处于较前位置，筹码极少使决策更倾向于激进突破", "pot_odds": "底池为30且对手已经下注20，相对于当前投入全下10来说，风险回报比较可接受", "opponent_reads": ["对手筹码雄厚，可能试图通过施压迫使短筹码玩家弃牌，但也容易因过于自信而暴露己方策略"]}, "table_talk": {"message": "全下！让我们看看谁才是真正的赢家！", "tone": "自信且挑衅"}}
2025-03-11 00:12:00,440 - src.agents.llm - INFO - ==================================================

2025-03-11 00:12:00,440 - src.agents.llm - INFO - 成功将字符串金额 10 转换为数字 10.0
2025-03-11 00:12:00,441 - src.agents.llm - INFO - 生成动作: ALL_IN 金额: 10 table_talk: {'message': '全下！让我们看看谁才是真正的赢家！', 'tone': '自信且挑衅'}
2025-03-11 00:12:00,441 - server - INFO - AI玩家 ai_1 决定执行动作: ALL_IN, 金额: 10
2025-03-11 00:12:00,441 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.ALL_IN
2025-03-11 00:12:00,441 - src.engine.state - INFO - 玩家 ai_1 全下 10 筹码，已标记为已行动
2025-03-11 00:12:00,441 - src.engine.game - INFO - 玩家 ai_1 全下
2025-03-11 00:12:00,441 - src.engine.state - INFO - 添加动作到历史记录: ALL_IN by ai_1
2025-03-11 00:12:00,442 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:12:00,442 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:12:00,442 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:12:00,443 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:12:00,443 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:12:00,444 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:12:00,444 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:00,444 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:12:00,446 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:12:00,446 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=True
2025-03-11 00:12:00,446 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:12:00,447 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:12:00,447 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:12:00,448 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:12:00,448 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 40, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 20, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 0, 'current_bet': 20, 'is_active': True, 'cards': ('10♣', '9♥'), 'is_all_in': True, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'ALL_IN', 'last_amount': 10}, {'id': 'ai_2', 'chips': 1720, 'current_bet': 20, 'is_active': True, 'cards': ('4♣', 'K♠'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '全下！让我们看看谁才是真正的赢家！', 'tone': '自信且挑衅'}}
2025-03-11 00:12:00,449 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:00,450 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:12:00,450 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:12:00,451 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=True, current_bet=20, is_all_in=True
2025-03-11 00:12:00,451 - src.engine.game - INFO - 检查玩家 ai_2: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:12:00,451 - src.engine.game - INFO - 玩家 ai_2 未行动，回合继续
2025-03-11 00:12:00,451 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:12:00,453 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:12:00,453 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:12:00,454 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:12:00,454 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:12:00,454 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:12:00,455 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:12:07,122 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌4♣和K♠在PRE_FLOP阶段较弱，缺乏形成强牌的潜力","position_analysis":"位置2在PRE_FLOP阶段没有明显优势","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["对手ai_1选择ALL_IN，表现出极强的攻击性，可能持有强牌"]},"table_talk":{"message":"看来你很有信心，但我选择退出这局","tone":"冷静"}}
2025-03-11 00:12:07,124 - src.agents.llm - INFO - ==================================================

2025-03-11 00:12:07,125 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来你很有信心，但我选择退出这局', 'tone': '冷静'}
2025-03-11 00:12:07,126 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:12:07,126 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:12:07,127 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:12:07,127 - src.engine.state - INFO - 只剩一个活跃玩家: ai_1
2025-03-11 00:12:07,128 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:12:07,128 - src.engine.game - INFO - 只剩一个活跃玩家: ai_1
2025-03-11 00:12:07,129 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:12:07,129 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:12:07,129 - src.engine.state - INFO - 玩家 ai_1 获得底池 40 筹码，当前筹码: 40
2025-03-11 00:12:07,130 - src.engine.game - INFO - 玩家 ai_1 获得底池 40 筹码
2025-03-11 00:12:07,130 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:12:07,130 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('10♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:12:07,131 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 20, 'max_raise': 0, 'game_result': {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('10♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 40, 'current_bet': 20, 'is_active': False, 'cards': ('10♣', '9♥'), 'is_all_in': True, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1720, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你很有信心，但我选择退出这局', 'tone': '冷静'}}
2025-03-11 00:12:07,133 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:07,133 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:12:07,133 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:12:07,134 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:12:07,134 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:12:07,135 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:12:07,135 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_1', 'pot_amount': 40, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_1', 'hole_cards': ('10♣', '9♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:12:07,136 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:12:14,302 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:12:14,303 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:12:14,303 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:12:14,304 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:12:14,304 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-11 00:12:14,305 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:12:14,305 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:12:14,306 - src.engine.game - INFO - 玩家 player_0 手牌: ('Q♦', 'Q♣')
2025-03-11 00:12:14,306 - src.engine.game - INFO - 玩家 ai_1 手牌: ('6♠', 'J♦')
2025-03-11 00:12:14,306 - src.engine.game - INFO - 玩家 ai_2 手牌: ('4♣', '10♥')
2025-03-11 00:12:14,307 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:12:14,307 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:12:14,307 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:12:14,308 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:12:14,308 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:12:14,309 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:12:14,309 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:12:14,309 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:12:17,143 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:12:17,145 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:12:17,145 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:12:17,146 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:12:17,147 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:12:17,148 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:12:40,614 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.85"}, "reasoning": {"hand_strength": "手牌6♠, J♦在Pre-flop阶段算是边缘弱牌，没有足够的翻牌潜力", "position_analysis": "处于位置1，处于早位，没有太多信息优势，加上对手已有大额下注，局面不利", "pot_odds": "底池30与需要投入的20筹码相比，赔率并不诱人，而且跟注后后续可能进一步投入", "opponent_reads": ["player_0当前下注20，可能持有更强牌", "ai_2虽下注较少，但整体局势倾向保守"]}, "table_talk": {"message": "看来今天我的牌运不佳，理智选择退出这一局。", "tone": "冷静而笃定"}}
2025-03-11 00:12:40,615 - src.agents.llm - INFO - ==================================================

2025-03-11 00:12:40,615 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天我的牌运不佳，理智选择退出这一局。', 'tone': '冷静而笃定'}
2025-03-11 00:12:40,615 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:12:40,616 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:12:40,616 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:12:40,616 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:12:40,616 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:12:40,616 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:12:40,617 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:12:40,617 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:12:40,617 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:12:40,618 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:12:40,618 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:12:40,619 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:40,620 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:12:40,620 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:12:40,621 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:12:40,621 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:12:40,622 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:12:40,622 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:12:40,622 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3220, 'current_bet': 20, 'is_active': True, 'cards': ('Q♦', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 40, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1710, 'current_bet': 10, 'is_active': True, 'cards': ('4♣', '10♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天我的牌运不佳，理智选择退出这一局。', 'tone': '冷静而笃定'}}
2025-03-11 00:12:40,624 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:40,624 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:12:40,626 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:12:40,627 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:12:40,627 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:12:40,627 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:12:40,629 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:12:40,629 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:12:40,630 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:12:40,630 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:12:40,630 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:12:40,632 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:12:47,474 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.8},"reasoning":{"hand_strength":"手牌4♣和10♥在PRE_FLOP阶段较弱，缺乏成牌潜力","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，难以控制后续行动","pot_odds":"底池赔率较低，不值得冒险跟注或加注","opponent_reads":["对手player_0在当前下注20，显示出一定的进攻性，可能持有较强手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-11 00:12:47,475 - src.agents.llm - INFO - ==================================================

2025-03-11 00:12:47,475 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-11 00:12:47,475 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:12:47,476 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:12:47,476 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:12:47,477 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:12:47,477 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:12:47,478 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:12:47,478 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:12:47,479 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:12:47,479 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3250
2025-03-11 00:12:47,480 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-11 00:12:47,480 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:12:47,480 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:12:47,481 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3250, 'current_bet': 20, 'is_active': False, 'cards': ('Q♦', 'Q♣'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 40, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1710, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-11 00:12:47,483 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:47,483 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:12:47,483 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:12:47,485 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:12:47,485 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:12:47,486 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:12:47,486 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('Q♦', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:12:47,487 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:12:49,621 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:12:49,622 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:12:49,622 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:12:49,622 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:12:49,624 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-11 00:12:49,624 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:12:49,624 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:12:49,625 - src.engine.game - INFO - 玩家 player_0 手牌: ('6♥', 'Q♥')
2025-03-11 00:12:49,625 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♣', '6♦')
2025-03-11 00:12:49,626 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♣', 'Q♣')
2025-03-11 00:12:49,626 - src.engine.state - INFO - 玩家 player_0 下注 10 筹码
2025-03-11 00:12:49,626 - src.engine.game - INFO - 玩家 player_0 下注小盲注 10
2025-03-11 00:12:49,627 - src.engine.state - INFO - 玩家 ai_1 下注 20 筹码
2025-03-11 00:12:49,627 - src.engine.game - INFO - 玩家 ai_1 下注大盲注 20
2025-03-11 00:12:49,628 - src.engine.game - INFO - 已收取盲注: 小盲注=player_0(10)，大盲注=ai_1(20)
2025-03-11 00:12:49,628 - src.engine.game - INFO - 当前玩家: ai_2
2025-03-11 00:12:49,629 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:12:49,629 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-11 00:12:52,496 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:12:52,497 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:12:52,497 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:12:52,498 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:12:52,498 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:12:52,499 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:12:59,987 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"RAISE","amount":40,"confidence":0.8},"reasoning":{"hand_strength":"A♣, Q♣是强起手牌，尤其是同花，有很好的潜力","position_analysis":"位置2，可以观察其他玩家的行动，做出更有利的决策","pot_odds":"底池30，当前最大注20，加注到40是合理的，可以增加底池价值","opponent_reads":["player_0下注10，可能持有中等强度的牌","ai_1下注20，可能持有较强的牌或试图偷盲"]},"table_talk":{"message":"看来你们都有点紧张，我来加点压力吧。","tone":"自信"}}
2025-03-11 00:12:59,988 - src.agents.llm - INFO - ==================================================

2025-03-11 00:12:59,989 - src.agents.llm - INFO - 生成动作: RAISE 金额: 40 table_talk: {'message': '看来你们都有点紧张，我来加点压力吧。', 'tone': '自信'}
2025-03-11 00:12:59,989 - server - INFO - AI玩家 ai_2 决定执行动作: RAISE, 金额: 40
2025-03-11 00:12:59,990 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.RAISE
2025-03-11 00:12:59,991 - src.engine.state - INFO - 玩家 ai_2 加注到 40 筹码，已标记为已行动
2025-03-11 00:12:59,991 - src.engine.game - INFO - 玩家 ai_2 加注到 40
2025-03-11 00:12:59,991 - src.engine.state - INFO - 添加动作到历史记录: RAISE by ai_2
2025-03-11 00:12:59,993 - src.engine.game - INFO - 已记录玩家 ai_2 的行动
2025-03-11 00:12:59,993 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_2
2025-03-11 00:12:59,994 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:12:59,994 - src.engine.game - INFO - 找到下一个玩家(从头开始): player_0, 位置: 0
2025-03-11 00:12:59,995 - src.engine.game - INFO - 当前玩家从 ai_2 更新为 player_0
2025-03-11 00:12:59,995 - src.engine.game - INFO - 更新当前玩家为: player_0
2025-03-11 00:12:59,996 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:12:59,996 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:12:59,997 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:12:59,997 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:12:59,997 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:12:59,998 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:12:59,998 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:12:59,999 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'player_0', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 10, 'is_active': True, 'cards': ('6♥', 'Q♥'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 20, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', '6♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1670, 'current_bet': 40, 'is_active': True, 'cards': ('A♣', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'RAISE', 'last_amount': 40}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来你们都有点紧张，我来加点压力吧。', 'tone': '自信'}}
2025-03-11 00:13:00,000 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:13:00,000 - src.engine.game - INFO - 活跃玩家数量: 3, 玩家ID: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:13:00,000 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:13:00,001 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:13:00,001 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:13:00,002 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:13:10,939 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:13:10,939 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:13:10.939942', 'table_talk': None}
2025-03-11 00:13:10,939 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:13:10,941 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:13:10,941 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:13:10,942 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:13:10,942 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:13:10,943 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:13:10,943 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:13:10,943 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:13:10,944 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:13:10,944 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:13:10,945 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:13:10,945 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:13:10,946 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:13:10,946 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:13:10,947 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:13:10,947 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:13:10,947 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:13:10,948 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 70, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 20, 'current_bet': 20, 'is_active': True, 'cards': ('5♣', '6♦'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1670, 'current_bet': 40, 'is_active': True, 'cards': ('A♣', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:13:10,949 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:13:10,949 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:13:10,949 - src.engine.game - INFO - 当前最大下注额: 40
2025-03-11 00:13:10,950 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:13:10,950 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:13:10,950 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:13:15,032 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:13:15,033 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:13:15,033 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:13:15,034 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:13:15,035 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:13:15,035 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:13:36,213 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "", "confidence": "0.9"}, "reasoning": {"hand_strength": "手牌5♣,6♦在PRE_FLOP阶段属于弱牌，没有足够潜力抵抗对手加注", "position_analysis": "位置靠前，加上对手主动加注，处于不利地位", "pot_odds": "虽然底池70对仅需跟注20有一定诱惑，但弱牌无法充分利用底池赔率", "opponent_reads": ["对手筹码充裕且主动加注，显示出强势或有较好牌型"]}, "table_talk": {"message": "看来这局我的牌不适合继续，我选择稳健退出，让你们好好较量。", "tone": "冷静、自信"}}
2025-03-11 00:13:36,214 - src.agents.llm - INFO - ==================================================

2025-03-11 00:13:36,214 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这局我的牌不适合继续，我选择稳健退出，让你们好好较量。', 'tone': '冷静、自信'}
2025-03-11 00:13:36,215 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:13:36,215 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:13:36,216 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:13:36,216 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:13:36,216 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:13:36,217 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:13:36,217 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:13:36,218 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:13:36,218 - src.engine.state - INFO - 玩家 ai_2 获得底池 70 筹码，当前筹码: 1740
2025-03-11 00:13:36,218 - src.engine.game - INFO - 玩家 ai_2 获得底池 70 筹码
2025-03-11 00:13:36,218 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:13:36,219 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♣', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:13:36,219 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♣', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 20, 'current_bet': 20, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 40, 'is_active': False, 'cards': ('A♣', 'Q♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这局我的牌不适合继续，我选择稳健退出，让你们好好较量。', 'tone': '冷静、自信'}}
2025-03-11 00:13:36,221 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:13:36,221 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:13:36,222 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:13:36,222 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:13:36,223 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:13:36,223 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:13:36,223 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 70, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('A♣', 'Q♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:13:36,224 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:13:38,314 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:13:38,315 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:13:38,316 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:13:38,317 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:13:38,317 - src.engine.game - INFO - 庄家位置轮动到: 3
2025-03-11 00:13:38,318 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:13:38,318 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:13:38,318 - src.engine.game - INFO - 玩家 player_0 手牌: ('6♦', 'Q♦')
2025-03-11 00:13:38,319 - src.engine.game - INFO - 玩家 ai_1 手牌: ('10♠', '2♥')
2025-03-11 00:13:38,319 - src.engine.game - INFO - 玩家 ai_2 手牌: ('3♣', 'A♣')
2025-03-11 00:13:38,319 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:13:38,320 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:13:38,320 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:13:38,321 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:13:38,321 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:13:38,321 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:13:38,322 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:13:38,322 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:13:44,084 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:13:44,085 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:13:44.085192', 'table_talk': None}
2025-03-11 00:13:44,085 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:13:44,086 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:13:44,086 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:13:44,087 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:13:44,087 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:13:44,087 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:13:44,088 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:13:44,088 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:13:44,089 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:13:44,089 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:13:44,089 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:13:44,090 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:13:44,090 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:13:44,091 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:13:44,091 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:13:44,091 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:13:44,091 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:13:44,092 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 10, 'current_bet': 10, 'is_active': True, 'cards': ('10♠', '2♥'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1720, 'current_bet': 20, 'is_active': True, 'cards': ('3♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:13:44,093 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:13:44,093 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:13:44,093 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:13:44,094 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:13:44,094 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:13:44,095 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:13:46,236 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:13:46,236 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:13:46,237 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:13:46,238 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:13:46,239 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:13:46,239 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:14:00,571 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "手牌极弱，10♠和2♥毫无竞争力", "position_analysis": "早期位置使得信息不足，加上对手状态激活，风险更大", "pot_odds": "底池虽小，但跟注所需全额筹码与风险不成正比", "opponent_reads": ["对手筹码丰厚且激活，可能运用压力迫使对手弃牌"]}, "table_talk": {"message": "今天就不陪你乱玩了，让你自己去炫耀筹码吧。", "tone": "冷静且略带轻蔑"}}
2025-03-11 00:14:00,572 - src.agents.llm - INFO - ==================================================

2025-03-11 00:14:00,572 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今天就不陪你乱玩了，让你自己去炫耀筹码吧。', 'tone': '冷静且略带轻蔑'}
2025-03-11 00:14:00,573 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:14:00,573 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:14:00,573 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:14:00,573 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:14:00,573 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:14:00,574 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:14:00,574 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:14:00,574 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:14:00,575 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 1750
2025-03-11 00:14:00,575 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-11 00:14:00,576 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:14:00,576 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('3♣', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:14:00,577 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('3♣', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3240, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 10, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1750, 'current_bet': 20, 'is_active': False, 'cards': ('3♣', 'A♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天就不陪你乱玩了，让你自己去炫耀筹码吧。', 'tone': '冷静且略带轻蔑'}}
2025-03-11 00:14:00,578 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:14:00,579 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:14:00,579 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:14:00,579 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:14:00,579 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:14:00,580 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:14:00,580 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('3♣', 'A♣'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:14:00,580 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:14:05,986 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:14:05,986 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:14:05,987 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:14:05,987 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:14:05,988 - src.engine.game - INFO - 庄家位置轮动到: 4
2025-03-11 00:14:05,988 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:14:05,988 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:14:05,989 - src.engine.game - INFO - 玩家 player_0 手牌: ('A♠', '8♠')
2025-03-11 00:14:05,990 - src.engine.game - INFO - 玩家 ai_1 手牌: ('5♥', '2♠')
2025-03-11 00:14:05,991 - src.engine.game - INFO - 玩家 ai_2 手牌: ('A♦', '2♣')
2025-03-11 00:14:05,992 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:14:05,993 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:14:05,994 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:14:05,994 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:14:05,994 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:14:05,995 - src.engine.game - INFO - 当前玩家: ai_1
2025-03-11 00:14:05,995 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:14:05,996 - src.engine.game - INFO - 第一个行动玩家: ai_1, 位置: 1
2025-03-11 00:14:10,606 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:14:10,607 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:14:10,607 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:14:10,608 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:14:10,608 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:14:10,608 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:14:27,669 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "手牌5♥, 2♠极其弱，无任何升级潜力，不具备竞争力", "position_analysis": "处于早期位置，面对已加注对手，局面十分不利", "pot_odds": "底池为30，但投资全下10芯远不足以抵消风险", "opponent_reads": ["对手资金雄厚且已表现出积极进攻姿态"]}, "table_talk": {"message": "今天我的牌没有魔法，就算全下也拯救不了这手烂牌，弃牌吧！", "tone": "轻松自嘲"}}
2025-03-11 00:14:27,670 - src.agents.llm - INFO - ==================================================

2025-03-11 00:14:27,670 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '今天我的牌没有魔法，就算全下也拯救不了这手烂牌，弃牌吧！', 'tone': '轻松自嘲'}
2025-03-11 00:14:27,670 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:14:27,670 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:14:27,670 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:14:27,672 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:14:27,672 - src.engine.state - INFO - 添加动作到历史记录: FOLD by ai_1
2025-03-11 00:14:27,673 - src.engine.game - INFO - 已记录玩家 ai_1 的行动
2025-03-11 00:14:27,673 - src.engine.game - INFO - 更新当前玩家，原始玩家: ai_1
2025-03-11 00:14:27,674 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:14:27,674 - src.engine.game - INFO - 找到下一个玩家: ai_2, 位置: 2
2025-03-11 00:14:27,675 - src.engine.game - INFO - 当前玩家从 ai_1 更新为 ai_2
2025-03-11 00:14:27,675 - src.engine.game - INFO - 更新当前玩家为: ai_2
2025-03-11 00:14:27,676 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:14:27,676 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:14:27,676 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:14:27,677 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:14:27,677 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:14:27,678 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:14:27,678 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:14:27,678 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_2', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3220, 'current_bet': 20, 'is_active': True, 'cards': ('A♠', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 10, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 10, 'is_active': True, 'cards': ('A♦', '2♣'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '今天我的牌没有魔法，就算全下也拯救不了这手烂牌，弃牌吧！', 'tone': '轻松自嘲'}}
2025-03-11 00:14:27,679 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:14:27,680 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['player_0', 'ai_2']
2025-03-11 00:14:27,680 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:14:27,681 - src.engine.game - INFO - 检查玩家 player_0: has_acted=False, current_bet=20, is_all_in=False
2025-03-11 00:14:27,681 - src.engine.game - INFO - 玩家 player_0 未行动，回合继续
2025-03-11 00:14:27,682 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:14:27,683 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:14:27,683 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:14:27,684 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:14:27,684 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:14:27,685 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:14:27,685 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:14:34,411 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.9},"reasoning":{"hand_strength":"手牌A♦, 2♣在PRE_FLOP阶段较弱，缺乏潜在的强牌组合","position_analysis":"处于中间位置，缺乏位置优势","pot_odds":"底池赔率不理想，不值得冒险跟注或加注","opponent_reads":["对手player_0下注20，表明其有一定的牌力，可能持有较强的起手牌"]},"table_talk":{"message":"看来这手牌不太适合我，我选择弃牌","tone":"冷静"}}
2025-03-11 00:14:34,412 - src.agents.llm - INFO - ==================================================

2025-03-11 00:14:34,413 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}
2025-03-11 00:14:34,413 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:14:34,413 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:14:34,414 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:14:34,414 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:14:34,415 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:14:34,416 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:14:34,416 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:14:34,417 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:14:34,417 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3250
2025-03-11 00:14:34,418 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-11 00:14:34,418 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:14:34,420 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♠', '8♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:14:34,421 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♠', '8♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3250, 'current_bet': 20, 'is_active': False, 'cards': ('A♠', '8♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 10, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不太适合我，我选择弃牌', 'tone': '冷静'}}
2025-03-11 00:14:34,423 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:14:34,423 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:14:34,424 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:14:34,424 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:14:34,426 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:14:34,426 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:14:34,426 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('A♠', '8♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:14:34,426 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:14:36,047 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:14:36,048 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:14:36,049 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:14:36,049 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:14:36,049 - src.engine.game - INFO - 庄家位置轮动到: 0
2025-03-11 00:14:36,050 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_1', 'ai_2']
2025-03-11 00:14:36,050 - src.engine.dealer - INFO - Dealt hole cards to 3 players
2025-03-11 00:14:36,050 - src.engine.game - INFO - 玩家 player_0 手牌: ('7♥', '10♦')
2025-03-11 00:14:36,051 - src.engine.game - INFO - 玩家 ai_1 手牌: ('Q♦', '6♣')
2025-03-11 00:14:36,051 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♣', 'Q♥')
2025-03-11 00:14:36,052 - src.engine.state - INFO - 玩家 ai_1 下注 10 筹码
2025-03-11 00:14:36,052 - src.engine.game - INFO - 玩家 ai_1 下注小盲注 10
2025-03-11 00:14:36,052 - src.engine.state - INFO - 玩家 ai_2 下注 20 筹码
2025-03-11 00:14:36,053 - src.engine.game - INFO - 玩家 ai_2 下注大盲注 20
2025-03-11 00:14:36,054 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_1(10)，大盲注=ai_2(20)
2025-03-11 00:14:36,054 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:14:36,055 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:14:36,055 - src.engine.game - INFO - 第一个行动玩家: player_0, 位置: 0
2025-03-11 00:14:55,688 - server - INFO - 处理玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0}
2025-03-11 00:14:55,689 - server - INFO - 创建的玩家动作: {'player_id': 'player_0', 'action_type': 'FOLD', 'amount': 0, 'timestamp': '2025-03-11T00:14:55.689929', 'table_talk': None}
2025-03-11 00:14:55,690 - src.engine.game - INFO - 处理玩家 player_0 的行动: ActionType.FOLD
2025-03-11 00:14:55,690 - src.engine.state - INFO - 玩家 player_0 弃牌
2025-03-11 00:14:55,690 - src.engine.game - INFO - 玩家 player_0 弃牌
2025-03-11 00:14:55,691 - src.engine.state - INFO - 添加动作到历史记录: FOLD by player_0
2025-03-11 00:14:55,691 - src.engine.game - INFO - 已记录玩家 player_0 的行动
2025-03-11 00:14:55,692 - src.engine.game - INFO - 更新当前玩家，原始玩家: player_0
2025-03-11 00:14:55,692 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:14:55,693 - src.engine.game - INFO - 找到下一个玩家: ai_1, 位置: 1
2025-03-11 00:14:55,693 - src.engine.game - INFO - 当前玩家从 player_0 更新为 ai_1
2025-03-11 00:14:55,693 - src.engine.game - INFO - 更新当前玩家为: ai_1
2025-03-11 00:14:55,695 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:14:55,695 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:14:55,695 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:14:55,695 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:14:55,696 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:14:55,696 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:14:55,697 - src.engine.game - INFO - 回合是否完成: False
2025-03-11 00:14:55,697 - server - INFO - 发送更新后的游戏状态: {'phase': 'PRE_FLOP', 'pot_size': 30, 'community_cards': [], 'current_player': 'ai_1', 'min_raise': 0, 'max_raise': 0, 'game_result': None, 'players': [{'id': 'player_0', 'chips': 3250, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_1', 'chips': 0, 'current_bet': 10, 'is_active': True, 'cards': ('Q♦', '6♣'), 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1720, 'current_bet': 20, 'is_active': True, 'cards': ('2♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}]}
2025-03-11 00:14:55,698 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:14:55,698 - src.engine.game - INFO - 活跃玩家数量: 2, 玩家ID: ['ai_1', 'ai_2']
2025-03-11 00:14:55,698 - src.engine.game - INFO - 当前最大下注额: 20
2025-03-11 00:14:55,698 - src.engine.game - INFO - 检查玩家 ai_1: has_acted=False, current_bet=10, is_all_in=False
2025-03-11 00:14:55,700 - src.engine.game - INFO - 玩家 ai_1 未行动，回合继续
2025-03-11 00:14:55,700 - src.engine.game - INFO - 回合完成判断: 所有玩家已行动=False, 所有下注相等=True, 回合完成=False
2025-03-11 00:14:59,438 - server - INFO - 当前AI玩家: ai_1
2025-03-11 00:14:59,440 - server - INFO - AI玩家 ai_1 开始观察游戏状态
2025-03-11 00:14:59,440 - src.agents.llm - INFO - AI玩家 ai_1 观察到新的游戏状态
2025-03-11 00:14:59,441 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:14:59,441 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:14:59,442 - src.agents.llm - INFO - 使用模型: openrouter/openai/o3-mini
2025-03-11 00:15:11,805 - src.agents.llm - INFO - 
💭 决策结果:
{"action": {"type": "FOLD", "amount": "0", "confidence": "1"}, "reasoning": {"hand_strength": "Q♦和6♣的组合在前牌阶段属于弱手牌，加上筹码为0，无力后续竞争", "position_analysis": "处于早位且筹码已经耗尽，无法利用位置优势进行反击", "pot_odds": "底池30与当前最大注20的比例并不吸引，同时无筹码跟注", "opponent_reads": ["对手状态激进，当前已下注20，增加了跟注的风险"]}, "table_talk": {"message": "看来今天这手牌不在我的菜单上，退出战局吧。", "tone": "冷静坚定"}}
2025-03-11 00:15:11,807 - src.agents.llm - INFO - ==================================================

2025-03-11 00:15:11,808 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来今天这手牌不在我的菜单上，退出战局吧。', 'tone': '冷静坚定'}
2025-03-11 00:15:11,810 - server - INFO - AI玩家 ai_1 决定执行动作: FOLD, 金额: 0
2025-03-11 00:15:11,810 - src.engine.game - INFO - 处理玩家 ai_1 的行动: ActionType.FOLD
2025-03-11 00:15:11,810 - src.engine.state - INFO - 玩家 ai_1 弃牌
2025-03-11 00:15:11,811 - src.engine.state - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:15:11,811 - src.engine.game - INFO - 玩家 ai_1 弃牌
2025-03-11 00:15:11,812 - src.engine.game - INFO - 只剩一个活跃玩家: ai_2
2025-03-11 00:15:11,812 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:15:11,813 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:15:11,814 - src.engine.state - INFO - 玩家 ai_2 获得底池 30 筹码，当前筹码: 1750
2025-03-11 00:15:11,814 - src.engine.game - INFO - 玩家 ai_2 获得底池 30 筹码
2025-03-11 00:15:11,815 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:15:11,815 - src.engine.game - INFO - 游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('2♣', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:15:11,816 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('2♣', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3250, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 0, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_2', 'chips': 1750, 'current_bet': 20, 'is_active': False, 'cards': ('2♣', 'Q♥'), 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': None, 'last_amount': None}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来今天这手牌不在我的菜单上，退出战局吧。', 'tone': '冷静坚定'}}
2025-03-11 00:15:11,817 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:15:11,818 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:15:11,818 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:15:11,818 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:15:11,818 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:15:11,820 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:15:11,821 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'ai_2', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'ai_2', 'hole_cards': ('2♣', 'Q♥'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:15:11,821 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:15:13,214 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:15:13,215 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:15:13,216 - src.engine.game - INFO - 玩家 ai_1 筹码为0，保持不活跃状态
2025-03-11 00:15:13,216 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:15:13,217 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:15:13,217 - src.engine.game - INFO - 庄家位置轮动到: 1
2025-03-11 00:15:13,218 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_2']
2025-03-11 00:15:13,218 - src.engine.dealer - INFO - Dealt hole cards to 2 players
2025-03-11 00:15:13,218 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♣', 'K♠')
2025-03-11 00:15:13,218 - src.engine.game - INFO - 玩家 ai_2 手牌: ('2♦', '2♥')
2025-03-11 00:15:13,219 - src.engine.state - INFO - 玩家 ai_2 下注 10 筹码
2025-03-11 00:15:13,219 - src.engine.game - INFO - 玩家 ai_2 下注小盲注 10
2025-03-11 00:15:13,220 - src.engine.state - INFO - 玩家 player_0 下注 20 筹码
2025-03-11 00:15:13,220 - src.engine.game - INFO - 玩家 player_0 下注大盲注 20
2025-03-11 00:15:13,220 - src.engine.game - INFO - 已收取盲注: 小盲注=ai_2(10)，大盲注=player_0(20)
2025-03-11 00:15:13,221 - src.engine.game - INFO - 当前玩家: player_0
2025-03-11 00:15:13,221 - src.engine.game - INFO - 游戏 ebfe7e47-85cc-4107-ada1-d8466e0d6d6e 开始，进入翻牌前阶段
2025-03-11 00:15:13,222 - src.engine.game - INFO - 第一个行动玩家: ai_2, 位置: 2
2025-03-11 00:15:16,815 - server - INFO - 当前AI玩家: ai_2
2025-03-11 00:15:16,815 - server - INFO - AI玩家 ai_2 开始观察游戏状态
2025-03-11 00:15:16,816 - src.agents.llm - INFO - AI玩家 ai_2 观察到新的游戏状态
2025-03-11 00:15:16,816 - src.agents.llm - INFO - 
==================================================
2025-03-11 00:15:16,816 - src.agents.llm - INFO - 🤖 AI玩家 {self.agent_id} 思考中...
2025-03-11 00:15:16,817 - src.agents.llm - INFO - 使用模型: openai/deepseek-v3
2025-03-11 00:15:24,677 - src.agents.llm - INFO - 
💭 决策结果:
{"action":{"type":"FOLD","amount":0,"confidence":0.85},"reasoning":{"hand_strength":"手牌2♦, 2♥在PRE_FLOP阶段强度较低，成对的可能性很小，且难以在后续公共牌中形成强牌。","position_analysis":"位置2在PRE_FLOP阶段处于不利位置，后续行动中可能会被对手压制。","pot_odds":"底池赔率在当前情况下不值得冒险跟注或加注。","opponent_reads":["对手player_0在当前下注20，显示出一定的进攻性，可能持有较强的手牌。"]},"table_talk":{"message":"看来这手牌不适合我，我选择弃牌。","tone":"冷静"}}
2025-03-11 00:15:24,678 - src.agents.llm - INFO - ==================================================

2025-03-11 00:15:24,679 - src.agents.llm - INFO - 生成动作: FOLD 金额: 0 table_talk: {'message': '看来这手牌不适合我，我选择弃牌。', 'tone': '冷静'}
2025-03-11 00:15:24,679 - server - INFO - AI玩家 ai_2 决定执行动作: FOLD, 金额: 0
2025-03-11 00:15:24,680 - src.engine.game - INFO - 处理玩家 ai_2 的行动: ActionType.FOLD
2025-03-11 00:15:24,680 - src.engine.state - INFO - 玩家 ai_2 弃牌
2025-03-11 00:15:24,682 - src.engine.state - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:15:24,682 - src.engine.game - INFO - 玩家 ai_2 弃牌
2025-03-11 00:15:24,682 - src.engine.game - INFO - 只剩一个活跃玩家: player_0
2025-03-11 00:15:24,683 - src.engine.game - INFO - 开始游戏结算
2025-03-11 00:15:24,683 - src.engine.game - INFO - 活跃玩家数量: 1
2025-03-11 00:15:24,684 - src.engine.state - INFO - 玩家 player_0 获得底池 30 筹码，当前筹码: 3260
2025-03-11 00:15:24,684 - src.engine.game - INFO - 玩家 player_0 获得底池 30 筹码
2025-03-11 00:15:24,685 - src.engine.state - INFO - 已停止所有玩家的行动
2025-03-11 00:15:24,685 - src.engine.game - INFO - 游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♣', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:15:24,686 - server - INFO - 发送AI行动后的游戏状态: {'phase': 'FINISHED', 'pot_size': 0, 'community_cards': [], 'current_player': None, 'min_raise': 0, 'max_raise': 0, 'game_result': {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♣', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}, 'players': [{'id': 'player_0', 'chips': 3260, 'current_bet': 20, 'is_active': False, 'cards': ('5♣', 'K♠'), 'is_all_in': False, 'position': 0, 'model_name': None, 'last_action': None, 'last_amount': None}, {'id': 'ai_1', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 1, 'model_name': 'openrouter/openai/o3-mini', 'last_action': None, 'last_amount': None}, {'id': 'ai_2', 'chips': 1740, 'current_bet': 10, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 2, 'model_name': 'openai/deepseek-v3', 'last_action': 'FOLD', 'last_amount': 0}, {'id': 'ai_3', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 3, 'model_name': 'openrouter/anthropic/claude-3.7-sonnet', 'last_action': None, 'last_amount': None}, {'id': 'ai_4', 'chips': 0, 'current_bet': 0, 'is_active': False, 'cards': [], 'is_all_in': False, 'position': 4, 'model_name': 'openai/qwen-max', 'last_action': None, 'last_amount': None}], 'table_talk': {'message': '看来这手牌不适合我，我选择弃牌。', 'tone': '冷静'}}
2025-03-11 00:15:24,688 - src.engine.game - INFO - 检查回合是否完成
2025-03-11 00:15:24,688 - src.engine.game - INFO - 活跃玩家数量: 0, 玩家ID: []
2025-03-11 00:15:24,688 - src.engine.game - INFO - 没有活跃玩家，回合完成
2025-03-11 00:15:24,690 - server - INFO - 回合结束，进入下一阶段
2025-03-11 00:15:24,692 - src.engine.game - INFO - 从阶段 GameStage.FINISHED 进入下一阶段
2025-03-11 00:15:24,692 - src.engine.game - INFO - 游戏已结束，不进入下一阶段
2025-03-11 00:15:24,693 - server - INFO - 游戏已结束，发送游戏结果: {'winner_id': 'player_0', 'pot_amount': 30, 'winning_hand': None, 'community_cards': [], 'showdown_data': [{'player_id': 'player_0', 'hole_cards': ('5♣', 'K♠'), 'hand_rank': 'WINNER_BY_FOLD', 'is_winner': True}]}
2025-03-11 00:15:24,693 - server - INFO - 游戏进入新阶段: FINISHED
2025-03-11 00:15:26,747 - src.engine.dealer - INFO - Deck has been reset and shuffled
2025-03-11 00:15:26,748 - src.engine.state - INFO - 游戏状态已完全重置，准备开始新局
2025-03-11 00:15:26,748 - src.engine.game - INFO - 玩家 ai_1 筹码为0，保持不活跃状态
2025-03-11 00:15:26,748 - src.engine.game - INFO - 玩家 ai_3 筹码为0，保持不活跃状态
2025-03-11 00:15:26,750 - src.engine.game - INFO - 玩家 ai_4 筹码为0，保持不活跃状态
2025-03-11 00:15:26,750 - src.engine.game - INFO - 庄家位置轮动到: 2
2025-03-11 00:15:26,750 - src.engine.game - INFO - 开始新的一局游戏，活跃玩家: ['player_0', 'ai_2']
2025-03-11 00:15:26,751 - src.engine.dealer - INFO - Dealt hole cards to 2 players
2025-03-11 00:15:26,751 - src.engine.game - INFO - 玩家 player_0 手牌: ('5♥', '3♣')
2025-03-11 00:15:26,751 - src.engine.game - INFO - 玩家 ai_2 手牌: ('9♦', '10♠')
2025-03-11 00:15:26,752 - server - ERROR - 开始新游戏失败: 无法找到小盲注或大盲注玩家
2025-03-11 00:15:27,419 - server - ERROR - 开始新游戏失败: 400: Game is not finished
2025-03-11 00:15:28,393 - server - ERROR - 开始新游戏失败: 400: Game is not finished
2025-03-11 00:15:29,472 - server - ERROR - 开始新游戏失败: 400: Game is not finished
2025-03-11 00:15:31,136 - server - ERROR - 开始新游戏失败: 400: Game is not finished
2025-03-11 00:17:17,560 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:17:17,564 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:18:40,737 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:18:40,741 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:19:36,580 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:19:36,583 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:19:55,041 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:19:55,045 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:20:34,173 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:20:34,177 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:21:25,124 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:21:25,129 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:21:40,472 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:21:40,475 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
2025-03-11 00:22:07,015 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\game.yml
2025-03-11 00:22:07,018 - src.utils.config - INFO - 成功加载配置文件: c:\Users\YiCheng\TexasHoldemAgent\config\llm.yml
